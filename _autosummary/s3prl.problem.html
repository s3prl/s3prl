<!doctype html>
<html class="no-js" lang="en">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="asr" href="s3prl.problem.asr.html" /><link rel="prev" title="upstream" href="s3prl.nn.upstream.html" />

    <!-- Generated with Sphinx 5.1.1 and Furo 2023.03.27 -->
        <title>problem - S3PRL 0.4.13 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=fad236701ea90a88636c2a8c73b44ae642ed2a53" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">S3PRL 0.4.13
 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">S3PRL 0.4.13
 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/installation.html">Install S3PRL</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/upstream_collection.html">S3PRL Upstream Collection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/problem.html">Use Problem module to run customizable recipes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">How to Contribute</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contribute/general.html">General Guideline</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribute/upstream.html">Adding New Upstream</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul class="current">
<li class="toctree-l1 has-children"><a class="reference internal" href="s3prl.nn.html">nn</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="s3prl.nn.beam_decoder.html">beam_decoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="s3prl.nn.common.html">common</a></li>
<li class="toctree-l2"><a class="reference internal" href="s3prl.nn.hear.html">hear</a></li>
<li class="toctree-l2"><a class="reference internal" href="s3prl.nn.interface.html">interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="s3prl.nn.linear.html">linear</a></li>
<li class="toctree-l2"><a class="reference internal" href="s3prl.nn.pit.html">pit</a></li>
<li class="toctree-l2"><a class="reference internal" href="s3prl.nn.pooling.html">pooling</a></li>
<li class="toctree-l2"><a class="reference internal" href="s3prl.nn.rnn.html">rnn</a></li>
<li class="toctree-l2"><a class="reference internal" href="s3prl.nn.speaker_loss.html">speaker_loss</a></li>
<li class="toctree-l2"><a class="reference internal" href="s3prl.nn.speaker_model.html">speaker_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="s3prl.nn.specaug.html">specaug</a></li>
<li class="toctree-l2"><a class="reference internal" href="s3prl.nn.upstream.html">upstream</a></li>
</ul>
</li>
<li class="toctree-l1 current has-children current-page"><a class="current reference internal" href="#">problem</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="s3prl.problem.asr.html">asr</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="s3prl.problem.asr.run.html">run</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.problem.asr.superb_asr.html">superb_asr</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.problem.asr.superb_pr.html">superb_pr</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.problem.asr.superb_sf.html">superb_sf</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="s3prl.problem.asv.html">asv</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="s3prl.problem.asv.run.html">run</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.problem.asv.superb_asv.html">superb_asv</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="s3prl.problem.base.html">base</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="s3prl.problem.common.html">common</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="s3prl.problem.common.example.html">example</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.problem.common.hear_beijing_opera.html">hear_beijing_opera</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.problem.common.hear_cremad.html">hear_cremad</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.problem.common.hear_dcase_2016_task2.html">hear_dcase_2016_task2</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.problem.common.hear_esc50.html">hear_esc50</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.problem.common.hear_fsd.html">hear_fsd</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.problem.common.hear_gsc5hr.html">hear_gsc5hr</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.problem.common.hear_gtzan.html">hear_gtzan</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.problem.common.hear_gtzan_music_speech.html">hear_gtzan_music_speech</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.problem.common.hear_gunshot.html">hear_gunshot</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.problem.common.hear_libricount.html">hear_libricount</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.problem.common.hear_maestro.html">hear_maestro</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.problem.common.hear_nsynth5hr.html">hear_nsynth5hr</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.problem.common.hear_stroke.html">hear_stroke</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.problem.common.hear_tonic.html">hear_tonic</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.problem.common.hear_vocal.html">hear_vocal</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.problem.common.hear_vox_lingual.html">hear_vox_lingual</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.problem.common.run.html">run</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.problem.common.superb_er.html">superb_er</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.problem.common.superb_ic.html">superb_ic</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.problem.common.superb_ks.html">superb_ks</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.problem.common.superb_sid.html">superb_sid</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="s3prl.problem.diarization.html">diarization</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="s3prl.problem.diarization.run.html">run</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.problem.diarization.superb_sd.html">superb_sd</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.problem.diarization.util.html">util</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="s3prl.task.html">task</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="s3prl.task.base.html">base</a></li>
<li class="toctree-l2"><a class="reference internal" href="s3prl.task.diarization.html">diarization</a></li>
<li class="toctree-l2"><a class="reference internal" href="s3prl.task.dump_feature.html">dump_feature</a></li>
<li class="toctree-l2"><a class="reference internal" href="s3prl.task.event_prediction.html">event_prediction</a></li>
<li class="toctree-l2"><a class="reference internal" href="s3prl.task.scene_prediction.html">scene_prediction</a></li>
<li class="toctree-l2"><a class="reference internal" href="s3prl.task.speaker_verification_task.html">speaker_verification_task</a></li>
<li class="toctree-l2"><a class="reference internal" href="s3prl.task.speech2text_ctc_task.html">speech2text_ctc_task</a></li>
<li class="toctree-l2"><a class="reference internal" href="s3prl.task.utterance_classification_task.html">utterance_classification_task</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="s3prl.dataio.html">dataio</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="s3prl.dataio.collate_fn.html">collate_fn</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="s3prl.dataio.corpus.html">corpus</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="s3prl.dataio.corpus.base.html">base</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.dataio.corpus.fluent_speech_commands.html">fluent_speech_commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.dataio.corpus.iemocap.html">iemocap</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.dataio.corpus.librilight.html">librilight</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.dataio.corpus.librispeech.html">librispeech</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.dataio.corpus.quesst14.html">quesst14</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.dataio.corpus.snips.html">snips</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.dataio.corpus.speech_commands.html">speech_commands</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.dataio.corpus.voxceleb1sid.html">voxceleb1sid</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.dataio.corpus.voxceleb1sv.html">voxceleb1sv</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="s3prl.dataio.dataset.html">dataset</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="s3prl.dataio.dataset.base.html">base</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.dataio.dataset.diarization.html">diarization</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.dataio.dataset.encode.html">encode</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.dataio.dataset.frame_label.html">frame_label</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.dataio.dataset.load_audio.html">load_audio</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.dataio.dataset.util.html">util</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="s3prl.dataio.encoder.html">encoder</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="s3prl.dataio.encoder.category.html">category</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.dataio.encoder.g2p.html">g2p</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.dataio.encoder.tokenizer.html">tokenizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.dataio.encoder.vocabulary.html">vocabulary</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="s3prl.dataio.sampler.html">sampler</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="s3prl.dataio.sampler.balanced_weighted_sampler.html">balanced_weighted_sampler</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.dataio.sampler.distributed_sampler.html">distributed_sampler</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.dataio.sampler.fixed_batch_size_batch_sampler.html">fixed_batch_size_batch_sampler</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.dataio.sampler.group_same_item_sampler.html">group_same_item_sampler</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.dataio.sampler.max_timestamp_batch_sampler.html">max_timestamp_batch_sampler</a></li>
<li class="toctree-l3"><a class="reference internal" href="s3prl.dataio.sampler.sorted_sampler.html">sorted_sampler</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="s3prl.metric.html">metric</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="s3prl.metric.common.html">common</a></li>
<li class="toctree-l2"><a class="reference internal" href="s3prl.metric.diarization.html">diarization</a></li>
<li class="toctree-l2"><a class="reference internal" href="s3prl.metric.slot_filling.html">slot_filling</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="s3prl.util.html">util</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="s3prl.util.audio_info.html">audio_info</a></li>
<li class="toctree-l2"><a class="reference internal" href="s3prl.util.benchmark.html">benchmark</a></li>
<li class="toctree-l2"><a class="reference internal" href="s3prl.util.download.html">download</a></li>
<li class="toctree-l2"><a class="reference internal" href="s3prl.util.override.html">override</a></li>
<li class="toctree-l2"><a class="reference internal" href="s3prl.util.pseudo_data.html">pseudo_data</a></li>
<li class="toctree-l2"><a class="reference internal" href="s3prl.util.seed.html">seed</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="problem">
<h1>problem<a class="headerlink" href="#problem" title="Permalink to this heading">#</a></h1>
<p><strong>(s3prl.problem)</strong></p>
<span class="target" id="module-s3prl.problem"></span><p>Pre-defined python recipes with customizable methods</p>
<div class="table-wrapper autosummary longtable docutils container">
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="s3prl.problem.asr.html#module-s3prl.problem.asr" title="s3prl.problem.asr"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.problem.asr</span></code></a></p></td>
<td><p>Speech-to-text based recipes</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="s3prl.problem.asv.html#module-s3prl.problem.asv" title="s3prl.problem.asv"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.problem.asv</span></code></a></p></td>
<td><p>Speaker Verification recipes</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="s3prl.problem.base.html#module-s3prl.problem.base" title="s3prl.problem.base"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.problem.base</span></code></a></p></td>
<td><p>The shared backbone of common ML train/test procedure for all problems</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="s3prl.problem.common.html#module-s3prl.problem.common" title="s3prl.problem.common"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.problem.common</span></code></a></p></td>
<td><p>The most common and simple train/valid/test recipes</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="s3prl.problem.diarization.html#module-s3prl.problem.diarization" title="s3prl.problem.diarization"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.problem.diarization</span></code></a></p></td>
<td><p>Speaker Diarization recipes</p></td>
</tr>
</tbody>
</table>
</div>
<section id="superbasr">
<h2>SuperbASR<a class="headerlink" href="#superbasr" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">s3prl.problem.</span></span><span class="sig-name descname"><span class="pre">SuperbASR</span></span><a class="reference internal" href="../_modules/s3prl/problem/asr/superb_asr.html#SuperbASR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/asr/superb_asr.py#L165-L530"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASR" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="s3prl.problem.asr.run.html#s3prl.problem.asr.run.ASR" title="s3prl.problem.asr.run.ASR"><code class="xref py py-class docutils literal notranslate"><span class="pre">ASR</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASR.default_config">
<span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/s3prl/problem/asr/superb_asr.html#SuperbASR.default_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/asr/superb_asr.py#L166-L257"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASR.default_config" title="Permalink to this definition">#</a></dt>
<dd><p>The default arguments for <a class="reference internal" href="#s3prl.problem.SuperbASR.run" title="s3prl.problem.SuperbASR.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> in yaml.
Note that for the fields with inner values, like <code class="code docutils literal notranslate"><span class="pre">build_model</span></code>,
the outer field name corresponds to a method name, so you can find the method
<a class="reference internal" href="#s3prl.problem.SuperbASR.build_model" title="s3prl.problem.SuperbASR.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>. Furthermore, the values inside that field will be
directly passed into the method. So by changing these inner values, you
can directly affect the behavior of the corresponding method. See the method
documentation for all the supported arguments and their meanings.</p>
<p>The methods affected by the following config are: <a class="reference internal" href="#s3prl.problem.SuperbASR.prepare_data" title="s3prl.problem.SuperbASR.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbASR.prepare_tokenizer_data" title="s3prl.problem.SuperbASR.prepare_tokenizer_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_tokenizer_data</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbASR.build_tokenizer" title="s3prl.problem.SuperbASR.build_tokenizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_tokenizer</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbASR.build_dataset" title="s3prl.problem.SuperbASR.build_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_dataset</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbASR.build_batch_sampler" title="s3prl.problem.SuperbASR.build_batch_sampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_batch_sampler</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbASR.build_upstream" title="s3prl.problem.SuperbASR.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbASR.build_featurizer" title="s3prl.problem.SuperbASR.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbASR.build_downstream" title="s3prl.problem.SuperbASR.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbASR.build_model" title="s3prl.problem.SuperbASR.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbASR.build_task" title="s3prl.problem.SuperbASR.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbASR.build_optimizer" title="s3prl.problem.SuperbASR.build_optimizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_optimizer</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbASR.build_scheduler" title="s3prl.problem.SuperbASR.build_scheduler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_scheduler</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbASR.save_model" title="s3prl.problem.SuperbASR.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbASR.save_task" title="s3prl.problem.SuperbASR.save_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_task</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbASR.train" title="s3prl.problem.SuperbASR.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">start</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="nt">stop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">target_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">cache_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">remove_all_cache</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">prepare_data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">dataset_root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="w">  </span><span class="nt">train_sets</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">train-clean-100</span>
<span class="w">  </span><span class="nt">valid_sets</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dev-clean</span>
<span class="w">  </span><span class="nt">test_sets</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test-clean</span>
<span class="nt">prepare_tokenizer_data</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">build_tokenizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">vocab_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">character</span>
<span class="nt">build_dataset</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">build_batch_sampler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">train</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">32</span>
<span class="w">    </span><span class="nt">max_length</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2000</span>
<span class="w">    </span><span class="nt">shuffle</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">valid</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">test</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="nt">build_upstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">build_featurizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">layer_selections</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="nt">normalize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_downstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">model_conf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">LSTM</span>
<span class="w">    </span><span class="nt">proj_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1024</span>
<span class="w">    </span><span class="nt">hidden_size</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1024</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1024</span>
<span class="w">    </span><span class="nt">dropout</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.2</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.2</span>
<span class="w">    </span><span class="nt">layer_norm</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">    </span><span class="nt">proj</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">    </span><span class="nt">sample_rate</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">sample_style</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">concat</span>
<span class="w">    </span><span class="nt">bidirectional</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">specaug_conf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">freq_mask_width_range</span><span class="p">:</span><span class="w"> </span><span class="kt">!!python/tuple</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50</span>
<span class="w">    </span><span class="nt">num_freq_mask</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span>
<span class="w">    </span><span class="nt">time_mask_width_range</span><span class="p">:</span><span class="w"> </span><span class="kt">!!python/tuple</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">40</span>
<span class="w">    </span><span class="nt">num_time_mask</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="nt">build_model</span><span class="p">:</span>
<span class="w">  </span><span class="nt">upstream_trainable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_task</span><span class="p">:</span>
<span class="w">  </span><span class="nt">log_metrics</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cer</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">wer</span>
<span class="nt">build_optimizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Adam</span>
<span class="w">  </span><span class="nt">conf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">lr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0001</span>
<span class="nt">build_scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ExponentialLR</span>
<span class="w">  </span><span class="nt">gamma</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.9</span>
<span class="nt">save_model</span><span class="p">:</span>
<span class="w">  </span><span class="nt">extra_conf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">build_downstream_conf</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${build_downstream}</span>
<span class="nt">save_task</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">train</span><span class="p">:</span>
<span class="w">  </span><span class="nt">total_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">200000</span>
<span class="w">  </span><span class="nt">log_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">  </span><span class="nt">eval_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2000</span>
<span class="w">  </span><span class="nt">save_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">500</span>
<span class="w">  </span><span class="nt">gradient_clipping</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0</span>
<span class="w">  </span><span class="nt">gradient_accumulate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">valid_metric</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">wer</span>
<span class="w">  </span><span class="nt">valid_higher_better</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">  </span><span class="nt">auto_resume</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">resume_ckpt_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASR.prepare_data">
<span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/asr/superb_asr.html#SuperbASR.prepare_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/asr/superb_asr.py#L259-L297"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASR.prepare_data" title="Permalink to this definition">#</a></dt>
<dd><p>Prepare the task-specific data metadata (path, labels…).
By default call <code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_librispeech</span></code> with <code class="code docutils literal notranslate"><span class="pre">**prepare_data</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prepare_data</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbASR.default_config" title="s3prl.problem.SuperbASR.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments in <code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_librispeech</span></code></p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Parse your corpus and save the csv file into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the parsing or preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>train_path (str)</p></li>
<li><p>valid_path (str)</p></li>
<li><p>test_paths (List[str])</p></li>
</ol>
<p>Each path (str) should be a csv file containing the following columns:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>column</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>(str) - the unique id for this data point</p></td>
</tr>
<tr class="row-odd"><td><p>wav_path</p></td>
<td><p>(str) - the absolute path of the waveform file</p></td>
</tr>
<tr class="row-even"><td><p>transcription</p></td>
<td><p>(str) - a text string</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASR.prepare_tokenizer_data">
<span class="sig-name descname"><span class="pre">prepare_tokenizer_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prepare_tokenizer_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_csvs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/asr/superb_asr.html#SuperbASR.prepare_tokenizer_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/asr/superb_asr.py#L299-L346"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASR.prepare_tokenizer_data" title="Permalink to this definition">#</a></dt>
<dd><p>Prepare the text file used for training tokenizer.
By default only use the transcription in the <code class="code docutils literal notranslate"><span class="pre">train_csv</span></code> returned from <a class="reference internal" href="#s3prl.problem.SuperbASR.prepare_data" title="s3prl.problem.SuperbASR.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a>
The default <code class="code docutils literal notranslate"><span class="pre">prepare_tokenizer_data</span></code> build the character-based tokenizer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prepare_tokenizer_data</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbASR.default_config" title="s3prl.problem.SuperbASR.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no supported argument for now</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Save the text file into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the parsing or preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>train_csv</strong> (<em>str</em>) – The train data given by <a class="reference internal" href="#s3prl.problem.SuperbASR.prepare_data" title="s3prl.problem.SuperbASR.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>str</p>
<p>The text file path, the text file should be in the format</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>This is the first line
This is the second line
These are all text used for training tokenizer
</pre></div>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASR.build_tokenizer">
<span class="sig-name descname"><span class="pre">build_tokenizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_tokenizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer_data_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/asr/superb_asr.html#SuperbASR.build_tokenizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/asr/superb_asr.py#L348-L376"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASR.build_tokenizer" title="Permalink to this definition">#</a></dt>
<dd><p>Build the tokenizer from the data prepared by <a class="reference internal" href="#s3prl.problem.SuperbASR.prepare_tokenizer_data" title="s3prl.problem.SuperbASR.prepare_tokenizer_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_tokenizer_data</span></code></a>
By default call <code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_common_tokenizer</span></code> with <code class="code docutils literal notranslate"><span class="pre">**build_tokenizer</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_tokenizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbASR.default_config" title="s3prl.problem.SuperbASR.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_common_tokenizer</span></code></p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experinment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the parsing or preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>tokenizer_data_path</strong> (<em>str</em>) – The text file from <a class="reference internal" href="#s3prl.problem.SuperbASR.prepare_tokenizer_data" title="s3prl.problem.SuperbASR.prepare_tokenizer_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_tokenizer_data</span></code></a></p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>str</p>
<p>filepath of the pickled <a class="reference internal" href="s3prl.dataio.encoder.html#s3prl.dataio.encoder.Tokenizer" title="s3prl.dataio.encoder.tokenizer.Tokenizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataio.encoder.tokenizer.Tokenizer</span></code></a></p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASR.build_dataset">
<span class="sig-name descname"><span class="pre">build_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/asr/superb_asr.html#SuperbASR.build_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/asr/superb_asr.py#L378-L442"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASR.build_dataset" title="Permalink to this definition">#</a></dt>
<dd><p>Build the dataset for train/valid/test.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_dataset</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbASR.default_config" title="s3prl.problem.SuperbASR.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, not used</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – The metadata csv file for the specific <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p></li>
<li><p><strong>tokenizer_path</strong> (<em>str</em>) – The pickled tokenizer path for encoding transcription</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch Dataset</p>
<p>For all train/valid/test mode, the dataset should return each item as a dictionary
containing the following keys:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>x</p></td>
<td><p>(torch.FloatTensor) - the waveform in (seq_len, 1)</p></td>
</tr>
<tr class="row-odd"><td><p>x_len</p></td>
<td><p>(int) - the waveform length <code class="code docutils literal notranslate"><span class="pre">seq_len</span></code></p></td>
</tr>
<tr class="row-even"><td><p>class_ids</p></td>
<td><p>(torch.LongTensor) - the encoded class ids of a transcription (sentence)</p></td>
</tr>
<tr class="row-odd"><td><p>labels</p></td>
<td><p>(str) - the text transcription</p></td>
</tr>
<tr class="row-even"><td><p>unique_name</p></td>
<td><p>(str) - the unique id for this datapoint</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASR.build_batch_sampler">
<span class="sig-name descname"><span class="pre">build_batch_sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/asr/superb_asr.html#SuperbASR.build_batch_sampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/asr/superb_asr.py#L444-L495"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASR.build_batch_sampler" title="Permalink to this definition">#</a></dt>
<dd><p>Return the batch sampler for torch DataLoader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_batch_sampler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbASR.default_config" title="s3prl.problem.SuperbASR.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>train</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">SortedBucketingSampler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>valid</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-even"><td><p>test</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">mode</span></code> specific csv from <a class="reference internal" href="#s3prl.problem.SuperbASR.prepare_data" title="s3prl.problem.SuperbASR.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>dataset</strong> – the dataset from <a class="reference internal" href="#s3prl.problem.SuperbASR.build_dataset" title="s3prl.problem.SuperbASR.build_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_dataset</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>batch sampler for torch DataLoader</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASR.build_downstream">
<span class="sig-name descname"><span class="pre">build_downstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/asr/superb_asr.html#SuperbASR.build_downstream"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/asr/superb_asr.py#L497-L530"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASR.build_downstream" title="Permalink to this definition">#</a></dt>
<dd><p>Return the task-specific downstream model.
By default build the <code class="xref py py-obj docutils literal notranslate"><span class="pre">RNNEncoder</span></code> model wrapped with <code class="xref py py-obj docutils literal notranslate"><span class="pre">ModelWithSpecaug</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbASR.default_config" title="s3prl.problem.SuperbASR.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, has two keys:
<code class="code docutils literal notranslate"><span class="pre">model_conf</span></code> is the arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">RNNEncoder</span></code>;
<code class="code docutils literal notranslate"><span class="pre">specaug_conf</span></code> is the arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">ModelWithSpecaug</span></code></p></li>
<li><p><strong>downstream_input_size</strong> (<em>int</em>) – the required input size of the model</p></li>
<li><p><strong>downstream_output_size</strong> (<em>int</em>) – the required output size of the model</p></li>
<li><p><strong>downstream_input_stride</strong> (<em>int</em>) – the input feature’s stride (from 16 KHz)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsFrameModel" title="s3prl.nn.interface.AbsFrameModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsFrameModel</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASR.build_collate_fn">
<span class="sig-name descname"><span class="pre">build_collate_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L143-L156"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASR.build_collate_fn" title="Permalink to this definition">#</a></dt>
<dd><p>By default returns <code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataset.base.default_collate_fn</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_collate_fn</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbASR.default_config" title="s3prl.problem.SuperbASR.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train, valid, or test</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>callable</p>
<p>the collate_fn for torch DataLoader in train/valid/test <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASR.build_featurizer">
<span class="sig-name descname"><span class="pre">build_featurizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upstream</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L175-L192"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASR.build_featurizer" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the featurizer with <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbASR.default_config" title="s3prl.problem.SuperbASR.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p></li>
<li><p><strong>upstream</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">AbsUpstream</span></code>) – the upstream model built by <a class="reference internal" href="#s3prl.problem.SuperbASR.build_upstream" title="s3prl.problem.SuperbASR.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsFeaturizer" title="s3prl.nn.interface.AbsFeaturizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsFeaturizer</span></code></a></p>
<p>Return the featurizer model. The featurizer is used to reduce the multiple
hidden states returned from the upstream model (built by <a class="reference internal" href="#s3prl.problem.SuperbASR.build_upstream" title="s3prl.problem.SuperbASR.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>)
into a single hidden state, so can be easliy fed into the downstream model</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASR.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L194-L231"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASR.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>By default build model with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbASR.default_config" title="s3prl.problem.SuperbASR.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p></li>
<li><p><strong>model_output_size</strong> (<em>int</em>) – the required model’s output hidden size</p></li>
<li><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbASR.default_config" title="s3prl.problem.SuperbASR.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.SuperbASR.build_upstream" title="s3prl.problem.SuperbASR.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbASR.default_config" title="s3prl.problem.SuperbASR.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.SuperbASR.build_featurizer" title="s3prl.problem.SuperbASR.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a></p></li>
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbASR.default_config" title="s3prl.problem.SuperbASR.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.SuperbASR.build_downstream" title="s3prl.problem.SuperbASR.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch.nn.Module</p>
<p>Return the entire model for the task, which takes the direct items from DataLoader as the input.
Usually, the components can be built by <a class="reference internal" href="#s3prl.problem.SuperbASR.build_upstream" title="s3prl.problem.SuperbASR.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>, <a class="reference internal" href="#s3prl.problem.SuperbASR.build_featurizer" title="s3prl.problem.SuperbASR.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a>,
<a class="reference internal" href="#s3prl.problem.SuperbASR.build_downstream" title="s3prl.problem.SuperbASR.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a>, and are concated together to get the final model.
The upstream extracts multiple hidden states, the featuizer reduce them into a single hidden state,
and the downstream takes the hidden states as the feature for the downstream-specific model.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASR.build_optimizer">
<span class="sig-name descname"><span class="pre">build_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L233-L258"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASR.build_optimizer" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_optimizer</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbASR.default_config" title="s3prl.problem.SuperbASR.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to below</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the optimizer class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the optimizer class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;lr&quot;:</span> <span class="pre">1.0e-4}</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>parameters</strong> (<em>iterable</em>) – the standard params accepted by <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code></p>
<p>An optimizer following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASR.build_scheduler">
<span class="sig-name descname"><span class="pre">build_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L260-L285"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASR.build_scheduler" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_scheduler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbASR.default_config" title="s3prl.problem.SuperbASR.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the scheduler class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the scheduler class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;gamma&quot;:</span> <span class="pre">0.01}</span></code> for <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler.StepLR</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>optimizer</strong> – the standard torch optimizer accepted by Scheduler in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch scheduler</p>
<p>A scheduler following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASR.build_task">
<span class="sig-name descname"><span class="pre">build_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/asr/run.py#L357-L359"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASR.build_task" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASR.build_upstream">
<span class="sig-name descname"><span class="pre">build_upstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L158-L173"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASR.build_upstream" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the upstream with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbASR.default_config" title="s3prl.problem.SuperbASR.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUpstream" title="s3prl.nn.interface.AbsUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUpstream</span></code></a></p>
<p>Return an upstream model, whose forward takes the waveform input and returns
multiple hidden states as features.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASR.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L660-L707"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASR.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>The evaluate routine used by <a class="reference internal" href="#s3prl.problem.SuperbASR.train" title="s3prl.problem.SuperbASR.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> (during validation phase) and <a class="reference internal" href="#s3prl.problem.SuperbASR.run" title="s3prl.problem.SuperbASR.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>
(during testing phase).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evaluate</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbASR.default_config" title="s3prl.problem.SuperbASR.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASR.get_class_from_name">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_class_from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L129-L141"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASR.get_class_from_name" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">__name__</span></code> of the problem class</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Problem</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASR.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L752-L772"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASR.load_model" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model_ckpt_dir</strong> (<em>str</em>) – Restore the model with <a class="reference internal" href="#s3prl.problem.SuperbASR.build_model" title="s3prl.problem.SuperbASR.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> and the checkpoint
saved in this directory.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASR.load_model_and_task">
<span class="sig-name descname"><span class="pre">load_model_and_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ckpts_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L884-L902"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASR.load_model_and_task" title="Permalink to this definition">#</a></dt>
<dd><p>This is a helper method to combine <a class="reference internal" href="#s3prl.problem.SuperbASR.load_model" title="s3prl.problem.SuperbASR.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a> and <a class="reference internal" href="#s3prl.problem.SuperbASR.load_task" title="s3prl.problem.SuperbASR.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>
together to directly load the model and the task. This method assumes
the model is saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'model'</span></code> and the task is
saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'task'</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>model (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>)</p></li>
<li><p>task (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a>)</p></li>
</ol>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASR.load_task">
<span class="sig-name descname"><span class="pre">load_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L833-L882"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASR.load_task" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – Restore the task with <a class="reference internal" href="#s3prl.problem.SuperbASR.build_task" title="s3prl.problem.SuperbASR.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> and the checkpoint
saved in this directory.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model for the task, since the model is separately saved
and is required for <a class="reference internal" href="#s3prl.problem.SuperbASR.build_task" title="s3prl.problem.SuperbASR.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a>.</p></li>
<li><p><strong>task_overrides</strong> (<em>dict</em>) – overrides the saved initialization arguments, so can change
the loaded task’s behavior. Like, change the decoding hyperparameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASR.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L954-L995"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASR.main" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASR.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_all_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cuda'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepare_tokenizer_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_tokenizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/asr/run.py#L24-L325"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASR.run" title="Permalink to this definition">#</a></dt>
<dd><div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>stage</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Parse the corpus and save the metadata file for ASR (waveform path, label…)</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Prepare the metadata file for training tokenizer</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Train the tokenizer</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Train the ASR model</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>Evaluate the model on multiple test sets, multiple checkpoints will be evaluated for each test set (See <code class="code docutils literal notranslate"><span class="pre">test_ckpt_steps</span></code>)</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_dir</strong> (<em>str</em>) – The directory that stores the script result.</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – The directory that caches the processed data.
Default: /home/user/.cache/s3prl/data</p></li>
<li><p><strong>remove_all_cache</strong> (<em>bool</em>) – Whether to remove all the cache stored under <cite>cache_dir</cite>.
Default: False</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting stage of the problem script.
Default: 0</p></li>
<li><p><strong>stop</strong> (<em>int</em>) – The stoping stage of the problem script, set <cite>None</cite> to reach the final stage.
Default: None</p></li>
<li><p><strong>num_workers</strong> (<em>int</em>) – num_workers for all the torch DataLoder</p></li>
<li><p><strong>eval_batch</strong> (<em>int</em>) – During evaluation (valid or test), limit the number of batch.
This is helpful for the fast development to check everything won’t crash.
If is -1, disable this feature and evaluate the entire epoch.
Default: -1</p></li>
<li><p><strong>device</strong> (<em>str</em>) – The device type for all torch-related operation: “cpu” or “cuda”
Default: “cuda”</p></li>
<li><p><strong>world_size</strong> (<em>int</em>) – How many processes are running this script simultaneously (in parallel).
Usually this is just 1, however if you are runnig distributed training,
this should be &gt; 1.
Default: 1</p></li>
<li><p><strong>rank</strong> (<em>int</em>) – When distributed training, world_size &gt; 1. Take <code class="code docutils literal notranslate"><span class="pre">world_size</span> <span class="pre">==</span> <span class="pre">8</span></code> for
example, this means 8 processes (8 GPUs) are runing in parallel. The script
needs to know which process among 8 processes it is. In this case, <code class="code docutils literal notranslate"><span class="pre">rank</span></code>
can range from 0~7. All the 8 processes have the same <code class="code docutils literal notranslate"><span class="pre">world_size</span></code> but
different <code class="code docutils literal notranslate"><span class="pre">rank</span></code> (process id).</p></li>
<li><p><strong>test_ckpt_dir</strong> (<em>str</em>) – Specify the checkpoint path for testing. If not, use checkpoints specified by
<code class="code docutils literal notranslate"><span class="pre">test_ckpts_steps</span></code>.</p></li>
<li><p><strong>**others</strong> – The other arguments like <code class="code docutils literal notranslate"><span class="pre">prepare_data</span></code> and <code class="code docutils literal notranslate"><span class="pre">build_model</span></code> are
method specific-arguments for methods like <a class="reference internal" href="#s3prl.problem.SuperbASR.prepare_data" title="s3prl.problem.SuperbASR.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> and
<a class="reference internal" href="#s3prl.problem.SuperbASR.build_model" title="s3prl.problem.SuperbASR.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>, and will not be used in the core <a class="reference internal" href="#s3prl.problem.SuperbASR.run" title="s3prl.problem.SuperbASR.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> logic.
See the specific method documentation for their supported arguments and
meaning</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASR.save_model">
<span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L709-L750"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASR.save_model" title="Permalink to this definition">#</a></dt>
<dd><p>Save the model state_dict and the model initialization arguments into the given directory.
If you override this method, it is highly possible you also need to override <a class="reference internal" href="#s3prl.problem.SuperbASR.load_model" title="s3prl.problem.SuperbASR.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbASR.default_config" title="s3prl.problem.SuperbASR.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_model</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>model_ckpt_dir</strong> (<em>str</em>) – save the model into the this directory.</p></li>
<li><p><strong>build_model_all_args</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.SuperbASR.build_model" title="s3prl.problem.SuperbASR.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>.
By saving this dictionary, you can easily reconstruct the same model
by calling <a class="reference internal" href="#s3prl.problem.SuperbASR.build_model" title="s3prl.problem.SuperbASR.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASR.save_task">
<span class="sig-name descname"><span class="pre">save_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="s3prl.task.base.html#s3prl.task.base.Task" title="s3prl.task.base.Task"><span class="pre">Task</span></a></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L774-L831"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASR.save_task" title="Permalink to this definition">#</a></dt>
<dd><p>Save the task’s state, <code class="code docutils literal notranslate"><span class="pre">task.get_state()</span></code>, and the initialization arguments into the given
directory. If you override this method, it is highly possible you also need to override
<a class="reference internal" href="#s3prl.problem.SuperbASR.load_task" title="s3prl.problem.SuperbASR.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbASR.default_config" title="s3prl.problem.SuperbASR.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_task</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – save the task into this directory.</p></li>
<li><p><strong>build_task_all_args_except_model</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.SuperbASR.build_task" title="s3prl.problem.SuperbASR.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> except
the <code class="code docutils literal notranslate"><span class="pre">model</span></code> argument since the model should be sapartely saved by
<a class="reference internal" href="#s3prl.problem.SuperbASR.save_model" title="s3prl.problem.SuperbASR.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a>. By saving this dictionary, you can easily reconstruct the same task
by calling <a class="reference internal" href="#s3prl.problem.SuperbASR.build_task" title="s3prl.problem.SuperbASR.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>task</strong> (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><em>Task</em></a>) – the task to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASR.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L287-L658"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASR.train" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbASR.default_config" title="s3prl.problem.SuperbASR.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>total_steps</p></td>
<td><p>(int) - the total optimization steps</p></td>
</tr>
<tr class="row-odd"><td><p>log_step</p></td>
<td><p>(int) - logging frequency. log every <code class="code docutils literal notranslate"><span class="pre">log_step</span></code> step</p></td>
</tr>
<tr class="row-even"><td><p>eval_step</p></td>
<td><p>(int) - evaluation frequency. Evaluate every <code class="code docutils literal notranslate"><span class="pre">eval_step</span></code> step.                                                 Note that you can control how many batch to evaluate to speed up the                                                 development by the <code class="code docutils literal notranslate"><span class="pre">eval_batch</span></code> argument in <a class="reference internal" href="#s3prl.problem.SuperbASR.run" title="s3prl.problem.SuperbASR.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>save_step</p></td>
<td><p>(int) - save the checkpoint every <code class="code docutils literal notranslate"><span class="pre">save_step</span></code> step.</p></td>
</tr>
<tr class="row-even"><td><p>gradient_clipping</p></td>
<td><p>(float) - clip the gradient. important for RNNs.</p></td>
</tr>
<tr class="row-odd"><td><p>gradient_accumulate</p></td>
<td><p>(int) - accumulate multiple steps’ gradient before updating network parameters                                                 to simulate large-batch optimization.</p></td>
</tr>
<tr class="row-even"><td><p>valid_metric</p></td>
<td><p>(str) - the metric to select the best valid checkpoint. Different Tasks have different                                                 supported valid_metrics. See <a class="reference internal" href="#s3prl.problem.SuperbASR.build_task" title="s3prl.problem.SuperbASR.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> for the supported metrics.</p></td>
</tr>
<tr class="row-odd"><td><p>valid_higher_better</p></td>
<td><p>(bool) - some metrics are higher better, while some are lower better                                                 this will affect how to save the best validation checkpoint.</p></td>
</tr>
<tr class="row-even"><td><p>auto_resume</p></td>
<td><p>(bool) - if there are already the last checkpoint in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.SuperbASR.run" title="s3prl.problem.SuperbASR.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>),                                                 whether to resume from it or delete it and start a new training session.</p></td>
</tr>
<tr class="row-odd"><td><p>resume_ckpt_dir</p></td>
<td><p>(str) - you can directly specify the checkpoint path to resume which is not necessary                                                 in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.SuperbASR.run" title="s3prl.problem.SuperbASR.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>).</p></td>
</tr>
<tr class="row-even"><td><p>seed</p></td>
<td><p>(int) - fix the seed before the training start</p></td>
</tr>
<tr class="row-odd"><td><p>keep_num_ckpts</p></td>
<td><p>(int) - to prevent saving too many checkpoints, only save the <code class="code docutils literal notranslate"><span class="pre">keep_num_ckpts</span></code>                                                 latest checkpoints and delete the old ones.</p></td>
</tr>
<tr class="row-even"><td><p>use_scheduler</p></td>
<td><p>(bool) - whether to use the scheduler</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="superbpr">
<h2>SuperbPR<a class="headerlink" href="#superbpr" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="s3prl.problem.SuperbPR">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">s3prl.problem.</span></span><span class="sig-name descname"><span class="pre">SuperbPR</span></span><a class="reference internal" href="../_modules/s3prl/problem/asr/superb_pr.html#SuperbPR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/asr/superb_pr.py#L27-L208"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbPR" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="s3prl.problem.asr.superb_asr.html#s3prl.problem.asr.superb_asr.SuperbASR" title="s3prl.problem.asr.superb_asr.SuperbASR"><code class="xref py py-class docutils literal notranslate"><span class="pre">SuperbASR</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbPR.default_config">
<span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/s3prl/problem/asr/superb_pr.html#SuperbPR.default_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/asr/superb_pr.py#L28-L103"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbPR.default_config" title="Permalink to this definition">#</a></dt>
<dd><p>The default arguments for <a class="reference internal" href="#s3prl.problem.SuperbPR.run" title="s3prl.problem.SuperbPR.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> in yaml.
Note that for the fields with inner values, like <code class="code docutils literal notranslate"><span class="pre">build_model</span></code>,
the outer field name corresponds to a method name, so you can find the method
<a class="reference internal" href="#s3prl.problem.SuperbPR.build_model" title="s3prl.problem.SuperbPR.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>. Furthermore, the values inside that field will be
directly passed into the method. So by changing these inner values, you
can directly affect the behavior of the corresponding method. See the method
documentation for all the supported arguments and their meanings.</p>
<p>The methods affected by the following config are: <a class="reference internal" href="#s3prl.problem.SuperbPR.prepare_data" title="s3prl.problem.SuperbPR.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbPR.prepare_tokenizer_data" title="s3prl.problem.SuperbPR.prepare_tokenizer_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_tokenizer_data</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbPR.build_tokenizer" title="s3prl.problem.SuperbPR.build_tokenizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_tokenizer</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbPR.build_dataset" title="s3prl.problem.SuperbPR.build_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_dataset</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbPR.build_batch_sampler" title="s3prl.problem.SuperbPR.build_batch_sampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_batch_sampler</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbPR.build_upstream" title="s3prl.problem.SuperbPR.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbPR.build_featurizer" title="s3prl.problem.SuperbPR.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbPR.build_downstream" title="s3prl.problem.SuperbPR.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbPR.build_model" title="s3prl.problem.SuperbPR.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbPR.build_task" title="s3prl.problem.SuperbPR.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbPR.build_optimizer" title="s3prl.problem.SuperbPR.build_optimizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_optimizer</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbPR.build_scheduler" title="s3prl.problem.SuperbPR.build_scheduler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_scheduler</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbPR.save_model" title="s3prl.problem.SuperbPR.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbPR.save_task" title="s3prl.problem.SuperbPR.save_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_task</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbPR.train" title="s3prl.problem.SuperbPR.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbPR.evaluate" title="s3prl.problem.SuperbPR.evaluate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate</span></code></a></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">start</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="nt">stop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">target_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">cache_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">remove_all_cache</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">prepare_data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">dataset_root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="w">  </span><span class="nt">train_sets</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">train-clean-100</span>
<span class="w">  </span><span class="nt">valid_sets</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dev-clean</span>
<span class="w">  </span><span class="nt">test_sets</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">test-clean</span>
<span class="nt">prepare_tokenizer_data</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">build_tokenizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">vocab_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">phoneme</span>
<span class="nt">build_dataset</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">build_batch_sampler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">train</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">16</span>
<span class="w">    </span><span class="nt">max_length</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">300000</span>
<span class="w">  </span><span class="nt">valid</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">test</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="nt">build_upstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">build_featurizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">layer_selections</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="nt">normalize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_downstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">hidden_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">256</span>
<span class="nt">build_model</span><span class="p">:</span>
<span class="w">  </span><span class="nt">upstream_trainable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_task</span><span class="p">:</span>
<span class="w">  </span><span class="nt">log_metrics</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">per</span>
<span class="nt">build_optimizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Adam</span>
<span class="w">  </span><span class="nt">conf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">lr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.01</span>
<span class="nt">build_scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ExponentialLR</span>
<span class="w">  </span><span class="nt">gamma</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.9</span>
<span class="nt">save_model</span><span class="p">:</span>
<span class="w">  </span><span class="nt">extra_conf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">build_downstream_conf</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${build_downstream}</span>
<span class="nt">save_task</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">train</span><span class="p">:</span>
<span class="w">  </span><span class="nt">total_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100000</span>
<span class="w">  </span><span class="nt">log_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">  </span><span class="nt">eval_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span>
<span class="w">  </span><span class="nt">save_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">  </span><span class="nt">gradient_clipping</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0</span>
<span class="w">  </span><span class="nt">gradient_accumulate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">  </span><span class="nt">valid_metric</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">per</span>
<span class="w">  </span><span class="nt">valid_higher_better</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">  </span><span class="nt">auto_resume</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">resume_ckpt_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">evaluate</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbPR.prepare_data">
<span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/asr/superb_pr.html#SuperbPR.prepare_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/asr/superb_pr.py#L105-L130"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbPR.prepare_data" title="Permalink to this definition">#</a></dt>
<dd><p>Prepare the task-specific data metadata (path, labels…).
By default call <code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_librispeech</span></code> with <code class="code docutils literal notranslate"><span class="pre">**prepare_data</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prepare_data</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbPR.default_config" title="s3prl.problem.SuperbPR.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments in <code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_librispeech</span></code></p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Parse your corpus and save the csv file into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the parsing or preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>train_path (str)</p></li>
<li><p>valid_path (str)</p></li>
<li><p>test_paths (List[str])</p></li>
</ol>
<p>Each path (str) should be a csv file containing the following columns:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>column</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>(str) - the unique id for this data point</p></td>
</tr>
<tr class="row-odd"><td><p>wav_path</p></td>
<td><p>(str) - the absolute path of the waveform file</p></td>
</tr>
<tr class="row-even"><td><p>transcription</p></td>
<td><p>(str) - a text string</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbPR.build_batch_sampler">
<span class="sig-name descname"><span class="pre">build_batch_sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/asr/superb_pr.html#SuperbPR.build_batch_sampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/asr/superb_pr.py#L132-L183"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbPR.build_batch_sampler" title="Permalink to this definition">#</a></dt>
<dd><p>Return the batch sampler for torch DataLoader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_batch_sampler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbPR.default_config" title="s3prl.problem.SuperbPR.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>train</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">SortedSliceSampler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>valid</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-even"><td><p>test</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">mode</span></code> specific csv from <a class="reference internal" href="#s3prl.problem.SuperbPR.prepare_data" title="s3prl.problem.SuperbPR.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>dataset</strong> – the dataset from <a class="reference internal" href="#s3prl.problem.SuperbPR.build_dataset" title="s3prl.problem.SuperbPR.build_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_dataset</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>batch sampler for torch DataLoader</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbPR.build_downstream">
<span class="sig-name descname"><span class="pre">build_downstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/asr/superb_pr.html#SuperbPR.build_downstream"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/asr/superb_pr.py#L185-L208"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbPR.build_downstream" title="Permalink to this definition">#</a></dt>
<dd><p>Return the task-specific downstream model.
By default build the <code class="xref py py-obj docutils literal notranslate"><span class="pre">FrameLevelLinear</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbPR.default_config" title="s3prl.problem.SuperbPR.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
supports arguments in <code class="xref py py-obj docutils literal notranslate"><span class="pre">FrameLevelLinear</span></code></p></li>
<li><p><strong>downstream_input_size</strong> (<em>int</em>) – the required input size of the model</p></li>
<li><p><strong>downstream_output_size</strong> (<em>int</em>) – the required output size of the model</p></li>
<li><p><strong>downstream_input_stride</strong> (<em>int</em>) – the input feature’s stride (from 16 KHz)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsFrameModel" title="s3prl.nn.interface.AbsFrameModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsFrameModel</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbPR.build_collate_fn">
<span class="sig-name descname"><span class="pre">build_collate_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L143-L156"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbPR.build_collate_fn" title="Permalink to this definition">#</a></dt>
<dd><p>By default returns <code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataset.base.default_collate_fn</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_collate_fn</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbPR.default_config" title="s3prl.problem.SuperbPR.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train, valid, or test</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>callable</p>
<p>the collate_fn for torch DataLoader in train/valid/test <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbPR.build_dataset">
<span class="sig-name descname"><span class="pre">build_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/asr/superb_asr.py#L378-L442"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbPR.build_dataset" title="Permalink to this definition">#</a></dt>
<dd><p>Build the dataset for train/valid/test.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_dataset</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbPR.default_config" title="s3prl.problem.SuperbPR.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, not used</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – The metadata csv file for the specific <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p></li>
<li><p><strong>tokenizer_path</strong> (<em>str</em>) – The pickled tokenizer path for encoding transcription</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch Dataset</p>
<p>For all train/valid/test mode, the dataset should return each item as a dictionary
containing the following keys:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>x</p></td>
<td><p>(torch.FloatTensor) - the waveform in (seq_len, 1)</p></td>
</tr>
<tr class="row-odd"><td><p>x_len</p></td>
<td><p>(int) - the waveform length <code class="code docutils literal notranslate"><span class="pre">seq_len</span></code></p></td>
</tr>
<tr class="row-even"><td><p>class_ids</p></td>
<td><p>(torch.LongTensor) - the encoded class ids of a transcription (sentence)</p></td>
</tr>
<tr class="row-odd"><td><p>labels</p></td>
<td><p>(str) - the text transcription</p></td>
</tr>
<tr class="row-even"><td><p>unique_name</p></td>
<td><p>(str) - the unique id for this datapoint</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbPR.build_featurizer">
<span class="sig-name descname"><span class="pre">build_featurizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upstream</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L175-L192"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbPR.build_featurizer" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the featurizer with <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbPR.default_config" title="s3prl.problem.SuperbPR.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p></li>
<li><p><strong>upstream</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">AbsUpstream</span></code>) – the upstream model built by <a class="reference internal" href="#s3prl.problem.SuperbPR.build_upstream" title="s3prl.problem.SuperbPR.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsFeaturizer" title="s3prl.nn.interface.AbsFeaturizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsFeaturizer</span></code></a></p>
<p>Return the featurizer model. The featurizer is used to reduce the multiple
hidden states returned from the upstream model (built by <a class="reference internal" href="#s3prl.problem.SuperbPR.build_upstream" title="s3prl.problem.SuperbPR.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>)
into a single hidden state, so can be easliy fed into the downstream model</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbPR.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L194-L231"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbPR.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>By default build model with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbPR.default_config" title="s3prl.problem.SuperbPR.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p></li>
<li><p><strong>model_output_size</strong> (<em>int</em>) – the required model’s output hidden size</p></li>
<li><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbPR.default_config" title="s3prl.problem.SuperbPR.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.SuperbPR.build_upstream" title="s3prl.problem.SuperbPR.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbPR.default_config" title="s3prl.problem.SuperbPR.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.SuperbPR.build_featurizer" title="s3prl.problem.SuperbPR.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a></p></li>
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbPR.default_config" title="s3prl.problem.SuperbPR.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.SuperbPR.build_downstream" title="s3prl.problem.SuperbPR.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch.nn.Module</p>
<p>Return the entire model for the task, which takes the direct items from DataLoader as the input.
Usually, the components can be built by <a class="reference internal" href="#s3prl.problem.SuperbPR.build_upstream" title="s3prl.problem.SuperbPR.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>, <a class="reference internal" href="#s3prl.problem.SuperbPR.build_featurizer" title="s3prl.problem.SuperbPR.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a>,
<a class="reference internal" href="#s3prl.problem.SuperbPR.build_downstream" title="s3prl.problem.SuperbPR.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a>, and are concated together to get the final model.
The upstream extracts multiple hidden states, the featuizer reduce them into a single hidden state,
and the downstream takes the hidden states as the feature for the downstream-specific model.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbPR.build_optimizer">
<span class="sig-name descname"><span class="pre">build_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L233-L258"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbPR.build_optimizer" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_optimizer</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbPR.default_config" title="s3prl.problem.SuperbPR.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to below</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the optimizer class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the optimizer class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;lr&quot;:</span> <span class="pre">1.0e-4}</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>parameters</strong> (<em>iterable</em>) – the standard params accepted by <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code></p>
<p>An optimizer following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbPR.build_scheduler">
<span class="sig-name descname"><span class="pre">build_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L260-L285"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbPR.build_scheduler" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_scheduler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbPR.default_config" title="s3prl.problem.SuperbPR.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the scheduler class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the scheduler class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;gamma&quot;:</span> <span class="pre">0.01}</span></code> for <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler.StepLR</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>optimizer</strong> – the standard torch optimizer accepted by Scheduler in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch scheduler</p>
<p>A scheduler following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbPR.build_task">
<span class="sig-name descname"><span class="pre">build_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/asr/run.py#L357-L359"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbPR.build_task" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbPR.build_tokenizer">
<span class="sig-name descname"><span class="pre">build_tokenizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_tokenizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer_data_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/asr/superb_asr.py#L348-L376"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbPR.build_tokenizer" title="Permalink to this definition">#</a></dt>
<dd><p>Build the tokenizer from the data prepared by <a class="reference internal" href="#s3prl.problem.SuperbPR.prepare_tokenizer_data" title="s3prl.problem.SuperbPR.prepare_tokenizer_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_tokenizer_data</span></code></a>
By default call <code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_common_tokenizer</span></code> with <code class="code docutils literal notranslate"><span class="pre">**build_tokenizer</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_tokenizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbPR.default_config" title="s3prl.problem.SuperbPR.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_common_tokenizer</span></code></p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experinment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the parsing or preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>tokenizer_data_path</strong> (<em>str</em>) – The text file from <a class="reference internal" href="#s3prl.problem.SuperbPR.prepare_tokenizer_data" title="s3prl.problem.SuperbPR.prepare_tokenizer_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_tokenizer_data</span></code></a></p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>str</p>
<p>filepath of the pickled <a class="reference internal" href="s3prl.dataio.encoder.html#s3prl.dataio.encoder.Tokenizer" title="s3prl.dataio.encoder.tokenizer.Tokenizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataio.encoder.tokenizer.Tokenizer</span></code></a></p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbPR.build_upstream">
<span class="sig-name descname"><span class="pre">build_upstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L158-L173"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbPR.build_upstream" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the upstream with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbPR.default_config" title="s3prl.problem.SuperbPR.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUpstream" title="s3prl.nn.interface.AbsUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUpstream</span></code></a></p>
<p>Return an upstream model, whose forward takes the waveform input and returns
multiple hidden states as features.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbPR.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L660-L707"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbPR.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>The evaluate routine used by <a class="reference internal" href="#s3prl.problem.SuperbPR.train" title="s3prl.problem.SuperbPR.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> (during validation phase) and <a class="reference internal" href="#s3prl.problem.SuperbPR.run" title="s3prl.problem.SuperbPR.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>
(during testing phase).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evaluate</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbPR.default_config" title="s3prl.problem.SuperbPR.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbPR.get_class_from_name">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_class_from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L129-L141"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbPR.get_class_from_name" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">__name__</span></code> of the problem class</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Problem</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbPR.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L752-L772"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbPR.load_model" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model_ckpt_dir</strong> (<em>str</em>) – Restore the model with <a class="reference internal" href="#s3prl.problem.SuperbPR.build_model" title="s3prl.problem.SuperbPR.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> and the checkpoint
saved in this directory.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbPR.load_model_and_task">
<span class="sig-name descname"><span class="pre">load_model_and_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ckpts_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L884-L902"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbPR.load_model_and_task" title="Permalink to this definition">#</a></dt>
<dd><p>This is a helper method to combine <a class="reference internal" href="#s3prl.problem.SuperbPR.load_model" title="s3prl.problem.SuperbPR.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a> and <a class="reference internal" href="#s3prl.problem.SuperbPR.load_task" title="s3prl.problem.SuperbPR.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>
together to directly load the model and the task. This method assumes
the model is saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'model'</span></code> and the task is
saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'task'</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>model (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>)</p></li>
<li><p>task (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a>)</p></li>
</ol>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbPR.load_task">
<span class="sig-name descname"><span class="pre">load_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L833-L882"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbPR.load_task" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – Restore the task with <a class="reference internal" href="#s3prl.problem.SuperbPR.build_task" title="s3prl.problem.SuperbPR.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> and the checkpoint
saved in this directory.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model for the task, since the model is separately saved
and is required for <a class="reference internal" href="#s3prl.problem.SuperbPR.build_task" title="s3prl.problem.SuperbPR.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a>.</p></li>
<li><p><strong>task_overrides</strong> (<em>dict</em>) – overrides the saved initialization arguments, so can change
the loaded task’s behavior. Like, change the decoding hyperparameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbPR.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L954-L995"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbPR.main" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbPR.prepare_tokenizer_data">
<span class="sig-name descname"><span class="pre">prepare_tokenizer_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prepare_tokenizer_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_csvs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/asr/superb_asr.py#L299-L346"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbPR.prepare_tokenizer_data" title="Permalink to this definition">#</a></dt>
<dd><p>Prepare the text file used for training tokenizer.
By default only use the transcription in the <code class="code docutils literal notranslate"><span class="pre">train_csv</span></code> returned from <a class="reference internal" href="#s3prl.problem.SuperbPR.prepare_data" title="s3prl.problem.SuperbPR.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a>
The default <code class="code docutils literal notranslate"><span class="pre">prepare_tokenizer_data</span></code> build the character-based tokenizer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prepare_tokenizer_data</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbPR.default_config" title="s3prl.problem.SuperbPR.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no supported argument for now</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Save the text file into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the parsing or preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>train_csv</strong> (<em>str</em>) – The train data given by <a class="reference internal" href="#s3prl.problem.SuperbPR.prepare_data" title="s3prl.problem.SuperbPR.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>str</p>
<p>The text file path, the text file should be in the format</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>This is the first line
This is the second line
These are all text used for training tokenizer
</pre></div>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbPR.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_all_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cuda'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepare_tokenizer_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_tokenizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/asr/run.py#L24-L325"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbPR.run" title="Permalink to this definition">#</a></dt>
<dd><div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>stage</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Parse the corpus and save the metadata file for ASR (waveform path, label…)</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Prepare the metadata file for training tokenizer</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Train the tokenizer</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Train the ASR model</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>Evaluate the model on multiple test sets, multiple checkpoints will be evaluated for each test set (See <code class="code docutils literal notranslate"><span class="pre">test_ckpt_steps</span></code>)</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_dir</strong> (<em>str</em>) – The directory that stores the script result.</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – The directory that caches the processed data.
Default: /home/user/.cache/s3prl/data</p></li>
<li><p><strong>remove_all_cache</strong> (<em>bool</em>) – Whether to remove all the cache stored under <cite>cache_dir</cite>.
Default: False</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting stage of the problem script.
Default: 0</p></li>
<li><p><strong>stop</strong> (<em>int</em>) – The stoping stage of the problem script, set <cite>None</cite> to reach the final stage.
Default: None</p></li>
<li><p><strong>num_workers</strong> (<em>int</em>) – num_workers for all the torch DataLoder</p></li>
<li><p><strong>eval_batch</strong> (<em>int</em>) – During evaluation (valid or test), limit the number of batch.
This is helpful for the fast development to check everything won’t crash.
If is -1, disable this feature and evaluate the entire epoch.
Default: -1</p></li>
<li><p><strong>device</strong> (<em>str</em>) – The device type for all torch-related operation: “cpu” or “cuda”
Default: “cuda”</p></li>
<li><p><strong>world_size</strong> (<em>int</em>) – How many processes are running this script simultaneously (in parallel).
Usually this is just 1, however if you are runnig distributed training,
this should be &gt; 1.
Default: 1</p></li>
<li><p><strong>rank</strong> (<em>int</em>) – When distributed training, world_size &gt; 1. Take <code class="code docutils literal notranslate"><span class="pre">world_size</span> <span class="pre">==</span> <span class="pre">8</span></code> for
example, this means 8 processes (8 GPUs) are runing in parallel. The script
needs to know which process among 8 processes it is. In this case, <code class="code docutils literal notranslate"><span class="pre">rank</span></code>
can range from 0~7. All the 8 processes have the same <code class="code docutils literal notranslate"><span class="pre">world_size</span></code> but
different <code class="code docutils literal notranslate"><span class="pre">rank</span></code> (process id).</p></li>
<li><p><strong>test_ckpt_dir</strong> (<em>str</em>) – Specify the checkpoint path for testing. If not, use checkpoints specified by
<code class="code docutils literal notranslate"><span class="pre">test_ckpts_steps</span></code>.</p></li>
<li><p><strong>**others</strong> – The other arguments like <code class="code docutils literal notranslate"><span class="pre">prepare_data</span></code> and <code class="code docutils literal notranslate"><span class="pre">build_model</span></code> are
method specific-arguments for methods like <a class="reference internal" href="#s3prl.problem.SuperbPR.prepare_data" title="s3prl.problem.SuperbPR.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> and
<a class="reference internal" href="#s3prl.problem.SuperbPR.build_model" title="s3prl.problem.SuperbPR.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>, and will not be used in the core <a class="reference internal" href="#s3prl.problem.SuperbPR.run" title="s3prl.problem.SuperbPR.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> logic.
See the specific method documentation for their supported arguments and
meaning</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbPR.save_model">
<span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L709-L750"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbPR.save_model" title="Permalink to this definition">#</a></dt>
<dd><p>Save the model state_dict and the model initialization arguments into the given directory.
If you override this method, it is highly possible you also need to override <a class="reference internal" href="#s3prl.problem.SuperbPR.load_model" title="s3prl.problem.SuperbPR.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbPR.default_config" title="s3prl.problem.SuperbPR.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_model</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>model_ckpt_dir</strong> (<em>str</em>) – save the model into the this directory.</p></li>
<li><p><strong>build_model_all_args</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.SuperbPR.build_model" title="s3prl.problem.SuperbPR.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>.
By saving this dictionary, you can easily reconstruct the same model
by calling <a class="reference internal" href="#s3prl.problem.SuperbPR.build_model" title="s3prl.problem.SuperbPR.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbPR.save_task">
<span class="sig-name descname"><span class="pre">save_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="s3prl.task.base.html#s3prl.task.base.Task" title="s3prl.task.base.Task"><span class="pre">Task</span></a></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L774-L831"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbPR.save_task" title="Permalink to this definition">#</a></dt>
<dd><p>Save the task’s state, <code class="code docutils literal notranslate"><span class="pre">task.get_state()</span></code>, and the initialization arguments into the given
directory. If you override this method, it is highly possible you also need to override
<a class="reference internal" href="#s3prl.problem.SuperbPR.load_task" title="s3prl.problem.SuperbPR.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbPR.default_config" title="s3prl.problem.SuperbPR.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_task</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – save the task into this directory.</p></li>
<li><p><strong>build_task_all_args_except_model</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.SuperbPR.build_task" title="s3prl.problem.SuperbPR.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> except
the <code class="code docutils literal notranslate"><span class="pre">model</span></code> argument since the model should be sapartely saved by
<a class="reference internal" href="#s3prl.problem.SuperbPR.save_model" title="s3prl.problem.SuperbPR.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a>. By saving this dictionary, you can easily reconstruct the same task
by calling <a class="reference internal" href="#s3prl.problem.SuperbPR.build_task" title="s3prl.problem.SuperbPR.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>task</strong> (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><em>Task</em></a>) – the task to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbPR.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L287-L658"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbPR.train" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbPR.default_config" title="s3prl.problem.SuperbPR.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>total_steps</p></td>
<td><p>(int) - the total optimization steps</p></td>
</tr>
<tr class="row-odd"><td><p>log_step</p></td>
<td><p>(int) - logging frequency. log every <code class="code docutils literal notranslate"><span class="pre">log_step</span></code> step</p></td>
</tr>
<tr class="row-even"><td><p>eval_step</p></td>
<td><p>(int) - evaluation frequency. Evaluate every <code class="code docutils literal notranslate"><span class="pre">eval_step</span></code> step.                                                 Note that you can control how many batch to evaluate to speed up the                                                 development by the <code class="code docutils literal notranslate"><span class="pre">eval_batch</span></code> argument in <a class="reference internal" href="#s3prl.problem.SuperbPR.run" title="s3prl.problem.SuperbPR.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>save_step</p></td>
<td><p>(int) - save the checkpoint every <code class="code docutils literal notranslate"><span class="pre">save_step</span></code> step.</p></td>
</tr>
<tr class="row-even"><td><p>gradient_clipping</p></td>
<td><p>(float) - clip the gradient. important for RNNs.</p></td>
</tr>
<tr class="row-odd"><td><p>gradient_accumulate</p></td>
<td><p>(int) - accumulate multiple steps’ gradient before updating network parameters                                                 to simulate large-batch optimization.</p></td>
</tr>
<tr class="row-even"><td><p>valid_metric</p></td>
<td><p>(str) - the metric to select the best valid checkpoint. Different Tasks have different                                                 supported valid_metrics. See <a class="reference internal" href="#s3prl.problem.SuperbPR.build_task" title="s3prl.problem.SuperbPR.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> for the supported metrics.</p></td>
</tr>
<tr class="row-odd"><td><p>valid_higher_better</p></td>
<td><p>(bool) - some metrics are higher better, while some are lower better                                                 this will affect how to save the best validation checkpoint.</p></td>
</tr>
<tr class="row-even"><td><p>auto_resume</p></td>
<td><p>(bool) - if there are already the last checkpoint in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.SuperbPR.run" title="s3prl.problem.SuperbPR.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>),                                                 whether to resume from it or delete it and start a new training session.</p></td>
</tr>
<tr class="row-odd"><td><p>resume_ckpt_dir</p></td>
<td><p>(str) - you can directly specify the checkpoint path to resume which is not necessary                                                 in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.SuperbPR.run" title="s3prl.problem.SuperbPR.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>).</p></td>
</tr>
<tr class="row-even"><td><p>seed</p></td>
<td><p>(int) - fix the seed before the training start</p></td>
</tr>
<tr class="row-odd"><td><p>keep_num_ckpts</p></td>
<td><p>(int) - to prevent saving too many checkpoints, only save the <code class="code docutils literal notranslate"><span class="pre">keep_num_ckpts</span></code>                                                 latest checkpoints and delete the old ones.</p></td>
</tr>
<tr class="row-even"><td><p>use_scheduler</p></td>
<td><p>(bool) - whether to use the scheduler</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="superbsf">
<h2>SuperbSF<a class="headerlink" href="#superbsf" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSF">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">s3prl.problem.</span></span><span class="sig-name descname"><span class="pre">SuperbSF</span></span><a class="reference internal" href="../_modules/s3prl/problem/asr/superb_sf.html#SuperbSF"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/asr/superb_sf.py#L101-L396"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSF" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="s3prl.problem.asr.superb_asr.html#s3prl.problem.asr.superb_asr.SuperbASR" title="s3prl.problem.asr.superb_asr.SuperbASR"><code class="xref py py-class docutils literal notranslate"><span class="pre">SuperbASR</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSF.default_config">
<span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/s3prl/problem/asr/superb_sf.html#SuperbSF.default_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/asr/superb_sf.py#L102-L205"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSF.default_config" title="Permalink to this definition">#</a></dt>
<dd><p>The default arguments for <a class="reference internal" href="#s3prl.problem.SuperbSF.run" title="s3prl.problem.SuperbSF.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> in yaml.
Note that for the fields with inner values, like <code class="code docutils literal notranslate"><span class="pre">build_model</span></code>,
the outer field name corresponds to a method name, so you can find the method
<a class="reference internal" href="#s3prl.problem.SuperbSF.build_model" title="s3prl.problem.SuperbSF.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>. Furthermore, the values inside that field will be
directly passed into the method. So by changing these inner values, you
can directly affect the behavior of the corresponding method. See the method
documentation for all the supported arguments and their meanings.</p>
<p>The methods affected by the following config are: <a class="reference internal" href="#s3prl.problem.SuperbSF.prepare_data" title="s3prl.problem.SuperbSF.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSF.prepare_tokenizer_data" title="s3prl.problem.SuperbSF.prepare_tokenizer_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_tokenizer_data</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSF.build_tokenizer" title="s3prl.problem.SuperbSF.build_tokenizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_tokenizer</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSF.build_dataset" title="s3prl.problem.SuperbSF.build_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_dataset</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSF.build_batch_sampler" title="s3prl.problem.SuperbSF.build_batch_sampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_batch_sampler</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSF.build_upstream" title="s3prl.problem.SuperbSF.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSF.build_featurizer" title="s3prl.problem.SuperbSF.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSF.build_downstream" title="s3prl.problem.SuperbSF.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSF.build_model" title="s3prl.problem.SuperbSF.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSF.build_task" title="s3prl.problem.SuperbSF.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSF.build_optimizer" title="s3prl.problem.SuperbSF.build_optimizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_optimizer</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSF.build_scheduler" title="s3prl.problem.SuperbSF.build_scheduler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_scheduler</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSF.save_model" title="s3prl.problem.SuperbSF.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSF.save_task" title="s3prl.problem.SuperbSF.save_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_task</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSF.train" title="s3prl.problem.SuperbSF.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">start</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="nt">stop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">target_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">cache_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">remove_all_cache</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">prepare_data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">dataset_root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="w">  </span><span class="nt">train_speakers</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ivy</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Joanna</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Joey</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Justin</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Kendra</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Kimberly</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Matthew</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Salli</span>
<span class="w">  </span><span class="nt">valid_speakers</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Aditi</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Amy</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Geraint</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Nicole</span>
<span class="w">  </span><span class="nt">test_speakers</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Brian</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Emma</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Raveena</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Russell</span>
<span class="nt">prepare_tokenizer_data</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">build_tokenizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">vocab_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">character</span>
<span class="nt">build_dataset</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">build_batch_sampler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">train</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">32</span>
<span class="w">    </span><span class="nt">max_length</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">300000</span>
<span class="w">  </span><span class="nt">valid</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">test</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="nt">build_upstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">build_featurizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">layer_selections</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="nt">normalize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_downstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">model_conf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">module</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">LSTM</span>
<span class="w">    </span><span class="nt">proj_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1024</span>
<span class="w">    </span><span class="nt">hidden_size</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1024</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1024</span>
<span class="w">    </span><span class="nt">dropout</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.2</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.2</span>
<span class="w">    </span><span class="nt">layer_norm</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">    </span><span class="nt">proj</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">    </span><span class="nt">sample_rate</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">    </span><span class="nt">sample_style</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">concat</span>
<span class="w">    </span><span class="nt">bidirectional</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">specaug_conf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">freq_mask_width_range</span><span class="p">:</span><span class="w"> </span><span class="kt">!!python/tuple</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50</span>
<span class="w">    </span><span class="nt">num_freq_mask</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span>
<span class="w">    </span><span class="nt">time_mask_width_range</span><span class="p">:</span><span class="w"> </span><span class="kt">!!python/tuple</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">40</span>
<span class="w">    </span><span class="nt">num_time_mask</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="nt">build_model</span><span class="p">:</span>
<span class="w">  </span><span class="nt">upstream_trainable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_task</span><span class="p">:</span>
<span class="w">  </span><span class="nt">log_metrics</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">wer</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cer</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">slot_type_f1</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">slot_value_cer</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">slot_value_wer</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">slot_edit_f1_full</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">slot_edit_f1_part</span>
<span class="nt">build_optimizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Adam</span>
<span class="w">  </span><span class="nt">conf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">lr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0001</span>
<span class="nt">build_scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ExponentialLR</span>
<span class="w">  </span><span class="nt">gamma</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.9</span>
<span class="nt">save_model</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">save_task</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">train</span><span class="p">:</span>
<span class="w">  </span><span class="nt">total_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">200000</span>
<span class="w">  </span><span class="nt">log_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">  </span><span class="nt">eval_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2000</span>
<span class="w">  </span><span class="nt">save_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">500</span>
<span class="w">  </span><span class="nt">gradient_clipping</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0</span>
<span class="w">  </span><span class="nt">gradient_accumulate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">valid_metric</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">slot_type_f1</span>
<span class="w">  </span><span class="nt">valid_higher_better</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">auto_resume</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">resume_ckpt_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSF.prepare_data">
<span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/asr/superb_sf.html#SuperbSF.prepare_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/asr/superb_sf.py#L207-L248"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSF.prepare_data" title="Permalink to this definition">#</a></dt>
<dd><p>Prepare the task-specific data metadata (path, labels…).
By default call <code class="xref py py-obj docutils literal notranslate"><span class="pre">audio_snips_for_slot_filling</span></code> with <code class="code docutils literal notranslate"><span class="pre">**prepare_data</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prepare_data</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSF.default_config" title="s3prl.problem.SuperbSF.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments in <code class="xref py py-obj docutils literal notranslate"><span class="pre">audio_snips_for_slot_filling</span></code></p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Parse your corpus and save the csv file into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the parsing or preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>train_path (str)</p></li>
<li><p>valid_path (str)</p></li>
<li><p>test_paths (List[str])</p></li>
</ol>
<p>Each path (str) should be a csv file containing the following columns:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>column</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>(str) - the unique id for this data point</p></td>
</tr>
<tr class="row-odd"><td><p>wav_path</p></td>
<td><p>(str) - the absolute path of the waveform file</p></td>
</tr>
<tr class="row-even"><td><p>transcription</p></td>
<td><dl class="simple">
<dt>(str) - a text string where words are separted by a space.</dt><dd><p>Eg. “I want to fly from Taipei to New York”</p>
</dd>
</dl>
</td>
</tr>
<tr class="row-odd"><td><p>iob</p></td>
<td><dl class="simple">
<dt>(str) - iob tags, use “O” if no tag, every word should have a tag, separted by a space.</dt><dd><p>Eg. “O O O O O from_location O to_location to_location”</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSF.prepare_tokenizer_data">
<span class="sig-name descname"><span class="pre">prepare_tokenizer_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prepare_tokenizer_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_csvs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/asr/superb_sf.html#SuperbSF.prepare_tokenizer_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/asr/superb_sf.py#L250-L284"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSF.prepare_tokenizer_data" title="Permalink to this definition">#</a></dt>
<dd><p>Prepare the text file used for training tokenizer.
By default only use the transcription in the <code class="code docutils literal notranslate"><span class="pre">train_csv</span></code> returned from <a class="reference internal" href="#s3prl.problem.SuperbSF.prepare_data" title="s3prl.problem.SuperbSF.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a>
The default <code class="code docutils literal notranslate"><span class="pre">prepare_tokenizer_data</span></code> build the character-based tokenizer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prepare_tokenizer_data</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSF.default_config" title="s3prl.problem.SuperbSF.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no supported argument for now</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Save the text file into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the parsing or preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>train_csv</strong> (<em>str</em>) – The train data given by <a class="reference internal" href="#s3prl.problem.SuperbSF.prepare_data" title="s3prl.problem.SuperbSF.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>str</p>
<p>The text file path, the text file should be in the format</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>This is the first line
This is the second line
These are all text used for training tokenizer
</pre></div>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSF.build_tokenizer">
<span class="sig-name descname"><span class="pre">build_tokenizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_tokenizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer_data_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/asr/superb_sf.html#SuperbSF.build_tokenizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/asr/superb_sf.py#L286-L303"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSF.build_tokenizer" title="Permalink to this definition">#</a></dt>
<dd><p>Build the tokenizer from the data prepared by <a class="reference internal" href="#s3prl.problem.SuperbSF.prepare_tokenizer_data" title="s3prl.problem.SuperbSF.prepare_tokenizer_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_tokenizer_data</span></code></a>
By default call <code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_common_tokenizer</span></code> with <code class="code docutils literal notranslate"><span class="pre">**build_tokenizer</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_tokenizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSF.default_config" title="s3prl.problem.SuperbSF.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_common_tokenizer</span></code></p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experinment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the parsing or preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>tokenizer_data_path</strong> (<em>str</em>) – The text file from <a class="reference internal" href="#s3prl.problem.SuperbSF.prepare_tokenizer_data" title="s3prl.problem.SuperbSF.prepare_tokenizer_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_tokenizer_data</span></code></a></p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>str</p>
<p>filepath of the pickled <a class="reference internal" href="s3prl.dataio.encoder.html#s3prl.dataio.encoder.Tokenizer" title="s3prl.dataio.encoder.tokenizer.Tokenizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataio.encoder.tokenizer.Tokenizer</span></code></a></p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSF.build_dataset">
<span class="sig-name descname"><span class="pre">build_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/asr/superb_sf.html#SuperbSF.build_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/asr/superb_sf.py#L305-L342"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSF.build_dataset" title="Permalink to this definition">#</a></dt>
<dd><p>Build the dataset for train/valid/test.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_dataset</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSF.default_config" title="s3prl.problem.SuperbSF.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, not used</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – The metadata csv file for the specific <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p></li>
<li><p><strong>tokenizer_path</strong> (<em>str</em>) – The pickled tokenizer path for encoding transcription</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch Dataset</p>
<p>For all train/valid/test mode, the dataset should return each item as a dictionary
containing the following keys:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>x</p></td>
<td><p>(torch.FloatTensor) - the waveform in (seq_len, 1)</p></td>
</tr>
<tr class="row-odd"><td><p>x_len</p></td>
<td><p>(int) - the waveform length <code class="code docutils literal notranslate"><span class="pre">seq_len</span></code></p></td>
</tr>
<tr class="row-even"><td><p>class_ids</p></td>
<td><p>(torch.LongTensor) - the encoded class ids of a transcription (sentence)</p></td>
</tr>
<tr class="row-odd"><td><p>labels</p></td>
<td><p>(str) - the text transcription</p></td>
</tr>
<tr class="row-even"><td><p>unique_name</p></td>
<td><p>(str) - the unique id for this datapoint</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSF.build_batch_sampler">
<span class="sig-name descname"><span class="pre">build_batch_sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/asr/superb_sf.html#SuperbSF.build_batch_sampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/asr/superb_sf.py#L344-L396"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSF.build_batch_sampler" title="Permalink to this definition">#</a></dt>
<dd><p>Return the batch sampler for torch DataLoader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_batch_sampler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbSF.default_config" title="s3prl.problem.SuperbSF.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>train</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">SortedSliceSampler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>valid</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-even"><td><p>test</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">mode</span></code> specific csv from <a class="reference internal" href="#s3prl.problem.SuperbSF.prepare_data" title="s3prl.problem.SuperbSF.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>dataset</strong> – the dataset from <a class="reference internal" href="#s3prl.problem.SuperbSF.build_dataset" title="s3prl.problem.SuperbSF.build_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_dataset</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>batch sampler for torch DataLoader</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSF.build_collate_fn">
<span class="sig-name descname"><span class="pre">build_collate_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L143-L156"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSF.build_collate_fn" title="Permalink to this definition">#</a></dt>
<dd><p>By default returns <code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataset.base.default_collate_fn</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_collate_fn</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSF.default_config" title="s3prl.problem.SuperbSF.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train, valid, or test</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>callable</p>
<p>the collate_fn for torch DataLoader in train/valid/test <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSF.build_downstream">
<span class="sig-name descname"><span class="pre">build_downstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/asr/superb_asr.py#L497-L530"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSF.build_downstream" title="Permalink to this definition">#</a></dt>
<dd><p>Return the task-specific downstream model.
By default build the <code class="xref py py-obj docutils literal notranslate"><span class="pre">RNNEncoder</span></code> model wrapped with <code class="xref py py-obj docutils literal notranslate"><span class="pre">ModelWithSpecaug</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSF.default_config" title="s3prl.problem.SuperbSF.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, has two keys:
<code class="code docutils literal notranslate"><span class="pre">model_conf</span></code> is the arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">RNNEncoder</span></code>;
<code class="code docutils literal notranslate"><span class="pre">specaug_conf</span></code> is the arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">ModelWithSpecaug</span></code></p></li>
<li><p><strong>downstream_input_size</strong> (<em>int</em>) – the required input size of the model</p></li>
<li><p><strong>downstream_output_size</strong> (<em>int</em>) – the required output size of the model</p></li>
<li><p><strong>downstream_input_stride</strong> (<em>int</em>) – the input feature’s stride (from 16 KHz)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsFrameModel" title="s3prl.nn.interface.AbsFrameModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsFrameModel</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSF.build_featurizer">
<span class="sig-name descname"><span class="pre">build_featurizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upstream</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L175-L192"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSF.build_featurizer" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the featurizer with <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSF.default_config" title="s3prl.problem.SuperbSF.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p></li>
<li><p><strong>upstream</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">AbsUpstream</span></code>) – the upstream model built by <a class="reference internal" href="#s3prl.problem.SuperbSF.build_upstream" title="s3prl.problem.SuperbSF.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsFeaturizer" title="s3prl.nn.interface.AbsFeaturizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsFeaturizer</span></code></a></p>
<p>Return the featurizer model. The featurizer is used to reduce the multiple
hidden states returned from the upstream model (built by <a class="reference internal" href="#s3prl.problem.SuperbSF.build_upstream" title="s3prl.problem.SuperbSF.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>)
into a single hidden state, so can be easliy fed into the downstream model</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSF.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L194-L231"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSF.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>By default build model with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSF.default_config" title="s3prl.problem.SuperbSF.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p></li>
<li><p><strong>model_output_size</strong> (<em>int</em>) – the required model’s output hidden size</p></li>
<li><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSF.default_config" title="s3prl.problem.SuperbSF.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.SuperbSF.build_upstream" title="s3prl.problem.SuperbSF.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSF.default_config" title="s3prl.problem.SuperbSF.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.SuperbSF.build_featurizer" title="s3prl.problem.SuperbSF.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a></p></li>
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSF.default_config" title="s3prl.problem.SuperbSF.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.SuperbSF.build_downstream" title="s3prl.problem.SuperbSF.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch.nn.Module</p>
<p>Return the entire model for the task, which takes the direct items from DataLoader as the input.
Usually, the components can be built by <a class="reference internal" href="#s3prl.problem.SuperbSF.build_upstream" title="s3prl.problem.SuperbSF.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>, <a class="reference internal" href="#s3prl.problem.SuperbSF.build_featurizer" title="s3prl.problem.SuperbSF.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a>,
<a class="reference internal" href="#s3prl.problem.SuperbSF.build_downstream" title="s3prl.problem.SuperbSF.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a>, and are concated together to get the final model.
The upstream extracts multiple hidden states, the featuizer reduce them into a single hidden state,
and the downstream takes the hidden states as the feature for the downstream-specific model.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSF.build_optimizer">
<span class="sig-name descname"><span class="pre">build_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L233-L258"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSF.build_optimizer" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_optimizer</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbSF.default_config" title="s3prl.problem.SuperbSF.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to below</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the optimizer class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the optimizer class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;lr&quot;:</span> <span class="pre">1.0e-4}</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>parameters</strong> (<em>iterable</em>) – the standard params accepted by <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code></p>
<p>An optimizer following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSF.build_scheduler">
<span class="sig-name descname"><span class="pre">build_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L260-L285"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSF.build_scheduler" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_scheduler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbSF.default_config" title="s3prl.problem.SuperbSF.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the scheduler class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the scheduler class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;gamma&quot;:</span> <span class="pre">0.01}</span></code> for <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler.StepLR</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>optimizer</strong> – the standard torch optimizer accepted by Scheduler in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch scheduler</p>
<p>A scheduler following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSF.build_task">
<span class="sig-name descname"><span class="pre">build_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tokenizer</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/asr/run.py#L357-L359"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSF.build_task" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSF.build_upstream">
<span class="sig-name descname"><span class="pre">build_upstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L158-L173"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSF.build_upstream" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the upstream with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSF.default_config" title="s3prl.problem.SuperbSF.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUpstream" title="s3prl.nn.interface.AbsUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUpstream</span></code></a></p>
<p>Return an upstream model, whose forward takes the waveform input and returns
multiple hidden states as features.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSF.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L660-L707"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSF.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>The evaluate routine used by <a class="reference internal" href="#s3prl.problem.SuperbSF.train" title="s3prl.problem.SuperbSF.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> (during validation phase) and <a class="reference internal" href="#s3prl.problem.SuperbSF.run" title="s3prl.problem.SuperbSF.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>
(during testing phase).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evaluate</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSF.default_config" title="s3prl.problem.SuperbSF.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSF.get_class_from_name">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_class_from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L129-L141"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSF.get_class_from_name" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">__name__</span></code> of the problem class</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Problem</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSF.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L752-L772"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSF.load_model" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model_ckpt_dir</strong> (<em>str</em>) – Restore the model with <a class="reference internal" href="#s3prl.problem.SuperbSF.build_model" title="s3prl.problem.SuperbSF.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> and the checkpoint
saved in this directory.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSF.load_model_and_task">
<span class="sig-name descname"><span class="pre">load_model_and_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ckpts_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L884-L902"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSF.load_model_and_task" title="Permalink to this definition">#</a></dt>
<dd><p>This is a helper method to combine <a class="reference internal" href="#s3prl.problem.SuperbSF.load_model" title="s3prl.problem.SuperbSF.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a> and <a class="reference internal" href="#s3prl.problem.SuperbSF.load_task" title="s3prl.problem.SuperbSF.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>
together to directly load the model and the task. This method assumes
the model is saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'model'</span></code> and the task is
saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'task'</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>model (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>)</p></li>
<li><p>task (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a>)</p></li>
</ol>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSF.load_task">
<span class="sig-name descname"><span class="pre">load_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L833-L882"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSF.load_task" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – Restore the task with <a class="reference internal" href="#s3prl.problem.SuperbSF.build_task" title="s3prl.problem.SuperbSF.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> and the checkpoint
saved in this directory.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model for the task, since the model is separately saved
and is required for <a class="reference internal" href="#s3prl.problem.SuperbSF.build_task" title="s3prl.problem.SuperbSF.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a>.</p></li>
<li><p><strong>task_overrides</strong> (<em>dict</em>) – overrides the saved initialization arguments, so can change
the loaded task’s behavior. Like, change the decoding hyperparameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSF.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L954-L995"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSF.main" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSF.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_all_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cuda'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepare_tokenizer_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_tokenizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/asr/run.py#L24-L325"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSF.run" title="Permalink to this definition">#</a></dt>
<dd><div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>stage</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Parse the corpus and save the metadata file for ASR (waveform path, label…)</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Prepare the metadata file for training tokenizer</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Train the tokenizer</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Train the ASR model</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>Evaluate the model on multiple test sets, multiple checkpoints will be evaluated for each test set (See <code class="code docutils literal notranslate"><span class="pre">test_ckpt_steps</span></code>)</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_dir</strong> (<em>str</em>) – The directory that stores the script result.</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – The directory that caches the processed data.
Default: /home/user/.cache/s3prl/data</p></li>
<li><p><strong>remove_all_cache</strong> (<em>bool</em>) – Whether to remove all the cache stored under <cite>cache_dir</cite>.
Default: False</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting stage of the problem script.
Default: 0</p></li>
<li><p><strong>stop</strong> (<em>int</em>) – The stoping stage of the problem script, set <cite>None</cite> to reach the final stage.
Default: None</p></li>
<li><p><strong>num_workers</strong> (<em>int</em>) – num_workers for all the torch DataLoder</p></li>
<li><p><strong>eval_batch</strong> (<em>int</em>) – During evaluation (valid or test), limit the number of batch.
This is helpful for the fast development to check everything won’t crash.
If is -1, disable this feature and evaluate the entire epoch.
Default: -1</p></li>
<li><p><strong>device</strong> (<em>str</em>) – The device type for all torch-related operation: “cpu” or “cuda”
Default: “cuda”</p></li>
<li><p><strong>world_size</strong> (<em>int</em>) – How many processes are running this script simultaneously (in parallel).
Usually this is just 1, however if you are runnig distributed training,
this should be &gt; 1.
Default: 1</p></li>
<li><p><strong>rank</strong> (<em>int</em>) – When distributed training, world_size &gt; 1. Take <code class="code docutils literal notranslate"><span class="pre">world_size</span> <span class="pre">==</span> <span class="pre">8</span></code> for
example, this means 8 processes (8 GPUs) are runing in parallel. The script
needs to know which process among 8 processes it is. In this case, <code class="code docutils literal notranslate"><span class="pre">rank</span></code>
can range from 0~7. All the 8 processes have the same <code class="code docutils literal notranslate"><span class="pre">world_size</span></code> but
different <code class="code docutils literal notranslate"><span class="pre">rank</span></code> (process id).</p></li>
<li><p><strong>test_ckpt_dir</strong> (<em>str</em>) – Specify the checkpoint path for testing. If not, use checkpoints specified by
<code class="code docutils literal notranslate"><span class="pre">test_ckpts_steps</span></code>.</p></li>
<li><p><strong>**others</strong> – The other arguments like <code class="code docutils literal notranslate"><span class="pre">prepare_data</span></code> and <code class="code docutils literal notranslate"><span class="pre">build_model</span></code> are
method specific-arguments for methods like <a class="reference internal" href="#s3prl.problem.SuperbSF.prepare_data" title="s3prl.problem.SuperbSF.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> and
<a class="reference internal" href="#s3prl.problem.SuperbSF.build_model" title="s3prl.problem.SuperbSF.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>, and will not be used in the core <a class="reference internal" href="#s3prl.problem.SuperbSF.run" title="s3prl.problem.SuperbSF.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> logic.
See the specific method documentation for their supported arguments and
meaning</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSF.save_model">
<span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L709-L750"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSF.save_model" title="Permalink to this definition">#</a></dt>
<dd><p>Save the model state_dict and the model initialization arguments into the given directory.
If you override this method, it is highly possible you also need to override <a class="reference internal" href="#s3prl.problem.SuperbSF.load_model" title="s3prl.problem.SuperbSF.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSF.default_config" title="s3prl.problem.SuperbSF.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_model</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>model_ckpt_dir</strong> (<em>str</em>) – save the model into the this directory.</p></li>
<li><p><strong>build_model_all_args</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.SuperbSF.build_model" title="s3prl.problem.SuperbSF.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>.
By saving this dictionary, you can easily reconstruct the same model
by calling <a class="reference internal" href="#s3prl.problem.SuperbSF.build_model" title="s3prl.problem.SuperbSF.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSF.save_task">
<span class="sig-name descname"><span class="pre">save_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="s3prl.task.base.html#s3prl.task.base.Task" title="s3prl.task.base.Task"><span class="pre">Task</span></a></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L774-L831"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSF.save_task" title="Permalink to this definition">#</a></dt>
<dd><p>Save the task’s state, <code class="code docutils literal notranslate"><span class="pre">task.get_state()</span></code>, and the initialization arguments into the given
directory. If you override this method, it is highly possible you also need to override
<a class="reference internal" href="#s3prl.problem.SuperbSF.load_task" title="s3prl.problem.SuperbSF.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSF.default_config" title="s3prl.problem.SuperbSF.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_task</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – save the task into this directory.</p></li>
<li><p><strong>build_task_all_args_except_model</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.SuperbSF.build_task" title="s3prl.problem.SuperbSF.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> except
the <code class="code docutils literal notranslate"><span class="pre">model</span></code> argument since the model should be sapartely saved by
<a class="reference internal" href="#s3prl.problem.SuperbSF.save_model" title="s3prl.problem.SuperbSF.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a>. By saving this dictionary, you can easily reconstruct the same task
by calling <a class="reference internal" href="#s3prl.problem.SuperbSF.build_task" title="s3prl.problem.SuperbSF.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>task</strong> (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><em>Task</em></a>) – the task to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSF.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L287-L658"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSF.train" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbSF.default_config" title="s3prl.problem.SuperbSF.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>total_steps</p></td>
<td><p>(int) - the total optimization steps</p></td>
</tr>
<tr class="row-odd"><td><p>log_step</p></td>
<td><p>(int) - logging frequency. log every <code class="code docutils literal notranslate"><span class="pre">log_step</span></code> step</p></td>
</tr>
<tr class="row-even"><td><p>eval_step</p></td>
<td><p>(int) - evaluation frequency. Evaluate every <code class="code docutils literal notranslate"><span class="pre">eval_step</span></code> step.                                                 Note that you can control how many batch to evaluate to speed up the                                                 development by the <code class="code docutils literal notranslate"><span class="pre">eval_batch</span></code> argument in <a class="reference internal" href="#s3prl.problem.SuperbSF.run" title="s3prl.problem.SuperbSF.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>save_step</p></td>
<td><p>(int) - save the checkpoint every <code class="code docutils literal notranslate"><span class="pre">save_step</span></code> step.</p></td>
</tr>
<tr class="row-even"><td><p>gradient_clipping</p></td>
<td><p>(float) - clip the gradient. important for RNNs.</p></td>
</tr>
<tr class="row-odd"><td><p>gradient_accumulate</p></td>
<td><p>(int) - accumulate multiple steps’ gradient before updating network parameters                                                 to simulate large-batch optimization.</p></td>
</tr>
<tr class="row-even"><td><p>valid_metric</p></td>
<td><p>(str) - the metric to select the best valid checkpoint. Different Tasks have different                                                 supported valid_metrics. See <a class="reference internal" href="#s3prl.problem.SuperbSF.build_task" title="s3prl.problem.SuperbSF.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> for the supported metrics.</p></td>
</tr>
<tr class="row-odd"><td><p>valid_higher_better</p></td>
<td><p>(bool) - some metrics are higher better, while some are lower better                                                 this will affect how to save the best validation checkpoint.</p></td>
</tr>
<tr class="row-even"><td><p>auto_resume</p></td>
<td><p>(bool) - if there are already the last checkpoint in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.SuperbSF.run" title="s3prl.problem.SuperbSF.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>),                                                 whether to resume from it or delete it and start a new training session.</p></td>
</tr>
<tr class="row-odd"><td><p>resume_ckpt_dir</p></td>
<td><p>(str) - you can directly specify the checkpoint path to resume which is not necessary                                                 in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.SuperbSF.run" title="s3prl.problem.SuperbSF.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>).</p></td>
</tr>
<tr class="row-even"><td><p>seed</p></td>
<td><p>(int) - fix the seed before the training start</p></td>
</tr>
<tr class="row-odd"><td><p>keep_num_ckpts</p></td>
<td><p>(int) - to prevent saving too many checkpoints, only save the <code class="code docutils literal notranslate"><span class="pre">keep_num_ckpts</span></code>                                                 latest checkpoints and delete the old ones.</p></td>
</tr>
<tr class="row-even"><td><p>use_scheduler</p></td>
<td><p>(bool) - whether to use the scheduler</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="superbasv">
<h2>SuperbASV<a class="headerlink" href="#superbasv" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASV">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">s3prl.problem.</span></span><span class="sig-name descname"><span class="pre">SuperbASV</span></span><a class="reference internal" href="../_modules/s3prl/problem/asv/superb_asv.html#SuperbASV"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/asv/superb_asv.py#L93-L472"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASV" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="s3prl.problem.asv.run.html#s3prl.problem.asv.run.ASV" title="s3prl.problem.asv.run.ASV"><code class="xref py py-class docutils literal notranslate"><span class="pre">ASV</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASV.default_config">
<span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/asv/superb_asv.html#SuperbASV.default_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/asv/superb_asv.py#L94-L157"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASV.default_config" title="Permalink to this definition">#</a></dt>
<dd><p>The default arguments for <a class="reference internal" href="#s3prl.problem.SuperbASV.run" title="s3prl.problem.SuperbASV.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> in yaml.
Note that for the fields with inner values, like <code class="code docutils literal notranslate"><span class="pre">build_model</span></code>,
the outer field name corresponds to a method name, so you can find the method
<a class="reference internal" href="#s3prl.problem.SuperbASV.build_model" title="s3prl.problem.SuperbASV.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>. Furthermore, the values inside that field will be
directly passed into the method. So by changing these inner values, you
can directly affect the behavior of the corresponding method. See the method
documentation for all the supported arguments and their meanings.</p>
<p>The methods affected by the following config are: <a class="reference internal" href="#s3prl.problem.SuperbASV.prepare_data" title="s3prl.problem.SuperbASV.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbASV.build_dataset" title="s3prl.problem.SuperbASV.build_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_dataset</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbASV.build_batch_sampler" title="s3prl.problem.SuperbASV.build_batch_sampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_batch_sampler</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbASV.build_upstream" title="s3prl.problem.SuperbASV.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbASV.build_featurizer" title="s3prl.problem.SuperbASV.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbASV.build_model" title="s3prl.problem.SuperbASV.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbASV.build_task" title="s3prl.problem.SuperbASV.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbASV.build_optimizer" title="s3prl.problem.SuperbASV.build_optimizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_optimizer</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbASV.build_scheduler" title="s3prl.problem.SuperbASV.build_scheduler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_scheduler</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbASV.train" title="s3prl.problem.SuperbASV.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">target_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">cache_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">test_ckpt_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">prepare_data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">dataset_root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">build_dataset</span><span class="p">:</span>
<span class="w">  </span><span class="nt">train</span><span class="p">:</span>
<span class="w">    </span><span class="nt">min_secs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2.0</span>
<span class="w">    </span><span class="nt">max_secs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8.0</span>
<span class="nt">build_batch_sampler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">train</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="w">    </span><span class="nt">shuffle</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">test</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="nt">build_upstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">build_featurizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">layer_selections</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="nt">normalize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_model</span><span class="p">:</span>
<span class="w">  </span><span class="nt">upstream_trainable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_task</span><span class="p">:</span>
<span class="w">  </span><span class="nt">loss_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">amsoftmax</span>
<span class="w">  </span><span class="nt">loss_conf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">margin</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.4</span>
<span class="w">    </span><span class="nt">scale</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30</span>
<span class="nt">build_optimizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">AdamW</span>
<span class="w">  </span><span class="nt">conf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">lr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0001</span>
<span class="nt">build_scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ExponentialLR</span>
<span class="w">  </span><span class="nt">gamma</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.9</span>
<span class="nt">train</span><span class="p">:</span>
<span class="w">  </span><span class="nt">total_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">200000</span>
<span class="w">  </span><span class="nt">log_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">500</span>
<span class="w">  </span><span class="nt">eval_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0e+20</span>
<span class="w">  </span><span class="nt">save_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10000</span>
<span class="w">  </span><span class="nt">gradient_clipping</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000.0</span>
<span class="w">  </span><span class="nt">gradient_accumulate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">  </span><span class="nt">valid_metric</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="nt">valid_higher_better</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="nt">auto_resume</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">resume_ckpt_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="nt">keep_num_ckpts</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASV.prepare_data">
<span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/asv/superb_asv.html#SuperbASV.prepare_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/asv/superb_asv.py#L159-L206"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASV.prepare_data" title="Permalink to this definition">#</a></dt>
<dd><p>Prepare the task-specific data metadata (path, labels…).
By default call <code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_voxceleb1_for_sv</span></code> with <code class="code docutils literal notranslate"><span class="pre">**prepare_data</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prepare_data</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbASV.default_config" title="s3prl.problem.SuperbASV.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
support arguments in <code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_voxceleb1_for_sv</span></code></p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Parse your corpus and save the csv file into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the parsing or preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>get_path_only</strong> (<em>bool</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>train_path (str)</p></li>
<li><p>test_trial_paths (List[str])</p></li>
</ol>
<p>The <code class="code docutils literal notranslate"><span class="pre">train_path</span></code> should be a csv file containing the following columns:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>column</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>(str) - the unique id for this utterance</p></td>
</tr>
<tr class="row-odd"><td><p>wav_path</p></td>
<td><p>(str) - the absolute path of the waveform file</p></td>
</tr>
<tr class="row-even"><td><p>spk</p></td>
<td><p>(str) - a string speaker label</p></td>
</tr>
</tbody>
</table>
</div>
<p>Each <code class="code docutils literal notranslate"><span class="pre">test_trial_path</span></code> should be a csv file containing the following columns:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>column</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id1</p></td>
<td><p>(str) - the unique id of the first utterance</p></td>
</tr>
<tr class="row-odd"><td><p>id2</p></td>
<td><p>(str) - the unique id of the second utterance</p></td>
</tr>
<tr class="row-even"><td><p>wav_path1</p></td>
<td><p>(str) - the absolute path of the first utterance</p></td>
</tr>
<tr class="row-odd"><td><p>wav_path2</p></td>
<td><p>(str) - the absolute path of the second utterance</p></td>
</tr>
<tr class="row-even"><td><p>label</p></td>
<td><p>(int) - 0 when two utterances are from different speakers,                                     1 when same speaker</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASV.build_encoder">
<span class="sig-name descname"><span class="pre">build_encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_csvs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/asv/superb_asv.html#SuperbASV.build_encoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/asv/superb_asv.py#L208-L248"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASV.build_encoder" title="Permalink to this definition">#</a></dt>
<dd><p>Build the encoder (for the labels) given the data metadata, and return the saved encoder path.
By default generate and save a <a class="reference internal" href="s3prl.dataio.encoder.html#s3prl.dataio.encoder.CategoryEncoder" title="s3prl.dataio.encoder.CategoryEncoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataio.encoder.CategoryEncoder</span></code></a> from the <code class="code docutils literal notranslate"><span class="pre">label</span></code> column of the train csv.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_encoder</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbASV.default_config" title="s3prl.problem.SuperbASV.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Save your encoder into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>train_csv_path</strong> (<em>str</em>) – the train path from <a class="reference internal" href="#s3prl.problem.SuperbASV.prepare_data" title="s3prl.problem.SuperbASV.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>valid_csv_path</strong> (<em>str</em>) – the valid path from <a class="reference internal" href="#s3prl.problem.SuperbASV.prepare_data" title="s3prl.problem.SuperbASV.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>test_csv_paths</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – the test paths from <a class="reference internal" href="#s3prl.problem.SuperbASV.prepare_data" title="s3prl.problem.SuperbASV.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>get_path_only</strong> (<em>bool</em>) – Directly return the filepaths no matter they exist or not</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>str</p>
<p>encoder_path: The encoder should be saved in the pickle format</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASV.build_dataset">
<span class="sig-name descname"><span class="pre">build_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/asv/superb_asv.html#SuperbASV.build_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/asv/superb_asv.py#L250-L403"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASV.build_dataset" title="Permalink to this definition">#</a></dt>
<dd><p>Build the dataset for train/valid/test.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_dataset</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbASV.default_config" title="s3prl.problem.SuperbASV.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, have
<code class="code docutils literal notranslate"><span class="pre">train</span></code> and <code class="code docutils literal notranslate"><span class="pre">test</span></code> keys, each is a dictionary, for <code class="code docutils literal notranslate"><span class="pre">train</span></code> dictionary:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>min_secs</p></td>
<td><p>(float) - Drop a waveform if it is not longer than <code class="code docutils literal notranslate"><span class="pre">min_secs</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>max_secs</p></td>
<td><p>(float) - If a waveform is longer than <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds,                                         randomly crop the waveform into <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds.                                         Default: None, no cropping</p></td>
</tr>
</tbody>
</table>
</div>
<p>for <code class="code docutils literal notranslate"><span class="pre">test</span></code> dictionary, no argument supported yet</p>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – The metadata csv file for the specific <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p></li>
<li><p><strong>encoder_path</strong> (<em>str</em>) – The pickled encoder path for encoding the labels</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch Dataset</p>
<p>For train mode, the dataset should return each item as a dictionary
containing the following keys:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>x</p></td>
<td><p>(torch.FloatTensor) - the waveform in (seq_len, 1)</p></td>
</tr>
<tr class="row-odd"><td><p>x_len</p></td>
<td><p>(int) - the waveform length <code class="code docutils literal notranslate"><span class="pre">seq_len</span></code></p></td>
</tr>
<tr class="row-even"><td><p>class_id</p></td>
<td><p>(str) - the label class id encoded by <code class="code docutils literal notranslate"><span class="pre">encoder_path</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>unique_name</p></td>
<td><p>(str) - the unique id for this datapoint</p></td>
</tr>
</tbody>
</table>
</div>
<p>For test mode:</p>
<p>x                     (torch.FloatTensor) - the waveform in (seq_len, 1)
x_len                 (int) - the waveform length <code class="code docutils literal notranslate"><span class="pre">seq_len</span></code>
unique_name           (str) - the unique id for this datapoint</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASV.build_batch_sampler">
<span class="sig-name descname"><span class="pre">build_batch_sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/asv/superb_asv.html#SuperbASV.build_batch_sampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/asv/superb_asv.py#L405-L449"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASV.build_batch_sampler" title="Permalink to this definition">#</a></dt>
<dd><p>Return the batch sampler for torch DataLoader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_batch_sampler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbASV.default_config" title="s3prl.problem.SuperbASV.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>train</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>test</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<p>Note that ASV does not support valid</p>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">mode</span></code> specific csv from <a class="reference internal" href="#s3prl.problem.SuperbASV.prepare_data" title="s3prl.problem.SuperbASV.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>dataset</strong> – the dataset from <a class="reference internal" href="#s3prl.problem.SuperbASV.build_dataset" title="s3prl.problem.SuperbASV.build_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_dataset</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>batch sampler for torch DataLoader</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASV.build_downstream">
<span class="sig-name descname"><span class="pre">build_downstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/asv/superb_asv.html#SuperbASV.build_downstream"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/asv/superb_asv.py#L451-L472"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASV.build_downstream" title="Permalink to this definition">#</a></dt>
<dd><p>Return the task-specific downstream model.
By default build the <code class="xref py py-obj docutils literal notranslate"><span class="pre">SuperbXvector</span></code> model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbASV.default_config" title="s3prl.problem.SuperbASV.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments of <code class="xref py py-obj docutils literal notranslate"><span class="pre">SuperbXvector</span></code></p></li>
<li><p><strong>downstream_input_size</strong> (<em>int</em>) – the required input size of the model</p></li>
<li><p><strong>downstream_output_size</strong> (<em>int</em>) – the required output size of the model</p></li>
<li><p><strong>downstream_input_stride</strong> (<em>int</em>) – the input feature’s stride (from 16 KHz)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUtteranceModel" title="s3prl.nn.interface.AbsUtteranceModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUtteranceModel</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASV.build_collate_fn">
<span class="sig-name descname"><span class="pre">build_collate_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L143-L156"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASV.build_collate_fn" title="Permalink to this definition">#</a></dt>
<dd><p>By default returns <code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataset.base.default_collate_fn</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_collate_fn</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbASV.default_config" title="s3prl.problem.SuperbASV.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train, valid, or test</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>callable</p>
<p>the collate_fn for torch DataLoader in train/valid/test <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASV.build_featurizer">
<span class="sig-name descname"><span class="pre">build_featurizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upstream</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L175-L192"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASV.build_featurizer" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the featurizer with <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbASV.default_config" title="s3prl.problem.SuperbASV.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p></li>
<li><p><strong>upstream</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">AbsUpstream</span></code>) – the upstream model built by <a class="reference internal" href="#s3prl.problem.SuperbASV.build_upstream" title="s3prl.problem.SuperbASV.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsFeaturizer" title="s3prl.nn.interface.AbsFeaturizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsFeaturizer</span></code></a></p>
<p>Return the featurizer model. The featurizer is used to reduce the multiple
hidden states returned from the upstream model (built by <a class="reference internal" href="#s3prl.problem.SuperbASV.build_upstream" title="s3prl.problem.SuperbASV.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>)
into a single hidden state, so can be easliy fed into the downstream model</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASV.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L194-L231"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASV.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>By default build model with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbASV.default_config" title="s3prl.problem.SuperbASV.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p></li>
<li><p><strong>model_output_size</strong> (<em>int</em>) – the required model’s output hidden size</p></li>
<li><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbASV.default_config" title="s3prl.problem.SuperbASV.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.SuperbASV.build_upstream" title="s3prl.problem.SuperbASV.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbASV.default_config" title="s3prl.problem.SuperbASV.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.SuperbASV.build_featurizer" title="s3prl.problem.SuperbASV.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a></p></li>
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbASV.default_config" title="s3prl.problem.SuperbASV.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.SuperbASV.build_downstream" title="s3prl.problem.SuperbASV.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch.nn.Module</p>
<p>Return the entire model for the task, which takes the direct items from DataLoader as the input.
Usually, the components can be built by <a class="reference internal" href="#s3prl.problem.SuperbASV.build_upstream" title="s3prl.problem.SuperbASV.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>, <a class="reference internal" href="#s3prl.problem.SuperbASV.build_featurizer" title="s3prl.problem.SuperbASV.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a>,
<a class="reference internal" href="#s3prl.problem.SuperbASV.build_downstream" title="s3prl.problem.SuperbASV.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a>, and are concated together to get the final model.
The upstream extracts multiple hidden states, the featuizer reduce them into a single hidden state,
and the downstream takes the hidden states as the feature for the downstream-specific model.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASV.build_optimizer">
<span class="sig-name descname"><span class="pre">build_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L233-L258"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASV.build_optimizer" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_optimizer</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbASV.default_config" title="s3prl.problem.SuperbASV.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to below</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the optimizer class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the optimizer class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;lr&quot;:</span> <span class="pre">1.0e-4}</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>parameters</strong> (<em>iterable</em>) – the standard params accepted by <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code></p>
<p>An optimizer following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASV.build_scheduler">
<span class="sig-name descname"><span class="pre">build_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L260-L285"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASV.build_scheduler" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_scheduler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbASV.default_config" title="s3prl.problem.SuperbASV.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the scheduler class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the scheduler class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;gamma&quot;:</span> <span class="pre">0.01}</span></code> for <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler.StepLR</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>optimizer</strong> – the standard torch optimizer accepted by Scheduler in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch scheduler</p>
<p>A scheduler following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASV.build_task">
<span class="sig-name descname"><span class="pre">build_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_trials</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/asv/run.py#L388-L412"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASV.build_task" title="Permalink to this definition">#</a></dt>
<dd><p>Build the task, which defines the logics for every train/valid/test forward step for the <code class="code docutils literal notranslate"><span class="pre">model</span></code>,
and the logics for how to reduce all the batch results from multiple train/valid/test steps into metrics</p>
<p>By default build <code class="xref py py-obj docutils literal notranslate"><span class="pre">SpeakerVerification</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbASV.default_config" title="s3prl.problem.SuperbASV.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model built by <a class="reference internal" href="#s3prl.problem.SuperbASV.build_model" title="s3prl.problem.SuperbASV.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a></p></li>
<li><p><strong>encoder</strong> – the encoder built by <a class="reference internal" href="#s3prl.problem.SuperbASV.build_encoder" title="s3prl.problem.SuperbASV.build_encoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_encoder</span></code></a></p></li>
<li><p><strong>test_trials</strong> (<em>List</em><em>[</em><em>Tuple</em><em>[</em><em>int</em><em>, </em><em>str</em><em>, </em><em>str</em><em>]</em><em>]</em>) – each tuple in the list consists of
<code class="code docutils literal notranslate"><span class="pre">(label,</span> <span class="pre">enroll_utt_id,</span> <span class="pre">test_utt_id)</span></code>. label is either 0 or 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Task</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASV.build_upstream">
<span class="sig-name descname"><span class="pre">build_upstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L158-L173"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASV.build_upstream" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the upstream with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbASV.default_config" title="s3prl.problem.SuperbASV.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUpstream" title="s3prl.nn.interface.AbsUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUpstream</span></code></a></p>
<p>Return an upstream model, whose forward takes the waveform input and returns
multiple hidden states as features.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASV.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L660-L707"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASV.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>The evaluate routine used by <a class="reference internal" href="#s3prl.problem.SuperbASV.train" title="s3prl.problem.SuperbASV.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> (during validation phase) and <a class="reference internal" href="#s3prl.problem.SuperbASV.run" title="s3prl.problem.SuperbASV.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>
(during testing phase).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evaluate</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbASV.default_config" title="s3prl.problem.SuperbASV.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASV.get_class_from_name">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_class_from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L129-L141"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASV.get_class_from_name" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">__name__</span></code> of the problem class</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Problem</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASV.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L752-L772"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASV.load_model" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model_ckpt_dir</strong> (<em>str</em>) – Restore the model with <a class="reference internal" href="#s3prl.problem.SuperbASV.build_model" title="s3prl.problem.SuperbASV.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> and the checkpoint
saved in this directory.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASV.load_model_and_task">
<span class="sig-name descname"><span class="pre">load_model_and_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ckpts_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L884-L902"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASV.load_model_and_task" title="Permalink to this definition">#</a></dt>
<dd><p>This is a helper method to combine <a class="reference internal" href="#s3prl.problem.SuperbASV.load_model" title="s3prl.problem.SuperbASV.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a> and <a class="reference internal" href="#s3prl.problem.SuperbASV.load_task" title="s3prl.problem.SuperbASV.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>
together to directly load the model and the task. This method assumes
the model is saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'model'</span></code> and the task is
saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'task'</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>model (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>)</p></li>
<li><p>task (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a>)</p></li>
</ol>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASV.load_task">
<span class="sig-name descname"><span class="pre">load_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L833-L882"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASV.load_task" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – Restore the task with <a class="reference internal" href="#s3prl.problem.SuperbASV.build_task" title="s3prl.problem.SuperbASV.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> and the checkpoint
saved in this directory.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model for the task, since the model is separately saved
and is required for <a class="reference internal" href="#s3prl.problem.SuperbASV.build_task" title="s3prl.problem.SuperbASV.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a>.</p></li>
<li><p><strong>task_overrides</strong> (<em>dict</em>) – overrides the saved initialization arguments, so can change
the loaded task’s behavior. Like, change the decoding hyperparameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASV.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L954-L995"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASV.main" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASV.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_all_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cuda'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_ckpt_steps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/asv/run.py#L28-L356"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASV.run" title="Permalink to this definition">#</a></dt>
<dd><div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>stage</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Parse the corpus and save the metadata file (waveform path, label…)</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Build the encoder for encoding the speaker labels</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Train the model</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Evaluate the model on multiple test sets, multiple checkpoints will be evaluated for each test set (See <code class="code docutils literal notranslate"><span class="pre">test_ckpt_steps</span></code>)</p></td>
</tr>
<tr class="row-even"><td><p>4</p></td>
<td><p>Report the best result find on each test set</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_dir</strong> (<em>str</em>) – The directory that stores the script result.</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – The directory that caches the processed data.
Default: /home/user/.cache/s3prl/data</p></li>
<li><p><strong>remove_all_cache</strong> (<em>bool</em>) – Whether to remove all the cache stored under <cite>cache_dir</cite>.
Default: False</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting stage of the problem script.
Default: 0</p></li>
<li><p><strong>stop</strong> (<em>int</em>) – The stoping stage of the problem script, set <cite>None</cite> to reach the final stage.
Default: None</p></li>
<li><p><strong>num_workers</strong> (<em>int</em>) – num_workers for all the torch DataLoder</p></li>
<li><p><strong>eval_batch</strong> (<em>int</em>) – During evaluation (valid or test), limit the number of batch.
This is helpful for the fast development to check everything won’t crash.
If is -1, disable this feature and evaluate the entire epoch.
Default: -1</p></li>
<li><p><strong>device</strong> (<em>str</em>) – The device type for all torch-related operation: “cpu” or “cuda”
Default: “cuda”</p></li>
<li><p><strong>world_size</strong> (<em>int</em>) – How many processes are running this script simultaneously (in parallel).
Usually this is just 1, however if you are runnig distributed training,
this should be &gt; 1.
Default: 1</p></li>
<li><p><strong>rank</strong> (<em>int</em>) – When distributed training, world_size &gt; 1. Take <code class="code docutils literal notranslate"><span class="pre">world_size</span> <span class="pre">==</span> <span class="pre">8</span></code> for
example, this means 8 processes (8 GPUs) are runing in parallel. The script
needs to know which process among 8 processes it is. In this case, <code class="code docutils literal notranslate"><span class="pre">rank</span></code>
can range from 0~7. All the 8 processes have the same <code class="code docutils literal notranslate"><span class="pre">world_size</span></code> but
different <code class="code docutils literal notranslate"><span class="pre">rank</span></code> (process id).</p></li>
<li><p><strong>test_ckpt_dir</strong> (<em>str</em>) – Specify the checkpoint path for testing. If not, use checkpoints specified by
<code class="code docutils literal notranslate"><span class="pre">test_ckpts_steps</span></code>.</p></li>
<li><p><strong>test_ckpt_steps</strong> (<em>List</em><em>[</em><em>int</em><em>]</em>) – After training, multiple steps of checkpoints are saved. This option specifies
which checkpoints (multiple) will be used for evaluation.</p></li>
<li><p><strong>**kwds</strong> – The other arguments like <code class="code docutils literal notranslate"><span class="pre">prepare_data</span></code> and <code class="code docutils literal notranslate"><span class="pre">build_model</span></code> are
method specific-arguments for methods like <a class="reference internal" href="#s3prl.problem.SuperbASV.prepare_data" title="s3prl.problem.SuperbASV.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> and
<a class="reference internal" href="#s3prl.problem.SuperbASV.build_model" title="s3prl.problem.SuperbASV.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>, and will not be used in the core <a class="reference internal" href="#s3prl.problem.SuperbASV.run" title="s3prl.problem.SuperbASV.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> logic.
See the specific method documentation for their supported arguments and
meaning</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASV.save_model">
<span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L709-L750"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASV.save_model" title="Permalink to this definition">#</a></dt>
<dd><p>Save the model state_dict and the model initialization arguments into the given directory.
If you override this method, it is highly possible you also need to override <a class="reference internal" href="#s3prl.problem.SuperbASV.load_model" title="s3prl.problem.SuperbASV.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbASV.default_config" title="s3prl.problem.SuperbASV.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_model</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>model_ckpt_dir</strong> (<em>str</em>) – save the model into the this directory.</p></li>
<li><p><strong>build_model_all_args</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.SuperbASV.build_model" title="s3prl.problem.SuperbASV.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>.
By saving this dictionary, you can easily reconstruct the same model
by calling <a class="reference internal" href="#s3prl.problem.SuperbASV.build_model" title="s3prl.problem.SuperbASV.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASV.save_task">
<span class="sig-name descname"><span class="pre">save_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="s3prl.task.base.html#s3prl.task.base.Task" title="s3prl.task.base.Task"><span class="pre">Task</span></a></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L774-L831"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASV.save_task" title="Permalink to this definition">#</a></dt>
<dd><p>Save the task’s state, <code class="code docutils literal notranslate"><span class="pre">task.get_state()</span></code>, and the initialization arguments into the given
directory. If you override this method, it is highly possible you also need to override
<a class="reference internal" href="#s3prl.problem.SuperbASV.load_task" title="s3prl.problem.SuperbASV.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbASV.default_config" title="s3prl.problem.SuperbASV.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_task</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – save the task into this directory.</p></li>
<li><p><strong>build_task_all_args_except_model</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.SuperbASV.build_task" title="s3prl.problem.SuperbASV.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> except
the <code class="code docutils literal notranslate"><span class="pre">model</span></code> argument since the model should be sapartely saved by
<a class="reference internal" href="#s3prl.problem.SuperbASV.save_model" title="s3prl.problem.SuperbASV.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a>. By saving this dictionary, you can easily reconstruct the same task
by calling <a class="reference internal" href="#s3prl.problem.SuperbASV.build_task" title="s3prl.problem.SuperbASV.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>task</strong> (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><em>Task</em></a>) – the task to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbASV.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L287-L658"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbASV.train" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbASV.default_config" title="s3prl.problem.SuperbASV.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>total_steps</p></td>
<td><p>(int) - the total optimization steps</p></td>
</tr>
<tr class="row-odd"><td><p>log_step</p></td>
<td><p>(int) - logging frequency. log every <code class="code docutils literal notranslate"><span class="pre">log_step</span></code> step</p></td>
</tr>
<tr class="row-even"><td><p>eval_step</p></td>
<td><p>(int) - evaluation frequency. Evaluate every <code class="code docutils literal notranslate"><span class="pre">eval_step</span></code> step.                                                 Note that you can control how many batch to evaluate to speed up the                                                 development by the <code class="code docutils literal notranslate"><span class="pre">eval_batch</span></code> argument in <a class="reference internal" href="#s3prl.problem.SuperbASV.run" title="s3prl.problem.SuperbASV.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>save_step</p></td>
<td><p>(int) - save the checkpoint every <code class="code docutils literal notranslate"><span class="pre">save_step</span></code> step.</p></td>
</tr>
<tr class="row-even"><td><p>gradient_clipping</p></td>
<td><p>(float) - clip the gradient. important for RNNs.</p></td>
</tr>
<tr class="row-odd"><td><p>gradient_accumulate</p></td>
<td><p>(int) - accumulate multiple steps’ gradient before updating network parameters                                                 to simulate large-batch optimization.</p></td>
</tr>
<tr class="row-even"><td><p>valid_metric</p></td>
<td><p>(str) - the metric to select the best valid checkpoint. Different Tasks have different                                                 supported valid_metrics. See <a class="reference internal" href="#s3prl.problem.SuperbASV.build_task" title="s3prl.problem.SuperbASV.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> for the supported metrics.</p></td>
</tr>
<tr class="row-odd"><td><p>valid_higher_better</p></td>
<td><p>(bool) - some metrics are higher better, while some are lower better                                                 this will affect how to save the best validation checkpoint.</p></td>
</tr>
<tr class="row-even"><td><p>auto_resume</p></td>
<td><p>(bool) - if there are already the last checkpoint in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.SuperbASV.run" title="s3prl.problem.SuperbASV.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>),                                                 whether to resume from it or delete it and start a new training session.</p></td>
</tr>
<tr class="row-odd"><td><p>resume_ckpt_dir</p></td>
<td><p>(str) - you can directly specify the checkpoint path to resume which is not necessary                                                 in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.SuperbASV.run" title="s3prl.problem.SuperbASV.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>).</p></td>
</tr>
<tr class="row-even"><td><p>seed</p></td>
<td><p>(int) - fix the seed before the training start</p></td>
</tr>
<tr class="row-odd"><td><p>keep_num_ckpts</p></td>
<td><p>(int) - to prevent saving too many checkpoints, only save the <code class="code docutils literal notranslate"><span class="pre">keep_num_ckpts</span></code>                                                 latest checkpoints and delete the old ones.</p></td>
</tr>
<tr class="row-even"><td><p>use_scheduler</p></td>
<td><p>(bool) - whether to use the scheduler</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="superber">
<h2>SuperbER<a class="headerlink" href="#superber" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="s3prl.problem.SuperbER">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">s3prl.problem.</span></span><span class="sig-name descname"><span class="pre">SuperbER</span></span><a class="reference internal" href="../_modules/s3prl/problem/common/superb_er.html#SuperbER"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/superb_er.py#L148-L256"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbER" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="s3prl.problem.common.superb_sid.html#s3prl.problem.common.superb_sid.SuperbSID" title="s3prl.problem.common.superb_sid.SuperbSID"><code class="xref py py-class docutils literal notranslate"><span class="pre">SuperbSID</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbER.default_config">
<span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/s3prl/problem/common/superb_er.html#SuperbER.default_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/superb_er.py#L149-L213"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbER.default_config" title="Permalink to this definition">#</a></dt>
<dd><p>The default arguments for <a class="reference internal" href="#s3prl.problem.SuperbER.run" title="s3prl.problem.SuperbER.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> in yaml.
Note that for the fields with inner values, like <code class="code docutils literal notranslate"><span class="pre">build_model</span></code>,
the outer field name corresponds to a method name, so you can find the method
<a class="reference internal" href="#s3prl.problem.SuperbER.build_model" title="s3prl.problem.SuperbER.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>. Furthermore, the values inside that field will be
directly passed into the method. So by changing these inner values, you
can directly affect the behavior of the corresponding method. See the method
documentation for all the supported arguments and their meanings.</p>
<p>The methods affected by the following config are: <a class="reference internal" href="#s3prl.problem.SuperbER.prepare_data" title="s3prl.problem.SuperbER.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbER.build_encoder" title="s3prl.problem.SuperbER.build_encoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_encoder</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbER.build_dataset" title="s3prl.problem.SuperbER.build_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_dataset</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbER.build_batch_sampler" title="s3prl.problem.SuperbER.build_batch_sampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_batch_sampler</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbER.build_upstream" title="s3prl.problem.SuperbER.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbER.build_featurizer" title="s3prl.problem.SuperbER.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbER.build_downstream" title="s3prl.problem.SuperbER.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbER.build_model" title="s3prl.problem.SuperbER.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbER.build_task" title="s3prl.problem.SuperbER.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbER.build_optimizer" title="s3prl.problem.SuperbER.build_optimizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_optimizer</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbER.build_scheduler" title="s3prl.problem.SuperbER.build_scheduler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_scheduler</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbER.save_model" title="s3prl.problem.SuperbER.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbER.save_task" title="s3prl.problem.SuperbER.save_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_task</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbER.train" title="s3prl.problem.SuperbER.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbER.evaluate" title="s3prl.problem.SuperbER.evaluate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate</span></code></a></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">start</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="nt">stop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">target_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">cache_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">remove_all_cache</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">prepare_data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">iemocap</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="w">  </span><span class="nt">test_fold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">build_encoder</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">build_dataset</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">build_batch_sampler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">train</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span>
<span class="w">    </span><span class="nt">shuffle</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">valid</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span>
<span class="w">  </span><span class="nt">test</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span>
<span class="nt">build_upstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">build_featurizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">layer_selections</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="nt">normalize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_downstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">hidden_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">256</span>
<span class="nt">build_model</span><span class="p">:</span>
<span class="w">  </span><span class="nt">upstream_trainable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_task</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">build_optimizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Adam</span>
<span class="w">  </span><span class="nt">conf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">lr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0001</span>
<span class="nt">build_scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ExponentialLR</span>
<span class="w">  </span><span class="nt">gamma</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.9</span>
<span class="nt">save_model</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">save_task</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">train</span><span class="p">:</span>
<span class="w">  </span><span class="nt">total_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30000</span>
<span class="w">  </span><span class="nt">log_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">500</span>
<span class="w">  </span><span class="nt">eval_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span>
<span class="w">  </span><span class="nt">save_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span>
<span class="w">  </span><span class="nt">gradient_clipping</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0</span>
<span class="w">  </span><span class="nt">gradient_accumulate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8</span>
<span class="w">  </span><span class="nt">valid_metric</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">accuracy</span>
<span class="w">  </span><span class="nt">valid_higher_better</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">auto_resume</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">resume_ckpt_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">evaluate</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbER.prepare_data">
<span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/common/superb_er.html#SuperbER.prepare_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/superb_er.py#L215-L256"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbER.prepare_data" title="Permalink to this definition">#</a></dt>
<dd><p>Prepare the task-specific data metadata (path, labels…).
By default call <code class="xref py py-obj docutils literal notranslate"><span class="pre">iemocap_for_superb</span></code> with <code class="code docutils literal notranslate"><span class="pre">**prepare_data</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prepare_data</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbER.default_config" title="s3prl.problem.SuperbER.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
support arguments in <code class="xref py py-obj docutils literal notranslate"><span class="pre">iemocap_for_superb</span></code></p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Parse your corpus and save the csv file into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the parsing or preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>train_path (str)</p></li>
<li><p>valid_path (str)</p></li>
<li><p>test_paths (List[str])</p></li>
</ol>
<p>Each path (str) should be a csv file containing the following columns:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>column</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>(str) - the unique id for this data point</p></td>
</tr>
<tr class="row-odd"><td><p>wav_path</p></td>
<td><p>(str) - the absolute path of the waveform file</p></td>
</tr>
<tr class="row-even"><td><p>label</p></td>
<td><p>(str) - a string label of the waveform</p></td>
</tr>
<tr class="row-odd"><td><p>start_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">start_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load from the beginning.</p></td>
</tr>
<tr class="row-even"><td><p>end_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">end_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load to the end.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbER.build_batch_sampler">
<span class="sig-name descname"><span class="pre">build_batch_sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/superb_sid.py#L360-L411"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbER.build_batch_sampler" title="Permalink to this definition">#</a></dt>
<dd><p>Return the batch sampler for torch DataLoader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_batch_sampler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbER.default_config" title="s3prl.problem.SuperbER.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>train</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>valid</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-even"><td><p>test</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">mode</span></code> specific csv from <a class="reference internal" href="#s3prl.problem.SuperbER.prepare_data" title="s3prl.problem.SuperbER.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>dataset</strong> – the dataset from <a class="reference internal" href="#s3prl.problem.SuperbER.build_dataset" title="s3prl.problem.SuperbER.build_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_dataset</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>batch sampler for torch DataLoader</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbER.build_collate_fn">
<span class="sig-name descname"><span class="pre">build_collate_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L143-L156"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbER.build_collate_fn" title="Permalink to this definition">#</a></dt>
<dd><p>By default returns <code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataset.base.default_collate_fn</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_collate_fn</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbER.default_config" title="s3prl.problem.SuperbER.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train, valid, or test</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>callable</p>
<p>the collate_fn for torch DataLoader in train/valid/test <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbER.build_dataset">
<span class="sig-name descname"><span class="pre">build_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_shift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/superb_sid.py#L244-L358"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbER.build_dataset" title="Permalink to this definition">#</a></dt>
<dd><p>Build the dataset for train/valid/test.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_dataset</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbER.default_config" title="s3prl.problem.SuperbER.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>. with <code class="code docutils literal notranslate"><span class="pre">train</span></code>, <code class="code docutils literal notranslate"><span class="pre">valid</span></code>, <code class="code docutils literal notranslate"><span class="pre">test</span></code> keys, each
is a dictionary with the following supported options:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>max_secs</p></td>
<td><p>(float) - If a waveform is longer than <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds, randomly crop the waveform into <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds</p></td>
</tr>
<tr class="row-odd"><td><p>sox_effects</p></td>
<td><p>(List[List[str]]) - If not None, apply sox effects on the utterance</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – The metadata csv file for the specific <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p></li>
<li><p><strong>encoder_path</strong> (<em>str</em>) – The pickled encoder path for encoding the labels</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch Dataset</p>
<p>For all train/valid/test mode, the dataset should return each item as a dictionary
containing the following keys:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>x</p></td>
<td><p>(torch.FloatTensor) - the waveform in (seq_len, 1)</p></td>
</tr>
<tr class="row-odd"><td><p>x_len</p></td>
<td><p>(int) - the waveform length <code class="code docutils literal notranslate"><span class="pre">seq_len</span></code></p></td>
</tr>
<tr class="row-even"><td><p>class_id</p></td>
<td><p>(int) - the encoded class id</p></td>
</tr>
<tr class="row-odd"><td><p>label</p></td>
<td><p>(str) - the class name</p></td>
</tr>
<tr class="row-even"><td><p>unique_name</p></td>
<td><p>(str) - the unique id for this datapoint</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbER.build_downstream">
<span class="sig-name descname"><span class="pre">build_downstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/superb_sid.py#L413-L436"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbER.build_downstream" title="Permalink to this definition">#</a></dt>
<dd><p>Return the task-specific downstream model.
By default build the <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code> model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbER.default_config" title="s3prl.problem.SuperbER.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments of <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code></p></li>
<li><p><strong>downstream_input_size</strong> (<em>int</em>) – the required input size of the model</p></li>
<li><p><strong>downstream_output_size</strong> (<em>int</em>) – the required output size of the model</p></li>
<li><p><strong>downstream_input_stride</strong> (<em>int</em>) – the input feature’s stride (from 16 KHz)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUtteranceModel" title="s3prl.nn.interface.AbsUtteranceModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUtteranceModel</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbER.build_encoder">
<span class="sig-name descname"><span class="pre">build_encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_csv_paths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/superb_sid.py#L198-L242"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbER.build_encoder" title="Permalink to this definition">#</a></dt>
<dd><p>Build the encoder (for the labels) given the data metadata, and return the saved encoder path.
By default generate and save a <a class="reference internal" href="s3prl.dataio.encoder.html#s3prl.dataio.encoder.CategoryEncoder" title="s3prl.dataio.encoder.CategoryEncoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataio.encoder.CategoryEncoder</span></code></a> from the <code class="code docutils literal notranslate"><span class="pre">label</span></code> column of all the csv files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_encoder</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbER.default_config" title="s3prl.problem.SuperbER.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Save your encoder into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>train_csv_path</strong> (<em>str</em>) – the train path from <a class="reference internal" href="#s3prl.problem.SuperbER.prepare_data" title="s3prl.problem.SuperbER.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>valid_csv_path</strong> (<em>str</em>) – the valid path from <a class="reference internal" href="#s3prl.problem.SuperbER.prepare_data" title="s3prl.problem.SuperbER.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>test_csv_paths</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – the test paths from <a class="reference internal" href="#s3prl.problem.SuperbER.prepare_data" title="s3prl.problem.SuperbER.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>str</p>
<p>encoder_path: The encoder should be saved in the pickle format</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbER.build_featurizer">
<span class="sig-name descname"><span class="pre">build_featurizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upstream</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L175-L192"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbER.build_featurizer" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the featurizer with <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbER.default_config" title="s3prl.problem.SuperbER.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p></li>
<li><p><strong>upstream</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">AbsUpstream</span></code>) – the upstream model built by <a class="reference internal" href="#s3prl.problem.SuperbER.build_upstream" title="s3prl.problem.SuperbER.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsFeaturizer" title="s3prl.nn.interface.AbsFeaturizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsFeaturizer</span></code></a></p>
<p>Return the featurizer model. The featurizer is used to reduce the multiple
hidden states returned from the upstream model (built by <a class="reference internal" href="#s3prl.problem.SuperbER.build_upstream" title="s3prl.problem.SuperbER.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>)
into a single hidden state, so can be easliy fed into the downstream model</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbER.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L194-L231"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbER.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>By default build model with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbER.default_config" title="s3prl.problem.SuperbER.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p></li>
<li><p><strong>model_output_size</strong> (<em>int</em>) – the required model’s output hidden size</p></li>
<li><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbER.default_config" title="s3prl.problem.SuperbER.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.SuperbER.build_upstream" title="s3prl.problem.SuperbER.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbER.default_config" title="s3prl.problem.SuperbER.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.SuperbER.build_featurizer" title="s3prl.problem.SuperbER.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a></p></li>
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbER.default_config" title="s3prl.problem.SuperbER.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.SuperbER.build_downstream" title="s3prl.problem.SuperbER.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch.nn.Module</p>
<p>Return the entire model for the task, which takes the direct items from DataLoader as the input.
Usually, the components can be built by <a class="reference internal" href="#s3prl.problem.SuperbER.build_upstream" title="s3prl.problem.SuperbER.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>, <a class="reference internal" href="#s3prl.problem.SuperbER.build_featurizer" title="s3prl.problem.SuperbER.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a>,
<a class="reference internal" href="#s3prl.problem.SuperbER.build_downstream" title="s3prl.problem.SuperbER.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a>, and are concated together to get the final model.
The upstream extracts multiple hidden states, the featuizer reduce them into a single hidden state,
and the downstream takes the hidden states as the feature for the downstream-specific model.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbER.build_optimizer">
<span class="sig-name descname"><span class="pre">build_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L233-L258"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbER.build_optimizer" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_optimizer</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbER.default_config" title="s3prl.problem.SuperbER.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to below</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the optimizer class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the optimizer class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;lr&quot;:</span> <span class="pre">1.0e-4}</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>parameters</strong> (<em>iterable</em>) – the standard params accepted by <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code></p>
<p>An optimizer following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbER.build_scheduler">
<span class="sig-name descname"><span class="pre">build_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L260-L285"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbER.build_scheduler" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_scheduler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbER.default_config" title="s3prl.problem.SuperbER.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the scheduler class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the scheduler class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;gamma&quot;:</span> <span class="pre">0.01}</span></code> for <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler.StepLR</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>optimizer</strong> – the standard torch optimizer accepted by Scheduler in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch scheduler</p>
<p>A scheduler following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbER.build_task">
<span class="sig-name descname"><span class="pre">build_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/run.py#L352-L375"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbER.build_task" title="Permalink to this definition">#</a></dt>
<dd><p>Build the task, which defines the logics for every train/valid/test forward step for the <code class="code docutils literal notranslate"><span class="pre">model</span></code>,
and the logics for how to reduce all the batch results from multiple train/valid/test steps into metrics</p>
<p>By default build <code class="xref py py-obj docutils literal notranslate"><span class="pre">UtteranceClassificationTask</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbER.default_config" title="s3prl.problem.SuperbER.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model built by <a class="reference internal" href="#s3prl.problem.SuperbER.build_model" title="s3prl.problem.SuperbER.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a></p></li>
<li><p><strong>encoder</strong> – the encoder built by <a class="reference internal" href="#s3prl.problem.SuperbER.build_encoder" title="s3prl.problem.SuperbER.build_encoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_encoder</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Task</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbER.build_upstream">
<span class="sig-name descname"><span class="pre">build_upstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L158-L173"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbER.build_upstream" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the upstream with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbER.default_config" title="s3prl.problem.SuperbER.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUpstream" title="s3prl.nn.interface.AbsUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUpstream</span></code></a></p>
<p>Return an upstream model, whose forward takes the waveform input and returns
multiple hidden states as features.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbER.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L660-L707"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbER.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>The evaluate routine used by <a class="reference internal" href="#s3prl.problem.SuperbER.train" title="s3prl.problem.SuperbER.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> (during validation phase) and <a class="reference internal" href="#s3prl.problem.SuperbER.run" title="s3prl.problem.SuperbER.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>
(during testing phase).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evaluate</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbER.default_config" title="s3prl.problem.SuperbER.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbER.get_class_from_name">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_class_from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L129-L141"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbER.get_class_from_name" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">__name__</span></code> of the problem class</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Problem</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbER.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L752-L772"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbER.load_model" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model_ckpt_dir</strong> (<em>str</em>) – Restore the model with <a class="reference internal" href="#s3prl.problem.SuperbER.build_model" title="s3prl.problem.SuperbER.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> and the checkpoint
saved in this directory.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbER.load_model_and_task">
<span class="sig-name descname"><span class="pre">load_model_and_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ckpts_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L884-L902"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbER.load_model_and_task" title="Permalink to this definition">#</a></dt>
<dd><p>This is a helper method to combine <a class="reference internal" href="#s3prl.problem.SuperbER.load_model" title="s3prl.problem.SuperbER.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a> and <a class="reference internal" href="#s3prl.problem.SuperbER.load_task" title="s3prl.problem.SuperbER.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>
together to directly load the model and the task. This method assumes
the model is saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'model'</span></code> and the task is
saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'task'</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>model (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>)</p></li>
<li><p>task (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a>)</p></li>
</ol>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbER.load_task">
<span class="sig-name descname"><span class="pre">load_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L833-L882"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbER.load_task" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – Restore the task with <a class="reference internal" href="#s3prl.problem.SuperbER.build_task" title="s3prl.problem.SuperbER.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> and the checkpoint
saved in this directory.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model for the task, since the model is separately saved
and is required for <a class="reference internal" href="#s3prl.problem.SuperbER.build_task" title="s3prl.problem.SuperbER.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a>.</p></li>
<li><p><strong>task_overrides</strong> (<em>dict</em>) – overrides the saved initialization arguments, so can change
the loaded task’s behavior. Like, change the decoding hyperparameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbER.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L954-L995"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbER.main" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbER.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_all_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cuda'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/run.py#L26-L318"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbER.run" title="Permalink to this definition">#</a></dt>
<dd><div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>stage</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Parse the corpus and save the metadata file (waveform path, label…)</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Build the encoder to encode the labels</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Train the model</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Evaluate the model on multiple test sets</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_dir</strong> (<em>str</em>) – The directory that stores the script result.</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – The directory that caches the processed data.
Default: /home/user/.cache/s3prl/data</p></li>
<li><p><strong>remove_all_cache</strong> (<em>bool</em>) – Whether to remove all the cache stored under <cite>cache_dir</cite>.
Default: False</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting stage of the problem script.
Default: 0</p></li>
<li><p><strong>stop</strong> (<em>int</em>) – The stoping stage of the problem script, set <cite>None</cite> to reach the final stage.
Default: None</p></li>
<li><p><strong>num_workers</strong> (<em>int</em>) – num_workers for all the torch DataLoder</p></li>
<li><p><strong>eval_batch</strong> (<em>int</em>) – During evaluation (valid or test), limit the number of batch.
This is helpful for the fast development to check everything won’t crash.
If is -1, disable this feature and evaluate the entire epoch.
Default: -1</p></li>
<li><p><strong>device</strong> (<em>str</em>) – The device type for all torch-related operation: “cpu” or “cuda”
Default: “cuda”</p></li>
<li><p><strong>world_size</strong> (<em>int</em>) – How many processes are running this script simultaneously (in parallel).
Usually this is just 1, however if you are runnig distributed training,
this should be &gt; 1.
Default: 1</p></li>
<li><p><strong>rank</strong> (<em>int</em>) – When distributed training, world_size &gt; 1. Take <code class="code docutils literal notranslate"><span class="pre">world_size</span> <span class="pre">==</span> <span class="pre">8</span></code> for
example, this means 8 processes (8 GPUs) are runing in parallel. The script
needs to know which process among 8 processes it is. In this case, <code class="code docutils literal notranslate"><span class="pre">rank</span></code>
can range from 0~7. All the 8 processes have the same <code class="code docutils literal notranslate"><span class="pre">world_size</span></code> but
different <code class="code docutils literal notranslate"><span class="pre">rank</span></code> (process id).</p></li>
<li><p><strong>test_ckpt_dir</strong> (<em>str</em>) – Specify the checkpoint path for testing. If not, use the validation best
checkpoint under the given <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> directory.</p></li>
<li><p><strong>**kwds</strong> – The other arguments like <code class="code docutils literal notranslate"><span class="pre">prepare_data</span></code> and <code class="code docutils literal notranslate"><span class="pre">build_model</span></code> are
method specific-arguments for methods like <a class="reference internal" href="#s3prl.problem.SuperbER.prepare_data" title="s3prl.problem.SuperbER.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> and
<a class="reference internal" href="#s3prl.problem.SuperbER.build_model" title="s3prl.problem.SuperbER.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>, and will not be used in the core <a class="reference internal" href="#s3prl.problem.SuperbER.run" title="s3prl.problem.SuperbER.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> logic.
See the specific method documentation for their supported arguments and
meaning</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbER.save_model">
<span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L709-L750"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbER.save_model" title="Permalink to this definition">#</a></dt>
<dd><p>Save the model state_dict and the model initialization arguments into the given directory.
If you override this method, it is highly possible you also need to override <a class="reference internal" href="#s3prl.problem.SuperbER.load_model" title="s3prl.problem.SuperbER.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbER.default_config" title="s3prl.problem.SuperbER.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_model</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>model_ckpt_dir</strong> (<em>str</em>) – save the model into the this directory.</p></li>
<li><p><strong>build_model_all_args</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.SuperbER.build_model" title="s3prl.problem.SuperbER.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>.
By saving this dictionary, you can easily reconstruct the same model
by calling <a class="reference internal" href="#s3prl.problem.SuperbER.build_model" title="s3prl.problem.SuperbER.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbER.save_task">
<span class="sig-name descname"><span class="pre">save_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="s3prl.task.base.html#s3prl.task.base.Task" title="s3prl.task.base.Task"><span class="pre">Task</span></a></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L774-L831"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbER.save_task" title="Permalink to this definition">#</a></dt>
<dd><p>Save the task’s state, <code class="code docutils literal notranslate"><span class="pre">task.get_state()</span></code>, and the initialization arguments into the given
directory. If you override this method, it is highly possible you also need to override
<a class="reference internal" href="#s3prl.problem.SuperbER.load_task" title="s3prl.problem.SuperbER.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbER.default_config" title="s3prl.problem.SuperbER.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_task</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – save the task into this directory.</p></li>
<li><p><strong>build_task_all_args_except_model</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.SuperbER.build_task" title="s3prl.problem.SuperbER.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> except
the <code class="code docutils literal notranslate"><span class="pre">model</span></code> argument since the model should be sapartely saved by
<a class="reference internal" href="#s3prl.problem.SuperbER.save_model" title="s3prl.problem.SuperbER.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a>. By saving this dictionary, you can easily reconstruct the same task
by calling <a class="reference internal" href="#s3prl.problem.SuperbER.build_task" title="s3prl.problem.SuperbER.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>task</strong> (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><em>Task</em></a>) – the task to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbER.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L287-L658"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbER.train" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbER.default_config" title="s3prl.problem.SuperbER.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>total_steps</p></td>
<td><p>(int) - the total optimization steps</p></td>
</tr>
<tr class="row-odd"><td><p>log_step</p></td>
<td><p>(int) - logging frequency. log every <code class="code docutils literal notranslate"><span class="pre">log_step</span></code> step</p></td>
</tr>
<tr class="row-even"><td><p>eval_step</p></td>
<td><p>(int) - evaluation frequency. Evaluate every <code class="code docutils literal notranslate"><span class="pre">eval_step</span></code> step.                                                 Note that you can control how many batch to evaluate to speed up the                                                 development by the <code class="code docutils literal notranslate"><span class="pre">eval_batch</span></code> argument in <a class="reference internal" href="#s3prl.problem.SuperbER.run" title="s3prl.problem.SuperbER.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>save_step</p></td>
<td><p>(int) - save the checkpoint every <code class="code docutils literal notranslate"><span class="pre">save_step</span></code> step.</p></td>
</tr>
<tr class="row-even"><td><p>gradient_clipping</p></td>
<td><p>(float) - clip the gradient. important for RNNs.</p></td>
</tr>
<tr class="row-odd"><td><p>gradient_accumulate</p></td>
<td><p>(int) - accumulate multiple steps’ gradient before updating network parameters                                                 to simulate large-batch optimization.</p></td>
</tr>
<tr class="row-even"><td><p>valid_metric</p></td>
<td><p>(str) - the metric to select the best valid checkpoint. Different Tasks have different                                                 supported valid_metrics. See <a class="reference internal" href="#s3prl.problem.SuperbER.build_task" title="s3prl.problem.SuperbER.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> for the supported metrics.</p></td>
</tr>
<tr class="row-odd"><td><p>valid_higher_better</p></td>
<td><p>(bool) - some metrics are higher better, while some are lower better                                                 this will affect how to save the best validation checkpoint.</p></td>
</tr>
<tr class="row-even"><td><p>auto_resume</p></td>
<td><p>(bool) - if there are already the last checkpoint in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.SuperbER.run" title="s3prl.problem.SuperbER.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>),                                                 whether to resume from it or delete it and start a new training session.</p></td>
</tr>
<tr class="row-odd"><td><p>resume_ckpt_dir</p></td>
<td><p>(str) - you can directly specify the checkpoint path to resume which is not necessary                                                 in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.SuperbER.run" title="s3prl.problem.SuperbER.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>).</p></td>
</tr>
<tr class="row-even"><td><p>seed</p></td>
<td><p>(int) - fix the seed before the training start</p></td>
</tr>
<tr class="row-odd"><td><p>keep_num_ckpts</p></td>
<td><p>(int) - to prevent saving too many checkpoints, only save the <code class="code docutils literal notranslate"><span class="pre">keep_num_ckpts</span></code>                                                 latest checkpoints and delete the old ones.</p></td>
</tr>
<tr class="row-even"><td><p>use_scheduler</p></td>
<td><p>(bool) - whether to use the scheduler</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="superbic">
<h2>SuperbIC<a class="headerlink" href="#superbic" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="s3prl.problem.SuperbIC">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">s3prl.problem.</span></span><span class="sig-name descname"><span class="pre">SuperbIC</span></span><a class="reference internal" href="../_modules/s3prl/problem/common/superb_ic.html#SuperbIC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/superb_ic.py#L98-L429"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbIC" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="s3prl.problem.common.run.html#s3prl.problem.common.run.Common" title="s3prl.problem.common.run.Common"><code class="xref py py-class docutils literal notranslate"><span class="pre">Common</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbIC.default_config">
<span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/s3prl/problem/common/superb_ic.html#SuperbIC.default_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/superb_ic.py#L99-L161"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbIC.default_config" title="Permalink to this definition">#</a></dt>
<dd><p>The default arguments for <a class="reference internal" href="#s3prl.problem.SuperbIC.run" title="s3prl.problem.SuperbIC.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> in yaml.
Note that for the fields with inner values, like <code class="code docutils literal notranslate"><span class="pre">build_model</span></code>,
the outer field name corresponds to a method name, so you can find the method
<a class="reference internal" href="#s3prl.problem.SuperbIC.build_model" title="s3prl.problem.SuperbIC.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>. Furthermore, the values inside that field will be
directly passed into the method. So by changing these inner values, you
can directly affect the behavior of the corresponding method. See the method
documentation for all the supported arguments and their meanings.</p>
<p>The methods affected by the following config are: <a class="reference internal" href="#s3prl.problem.SuperbIC.prepare_data" title="s3prl.problem.SuperbIC.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbIC.build_encoder" title="s3prl.problem.SuperbIC.build_encoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_encoder</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbIC.build_dataset" title="s3prl.problem.SuperbIC.build_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_dataset</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbIC.build_batch_sampler" title="s3prl.problem.SuperbIC.build_batch_sampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_batch_sampler</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbIC.build_upstream" title="s3prl.problem.SuperbIC.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbIC.build_featurizer" title="s3prl.problem.SuperbIC.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbIC.build_downstream" title="s3prl.problem.SuperbIC.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbIC.build_model" title="s3prl.problem.SuperbIC.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbIC.build_task" title="s3prl.problem.SuperbIC.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbIC.build_optimizer" title="s3prl.problem.SuperbIC.build_optimizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_optimizer</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbIC.build_scheduler" title="s3prl.problem.SuperbIC.build_scheduler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_scheduler</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbIC.save_model" title="s3prl.problem.SuperbIC.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbIC.save_task" title="s3prl.problem.SuperbIC.save_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_task</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbIC.train" title="s3prl.problem.SuperbIC.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">start</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="nt">stop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">target_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">cache_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">remove_all_cache</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">prepare_data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">dataset_root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">build_encoder</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">build_dataset</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">build_batch_sampler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">train</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">32</span>
<span class="w">    </span><span class="nt">shuffle</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">valid</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">32</span>
<span class="w">  </span><span class="nt">test</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">32</span>
<span class="nt">build_upstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">build_featurizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">layer_selections</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="nt">normalize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_downstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">hidden_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">256</span>
<span class="nt">build_model</span><span class="p">:</span>
<span class="w">  </span><span class="nt">upstream_trainable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_task</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">build_optimizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Adam</span>
<span class="w">  </span><span class="nt">conf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">lr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0001</span>
<span class="nt">build_scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ExponentialLR</span>
<span class="w">  </span><span class="nt">gamma</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.9</span>
<span class="nt">save_model</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">save_task</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">train</span><span class="p">:</span>
<span class="w">  </span><span class="nt">total_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">200000</span>
<span class="w">  </span><span class="nt">log_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">  </span><span class="nt">eval_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5000</span>
<span class="w">  </span><span class="nt">save_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">250</span>
<span class="w">  </span><span class="nt">gradient_clipping</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0</span>
<span class="w">  </span><span class="nt">gradient_accumulate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">valid_metric</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">accuracy</span>
<span class="w">  </span><span class="nt">valid_higher_better</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">auto_resume</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">resume_ckpt_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbIC.prepare_data">
<span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/common/superb_ic.html#SuperbIC.prepare_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/superb_ic.py#L163-L204"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbIC.prepare_data" title="Permalink to this definition">#</a></dt>
<dd><p>Prepare the task-specific data metadata (path, labels…).
By default call <code class="xref py py-obj docutils literal notranslate"><span class="pre">fsc_for_multi_classification</span></code> with <code class="code docutils literal notranslate"><span class="pre">**prepare_data</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prepare_data</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbIC.default_config" title="s3prl.problem.SuperbIC.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">fsc_for_multi_classification</span></code></p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Parse your corpus and save the csv file into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the parsing or preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>train_path (str)</p></li>
<li><p>valid_path (str)</p></li>
<li><p>test_paths (List[str])</p></li>
</ol>
<p>Each path (str) should be a csv file containing the following columns:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>column</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>(str) - the unique id for this data point</p></td>
</tr>
<tr class="row-odd"><td><p>wav_path</p></td>
<td><p>(str) - the absolute path of the waveform file</p></td>
</tr>
<tr class="row-even"><td><p>labels</p></td>
<td><p>(str) - the string labels of the waveform, separated by a ‘;’</p></td>
</tr>
</tbody>
</table>
</div>
<p>The number of the label columns can be arbitrary.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbIC.build_encoder">
<span class="sig-name descname"><span class="pre">build_encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_csv_paths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/common/superb_ic.html#SuperbIC.build_encoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/superb_ic.py#L206-L256"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbIC.build_encoder" title="Permalink to this definition">#</a></dt>
<dd><p>Build the encoder (for the labels) given the data metadata, and return the saved encoder path.
By default generate and save a <a class="reference internal" href="s3prl.dataio.encoder.html#s3prl.dataio.encoder.CategoryEncoders" title="s3prl.dataio.encoder.CategoryEncoders"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataio.encoder.CategoryEncoders</span></code></a> from all the columns
prefixing <code class="code docutils literal notranslate"><span class="pre">label</span></code> from all the csv files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_encoder</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbIC.default_config" title="s3prl.problem.SuperbIC.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Save your encoder into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>train_csv_path</strong> (<em>str</em>) – the train path from <a class="reference internal" href="#s3prl.problem.SuperbIC.prepare_data" title="s3prl.problem.SuperbIC.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>valid_csv_path</strong> (<em>str</em>) – the valid path from <a class="reference internal" href="#s3prl.problem.SuperbIC.prepare_data" title="s3prl.problem.SuperbIC.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>test_csv_paths</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – the test paths from <a class="reference internal" href="#s3prl.problem.SuperbIC.prepare_data" title="s3prl.problem.SuperbIC.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>get_path_only</strong> (<em>bool</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>str</p>
<p>tokenizer_path: The tokenizer should be saved in the pickle format</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbIC.build_dataset">
<span class="sig-name descname"><span class="pre">build_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_shift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/common/superb_ic.html#SuperbIC.build_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/superb_ic.py#L258-L329"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbIC.build_dataset" title="Permalink to this definition">#</a></dt>
<dd><p>Build the dataset for train/valid/test.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_dataset</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbIC.default_config" title="s3prl.problem.SuperbIC.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – The metadata csv file for the specific <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p></li>
<li><p><strong>encoder_path</strong> (<em>str</em>) – The pickled encoder path for encoding the labels</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch Dataset</p>
<p>For all train/valid/test mode, the dataset should return each item as a dictionary
containing the following keys:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>x</p></td>
<td><p>(torch.FloatTensor) - the waveform in (seq_len, 1)</p></td>
</tr>
<tr class="row-odd"><td><p>x_len</p></td>
<td><p>(int) - the waveform length <code class="code docutils literal notranslate"><span class="pre">seq_len</span></code></p></td>
</tr>
<tr class="row-even"><td><p>class_ids</p></td>
<td><p>(torch.LongTensor) - the encoded class ids. shape: (num_class, )</p></td>
</tr>
<tr class="row-odd"><td><p>labels</p></td>
<td><p>(List[str]) - the class name. length: num_class</p></td>
</tr>
<tr class="row-even"><td><p>unique_name</p></td>
<td><p>(str) - the unique id for this datapoint</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbIC.build_batch_sampler">
<span class="sig-name descname"><span class="pre">build_batch_sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/common/superb_ic.html#SuperbIC.build_batch_sampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/superb_ic.py#L331-L377"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbIC.build_batch_sampler" title="Permalink to this definition">#</a></dt>
<dd><p>Return the batch sampler for torch DataLoader.
By default call <code class="xref py py-obj docutils literal notranslate"><span class="pre">superb_sid_batch_sampler</span></code> with <code class="code docutils literal notranslate"><span class="pre">**build_batch_sampler</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_batch_sampler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbIC.default_config" title="s3prl.problem.SuperbIC.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>train</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>valid</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-even"><td><p>test</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">mode</span></code> specific csv from <a class="reference internal" href="#s3prl.problem.SuperbIC.prepare_data" title="s3prl.problem.SuperbIC.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>dataset</strong> – the dataset from <a class="reference internal" href="#s3prl.problem.SuperbIC.build_dataset" title="s3prl.problem.SuperbIC.build_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_dataset</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>batch sampler for torch DataLoader</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbIC.build_downstream">
<span class="sig-name descname"><span class="pre">build_downstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/common/superb_ic.html#SuperbIC.build_downstream"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/superb_ic.py#L379-L403"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbIC.build_downstream" title="Permalink to this definition">#</a></dt>
<dd><p>Return the task-specific downstream model.
By default build the <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code> model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbIC.default_config" title="s3prl.problem.SuperbIC.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
support arguments of <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code></p></li>
<li><p><strong>downstream_input_size</strong> (<em>int</em>) – the required input size of the model</p></li>
<li><p><strong>downstream_output_size</strong> (<em>int</em>) – the required output size of the model</p></li>
<li><p><strong>downstream_input_stride</strong> (<em>int</em>) – the input feature’s stride (from 16 KHz)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">AbsUtteranceModel</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbIC.build_task">
<span class="sig-name descname"><span class="pre">build_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/common/superb_ic.html#SuperbIC.build_task"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/superb_ic.py#L405-L429"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbIC.build_task" title="Permalink to this definition">#</a></dt>
<dd><p>Build the task, which defines the logics for every train/valid/test forward step for the <code class="code docutils literal notranslate"><span class="pre">model</span></code>,
and the logics for how to reduce all the batch results from multiple train/valid/test steps into metrics</p>
<p>By default build <code class="xref py py-obj docutils literal notranslate"><span class="pre">UtteranceMultiClassClassificationTask</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbIC.default_config" title="s3prl.problem.SuperbIC.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model built by <a class="reference internal" href="#s3prl.problem.SuperbIC.build_model" title="s3prl.problem.SuperbIC.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a></p></li>
<li><p><strong>encoder</strong> – the encoder built by <a class="reference internal" href="#s3prl.problem.SuperbIC.build_encoder" title="s3prl.problem.SuperbIC.build_encoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_encoder</span></code></a></p></li>
<li><p><strong>valid_df</strong> (<em>pd.DataFrame</em>) – metadata of the valid set</p></li>
<li><p><strong>test_df</strong> (<em>pd.DataFrame</em>) – metadata of the test set</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Task</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbIC.build_collate_fn">
<span class="sig-name descname"><span class="pre">build_collate_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L143-L156"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbIC.build_collate_fn" title="Permalink to this definition">#</a></dt>
<dd><p>By default returns <code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataset.base.default_collate_fn</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_collate_fn</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbIC.default_config" title="s3prl.problem.SuperbIC.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train, valid, or test</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>callable</p>
<p>the collate_fn for torch DataLoader in train/valid/test <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbIC.build_featurizer">
<span class="sig-name descname"><span class="pre">build_featurizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upstream</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L175-L192"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbIC.build_featurizer" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the featurizer with <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbIC.default_config" title="s3prl.problem.SuperbIC.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p></li>
<li><p><strong>upstream</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">AbsUpstream</span></code>) – the upstream model built by <a class="reference internal" href="#s3prl.problem.SuperbIC.build_upstream" title="s3prl.problem.SuperbIC.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsFeaturizer" title="s3prl.nn.interface.AbsFeaturizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsFeaturizer</span></code></a></p>
<p>Return the featurizer model. The featurizer is used to reduce the multiple
hidden states returned from the upstream model (built by <a class="reference internal" href="#s3prl.problem.SuperbIC.build_upstream" title="s3prl.problem.SuperbIC.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>)
into a single hidden state, so can be easliy fed into the downstream model</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbIC.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L194-L231"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbIC.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>By default build model with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbIC.default_config" title="s3prl.problem.SuperbIC.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p></li>
<li><p><strong>model_output_size</strong> (<em>int</em>) – the required model’s output hidden size</p></li>
<li><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbIC.default_config" title="s3prl.problem.SuperbIC.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.SuperbIC.build_upstream" title="s3prl.problem.SuperbIC.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbIC.default_config" title="s3prl.problem.SuperbIC.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.SuperbIC.build_featurizer" title="s3prl.problem.SuperbIC.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a></p></li>
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbIC.default_config" title="s3prl.problem.SuperbIC.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.SuperbIC.build_downstream" title="s3prl.problem.SuperbIC.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch.nn.Module</p>
<p>Return the entire model for the task, which takes the direct items from DataLoader as the input.
Usually, the components can be built by <a class="reference internal" href="#s3prl.problem.SuperbIC.build_upstream" title="s3prl.problem.SuperbIC.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>, <a class="reference internal" href="#s3prl.problem.SuperbIC.build_featurizer" title="s3prl.problem.SuperbIC.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a>,
<a class="reference internal" href="#s3prl.problem.SuperbIC.build_downstream" title="s3prl.problem.SuperbIC.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a>, and are concated together to get the final model.
The upstream extracts multiple hidden states, the featuizer reduce them into a single hidden state,
and the downstream takes the hidden states as the feature for the downstream-specific model.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbIC.build_optimizer">
<span class="sig-name descname"><span class="pre">build_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L233-L258"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbIC.build_optimizer" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_optimizer</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbIC.default_config" title="s3prl.problem.SuperbIC.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to below</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the optimizer class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the optimizer class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;lr&quot;:</span> <span class="pre">1.0e-4}</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>parameters</strong> (<em>iterable</em>) – the standard params accepted by <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code></p>
<p>An optimizer following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbIC.build_scheduler">
<span class="sig-name descname"><span class="pre">build_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L260-L285"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbIC.build_scheduler" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_scheduler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbIC.default_config" title="s3prl.problem.SuperbIC.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the scheduler class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the scheduler class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;gamma&quot;:</span> <span class="pre">0.01}</span></code> for <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler.StepLR</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>optimizer</strong> – the standard torch optimizer accepted by Scheduler in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch scheduler</p>
<p>A scheduler following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbIC.build_upstream">
<span class="sig-name descname"><span class="pre">build_upstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L158-L173"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbIC.build_upstream" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the upstream with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbIC.default_config" title="s3prl.problem.SuperbIC.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUpstream" title="s3prl.nn.interface.AbsUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUpstream</span></code></a></p>
<p>Return an upstream model, whose forward takes the waveform input and returns
multiple hidden states as features.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbIC.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L660-L707"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbIC.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>The evaluate routine used by <a class="reference internal" href="#s3prl.problem.SuperbIC.train" title="s3prl.problem.SuperbIC.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> (during validation phase) and <a class="reference internal" href="#s3prl.problem.SuperbIC.run" title="s3prl.problem.SuperbIC.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>
(during testing phase).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evaluate</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbIC.default_config" title="s3prl.problem.SuperbIC.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbIC.get_class_from_name">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_class_from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L129-L141"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbIC.get_class_from_name" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">__name__</span></code> of the problem class</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Problem</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbIC.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L752-L772"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbIC.load_model" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model_ckpt_dir</strong> (<em>str</em>) – Restore the model with <a class="reference internal" href="#s3prl.problem.SuperbIC.build_model" title="s3prl.problem.SuperbIC.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> and the checkpoint
saved in this directory.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbIC.load_model_and_task">
<span class="sig-name descname"><span class="pre">load_model_and_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ckpts_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L884-L902"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbIC.load_model_and_task" title="Permalink to this definition">#</a></dt>
<dd><p>This is a helper method to combine <a class="reference internal" href="#s3prl.problem.SuperbIC.load_model" title="s3prl.problem.SuperbIC.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a> and <a class="reference internal" href="#s3prl.problem.SuperbIC.load_task" title="s3prl.problem.SuperbIC.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>
together to directly load the model and the task. This method assumes
the model is saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'model'</span></code> and the task is
saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'task'</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>model (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>)</p></li>
<li><p>task (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a>)</p></li>
</ol>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbIC.load_task">
<span class="sig-name descname"><span class="pre">load_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L833-L882"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbIC.load_task" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – Restore the task with <a class="reference internal" href="#s3prl.problem.SuperbIC.build_task" title="s3prl.problem.SuperbIC.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> and the checkpoint
saved in this directory.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model for the task, since the model is separately saved
and is required for <a class="reference internal" href="#s3prl.problem.SuperbIC.build_task" title="s3prl.problem.SuperbIC.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a>.</p></li>
<li><p><strong>task_overrides</strong> (<em>dict</em>) – overrides the saved initialization arguments, so can change
the loaded task’s behavior. Like, change the decoding hyperparameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbIC.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L954-L995"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbIC.main" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbIC.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_all_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cuda'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/run.py#L26-L318"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbIC.run" title="Permalink to this definition">#</a></dt>
<dd><div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>stage</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Parse the corpus and save the metadata file (waveform path, label…)</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Build the encoder to encode the labels</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Train the model</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Evaluate the model on multiple test sets</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_dir</strong> (<em>str</em>) – The directory that stores the script result.</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – The directory that caches the processed data.
Default: /home/user/.cache/s3prl/data</p></li>
<li><p><strong>remove_all_cache</strong> (<em>bool</em>) – Whether to remove all the cache stored under <cite>cache_dir</cite>.
Default: False</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting stage of the problem script.
Default: 0</p></li>
<li><p><strong>stop</strong> (<em>int</em>) – The stoping stage of the problem script, set <cite>None</cite> to reach the final stage.
Default: None</p></li>
<li><p><strong>num_workers</strong> (<em>int</em>) – num_workers for all the torch DataLoder</p></li>
<li><p><strong>eval_batch</strong> (<em>int</em>) – During evaluation (valid or test), limit the number of batch.
This is helpful for the fast development to check everything won’t crash.
If is -1, disable this feature and evaluate the entire epoch.
Default: -1</p></li>
<li><p><strong>device</strong> (<em>str</em>) – The device type for all torch-related operation: “cpu” or “cuda”
Default: “cuda”</p></li>
<li><p><strong>world_size</strong> (<em>int</em>) – How many processes are running this script simultaneously (in parallel).
Usually this is just 1, however if you are runnig distributed training,
this should be &gt; 1.
Default: 1</p></li>
<li><p><strong>rank</strong> (<em>int</em>) – When distributed training, world_size &gt; 1. Take <code class="code docutils literal notranslate"><span class="pre">world_size</span> <span class="pre">==</span> <span class="pre">8</span></code> for
example, this means 8 processes (8 GPUs) are runing in parallel. The script
needs to know which process among 8 processes it is. In this case, <code class="code docutils literal notranslate"><span class="pre">rank</span></code>
can range from 0~7. All the 8 processes have the same <code class="code docutils literal notranslate"><span class="pre">world_size</span></code> but
different <code class="code docutils literal notranslate"><span class="pre">rank</span></code> (process id).</p></li>
<li><p><strong>test_ckpt_dir</strong> (<em>str</em>) – Specify the checkpoint path for testing. If not, use the validation best
checkpoint under the given <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> directory.</p></li>
<li><p><strong>**kwds</strong> – The other arguments like <code class="code docutils literal notranslate"><span class="pre">prepare_data</span></code> and <code class="code docutils literal notranslate"><span class="pre">build_model</span></code> are
method specific-arguments for methods like <a class="reference internal" href="#s3prl.problem.SuperbIC.prepare_data" title="s3prl.problem.SuperbIC.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> and
<a class="reference internal" href="#s3prl.problem.SuperbIC.build_model" title="s3prl.problem.SuperbIC.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>, and will not be used in the core <a class="reference internal" href="#s3prl.problem.SuperbIC.run" title="s3prl.problem.SuperbIC.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> logic.
See the specific method documentation for their supported arguments and
meaning</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbIC.save_model">
<span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L709-L750"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbIC.save_model" title="Permalink to this definition">#</a></dt>
<dd><p>Save the model state_dict and the model initialization arguments into the given directory.
If you override this method, it is highly possible you also need to override <a class="reference internal" href="#s3prl.problem.SuperbIC.load_model" title="s3prl.problem.SuperbIC.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbIC.default_config" title="s3prl.problem.SuperbIC.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_model</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>model_ckpt_dir</strong> (<em>str</em>) – save the model into the this directory.</p></li>
<li><p><strong>build_model_all_args</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.SuperbIC.build_model" title="s3prl.problem.SuperbIC.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>.
By saving this dictionary, you can easily reconstruct the same model
by calling <a class="reference internal" href="#s3prl.problem.SuperbIC.build_model" title="s3prl.problem.SuperbIC.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbIC.save_task">
<span class="sig-name descname"><span class="pre">save_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="s3prl.task.base.html#s3prl.task.base.Task" title="s3prl.task.base.Task"><span class="pre">Task</span></a></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L774-L831"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbIC.save_task" title="Permalink to this definition">#</a></dt>
<dd><p>Save the task’s state, <code class="code docutils literal notranslate"><span class="pre">task.get_state()</span></code>, and the initialization arguments into the given
directory. If you override this method, it is highly possible you also need to override
<a class="reference internal" href="#s3prl.problem.SuperbIC.load_task" title="s3prl.problem.SuperbIC.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbIC.default_config" title="s3prl.problem.SuperbIC.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_task</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – save the task into this directory.</p></li>
<li><p><strong>build_task_all_args_except_model</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.SuperbIC.build_task" title="s3prl.problem.SuperbIC.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> except
the <code class="code docutils literal notranslate"><span class="pre">model</span></code> argument since the model should be sapartely saved by
<a class="reference internal" href="#s3prl.problem.SuperbIC.save_model" title="s3prl.problem.SuperbIC.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a>. By saving this dictionary, you can easily reconstruct the same task
by calling <a class="reference internal" href="#s3prl.problem.SuperbIC.build_task" title="s3prl.problem.SuperbIC.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>task</strong> (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><em>Task</em></a>) – the task to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbIC.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L287-L658"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbIC.train" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbIC.default_config" title="s3prl.problem.SuperbIC.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>total_steps</p></td>
<td><p>(int) - the total optimization steps</p></td>
</tr>
<tr class="row-odd"><td><p>log_step</p></td>
<td><p>(int) - logging frequency. log every <code class="code docutils literal notranslate"><span class="pre">log_step</span></code> step</p></td>
</tr>
<tr class="row-even"><td><p>eval_step</p></td>
<td><p>(int) - evaluation frequency. Evaluate every <code class="code docutils literal notranslate"><span class="pre">eval_step</span></code> step.                                                 Note that you can control how many batch to evaluate to speed up the                                                 development by the <code class="code docutils literal notranslate"><span class="pre">eval_batch</span></code> argument in <a class="reference internal" href="#s3prl.problem.SuperbIC.run" title="s3prl.problem.SuperbIC.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>save_step</p></td>
<td><p>(int) - save the checkpoint every <code class="code docutils literal notranslate"><span class="pre">save_step</span></code> step.</p></td>
</tr>
<tr class="row-even"><td><p>gradient_clipping</p></td>
<td><p>(float) - clip the gradient. important for RNNs.</p></td>
</tr>
<tr class="row-odd"><td><p>gradient_accumulate</p></td>
<td><p>(int) - accumulate multiple steps’ gradient before updating network parameters                                                 to simulate large-batch optimization.</p></td>
</tr>
<tr class="row-even"><td><p>valid_metric</p></td>
<td><p>(str) - the metric to select the best valid checkpoint. Different Tasks have different                                                 supported valid_metrics. See <a class="reference internal" href="#s3prl.problem.SuperbIC.build_task" title="s3prl.problem.SuperbIC.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> for the supported metrics.</p></td>
</tr>
<tr class="row-odd"><td><p>valid_higher_better</p></td>
<td><p>(bool) - some metrics are higher better, while some are lower better                                                 this will affect how to save the best validation checkpoint.</p></td>
</tr>
<tr class="row-even"><td><p>auto_resume</p></td>
<td><p>(bool) - if there are already the last checkpoint in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.SuperbIC.run" title="s3prl.problem.SuperbIC.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>),                                                 whether to resume from it or delete it and start a new training session.</p></td>
</tr>
<tr class="row-odd"><td><p>resume_ckpt_dir</p></td>
<td><p>(str) - you can directly specify the checkpoint path to resume which is not necessary                                                 in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.SuperbIC.run" title="s3prl.problem.SuperbIC.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>).</p></td>
</tr>
<tr class="row-even"><td><p>seed</p></td>
<td><p>(int) - fix the seed before the training start</p></td>
</tr>
<tr class="row-odd"><td><p>keep_num_ckpts</p></td>
<td><p>(int) - to prevent saving too many checkpoints, only save the <code class="code docutils literal notranslate"><span class="pre">keep_num_ckpts</span></code>                                                 latest checkpoints and delete the old ones.</p></td>
</tr>
<tr class="row-even"><td><p>use_scheduler</p></td>
<td><p>(bool) - whether to use the scheduler</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="superbks">
<h2>SuperbKS<a class="headerlink" href="#superbks" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="s3prl.problem.SuperbKS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">s3prl.problem.</span></span><span class="sig-name descname"><span class="pre">SuperbKS</span></span><a class="reference internal" href="../_modules/s3prl/problem/common/superb_ks.html#SuperbKS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/superb_ks.py#L115-L372"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbKS" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="s3prl.problem.common.superb_sid.html#s3prl.problem.common.superb_sid.SuperbSID" title="s3prl.problem.common.superb_sid.SuperbSID"><code class="xref py py-class docutils literal notranslate"><span class="pre">SuperbSID</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbKS.default_config">
<span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/s3prl/problem/common/superb_ks.html#SuperbKS.default_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/superb_ks.py#L116-L201"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbKS.default_config" title="Permalink to this definition">#</a></dt>
<dd><p>The default arguments for <a class="reference internal" href="#s3prl.problem.SuperbKS.run" title="s3prl.problem.SuperbKS.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> in yaml.
Note that for the fields with inner values, like <code class="code docutils literal notranslate"><span class="pre">build_model</span></code>,
the outer field name corresponds to a method name, so you can find the method
<a class="reference internal" href="#s3prl.problem.SuperbKS.build_model" title="s3prl.problem.SuperbKS.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>. Furthermore, the values inside that field will be
directly passed into the method. So by changing these inner values, you
can directly affect the behavior of the corresponding method. See the method
documentation for all the supported arguments and their meanings.</p>
<p>The methods affected by the following config are: <a class="reference internal" href="#s3prl.problem.SuperbKS.prepare_data" title="s3prl.problem.SuperbKS.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbKS.build_encoder" title="s3prl.problem.SuperbKS.build_encoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_encoder</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbKS.build_dataset" title="s3prl.problem.SuperbKS.build_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_dataset</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbKS.build_batch_sampler" title="s3prl.problem.SuperbKS.build_batch_sampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_batch_sampler</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbKS.build_upstream" title="s3prl.problem.SuperbKS.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbKS.build_featurizer" title="s3prl.problem.SuperbKS.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbKS.build_downstream" title="s3prl.problem.SuperbKS.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbKS.build_model" title="s3prl.problem.SuperbKS.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbKS.build_task" title="s3prl.problem.SuperbKS.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbKS.build_optimizer" title="s3prl.problem.SuperbKS.build_optimizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_optimizer</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbKS.build_scheduler" title="s3prl.problem.SuperbKS.build_scheduler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_scheduler</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbKS.save_model" title="s3prl.problem.SuperbKS.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbKS.save_task" title="s3prl.problem.SuperbKS.save_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_task</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbKS.train" title="s3prl.problem.SuperbKS.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbKS.evaluate" title="s3prl.problem.SuperbKS.evaluate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate</span></code></a></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">start</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="nt">stop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">target_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">cache_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">remove_all_cache</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">prepare_data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">gsc1</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="w">  </span><span class="nt">gsc1_test</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">build_encoder</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">build_dataset</span><span class="p">:</span>
<span class="w">  </span><span class="nt">train</span><span class="p">:</span>
<span class="w">    </span><span class="nt">sox_effects</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">channels</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rate</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;16000&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gain</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;-3.0&#39;</span>
<span class="w">  </span><span class="nt">valid</span><span class="p">:</span>
<span class="w">    </span><span class="nt">sox_effects</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">channels</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rate</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;16000&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gain</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;-3.0&#39;</span>
<span class="w">  </span><span class="nt">test</span><span class="p">:</span>
<span class="w">    </span><span class="nt">sox_effects</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">channels</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;1&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">rate</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;16000&#39;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">gain</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&#39;-3.0&#39;</span>
<span class="nt">build_batch_sampler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">train</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">32</span>
<span class="w">  </span><span class="nt">valid</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">32</span>
<span class="w">  </span><span class="nt">test</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">32</span>
<span class="nt">build_upstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">build_featurizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">layer_selections</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="nt">normalize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_downstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">hidden_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">256</span>
<span class="nt">build_model</span><span class="p">:</span>
<span class="w">  </span><span class="nt">upstream_trainable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_task</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">build_optimizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Adam</span>
<span class="w">  </span><span class="nt">conf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">lr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0001</span>
<span class="nt">build_scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ExponentialLR</span>
<span class="w">  </span><span class="nt">gamma</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.9</span>
<span class="nt">save_model</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">save_task</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">train</span><span class="p">:</span>
<span class="w">  </span><span class="nt">total_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">200000</span>
<span class="w">  </span><span class="nt">log_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">  </span><span class="nt">eval_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5000</span>
<span class="w">  </span><span class="nt">save_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span>
<span class="w">  </span><span class="nt">gradient_clipping</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0</span>
<span class="w">  </span><span class="nt">gradient_accumulate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">valid_metric</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">accuracy</span>
<span class="w">  </span><span class="nt">valid_higher_better</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">auto_resume</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">resume_ckpt_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">evaluate</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbKS.prepare_data">
<span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/common/superb_ks.html#SuperbKS.prepare_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/superb_ks.py#L203-L244"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbKS.prepare_data" title="Permalink to this definition">#</a></dt>
<dd><p>Prepare the task-specific data metadata (path, labels…).
By default call <code class="xref py py-obj docutils literal notranslate"><span class="pre">gsc1_for_classification</span></code> with <code class="code docutils literal notranslate"><span class="pre">**prepare_data</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prepare_data</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbKS.default_config" title="s3prl.problem.SuperbKS.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
support arguments in <code class="xref py py-obj docutils literal notranslate"><span class="pre">gsc1_for_classification</span></code></p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Parse your corpus and save the csv file into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the parsing or preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>train_path (str)</p></li>
<li><p>valid_path (str)</p></li>
<li><p>test_paths (List[str])</p></li>
</ol>
<p>Each path (str) should be a csv file containing the following columns:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>column</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>(str) - the unique id for this data point</p></td>
</tr>
<tr class="row-odd"><td><p>wav_path</p></td>
<td><p>(str) - the absolute path of the waveform file</p></td>
</tr>
<tr class="row-even"><td><p>label</p></td>
<td><p>(str) - a string label of the waveform</p></td>
</tr>
<tr class="row-odd"><td><p>start_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">start_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load from the beginning.</p></td>
</tr>
<tr class="row-even"><td><p>end_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">end_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load to the end.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbKS.build_encoder">
<span class="sig-name descname"><span class="pre">build_encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_csv_paths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/common/superb_ks.html#SuperbKS.build_encoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/superb_ks.py#L246-L290"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbKS.build_encoder" title="Permalink to this definition">#</a></dt>
<dd><p>Build the encoder (for the labels) given the data metadata, and return the saved encoder path.
By default generate and save a <a class="reference internal" href="s3prl.dataio.encoder.html#s3prl.dataio.encoder.CategoryEncoder" title="s3prl.dataio.encoder.CategoryEncoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataio.encoder.CategoryEncoder</span></code></a> from the <code class="code docutils literal notranslate"><span class="pre">label</span></code> column of all the csv files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_encoder</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbKS.default_config" title="s3prl.problem.SuperbKS.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Save your encoder into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>train_csv_path</strong> (<em>str</em>) – the train path from <a class="reference internal" href="#s3prl.problem.SuperbKS.prepare_data" title="s3prl.problem.SuperbKS.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>valid_csv_path</strong> (<em>str</em>) – the valid path from <a class="reference internal" href="#s3prl.problem.SuperbKS.prepare_data" title="s3prl.problem.SuperbKS.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>test_csv_paths</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – the test paths from <a class="reference internal" href="#s3prl.problem.SuperbKS.prepare_data" title="s3prl.problem.SuperbKS.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>str</p>
<p>tokenizer_path: The tokenizer should be saved in the pickle format</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbKS.build_batch_sampler">
<span class="sig-name descname"><span class="pre">build_batch_sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/common/superb_ks.html#SuperbKS.build_batch_sampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/superb_ks.py#L292-L346"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbKS.build_batch_sampler" title="Permalink to this definition">#</a></dt>
<dd><p>Return the batch sampler for torch DataLoader.
By default for train and valid, use <code class="xref py py-obj docutils literal notranslate"><span class="pre">BalancedWeightedSampler</span></code>; for test use
<code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_batch_sampler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbKS.default_config" title="s3prl.problem.SuperbKS.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>train</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">BalancedWeightedSampler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>valid</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">BalancedWeightedSampler</span></code></p></td>
</tr>
<tr class="row-even"><td><p>test</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">mode</span></code> specific csv from <a class="reference internal" href="#s3prl.problem.SuperbKS.prepare_data" title="s3prl.problem.SuperbKS.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>dataset</strong> – the dataset from <a class="reference internal" href="#s3prl.problem.SuperbKS.build_dataset" title="s3prl.problem.SuperbKS.build_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_dataset</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>batch sampler for torch DataLoader</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbKS.build_downstream">
<span class="sig-name descname"><span class="pre">build_downstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_downsample_rate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/common/superb_ks.html#SuperbKS.build_downstream"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/superb_ks.py#L348-L372"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbKS.build_downstream" title="Permalink to this definition">#</a></dt>
<dd><p>Return the task-specific downstream model.
By default build the <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code> model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbKS.default_config" title="s3prl.problem.SuperbKS.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
support arguments of <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code></p></li>
<li><p><strong>downstream_input_size</strong> (<em>int</em>) – the required input size of the model</p></li>
<li><p><strong>downstream_output_size</strong> (<em>int</em>) – the required output size of the model</p></li>
<li><p><strong>downstream_input_stride</strong> (<em>int</em>) – the input feature’s stride (from 16 KHz)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">AbsUtteranceModel</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbKS.build_collate_fn">
<span class="sig-name descname"><span class="pre">build_collate_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L143-L156"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbKS.build_collate_fn" title="Permalink to this definition">#</a></dt>
<dd><p>By default returns <code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataset.base.default_collate_fn</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_collate_fn</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbKS.default_config" title="s3prl.problem.SuperbKS.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train, valid, or test</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>callable</p>
<p>the collate_fn for torch DataLoader in train/valid/test <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbKS.build_dataset">
<span class="sig-name descname"><span class="pre">build_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_shift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/superb_sid.py#L244-L358"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbKS.build_dataset" title="Permalink to this definition">#</a></dt>
<dd><p>Build the dataset for train/valid/test.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_dataset</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbKS.default_config" title="s3prl.problem.SuperbKS.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>. with <code class="code docutils literal notranslate"><span class="pre">train</span></code>, <code class="code docutils literal notranslate"><span class="pre">valid</span></code>, <code class="code docutils literal notranslate"><span class="pre">test</span></code> keys, each
is a dictionary with the following supported options:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>max_secs</p></td>
<td><p>(float) - If a waveform is longer than <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds, randomly crop the waveform into <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds</p></td>
</tr>
<tr class="row-odd"><td><p>sox_effects</p></td>
<td><p>(List[List[str]]) - If not None, apply sox effects on the utterance</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – The metadata csv file for the specific <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p></li>
<li><p><strong>encoder_path</strong> (<em>str</em>) – The pickled encoder path for encoding the labels</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch Dataset</p>
<p>For all train/valid/test mode, the dataset should return each item as a dictionary
containing the following keys:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>x</p></td>
<td><p>(torch.FloatTensor) - the waveform in (seq_len, 1)</p></td>
</tr>
<tr class="row-odd"><td><p>x_len</p></td>
<td><p>(int) - the waveform length <code class="code docutils literal notranslate"><span class="pre">seq_len</span></code></p></td>
</tr>
<tr class="row-even"><td><p>class_id</p></td>
<td><p>(int) - the encoded class id</p></td>
</tr>
<tr class="row-odd"><td><p>label</p></td>
<td><p>(str) - the class name</p></td>
</tr>
<tr class="row-even"><td><p>unique_name</p></td>
<td><p>(str) - the unique id for this datapoint</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbKS.build_featurizer">
<span class="sig-name descname"><span class="pre">build_featurizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upstream</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L175-L192"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbKS.build_featurizer" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the featurizer with <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbKS.default_config" title="s3prl.problem.SuperbKS.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p></li>
<li><p><strong>upstream</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">AbsUpstream</span></code>) – the upstream model built by <a class="reference internal" href="#s3prl.problem.SuperbKS.build_upstream" title="s3prl.problem.SuperbKS.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsFeaturizer" title="s3prl.nn.interface.AbsFeaturizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsFeaturizer</span></code></a></p>
<p>Return the featurizer model. The featurizer is used to reduce the multiple
hidden states returned from the upstream model (built by <a class="reference internal" href="#s3prl.problem.SuperbKS.build_upstream" title="s3prl.problem.SuperbKS.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>)
into a single hidden state, so can be easliy fed into the downstream model</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbKS.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L194-L231"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbKS.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>By default build model with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbKS.default_config" title="s3prl.problem.SuperbKS.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p></li>
<li><p><strong>model_output_size</strong> (<em>int</em>) – the required model’s output hidden size</p></li>
<li><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbKS.default_config" title="s3prl.problem.SuperbKS.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.SuperbKS.build_upstream" title="s3prl.problem.SuperbKS.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbKS.default_config" title="s3prl.problem.SuperbKS.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.SuperbKS.build_featurizer" title="s3prl.problem.SuperbKS.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a></p></li>
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbKS.default_config" title="s3prl.problem.SuperbKS.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.SuperbKS.build_downstream" title="s3prl.problem.SuperbKS.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch.nn.Module</p>
<p>Return the entire model for the task, which takes the direct items from DataLoader as the input.
Usually, the components can be built by <a class="reference internal" href="#s3prl.problem.SuperbKS.build_upstream" title="s3prl.problem.SuperbKS.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>, <a class="reference internal" href="#s3prl.problem.SuperbKS.build_featurizer" title="s3prl.problem.SuperbKS.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a>,
<a class="reference internal" href="#s3prl.problem.SuperbKS.build_downstream" title="s3prl.problem.SuperbKS.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a>, and are concated together to get the final model.
The upstream extracts multiple hidden states, the featuizer reduce them into a single hidden state,
and the downstream takes the hidden states as the feature for the downstream-specific model.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbKS.build_optimizer">
<span class="sig-name descname"><span class="pre">build_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L233-L258"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbKS.build_optimizer" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_optimizer</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbKS.default_config" title="s3prl.problem.SuperbKS.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to below</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the optimizer class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the optimizer class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;lr&quot;:</span> <span class="pre">1.0e-4}</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>parameters</strong> (<em>iterable</em>) – the standard params accepted by <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code></p>
<p>An optimizer following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbKS.build_scheduler">
<span class="sig-name descname"><span class="pre">build_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L260-L285"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbKS.build_scheduler" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_scheduler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbKS.default_config" title="s3prl.problem.SuperbKS.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the scheduler class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the scheduler class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;gamma&quot;:</span> <span class="pre">0.01}</span></code> for <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler.StepLR</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>optimizer</strong> – the standard torch optimizer accepted by Scheduler in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch scheduler</p>
<p>A scheduler following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbKS.build_task">
<span class="sig-name descname"><span class="pre">build_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/run.py#L352-L375"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbKS.build_task" title="Permalink to this definition">#</a></dt>
<dd><p>Build the task, which defines the logics for every train/valid/test forward step for the <code class="code docutils literal notranslate"><span class="pre">model</span></code>,
and the logics for how to reduce all the batch results from multiple train/valid/test steps into metrics</p>
<p>By default build <code class="xref py py-obj docutils literal notranslate"><span class="pre">UtteranceClassificationTask</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbKS.default_config" title="s3prl.problem.SuperbKS.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model built by <a class="reference internal" href="#s3prl.problem.SuperbKS.build_model" title="s3prl.problem.SuperbKS.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a></p></li>
<li><p><strong>encoder</strong> – the encoder built by <a class="reference internal" href="#s3prl.problem.SuperbKS.build_encoder" title="s3prl.problem.SuperbKS.build_encoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_encoder</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Task</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbKS.build_upstream">
<span class="sig-name descname"><span class="pre">build_upstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L158-L173"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbKS.build_upstream" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the upstream with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbKS.default_config" title="s3prl.problem.SuperbKS.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUpstream" title="s3prl.nn.interface.AbsUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUpstream</span></code></a></p>
<p>Return an upstream model, whose forward takes the waveform input and returns
multiple hidden states as features.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbKS.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L660-L707"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbKS.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>The evaluate routine used by <a class="reference internal" href="#s3prl.problem.SuperbKS.train" title="s3prl.problem.SuperbKS.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> (during validation phase) and <a class="reference internal" href="#s3prl.problem.SuperbKS.run" title="s3prl.problem.SuperbKS.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>
(during testing phase).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evaluate</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbKS.default_config" title="s3prl.problem.SuperbKS.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbKS.get_class_from_name">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_class_from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L129-L141"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbKS.get_class_from_name" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">__name__</span></code> of the problem class</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Problem</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbKS.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L752-L772"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbKS.load_model" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model_ckpt_dir</strong> (<em>str</em>) – Restore the model with <a class="reference internal" href="#s3prl.problem.SuperbKS.build_model" title="s3prl.problem.SuperbKS.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> and the checkpoint
saved in this directory.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbKS.load_model_and_task">
<span class="sig-name descname"><span class="pre">load_model_and_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ckpts_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L884-L902"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbKS.load_model_and_task" title="Permalink to this definition">#</a></dt>
<dd><p>This is a helper method to combine <a class="reference internal" href="#s3prl.problem.SuperbKS.load_model" title="s3prl.problem.SuperbKS.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a> and <a class="reference internal" href="#s3prl.problem.SuperbKS.load_task" title="s3prl.problem.SuperbKS.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>
together to directly load the model and the task. This method assumes
the model is saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'model'</span></code> and the task is
saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'task'</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>model (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>)</p></li>
<li><p>task (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a>)</p></li>
</ol>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbKS.load_task">
<span class="sig-name descname"><span class="pre">load_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L833-L882"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbKS.load_task" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – Restore the task with <a class="reference internal" href="#s3prl.problem.SuperbKS.build_task" title="s3prl.problem.SuperbKS.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> and the checkpoint
saved in this directory.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model for the task, since the model is separately saved
and is required for <a class="reference internal" href="#s3prl.problem.SuperbKS.build_task" title="s3prl.problem.SuperbKS.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a>.</p></li>
<li><p><strong>task_overrides</strong> (<em>dict</em>) – overrides the saved initialization arguments, so can change
the loaded task’s behavior. Like, change the decoding hyperparameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbKS.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L954-L995"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbKS.main" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbKS.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_all_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cuda'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/run.py#L26-L318"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbKS.run" title="Permalink to this definition">#</a></dt>
<dd><div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>stage</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Parse the corpus and save the metadata file (waveform path, label…)</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Build the encoder to encode the labels</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Train the model</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Evaluate the model on multiple test sets</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_dir</strong> (<em>str</em>) – The directory that stores the script result.</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – The directory that caches the processed data.
Default: /home/user/.cache/s3prl/data</p></li>
<li><p><strong>remove_all_cache</strong> (<em>bool</em>) – Whether to remove all the cache stored under <cite>cache_dir</cite>.
Default: False</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting stage of the problem script.
Default: 0</p></li>
<li><p><strong>stop</strong> (<em>int</em>) – The stoping stage of the problem script, set <cite>None</cite> to reach the final stage.
Default: None</p></li>
<li><p><strong>num_workers</strong> (<em>int</em>) – num_workers for all the torch DataLoder</p></li>
<li><p><strong>eval_batch</strong> (<em>int</em>) – During evaluation (valid or test), limit the number of batch.
This is helpful for the fast development to check everything won’t crash.
If is -1, disable this feature and evaluate the entire epoch.
Default: -1</p></li>
<li><p><strong>device</strong> (<em>str</em>) – The device type for all torch-related operation: “cpu” or “cuda”
Default: “cuda”</p></li>
<li><p><strong>world_size</strong> (<em>int</em>) – How many processes are running this script simultaneously (in parallel).
Usually this is just 1, however if you are runnig distributed training,
this should be &gt; 1.
Default: 1</p></li>
<li><p><strong>rank</strong> (<em>int</em>) – When distributed training, world_size &gt; 1. Take <code class="code docutils literal notranslate"><span class="pre">world_size</span> <span class="pre">==</span> <span class="pre">8</span></code> for
example, this means 8 processes (8 GPUs) are runing in parallel. The script
needs to know which process among 8 processes it is. In this case, <code class="code docutils literal notranslate"><span class="pre">rank</span></code>
can range from 0~7. All the 8 processes have the same <code class="code docutils literal notranslate"><span class="pre">world_size</span></code> but
different <code class="code docutils literal notranslate"><span class="pre">rank</span></code> (process id).</p></li>
<li><p><strong>test_ckpt_dir</strong> (<em>str</em>) – Specify the checkpoint path for testing. If not, use the validation best
checkpoint under the given <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> directory.</p></li>
<li><p><strong>**kwds</strong> – The other arguments like <code class="code docutils literal notranslate"><span class="pre">prepare_data</span></code> and <code class="code docutils literal notranslate"><span class="pre">build_model</span></code> are
method specific-arguments for methods like <a class="reference internal" href="#s3prl.problem.SuperbKS.prepare_data" title="s3prl.problem.SuperbKS.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> and
<a class="reference internal" href="#s3prl.problem.SuperbKS.build_model" title="s3prl.problem.SuperbKS.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>, and will not be used in the core <a class="reference internal" href="#s3prl.problem.SuperbKS.run" title="s3prl.problem.SuperbKS.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> logic.
See the specific method documentation for their supported arguments and
meaning</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbKS.save_model">
<span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L709-L750"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbKS.save_model" title="Permalink to this definition">#</a></dt>
<dd><p>Save the model state_dict and the model initialization arguments into the given directory.
If you override this method, it is highly possible you also need to override <a class="reference internal" href="#s3prl.problem.SuperbKS.load_model" title="s3prl.problem.SuperbKS.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbKS.default_config" title="s3prl.problem.SuperbKS.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_model</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>model_ckpt_dir</strong> (<em>str</em>) – save the model into the this directory.</p></li>
<li><p><strong>build_model_all_args</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.SuperbKS.build_model" title="s3prl.problem.SuperbKS.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>.
By saving this dictionary, you can easily reconstruct the same model
by calling <a class="reference internal" href="#s3prl.problem.SuperbKS.build_model" title="s3prl.problem.SuperbKS.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbKS.save_task">
<span class="sig-name descname"><span class="pre">save_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="s3prl.task.base.html#s3prl.task.base.Task" title="s3prl.task.base.Task"><span class="pre">Task</span></a></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L774-L831"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbKS.save_task" title="Permalink to this definition">#</a></dt>
<dd><p>Save the task’s state, <code class="code docutils literal notranslate"><span class="pre">task.get_state()</span></code>, and the initialization arguments into the given
directory. If you override this method, it is highly possible you also need to override
<a class="reference internal" href="#s3prl.problem.SuperbKS.load_task" title="s3prl.problem.SuperbKS.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbKS.default_config" title="s3prl.problem.SuperbKS.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_task</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – save the task into this directory.</p></li>
<li><p><strong>build_task_all_args_except_model</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.SuperbKS.build_task" title="s3prl.problem.SuperbKS.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> except
the <code class="code docutils literal notranslate"><span class="pre">model</span></code> argument since the model should be sapartely saved by
<a class="reference internal" href="#s3prl.problem.SuperbKS.save_model" title="s3prl.problem.SuperbKS.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a>. By saving this dictionary, you can easily reconstruct the same task
by calling <a class="reference internal" href="#s3prl.problem.SuperbKS.build_task" title="s3prl.problem.SuperbKS.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>task</strong> (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><em>Task</em></a>) – the task to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbKS.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L287-L658"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbKS.train" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbKS.default_config" title="s3prl.problem.SuperbKS.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>total_steps</p></td>
<td><p>(int) - the total optimization steps</p></td>
</tr>
<tr class="row-odd"><td><p>log_step</p></td>
<td><p>(int) - logging frequency. log every <code class="code docutils literal notranslate"><span class="pre">log_step</span></code> step</p></td>
</tr>
<tr class="row-even"><td><p>eval_step</p></td>
<td><p>(int) - evaluation frequency. Evaluate every <code class="code docutils literal notranslate"><span class="pre">eval_step</span></code> step.                                                 Note that you can control how many batch to evaluate to speed up the                                                 development by the <code class="code docutils literal notranslate"><span class="pre">eval_batch</span></code> argument in <a class="reference internal" href="#s3prl.problem.SuperbKS.run" title="s3prl.problem.SuperbKS.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>save_step</p></td>
<td><p>(int) - save the checkpoint every <code class="code docutils literal notranslate"><span class="pre">save_step</span></code> step.</p></td>
</tr>
<tr class="row-even"><td><p>gradient_clipping</p></td>
<td><p>(float) - clip the gradient. important for RNNs.</p></td>
</tr>
<tr class="row-odd"><td><p>gradient_accumulate</p></td>
<td><p>(int) - accumulate multiple steps’ gradient before updating network parameters                                                 to simulate large-batch optimization.</p></td>
</tr>
<tr class="row-even"><td><p>valid_metric</p></td>
<td><p>(str) - the metric to select the best valid checkpoint. Different Tasks have different                                                 supported valid_metrics. See <a class="reference internal" href="#s3prl.problem.SuperbKS.build_task" title="s3prl.problem.SuperbKS.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> for the supported metrics.</p></td>
</tr>
<tr class="row-odd"><td><p>valid_higher_better</p></td>
<td><p>(bool) - some metrics are higher better, while some are lower better                                                 this will affect how to save the best validation checkpoint.</p></td>
</tr>
<tr class="row-even"><td><p>auto_resume</p></td>
<td><p>(bool) - if there are already the last checkpoint in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.SuperbKS.run" title="s3prl.problem.SuperbKS.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>),                                                 whether to resume from it or delete it and start a new training session.</p></td>
</tr>
<tr class="row-odd"><td><p>resume_ckpt_dir</p></td>
<td><p>(str) - you can directly specify the checkpoint path to resume which is not necessary                                                 in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.SuperbKS.run" title="s3prl.problem.SuperbKS.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>).</p></td>
</tr>
<tr class="row-even"><td><p>seed</p></td>
<td><p>(int) - fix the seed before the training start</p></td>
</tr>
<tr class="row-odd"><td><p>keep_num_ckpts</p></td>
<td><p>(int) - to prevent saving too many checkpoints, only save the <code class="code docutils literal notranslate"><span class="pre">keep_num_ckpts</span></code>                                                 latest checkpoints and delete the old ones.</p></td>
</tr>
<tr class="row-even"><td><p>use_scheduler</p></td>
<td><p>(bool) - whether to use the scheduler</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="superbsid">
<h2>SuperbSID<a class="headerlink" href="#superbsid" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSID">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">s3prl.problem.</span></span><span class="sig-name descname"><span class="pre">SuperbSID</span></span><a class="reference internal" href="../_modules/s3prl/problem/common/superb_sid.html#SuperbSID"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/superb_sid.py#L82-L436"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSID" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="s3prl.problem.common.run.html#s3prl.problem.common.run.Common" title="s3prl.problem.common.run.Common"><code class="xref py py-class docutils literal notranslate"><span class="pre">Common</span></code></a></p>
<p>The standard SUPERB SID task</p>
<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSID.default_config">
<span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/s3prl/problem/common/superb_sid.html#SuperbSID.default_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/superb_sid.py#L87-L154"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSID.default_config" title="Permalink to this definition">#</a></dt>
<dd><p>The default arguments for <a class="reference internal" href="#s3prl.problem.SuperbSID.run" title="s3prl.problem.SuperbSID.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> in yaml.
Note that for the fields with inner values, like <code class="code docutils literal notranslate"><span class="pre">build_model</span></code>,
the outer field name corresponds to a method name, so you can find the method
<a class="reference internal" href="#s3prl.problem.SuperbSID.build_model" title="s3prl.problem.SuperbSID.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>. Furthermore, the values inside that field will be
directly passed into the method. So by changing these inner values, you
can directly affect the behavior of the corresponding method. See the method
documentation for all the supported arguments and their meanings.</p>
<p>The methods affected by the following config are: <a class="reference internal" href="#s3prl.problem.SuperbSID.prepare_data" title="s3prl.problem.SuperbSID.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSID.build_encoder" title="s3prl.problem.SuperbSID.build_encoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_encoder</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSID.build_dataset" title="s3prl.problem.SuperbSID.build_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_dataset</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSID.build_batch_sampler" title="s3prl.problem.SuperbSID.build_batch_sampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_batch_sampler</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSID.build_upstream" title="s3prl.problem.SuperbSID.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSID.build_featurizer" title="s3prl.problem.SuperbSID.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSID.build_downstream" title="s3prl.problem.SuperbSID.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSID.build_model" title="s3prl.problem.SuperbSID.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSID.build_task" title="s3prl.problem.SuperbSID.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSID.build_optimizer" title="s3prl.problem.SuperbSID.build_optimizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_optimizer</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSID.build_scheduler" title="s3prl.problem.SuperbSID.build_scheduler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_scheduler</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSID.save_model" title="s3prl.problem.SuperbSID.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSID.save_task" title="s3prl.problem.SuperbSID.save_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_task</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSID.train" title="s3prl.problem.SuperbSID.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSID.evaluate" title="s3prl.problem.SuperbSID.evaluate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate</span></code></a></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">start</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="nt">stop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">target_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">cache_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">remove_all_cache</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">prepare_data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">dataset_root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">build_encoder</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">build_dataset</span><span class="p">:</span>
<span class="w">  </span><span class="nt">train</span><span class="p">:</span>
<span class="w">    </span><span class="nt">max_secs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8.0</span>
<span class="nt">build_batch_sampler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">train</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8</span>
<span class="w">    </span><span class="nt">shuffle</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">valid</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">test</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="nt">build_upstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">build_featurizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">layer_selections</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="nt">normalize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_downstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">hidden_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">256</span>
<span class="nt">build_model</span><span class="p">:</span>
<span class="w">  </span><span class="nt">upstream_trainable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_task</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">build_optimizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Adam</span>
<span class="w">  </span><span class="nt">conf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">lr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0001</span>
<span class="nt">build_scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ExponentialLR</span>
<span class="w">  </span><span class="nt">gamma</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.9</span>
<span class="nt">save_model</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">save_task</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">train</span><span class="p">:</span>
<span class="w">  </span><span class="nt">total_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">200000</span>
<span class="w">  </span><span class="nt">log_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">500</span>
<span class="w">  </span><span class="nt">eval_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5000</span>
<span class="w">  </span><span class="nt">save_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span>
<span class="w">  </span><span class="nt">gradient_clipping</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0</span>
<span class="w">  </span><span class="nt">gradient_accumulate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span>
<span class="w">  </span><span class="nt">valid_metric</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">accuracy</span>
<span class="w">  </span><span class="nt">valid_higher_better</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">auto_resume</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">resume_ckpt_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">evaluate</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSID.prepare_data">
<span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/common/superb_sid.html#SuperbSID.prepare_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/superb_sid.py#L156-L196"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSID.prepare_data" title="Permalink to this definition">#</a></dt>
<dd><p>Prepare the task-specific data metadata (path, labels…).
By default call <code class="xref py py-obj docutils literal notranslate"><span class="pre">voxceleb1_for_sid</span></code> with <code class="code docutils literal notranslate"><span class="pre">**prepare_data</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prepare_data</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSID.default_config" title="s3prl.problem.SuperbSID.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments in <code class="xref py py-obj docutils literal notranslate"><span class="pre">voxceleb1_for_sid</span></code></p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Parse your corpus and save the csv file into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the parsing or preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>train_path (str)</p></li>
<li><p>valid_path (str)</p></li>
<li><p>test_paths (List[str])</p></li>
</ol>
<p>Each path (str) should be a csv file containing the following columns:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>column</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>(str) - the unique id for this data point</p></td>
</tr>
<tr class="row-odd"><td><p>wav_path</p></td>
<td><p>(str) - the absolute path of the waveform file</p></td>
</tr>
<tr class="row-even"><td><p>label</p></td>
<td><p>(str) - a string label of the waveform</p></td>
</tr>
<tr class="row-odd"><td><p>start_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">start_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load from the beginning.</p></td>
</tr>
<tr class="row-even"><td><p>end_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">end_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load to the end.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSID.build_encoder">
<span class="sig-name descname"><span class="pre">build_encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_csv_paths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/common/superb_sid.html#SuperbSID.build_encoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/superb_sid.py#L198-L242"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSID.build_encoder" title="Permalink to this definition">#</a></dt>
<dd><p>Build the encoder (for the labels) given the data metadata, and return the saved encoder path.
By default generate and save a <a class="reference internal" href="s3prl.dataio.encoder.html#s3prl.dataio.encoder.CategoryEncoder" title="s3prl.dataio.encoder.CategoryEncoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataio.encoder.CategoryEncoder</span></code></a> from the <code class="code docutils literal notranslate"><span class="pre">label</span></code> column of all the csv files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_encoder</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSID.default_config" title="s3prl.problem.SuperbSID.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Save your encoder into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>train_csv_path</strong> (<em>str</em>) – the train path from <a class="reference internal" href="#s3prl.problem.SuperbSID.prepare_data" title="s3prl.problem.SuperbSID.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>valid_csv_path</strong> (<em>str</em>) – the valid path from <a class="reference internal" href="#s3prl.problem.SuperbSID.prepare_data" title="s3prl.problem.SuperbSID.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>test_csv_paths</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – the test paths from <a class="reference internal" href="#s3prl.problem.SuperbSID.prepare_data" title="s3prl.problem.SuperbSID.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>str</p>
<p>encoder_path: The encoder should be saved in the pickle format</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSID.build_dataset">
<span class="sig-name descname"><span class="pre">build_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_shift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/common/superb_sid.html#SuperbSID.build_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/superb_sid.py#L244-L358"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSID.build_dataset" title="Permalink to this definition">#</a></dt>
<dd><p>Build the dataset for train/valid/test.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_dataset</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbSID.default_config" title="s3prl.problem.SuperbSID.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>. with <code class="code docutils literal notranslate"><span class="pre">train</span></code>, <code class="code docutils literal notranslate"><span class="pre">valid</span></code>, <code class="code docutils literal notranslate"><span class="pre">test</span></code> keys, each
is a dictionary with the following supported options:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>max_secs</p></td>
<td><p>(float) - If a waveform is longer than <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds, randomly crop the waveform into <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds</p></td>
</tr>
<tr class="row-odd"><td><p>sox_effects</p></td>
<td><p>(List[List[str]]) - If not None, apply sox effects on the utterance</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – The metadata csv file for the specific <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p></li>
<li><p><strong>encoder_path</strong> (<em>str</em>) – The pickled encoder path for encoding the labels</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch Dataset</p>
<p>For all train/valid/test mode, the dataset should return each item as a dictionary
containing the following keys:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>x</p></td>
<td><p>(torch.FloatTensor) - the waveform in (seq_len, 1)</p></td>
</tr>
<tr class="row-odd"><td><p>x_len</p></td>
<td><p>(int) - the waveform length <code class="code docutils literal notranslate"><span class="pre">seq_len</span></code></p></td>
</tr>
<tr class="row-even"><td><p>class_id</p></td>
<td><p>(int) - the encoded class id</p></td>
</tr>
<tr class="row-odd"><td><p>label</p></td>
<td><p>(str) - the class name</p></td>
</tr>
<tr class="row-even"><td><p>unique_name</p></td>
<td><p>(str) - the unique id for this datapoint</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSID.build_batch_sampler">
<span class="sig-name descname"><span class="pre">build_batch_sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/common/superb_sid.html#SuperbSID.build_batch_sampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/superb_sid.py#L360-L411"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSID.build_batch_sampler" title="Permalink to this definition">#</a></dt>
<dd><p>Return the batch sampler for torch DataLoader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_batch_sampler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbSID.default_config" title="s3prl.problem.SuperbSID.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>train</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>valid</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-even"><td><p>test</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">mode</span></code> specific csv from <a class="reference internal" href="#s3prl.problem.SuperbSID.prepare_data" title="s3prl.problem.SuperbSID.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>dataset</strong> – the dataset from <a class="reference internal" href="#s3prl.problem.SuperbSID.build_dataset" title="s3prl.problem.SuperbSID.build_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_dataset</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>batch sampler for torch DataLoader</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSID.build_downstream">
<span class="sig-name descname"><span class="pre">build_downstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/common/superb_sid.html#SuperbSID.build_downstream"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/superb_sid.py#L413-L436"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSID.build_downstream" title="Permalink to this definition">#</a></dt>
<dd><p>Return the task-specific downstream model.
By default build the <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code> model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSID.default_config" title="s3prl.problem.SuperbSID.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments of <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code></p></li>
<li><p><strong>downstream_input_size</strong> (<em>int</em>) – the required input size of the model</p></li>
<li><p><strong>downstream_output_size</strong> (<em>int</em>) – the required output size of the model</p></li>
<li><p><strong>downstream_input_stride</strong> (<em>int</em>) – the input feature’s stride (from 16 KHz)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUtteranceModel" title="s3prl.nn.interface.AbsUtteranceModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUtteranceModel</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSID.build_collate_fn">
<span class="sig-name descname"><span class="pre">build_collate_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L143-L156"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSID.build_collate_fn" title="Permalink to this definition">#</a></dt>
<dd><p>By default returns <code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataset.base.default_collate_fn</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_collate_fn</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSID.default_config" title="s3prl.problem.SuperbSID.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train, valid, or test</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>callable</p>
<p>the collate_fn for torch DataLoader in train/valid/test <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSID.build_featurizer">
<span class="sig-name descname"><span class="pre">build_featurizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upstream</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L175-L192"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSID.build_featurizer" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the featurizer with <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSID.default_config" title="s3prl.problem.SuperbSID.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p></li>
<li><p><strong>upstream</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">AbsUpstream</span></code>) – the upstream model built by <a class="reference internal" href="#s3prl.problem.SuperbSID.build_upstream" title="s3prl.problem.SuperbSID.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsFeaturizer" title="s3prl.nn.interface.AbsFeaturizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsFeaturizer</span></code></a></p>
<p>Return the featurizer model. The featurizer is used to reduce the multiple
hidden states returned from the upstream model (built by <a class="reference internal" href="#s3prl.problem.SuperbSID.build_upstream" title="s3prl.problem.SuperbSID.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>)
into a single hidden state, so can be easliy fed into the downstream model</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSID.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L194-L231"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSID.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>By default build model with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSID.default_config" title="s3prl.problem.SuperbSID.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p></li>
<li><p><strong>model_output_size</strong> (<em>int</em>) – the required model’s output hidden size</p></li>
<li><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSID.default_config" title="s3prl.problem.SuperbSID.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.SuperbSID.build_upstream" title="s3prl.problem.SuperbSID.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSID.default_config" title="s3prl.problem.SuperbSID.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.SuperbSID.build_featurizer" title="s3prl.problem.SuperbSID.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a></p></li>
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSID.default_config" title="s3prl.problem.SuperbSID.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.SuperbSID.build_downstream" title="s3prl.problem.SuperbSID.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch.nn.Module</p>
<p>Return the entire model for the task, which takes the direct items from DataLoader as the input.
Usually, the components can be built by <a class="reference internal" href="#s3prl.problem.SuperbSID.build_upstream" title="s3prl.problem.SuperbSID.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>, <a class="reference internal" href="#s3prl.problem.SuperbSID.build_featurizer" title="s3prl.problem.SuperbSID.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a>,
<a class="reference internal" href="#s3prl.problem.SuperbSID.build_downstream" title="s3prl.problem.SuperbSID.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a>, and are concated together to get the final model.
The upstream extracts multiple hidden states, the featuizer reduce them into a single hidden state,
and the downstream takes the hidden states as the feature for the downstream-specific model.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSID.build_optimizer">
<span class="sig-name descname"><span class="pre">build_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L233-L258"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSID.build_optimizer" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_optimizer</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbSID.default_config" title="s3prl.problem.SuperbSID.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to below</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the optimizer class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the optimizer class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;lr&quot;:</span> <span class="pre">1.0e-4}</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>parameters</strong> (<em>iterable</em>) – the standard params accepted by <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code></p>
<p>An optimizer following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSID.build_scheduler">
<span class="sig-name descname"><span class="pre">build_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L260-L285"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSID.build_scheduler" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_scheduler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbSID.default_config" title="s3prl.problem.SuperbSID.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the scheduler class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the scheduler class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;gamma&quot;:</span> <span class="pre">0.01}</span></code> for <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler.StepLR</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>optimizer</strong> – the standard torch optimizer accepted by Scheduler in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch scheduler</p>
<p>A scheduler following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSID.build_task">
<span class="sig-name descname"><span class="pre">build_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/run.py#L352-L375"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSID.build_task" title="Permalink to this definition">#</a></dt>
<dd><p>Build the task, which defines the logics for every train/valid/test forward step for the <code class="code docutils literal notranslate"><span class="pre">model</span></code>,
and the logics for how to reduce all the batch results from multiple train/valid/test steps into metrics</p>
<p>By default build <code class="xref py py-obj docutils literal notranslate"><span class="pre">UtteranceClassificationTask</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSID.default_config" title="s3prl.problem.SuperbSID.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model built by <a class="reference internal" href="#s3prl.problem.SuperbSID.build_model" title="s3prl.problem.SuperbSID.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a></p></li>
<li><p><strong>encoder</strong> – the encoder built by <a class="reference internal" href="#s3prl.problem.SuperbSID.build_encoder" title="s3prl.problem.SuperbSID.build_encoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_encoder</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Task</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSID.build_upstream">
<span class="sig-name descname"><span class="pre">build_upstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L158-L173"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSID.build_upstream" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the upstream with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSID.default_config" title="s3prl.problem.SuperbSID.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUpstream" title="s3prl.nn.interface.AbsUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUpstream</span></code></a></p>
<p>Return an upstream model, whose forward takes the waveform input and returns
multiple hidden states as features.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSID.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L660-L707"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSID.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>The evaluate routine used by <a class="reference internal" href="#s3prl.problem.SuperbSID.train" title="s3prl.problem.SuperbSID.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> (during validation phase) and <a class="reference internal" href="#s3prl.problem.SuperbSID.run" title="s3prl.problem.SuperbSID.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>
(during testing phase).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evaluate</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSID.default_config" title="s3prl.problem.SuperbSID.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSID.get_class_from_name">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_class_from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L129-L141"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSID.get_class_from_name" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">__name__</span></code> of the problem class</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Problem</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSID.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L752-L772"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSID.load_model" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model_ckpt_dir</strong> (<em>str</em>) – Restore the model with <a class="reference internal" href="#s3prl.problem.SuperbSID.build_model" title="s3prl.problem.SuperbSID.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> and the checkpoint
saved in this directory.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSID.load_model_and_task">
<span class="sig-name descname"><span class="pre">load_model_and_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ckpts_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L884-L902"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSID.load_model_and_task" title="Permalink to this definition">#</a></dt>
<dd><p>This is a helper method to combine <a class="reference internal" href="#s3prl.problem.SuperbSID.load_model" title="s3prl.problem.SuperbSID.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a> and <a class="reference internal" href="#s3prl.problem.SuperbSID.load_task" title="s3prl.problem.SuperbSID.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>
together to directly load the model and the task. This method assumes
the model is saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'model'</span></code> and the task is
saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'task'</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>model (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>)</p></li>
<li><p>task (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a>)</p></li>
</ol>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSID.load_task">
<span class="sig-name descname"><span class="pre">load_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L833-L882"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSID.load_task" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – Restore the task with <a class="reference internal" href="#s3prl.problem.SuperbSID.build_task" title="s3prl.problem.SuperbSID.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> and the checkpoint
saved in this directory.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model for the task, since the model is separately saved
and is required for <a class="reference internal" href="#s3prl.problem.SuperbSID.build_task" title="s3prl.problem.SuperbSID.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a>.</p></li>
<li><p><strong>task_overrides</strong> (<em>dict</em>) – overrides the saved initialization arguments, so can change
the loaded task’s behavior. Like, change the decoding hyperparameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSID.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L954-L995"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSID.main" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSID.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_all_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cuda'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/run.py#L26-L318"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSID.run" title="Permalink to this definition">#</a></dt>
<dd><div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>stage</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Parse the corpus and save the metadata file (waveform path, label…)</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Build the encoder to encode the labels</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Train the model</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Evaluate the model on multiple test sets</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_dir</strong> (<em>str</em>) – The directory that stores the script result.</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – The directory that caches the processed data.
Default: /home/user/.cache/s3prl/data</p></li>
<li><p><strong>remove_all_cache</strong> (<em>bool</em>) – Whether to remove all the cache stored under <cite>cache_dir</cite>.
Default: False</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting stage of the problem script.
Default: 0</p></li>
<li><p><strong>stop</strong> (<em>int</em>) – The stoping stage of the problem script, set <cite>None</cite> to reach the final stage.
Default: None</p></li>
<li><p><strong>num_workers</strong> (<em>int</em>) – num_workers for all the torch DataLoder</p></li>
<li><p><strong>eval_batch</strong> (<em>int</em>) – During evaluation (valid or test), limit the number of batch.
This is helpful for the fast development to check everything won’t crash.
If is -1, disable this feature and evaluate the entire epoch.
Default: -1</p></li>
<li><p><strong>device</strong> (<em>str</em>) – The device type for all torch-related operation: “cpu” or “cuda”
Default: “cuda”</p></li>
<li><p><strong>world_size</strong> (<em>int</em>) – How many processes are running this script simultaneously (in parallel).
Usually this is just 1, however if you are runnig distributed training,
this should be &gt; 1.
Default: 1</p></li>
<li><p><strong>rank</strong> (<em>int</em>) – When distributed training, world_size &gt; 1. Take <code class="code docutils literal notranslate"><span class="pre">world_size</span> <span class="pre">==</span> <span class="pre">8</span></code> for
example, this means 8 processes (8 GPUs) are runing in parallel. The script
needs to know which process among 8 processes it is. In this case, <code class="code docutils literal notranslate"><span class="pre">rank</span></code>
can range from 0~7. All the 8 processes have the same <code class="code docutils literal notranslate"><span class="pre">world_size</span></code> but
different <code class="code docutils literal notranslate"><span class="pre">rank</span></code> (process id).</p></li>
<li><p><strong>test_ckpt_dir</strong> (<em>str</em>) – Specify the checkpoint path for testing. If not, use the validation best
checkpoint under the given <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> directory.</p></li>
<li><p><strong>**kwds</strong> – The other arguments like <code class="code docutils literal notranslate"><span class="pre">prepare_data</span></code> and <code class="code docutils literal notranslate"><span class="pre">build_model</span></code> are
method specific-arguments for methods like <a class="reference internal" href="#s3prl.problem.SuperbSID.prepare_data" title="s3prl.problem.SuperbSID.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> and
<a class="reference internal" href="#s3prl.problem.SuperbSID.build_model" title="s3prl.problem.SuperbSID.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>, and will not be used in the core <a class="reference internal" href="#s3prl.problem.SuperbSID.run" title="s3prl.problem.SuperbSID.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> logic.
See the specific method documentation for their supported arguments and
meaning</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSID.save_model">
<span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L709-L750"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSID.save_model" title="Permalink to this definition">#</a></dt>
<dd><p>Save the model state_dict and the model initialization arguments into the given directory.
If you override this method, it is highly possible you also need to override <a class="reference internal" href="#s3prl.problem.SuperbSID.load_model" title="s3prl.problem.SuperbSID.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSID.default_config" title="s3prl.problem.SuperbSID.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_model</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>model_ckpt_dir</strong> (<em>str</em>) – save the model into the this directory.</p></li>
<li><p><strong>build_model_all_args</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.SuperbSID.build_model" title="s3prl.problem.SuperbSID.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>.
By saving this dictionary, you can easily reconstruct the same model
by calling <a class="reference internal" href="#s3prl.problem.SuperbSID.build_model" title="s3prl.problem.SuperbSID.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSID.save_task">
<span class="sig-name descname"><span class="pre">save_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="s3prl.task.base.html#s3prl.task.base.Task" title="s3prl.task.base.Task"><span class="pre">Task</span></a></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L774-L831"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSID.save_task" title="Permalink to this definition">#</a></dt>
<dd><p>Save the task’s state, <code class="code docutils literal notranslate"><span class="pre">task.get_state()</span></code>, and the initialization arguments into the given
directory. If you override this method, it is highly possible you also need to override
<a class="reference internal" href="#s3prl.problem.SuperbSID.load_task" title="s3prl.problem.SuperbSID.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSID.default_config" title="s3prl.problem.SuperbSID.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_task</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – save the task into this directory.</p></li>
<li><p><strong>build_task_all_args_except_model</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.SuperbSID.build_task" title="s3prl.problem.SuperbSID.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> except
the <code class="code docutils literal notranslate"><span class="pre">model</span></code> argument since the model should be sapartely saved by
<a class="reference internal" href="#s3prl.problem.SuperbSID.save_model" title="s3prl.problem.SuperbSID.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a>. By saving this dictionary, you can easily reconstruct the same task
by calling <a class="reference internal" href="#s3prl.problem.SuperbSID.build_task" title="s3prl.problem.SuperbSID.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>task</strong> (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><em>Task</em></a>) – the task to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSID.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L287-L658"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSID.train" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbSID.default_config" title="s3prl.problem.SuperbSID.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>total_steps</p></td>
<td><p>(int) - the total optimization steps</p></td>
</tr>
<tr class="row-odd"><td><p>log_step</p></td>
<td><p>(int) - logging frequency. log every <code class="code docutils literal notranslate"><span class="pre">log_step</span></code> step</p></td>
</tr>
<tr class="row-even"><td><p>eval_step</p></td>
<td><p>(int) - evaluation frequency. Evaluate every <code class="code docutils literal notranslate"><span class="pre">eval_step</span></code> step.                                                 Note that you can control how many batch to evaluate to speed up the                                                 development by the <code class="code docutils literal notranslate"><span class="pre">eval_batch</span></code> argument in <a class="reference internal" href="#s3prl.problem.SuperbSID.run" title="s3prl.problem.SuperbSID.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>save_step</p></td>
<td><p>(int) - save the checkpoint every <code class="code docutils literal notranslate"><span class="pre">save_step</span></code> step.</p></td>
</tr>
<tr class="row-even"><td><p>gradient_clipping</p></td>
<td><p>(float) - clip the gradient. important for RNNs.</p></td>
</tr>
<tr class="row-odd"><td><p>gradient_accumulate</p></td>
<td><p>(int) - accumulate multiple steps’ gradient before updating network parameters                                                 to simulate large-batch optimization.</p></td>
</tr>
<tr class="row-even"><td><p>valid_metric</p></td>
<td><p>(str) - the metric to select the best valid checkpoint. Different Tasks have different                                                 supported valid_metrics. See <a class="reference internal" href="#s3prl.problem.SuperbSID.build_task" title="s3prl.problem.SuperbSID.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> for the supported metrics.</p></td>
</tr>
<tr class="row-odd"><td><p>valid_higher_better</p></td>
<td><p>(bool) - some metrics are higher better, while some are lower better                                                 this will affect how to save the best validation checkpoint.</p></td>
</tr>
<tr class="row-even"><td><p>auto_resume</p></td>
<td><p>(bool) - if there are already the last checkpoint in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.SuperbSID.run" title="s3prl.problem.SuperbSID.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>),                                                 whether to resume from it or delete it and start a new training session.</p></td>
</tr>
<tr class="row-odd"><td><p>resume_ckpt_dir</p></td>
<td><p>(str) - you can directly specify the checkpoint path to resume which is not necessary                                                 in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.SuperbSID.run" title="s3prl.problem.SuperbSID.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>).</p></td>
</tr>
<tr class="row-even"><td><p>seed</p></td>
<td><p>(int) - fix the seed before the training start</p></td>
</tr>
<tr class="row-odd"><td><p>keep_num_ckpts</p></td>
<td><p>(int) - to prevent saving too many checkpoints, only save the <code class="code docutils literal notranslate"><span class="pre">keep_num_ckpts</span></code>                                                 latest checkpoints and delete the old ones.</p></td>
</tr>
<tr class="row-even"><td><p>use_scheduler</p></td>
<td><p>(bool) - whether to use the scheduler</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="superbsd">
<h2>SuperbSD<a class="headerlink" href="#superbsd" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSD">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">s3prl.problem.</span></span><span class="sig-name descname"><span class="pre">SuperbSD</span></span><a class="reference internal" href="../_modules/s3prl/problem/diarization/superb_sd.html#SuperbSD"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/diarization/superb_sd.py#L26-L302"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSD" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="s3prl.problem.diarization.run.html#s3prl.problem.diarization.run.Diarization" title="s3prl.problem.diarization.run.Diarization"><code class="xref py py-class docutils literal notranslate"><span class="pre">Diarization</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSD.default_config">
<span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/diarization/superb_sd.html#SuperbSD.default_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/diarization/superb_sd.py#L27-L99"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSD.default_config" title="Permalink to this definition">#</a></dt>
<dd><p>The default arguments for <a class="reference internal" href="#s3prl.problem.SuperbSD.run" title="s3prl.problem.SuperbSD.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> in yaml.
Note that for the fields with inner values, like <code class="code docutils literal notranslate"><span class="pre">build_model</span></code>,
the outer field name corresponds to a method name, so you can find the method
<a class="reference internal" href="#s3prl.problem.SuperbSD.build_model" title="s3prl.problem.SuperbSD.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>. Furthermore, the values inside that field will be
directly passed into the method. So by changing these inner values, you
can directly affect the behavior of the corresponding method. See the method
documentation for all the supported arguments and their meanings.</p>
<p>The methods affected by the following config are: <a class="reference internal" href="#s3prl.problem.SuperbSD.prepare_data" title="s3prl.problem.SuperbSD.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSD.build_dataset" title="s3prl.problem.SuperbSD.build_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_dataset</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSD.build_batch_sampler" title="s3prl.problem.SuperbSD.build_batch_sampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_batch_sampler</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSD.build_upstream" title="s3prl.problem.SuperbSD.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSD.build_featurizer" title="s3prl.problem.SuperbSD.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSD.build_downstream" title="s3prl.problem.SuperbSD.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSD.build_model" title="s3prl.problem.SuperbSD.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSD.build_optimizer" title="s3prl.problem.SuperbSD.build_optimizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_optimizer</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSD.build_scheduler" title="s3prl.problem.SuperbSD.build_scheduler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_scheduler</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSD.save_model" title="s3prl.problem.SuperbSD.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSD.save_task" title="s3prl.problem.SuperbSD.save_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_task</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSD.train" title="s3prl.problem.SuperbSD.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> <a class="reference internal" href="#s3prl.problem.SuperbSD.scoring" title="s3prl.problem.SuperbSD.scoring"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scoring</span></code></a></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">start</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="nt">stop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">target_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">cache_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">remove_all_cache</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">prepare_data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">data_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">build_dataset</span><span class="p">:</span>
<span class="w">  </span><span class="nt">chunk_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2000</span>
<span class="w">  </span><span class="nt">subsampling</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">rate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">16000</span>
<span class="w">  </span><span class="nt">use_last_samples</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">label_delay</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="nt">build_batch_sampler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">train</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8</span>
<span class="w">    </span><span class="nt">shuffle</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">valid</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="nt">build_upstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">build_featurizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">layer_selections</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="nt">normalize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_downstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">hidden_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">512</span>
<span class="w">  </span><span class="nt">rnn_layers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="nt">build_model</span><span class="p">:</span>
<span class="w">  </span><span class="nt">upstream_trainable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_optimizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Adam</span>
<span class="w">  </span><span class="nt">conf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">lr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0001</span>
<span class="nt">build_scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ExponentialLR</span>
<span class="w">  </span><span class="nt">gamma</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.9</span>
<span class="nt">save_model</span><span class="p">:</span>
<span class="w">  </span><span class="nt">extra_conf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">build_downstream_conf</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">${build_downstream}</span>
<span class="nt">save_task</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">train</span><span class="p">:</span>
<span class="w">  </span><span class="nt">total_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">30000</span>
<span class="w">  </span><span class="nt">log_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">500</span>
<span class="w">  </span><span class="nt">eval_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">500</span>
<span class="w">  </span><span class="nt">save_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">500</span>
<span class="w">  </span><span class="nt">gradient_clipping</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0</span>
<span class="w">  </span><span class="nt">gradient_accumulate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span>
<span class="w">  </span><span class="nt">valid_metric</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">der</span>
<span class="w">  </span><span class="nt">valid_higher_better</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">  </span><span class="nt">auto_resume</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">resume_ckpt_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">scoring</span><span class="p">:</span>
<span class="w">  </span><span class="nt">thresholds</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.3</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.4</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.5</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.6</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.7</span>
<span class="w">  </span><span class="nt">median_filters</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">11</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSD.prepare_data">
<span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/diarization/superb_sd.html#SuperbSD.prepare_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/diarization/superb_sd.py#L101-L166"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSD.prepare_data" title="Permalink to this definition">#</a></dt>
<dd><p>Prepare the task-specific data metadata (path, labels…).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prepare_data</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbSD.default_config" title="s3prl.problem.SuperbSD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>data_dir</p></td>
<td><p>(str) - the standard Kaldi data directory</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Parse your corpus and save the csv file into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the parsing or preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>train_path (str)</p></li>
<li><p>valid_path (str)</p></li>
<li><p>test_paths (List[str])</p></li>
</ol>
<p>Each path (str) should be a csv file containing the following columns:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>column</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>record_id</p></td>
<td><p>(str) - the id for the recording</p></td>
</tr>
<tr class="row-odd"><td><p>duration</p></td>
<td><p>(float) - the total seconds of the recording</p></td>
</tr>
<tr class="row-even"><td><p>wav_path</p></td>
<td><p>(str) - the absolute path of the recording</p></td>
</tr>
<tr class="row-odd"><td><p>utt_id</p></td>
<td><p>(str) - the id for the segmented utterance, should be                                     globally unique across all recordings instead of just                                     unique in a recording</p></td>
</tr>
<tr class="row-even"><td><p>speaker</p></td>
<td><p>(str) - the speaker label for the segmented utterance</p></td>
</tr>
<tr class="row-odd"><td><p>start_sec</p></td>
<td><p>(float) - segment start second in the recording</p></td>
</tr>
<tr class="row-even"><td><p>end_sec</p></td>
<td><p>(float) - segment end second in the recording</p></td>
</tr>
</tbody>
</table>
</div>
<p>Instead of one waveform file per row, the above file format is one segment per row,
and a waveform file can have multiple overlapped segments uttered by different speakers.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSD.build_dataset">
<span class="sig-name descname"><span class="pre">build_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_speakers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_shift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/diarization/superb_sd.html#SuperbSD.build_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/diarization/superb_sd.py#L168-L223"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSD.build_dataset" title="Permalink to this definition">#</a></dt>
<dd><p>Build the dataset for train/valid/test.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_dataset</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSD.default_config" title="s3prl.problem.SuperbSD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, supports arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">DiarizationDataset</span></code></p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – The metadata csv file for the specific <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p></li>
<li><p><strong>data_dir</strong> (<em>str</em>) – The converted kaldi data directory from <code class="code docutils literal notranslate"><span class="pre">data_csv</span></code></p></li>
<li><p><strong>num_speakers</strong> (<em>int</em>) – The number of speaker per utterance</p></li>
<li><p><strong>frame_shift</strong> (<em>int</em>) – The frame shift of the upstream model (downsample rate from 16 KHz)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch Dataset</p>
<p>For all train/valid/test mode, the dataset should return each item as a dictionary
containing the following keys:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>x</p></td>
<td><p>(torch.FloatTensor) - the waveform in (seq_len, 1)</p></td>
</tr>
<tr class="row-odd"><td><p>x_len</p></td>
<td><p>(int) - the waveform length <code class="code docutils literal notranslate"><span class="pre">seq_len</span></code></p></td>
</tr>
<tr class="row-even"><td><p>label</p></td>
<td><p>(torch.LongTensor) - the binary label for each upstream frame,                                     shape: <code class="code docutils literal notranslate"><span class="pre">(upstream_len,</span> <span class="pre">2)</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>label_len</p></td>
<td><p>(int) - the upstream feature’s seq length <code class="code docutils literal notranslate"><span class="pre">upstream_len</span></code></p></td>
</tr>
<tr class="row-even"><td><p>record_id</p></td>
<td><p>(str) - the unique id for the recording</p></td>
</tr>
<tr class="row-odd"><td><p>chunk_id</p></td>
<td><p>(int) - since recording can be chunked into several segments                                     for efficient training, this field indicate the segment’s                                     original position (order, 0-index) in the recording. This                                     field is only useful during the testing stage</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSD.build_batch_sampler">
<span class="sig-name descname"><span class="pre">build_batch_sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/diarization/superb_sd.html#SuperbSD.build_batch_sampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/diarization/superb_sd.py#L225-L278"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSD.build_batch_sampler" title="Permalink to this definition">#</a></dt>
<dd><p>Return the batch sampler for torch DataLoader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_batch_sampler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbSD.default_config" title="s3prl.problem.SuperbSD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>train</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>valid</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-even"><td><p>test</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">GroupSameItemSampler</span></code>, should always                                         use this batch sampler for the testing stage</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – The metadata csv file for the specific <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p></li>
<li><p><strong>data_dir</strong> (<em>str</em>) – The converted kaldi data directory from <code class="code docutils literal notranslate"><span class="pre">data_csv</span></code></p></li>
<li><p><strong>dataset</strong> – the dataset from <a class="reference internal" href="#s3prl.problem.SuperbSD.build_dataset" title="s3prl.problem.SuperbSD.build_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_dataset</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>batch sampler for torch DataLoader</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSD.build_downstream">
<span class="sig-name descname"><span class="pre">build_downstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/diarization/superb_sd.html#SuperbSD.build_downstream"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/diarization/superb_sd.py#L280-L302"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSD.build_downstream" title="Permalink to this definition">#</a></dt>
<dd><p>Return the task-specific downstream model.
By default build the <code class="xref py py-obj docutils literal notranslate"><span class="pre">SuperbDiarizationModel</span></code> model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSD.default_config" title="s3prl.problem.SuperbSD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments of <code class="xref py py-obj docutils literal notranslate"><span class="pre">SuperbDiarizationModel</span></code></p></li>
<li><p><strong>downstream_input_size</strong> (<em>int</em>) – the required input size of the model</p></li>
<li><p><strong>downstream_output_size</strong> (<em>int</em>) – the required output size of the model</p></li>
<li><p><strong>downstream_input_stride</strong> (<em>int</em>) – the input feature’s stride (from 16 KHz)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsFrameModel" title="s3prl.nn.interface.AbsFrameModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsFrameModel</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSD.build_collate_fn">
<span class="sig-name descname"><span class="pre">build_collate_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L143-L156"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSD.build_collate_fn" title="Permalink to this definition">#</a></dt>
<dd><p>By default returns <code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataset.base.default_collate_fn</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_collate_fn</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSD.default_config" title="s3prl.problem.SuperbSD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train, valid, or test</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>callable</p>
<p>the collate_fn for torch DataLoader in train/valid/test <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSD.build_featurizer">
<span class="sig-name descname"><span class="pre">build_featurizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upstream</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L175-L192"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSD.build_featurizer" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the featurizer with <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSD.default_config" title="s3prl.problem.SuperbSD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p></li>
<li><p><strong>upstream</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">AbsUpstream</span></code>) – the upstream model built by <a class="reference internal" href="#s3prl.problem.SuperbSD.build_upstream" title="s3prl.problem.SuperbSD.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsFeaturizer" title="s3prl.nn.interface.AbsFeaturizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsFeaturizer</span></code></a></p>
<p>Return the featurizer model. The featurizer is used to reduce the multiple
hidden states returned from the upstream model (built by <a class="reference internal" href="#s3prl.problem.SuperbSD.build_upstream" title="s3prl.problem.SuperbSD.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>)
into a single hidden state, so can be easliy fed into the downstream model</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSD.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L194-L231"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSD.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>By default build model with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSD.default_config" title="s3prl.problem.SuperbSD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p></li>
<li><p><strong>model_output_size</strong> (<em>int</em>) – the required model’s output hidden size</p></li>
<li><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSD.default_config" title="s3prl.problem.SuperbSD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.SuperbSD.build_upstream" title="s3prl.problem.SuperbSD.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSD.default_config" title="s3prl.problem.SuperbSD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.SuperbSD.build_featurizer" title="s3prl.problem.SuperbSD.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a></p></li>
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSD.default_config" title="s3prl.problem.SuperbSD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.SuperbSD.build_downstream" title="s3prl.problem.SuperbSD.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch.nn.Module</p>
<p>Return the entire model for the task, which takes the direct items from DataLoader as the input.
Usually, the components can be built by <a class="reference internal" href="#s3prl.problem.SuperbSD.build_upstream" title="s3prl.problem.SuperbSD.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>, <a class="reference internal" href="#s3prl.problem.SuperbSD.build_featurizer" title="s3prl.problem.SuperbSD.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a>,
<a class="reference internal" href="#s3prl.problem.SuperbSD.build_downstream" title="s3prl.problem.SuperbSD.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a>, and are concated together to get the final model.
The upstream extracts multiple hidden states, the featuizer reduce them into a single hidden state,
and the downstream takes the hidden states as the feature for the downstream-specific model.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSD.build_optimizer">
<span class="sig-name descname"><span class="pre">build_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L233-L258"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSD.build_optimizer" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_optimizer</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbSD.default_config" title="s3prl.problem.SuperbSD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to below</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the optimizer class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the optimizer class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;lr&quot;:</span> <span class="pre">1.0e-4}</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>parameters</strong> (<em>iterable</em>) – the standard params accepted by <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code></p>
<p>An optimizer following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSD.build_scheduler">
<span class="sig-name descname"><span class="pre">build_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L260-L285"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSD.build_scheduler" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_scheduler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbSD.default_config" title="s3prl.problem.SuperbSD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the scheduler class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the scheduler class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;gamma&quot;:</span> <span class="pre">0.01}</span></code> for <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler.StepLR</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>optimizer</strong> – the standard torch optimizer accepted by Scheduler in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch scheduler</p>
<p>A scheduler following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSD.build_task">
<span class="sig-name descname"><span class="pre">build_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/diarization/run.py#L414-L429"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSD.build_task" title="Permalink to this definition">#</a></dt>
<dd><p>Build the task, which defines the logics for every train/valid/test forward step for the <code class="code docutils literal notranslate"><span class="pre">model</span></code>,
and the logics for how to reduce all the batch results from multiple train/valid/test steps into metrics</p>
<p>By default build <code class="xref py py-obj docutils literal notranslate"><span class="pre">DiarizationPIT</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSD.default_config" title="s3prl.problem.SuperbSD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model built by <a class="reference internal" href="#s3prl.problem.SuperbSD.build_model" title="s3prl.problem.SuperbSD.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Task</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSD.build_upstream">
<span class="sig-name descname"><span class="pre">build_upstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L158-L173"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSD.build_upstream" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the upstream with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSD.default_config" title="s3prl.problem.SuperbSD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUpstream" title="s3prl.nn.interface.AbsUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUpstream</span></code></a></p>
<p>Return an upstream model, whose forward takes the waveform input and returns
multiple hidden states as features.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSD.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L660-L707"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSD.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>The evaluate routine used by <a class="reference internal" href="#s3prl.problem.SuperbSD.train" title="s3prl.problem.SuperbSD.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> (during validation phase) and <a class="reference internal" href="#s3prl.problem.SuperbSD.run" title="s3prl.problem.SuperbSD.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>
(during testing phase).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evaluate</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSD.default_config" title="s3prl.problem.SuperbSD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSD.get_class_from_name">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_class_from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L129-L141"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSD.get_class_from_name" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">__name__</span></code> of the problem class</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Problem</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSD.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L752-L772"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSD.load_model" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model_ckpt_dir</strong> (<em>str</em>) – Restore the model with <a class="reference internal" href="#s3prl.problem.SuperbSD.build_model" title="s3prl.problem.SuperbSD.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> and the checkpoint
saved in this directory.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSD.load_model_and_task">
<span class="sig-name descname"><span class="pre">load_model_and_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ckpts_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L884-L902"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSD.load_model_and_task" title="Permalink to this definition">#</a></dt>
<dd><p>This is a helper method to combine <a class="reference internal" href="#s3prl.problem.SuperbSD.load_model" title="s3prl.problem.SuperbSD.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a> and <a class="reference internal" href="#s3prl.problem.SuperbSD.load_task" title="s3prl.problem.SuperbSD.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>
together to directly load the model and the task. This method assumes
the model is saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'model'</span></code> and the task is
saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'task'</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>model (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>)</p></li>
<li><p>task (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a>)</p></li>
</ol>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSD.load_task">
<span class="sig-name descname"><span class="pre">load_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L833-L882"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSD.load_task" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – Restore the task with <a class="reference internal" href="#s3prl.problem.SuperbSD.build_task" title="s3prl.problem.SuperbSD.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> and the checkpoint
saved in this directory.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model for the task, since the model is separately saved
and is required for <a class="reference internal" href="#s3prl.problem.SuperbSD.build_task" title="s3prl.problem.SuperbSD.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a>.</p></li>
<li><p><strong>task_overrides</strong> (<em>dict</em>) – overrides the saved initialization arguments, so can change
the loaded task’s behavior. Like, change the decoding hyperparameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSD.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L954-L995"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSD.main" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSD.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_all_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cuda'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_speaker</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scoring</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/diarization/run.py#L27-L319"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSD.run" title="Permalink to this definition">#</a></dt>
<dd><div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>stage</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Parse the corpus and save the Kaldi-style data directory for speaker diarization</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Train the model</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Inference the prediction</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Score the prediction</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_dir</strong> (<em>str</em>) – The directory that stores the script result.</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – The directory that caches the processed data.
Default: /home/user/.cache/s3prl/data</p></li>
<li><p><strong>remove_all_cache</strong> (<em>bool</em>) – Whether to remove all the cache stored under <cite>cache_dir</cite>.
Default: False</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting stage of the problem script.
Default: 0</p></li>
<li><p><strong>stop</strong> (<em>int</em>) – The stoping stage of the problem script, set <cite>None</cite> to reach the final stage.
Default: None</p></li>
<li><p><strong>num_workers</strong> (<em>int</em>) – num_workers for all the torch DataLoder</p></li>
<li><p><strong>eval_batch</strong> (<em>int</em>) – During evaluation (valid or test), limit the number of batch.
This is helpful for the fast development to check everything won’t crash.
If is -1, disable this feature and evaluate the entire epoch.
Default: -1</p></li>
<li><p><strong>device</strong> (<em>str</em>) – The device type for all torch-related operation: “cpu” or “cuda”
Default: “cuda”</p></li>
<li><p><strong>world_size</strong> (<em>int</em>) – How many processes are running this script simultaneously (in parallel).
Usually this is just 1, however if you are runnig distributed training,
this should be &gt; 1.
Default: 1</p></li>
<li><p><strong>rank</strong> (<em>int</em>) – When distributed training, world_size &gt; 1. Take <code class="code docutils literal notranslate"><span class="pre">world_size</span> <span class="pre">==</span> <span class="pre">8</span></code> for
example, this means 8 processes (8 GPUs) are runing in parallel. The script
needs to know which process among 8 processes it is. In this case, <code class="code docutils literal notranslate"><span class="pre">rank</span></code>
can range from 0~7. All the 8 processes have the same <code class="code docutils literal notranslate"><span class="pre">world_size</span></code> but
different <code class="code docutils literal notranslate"><span class="pre">rank</span></code> (process id).</p></li>
<li><p><strong>test_ckpt_dir</strong> (<em>str</em>) – Specify the checkpoint path for testing. If not, use checkpoints specified by
<code class="code docutils literal notranslate"><span class="pre">test_ckpts_steps</span></code>.</p></li>
<li><p><strong>num_speaker</strong> (<em>int</em>) – How many speakers per utterance</p></li>
<li><p><strong>**others</strong> – The other arguments like <code class="code docutils literal notranslate"><span class="pre">prepare_data</span></code> and <code class="code docutils literal notranslate"><span class="pre">build_model</span></code> are
method specific-arguments for methods like <a class="reference internal" href="#s3prl.problem.SuperbSD.prepare_data" title="s3prl.problem.SuperbSD.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> and
<a class="reference internal" href="#s3prl.problem.SuperbSD.build_model" title="s3prl.problem.SuperbSD.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>, and will not be used in the core <a class="reference internal" href="#s3prl.problem.SuperbSD.run" title="s3prl.problem.SuperbSD.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> logic.
See the specific method documentation for their supported arguments and
meaning</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSD.save_model">
<span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L709-L750"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSD.save_model" title="Permalink to this definition">#</a></dt>
<dd><p>Save the model state_dict and the model initialization arguments into the given directory.
If you override this method, it is highly possible you also need to override <a class="reference internal" href="#s3prl.problem.SuperbSD.load_model" title="s3prl.problem.SuperbSD.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSD.default_config" title="s3prl.problem.SuperbSD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_model</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>model_ckpt_dir</strong> (<em>str</em>) – save the model into the this directory.</p></li>
<li><p><strong>build_model_all_args</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.SuperbSD.build_model" title="s3prl.problem.SuperbSD.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>.
By saving this dictionary, you can easily reconstruct the same model
by calling <a class="reference internal" href="#s3prl.problem.SuperbSD.build_model" title="s3prl.problem.SuperbSD.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSD.save_task">
<span class="sig-name descname"><span class="pre">save_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="s3prl.task.base.html#s3prl.task.base.Task" title="s3prl.task.base.Task"><span class="pre">Task</span></a></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L774-L831"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSD.save_task" title="Permalink to this definition">#</a></dt>
<dd><p>Save the task’s state, <code class="code docutils literal notranslate"><span class="pre">task.get_state()</span></code>, and the initialization arguments into the given
directory. If you override this method, it is highly possible you also need to override
<a class="reference internal" href="#s3prl.problem.SuperbSD.load_task" title="s3prl.problem.SuperbSD.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.SuperbSD.default_config" title="s3prl.problem.SuperbSD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_task</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – save the task into this directory.</p></li>
<li><p><strong>build_task_all_args_except_model</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.SuperbSD.build_task" title="s3prl.problem.SuperbSD.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> except
the <code class="code docutils literal notranslate"><span class="pre">model</span></code> argument since the model should be sapartely saved by
<a class="reference internal" href="#s3prl.problem.SuperbSD.save_model" title="s3prl.problem.SuperbSD.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a>. By saving this dictionary, you can easily reconstruct the same task
by calling <a class="reference internal" href="#s3prl.problem.SuperbSD.build_task" title="s3prl.problem.SuperbSD.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>task</strong> (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><em>Task</em></a>) – the task to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSD.scoring">
<span class="sig-name descname"><span class="pre">scoring</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scoring</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_dirs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_rttms</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_shift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/diarization/run.py#L321-L377"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSD.scoring" title="Permalink to this definition">#</a></dt>
<dd><p>Score the prediction</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scoring</strong> (<em>dict</em>) – <div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>thresholds</p></td>
<td><p>(List[int]) - Given the 0~1 (float) soft prediction, the threshold decides                                         how to get the 0/1 hard prediction. This list are all the thresholds to try.</p></td>
</tr>
<tr class="row-odd"><td><p>median_filters</p></td>
<td><p>(List[int]) - After getting hard prediction, use median filter to smooth out the                                         prediction. This list are all the median filter sizes to try.</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>*others</strong> – This method is not designed to be overridden</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.SuperbSD.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L287-L658"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.SuperbSD.train" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.SuperbSD.default_config" title="s3prl.problem.SuperbSD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>total_steps</p></td>
<td><p>(int) - the total optimization steps</p></td>
</tr>
<tr class="row-odd"><td><p>log_step</p></td>
<td><p>(int) - logging frequency. log every <code class="code docutils literal notranslate"><span class="pre">log_step</span></code> step</p></td>
</tr>
<tr class="row-even"><td><p>eval_step</p></td>
<td><p>(int) - evaluation frequency. Evaluate every <code class="code docutils literal notranslate"><span class="pre">eval_step</span></code> step.                                                 Note that you can control how many batch to evaluate to speed up the                                                 development by the <code class="code docutils literal notranslate"><span class="pre">eval_batch</span></code> argument in <a class="reference internal" href="#s3prl.problem.SuperbSD.run" title="s3prl.problem.SuperbSD.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>save_step</p></td>
<td><p>(int) - save the checkpoint every <code class="code docutils literal notranslate"><span class="pre">save_step</span></code> step.</p></td>
</tr>
<tr class="row-even"><td><p>gradient_clipping</p></td>
<td><p>(float) - clip the gradient. important for RNNs.</p></td>
</tr>
<tr class="row-odd"><td><p>gradient_accumulate</p></td>
<td><p>(int) - accumulate multiple steps’ gradient before updating network parameters                                                 to simulate large-batch optimization.</p></td>
</tr>
<tr class="row-even"><td><p>valid_metric</p></td>
<td><p>(str) - the metric to select the best valid checkpoint. Different Tasks have different                                                 supported valid_metrics. See <a class="reference internal" href="#s3prl.problem.SuperbSD.build_task" title="s3prl.problem.SuperbSD.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> for the supported metrics.</p></td>
</tr>
<tr class="row-odd"><td><p>valid_higher_better</p></td>
<td><p>(bool) - some metrics are higher better, while some are lower better                                                 this will affect how to save the best validation checkpoint.</p></td>
</tr>
<tr class="row-even"><td><p>auto_resume</p></td>
<td><p>(bool) - if there are already the last checkpoint in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.SuperbSD.run" title="s3prl.problem.SuperbSD.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>),                                                 whether to resume from it or delete it and start a new training session.</p></td>
</tr>
<tr class="row-odd"><td><p>resume_ckpt_dir</p></td>
<td><p>(str) - you can directly specify the checkpoint path to resume which is not necessary                                                 in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.SuperbSD.run" title="s3prl.problem.SuperbSD.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>).</p></td>
</tr>
<tr class="row-even"><td><p>seed</p></td>
<td><p>(int) - fix the seed before the training start</p></td>
</tr>
<tr class="row-odd"><td><p>keep_num_ckpts</p></td>
<td><p>(int) - to prevent saving too many checkpoints, only save the <code class="code docutils literal notranslate"><span class="pre">keep_num_ckpts</span></code>                                                 latest checkpoints and delete the old ones.</p></td>
</tr>
<tr class="row-even"><td><p>use_scheduler</p></td>
<td><p>(bool) - whether to use the scheduler</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="hearfsd">
<h2>HearFSD<a class="headerlink" href="#hearfsd" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="s3prl.problem.HearFSD">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">s3prl.problem.</span></span><span class="sig-name descname"><span class="pre">HearFSD</span></span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_fsd.html#HearFSD"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L63-L250"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearFSD" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="s3prl.problem.common.superb_sid.html#s3prl.problem.common.superb_sid.SuperbSID" title="s3prl.problem.common.superb_sid.SuperbSID"><code class="xref py py-class docutils literal notranslate"><span class="pre">SuperbSID</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearFSD.default_config">
<span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_fsd.html#HearFSD.default_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L64-L129"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearFSD.default_config" title="Permalink to this definition">#</a></dt>
<dd><p>The default arguments for <a class="reference internal" href="#s3prl.problem.HearFSD.run" title="s3prl.problem.HearFSD.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> in yaml.
Note that for the fields with inner values, like <code class="code docutils literal notranslate"><span class="pre">build_model</span></code>,
the outer field name corresponds to a method name, so you can find the method
<a class="reference internal" href="#s3prl.problem.HearFSD.build_model" title="s3prl.problem.HearFSD.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>. Furthermore, the values inside that field will be
directly passed into the method. So by changing these inner values, you
can directly affect the behavior of the corresponding method. See the method
documentation for all the supported arguments and their meanings.</p>
<p>The methods affected by the following config are: <a class="reference internal" href="#s3prl.problem.HearFSD.prepare_data" title="s3prl.problem.HearFSD.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> <a class="reference internal" href="#s3prl.problem.HearFSD.build_batch_sampler" title="s3prl.problem.HearFSD.build_batch_sampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_batch_sampler</span></code></a> <a class="reference internal" href="#s3prl.problem.HearFSD.build_upstream" title="s3prl.problem.HearFSD.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a> <a class="reference internal" href="#s3prl.problem.HearFSD.build_featurizer" title="s3prl.problem.HearFSD.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a> <a class="reference internal" href="#s3prl.problem.HearFSD.build_downstream" title="s3prl.problem.HearFSD.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a> <a class="reference internal" href="#s3prl.problem.HearFSD.build_model" title="s3prl.problem.HearFSD.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> <a class="reference internal" href="#s3prl.problem.HearFSD.build_task" title="s3prl.problem.HearFSD.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> <a class="reference internal" href="#s3prl.problem.HearFSD.build_optimizer" title="s3prl.problem.HearFSD.build_optimizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_optimizer</span></code></a> <a class="reference internal" href="#s3prl.problem.HearFSD.build_scheduler" title="s3prl.problem.HearFSD.build_scheduler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_scheduler</span></code></a> <a class="reference internal" href="#s3prl.problem.HearFSD.save_model" title="s3prl.problem.HearFSD.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a> <a class="reference internal" href="#s3prl.problem.HearFSD.save_task" title="s3prl.problem.HearFSD.save_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_task</span></code></a> <a class="reference internal" href="#s3prl.problem.HearFSD.train" title="s3prl.problem.HearFSD.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> <a class="reference internal" href="#s3prl.problem.HearFSD.evaluate" title="s3prl.problem.HearFSD.evaluate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate</span></code></a></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">start</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="nt">stop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">target_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">cache_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">remove_all_cache</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">prepare_data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">dataset_root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">build_batch_sampler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">train</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="w">    </span><span class="nt">shuffle</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">valid</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">test</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="nt">build_upstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">build_featurizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">layer_selections</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="nt">normalize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_downstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">hidden_layers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">  </span><span class="nt">pooling_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MeanPooling</span>
<span class="nt">build_model</span><span class="p">:</span>
<span class="w">  </span><span class="nt">upstream_trainable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_task</span><span class="p">:</span>
<span class="w">  </span><span class="nt">prediction_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">multilabel</span>
<span class="w">  </span><span class="nt">scores</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mAP</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top1_acc</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">d_prime</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aucroc</span>
<span class="nt">build_optimizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Adam</span>
<span class="w">  </span><span class="nt">conf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">lr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.001</span>
<span class="nt">build_scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ExponentialLR</span>
<span class="w">  </span><span class="nt">gamma</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.9</span>
<span class="nt">save_model</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">save_task</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">train</span><span class="p">:</span>
<span class="w">  </span><span class="nt">total_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">40000</span>
<span class="w">  </span><span class="nt">log_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">  </span><span class="nt">eval_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span>
<span class="w">  </span><span class="nt">save_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">  </span><span class="nt">gradient_clipping</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0</span>
<span class="w">  </span><span class="nt">gradient_accumulate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">valid_metric</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mAP</span>
<span class="w">  </span><span class="nt">valid_higher_better</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">auto_resume</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">resume_ckpt_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">evaluate</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearFSD.prepare_data">
<span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_fsd.html#HearFSD.prepare_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L131-L140"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearFSD.prepare_data" title="Permalink to this definition">#</a></dt>
<dd><p>Prepare the task-specific data metadata (path, labels…).
By default call <code class="xref py py-obj docutils literal notranslate"><span class="pre">voxceleb1_for_sid</span></code> with <code class="code docutils literal notranslate"><span class="pre">**prepare_data</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prepare_data</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearFSD.default_config" title="s3prl.problem.HearFSD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments in <code class="xref py py-obj docutils literal notranslate"><span class="pre">voxceleb1_for_sid</span></code></p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Parse your corpus and save the csv file into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the parsing or preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>train_path (str)</p></li>
<li><p>valid_path (str)</p></li>
<li><p>test_paths (List[str])</p></li>
</ol>
<p>Each path (str) should be a csv file containing the following columns:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>column</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>(str) - the unique id for this data point</p></td>
</tr>
<tr class="row-odd"><td><p>wav_path</p></td>
<td><p>(str) - the absolute path of the waveform file</p></td>
</tr>
<tr class="row-even"><td><p>label</p></td>
<td><p>(str) - a string label of the waveform</p></td>
</tr>
<tr class="row-odd"><td><p>start_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">start_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load from the beginning.</p></td>
</tr>
<tr class="row-even"><td><p>end_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">end_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load to the end.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearFSD.build_encoder">
<span class="sig-name descname"><span class="pre">build_encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_csv_paths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_fsd.html#HearFSD.build_encoder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L142-L170"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearFSD.build_encoder" title="Permalink to this definition">#</a></dt>
<dd><p>Build the encoder (for the labels) given the data metadata, and return the saved encoder path.
By default generate and save a <a class="reference internal" href="s3prl.dataio.encoder.html#s3prl.dataio.encoder.CategoryEncoder" title="s3prl.dataio.encoder.CategoryEncoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataio.encoder.CategoryEncoder</span></code></a> from the <code class="code docutils literal notranslate"><span class="pre">label</span></code> column of all the csv files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_encoder</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearFSD.default_config" title="s3prl.problem.HearFSD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Save your encoder into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>train_csv_path</strong> (<em>str</em>) – the train path from <a class="reference internal" href="#s3prl.problem.HearFSD.prepare_data" title="s3prl.problem.HearFSD.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>valid_csv_path</strong> (<em>str</em>) – the valid path from <a class="reference internal" href="#s3prl.problem.HearFSD.prepare_data" title="s3prl.problem.HearFSD.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>test_csv_paths</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – the test paths from <a class="reference internal" href="#s3prl.problem.HearFSD.prepare_data" title="s3prl.problem.HearFSD.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>str</p>
<p>encoder_path: The encoder should be saved in the pickle format</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearFSD.build_dataset">
<span class="sig-name descname"><span class="pre">build_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_shift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_fsd.html#HearFSD.build_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L172-L211"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearFSD.build_dataset" title="Permalink to this definition">#</a></dt>
<dd><p>Build the dataset for train/valid/test.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_dataset</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearFSD.default_config" title="s3prl.problem.HearFSD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>. with <code class="code docutils literal notranslate"><span class="pre">train</span></code>, <code class="code docutils literal notranslate"><span class="pre">valid</span></code>, <code class="code docutils literal notranslate"><span class="pre">test</span></code> keys, each
is a dictionary with the following supported options:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>max_secs</p></td>
<td><p>(float) - If a waveform is longer than <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds, randomly crop the waveform into <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds</p></td>
</tr>
<tr class="row-odd"><td><p>sox_effects</p></td>
<td><p>(List[List[str]]) - If not None, apply sox effects on the utterance</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – The metadata csv file for the specific <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p></li>
<li><p><strong>encoder_path</strong> (<em>str</em>) – The pickled encoder path for encoding the labels</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch Dataset</p>
<p>For all train/valid/test mode, the dataset should return each item as a dictionary
containing the following keys:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>x</p></td>
<td><p>(torch.FloatTensor) - the waveform in (seq_len, 1)</p></td>
</tr>
<tr class="row-odd"><td><p>x_len</p></td>
<td><p>(int) - the waveform length <code class="code docutils literal notranslate"><span class="pre">seq_len</span></code></p></td>
</tr>
<tr class="row-even"><td><p>class_id</p></td>
<td><p>(int) - the encoded class id</p></td>
</tr>
<tr class="row-odd"><td><p>label</p></td>
<td><p>(str) - the class name</p></td>
</tr>
<tr class="row-even"><td><p>unique_name</p></td>
<td><p>(str) - the unique id for this datapoint</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearFSD.build_batch_sampler">
<span class="sig-name descname"><span class="pre">build_batch_sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_fsd.html#HearFSD.build_batch_sampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L213-L229"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearFSD.build_batch_sampler" title="Permalink to this definition">#</a></dt>
<dd><p>Return the batch sampler for torch DataLoader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_batch_sampler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearFSD.default_config" title="s3prl.problem.HearFSD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>train</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>valid</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-even"><td><p>test</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">mode</span></code> specific csv from <a class="reference internal" href="#s3prl.problem.HearFSD.prepare_data" title="s3prl.problem.HearFSD.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>dataset</strong> – the dataset from <a class="reference internal" href="#s3prl.problem.HearFSD.build_dataset" title="s3prl.problem.HearFSD.build_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_dataset</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>batch sampler for torch DataLoader</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearFSD.build_downstream">
<span class="sig-name descname"><span class="pre">build_downstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_fsd.html#HearFSD.build_downstream"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L231-L240"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearFSD.build_downstream" title="Permalink to this definition">#</a></dt>
<dd><p>Return the task-specific downstream model.
By default build the <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code> model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearFSD.default_config" title="s3prl.problem.HearFSD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments of <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code></p></li>
<li><p><strong>downstream_input_size</strong> (<em>int</em>) – the required input size of the model</p></li>
<li><p><strong>downstream_output_size</strong> (<em>int</em>) – the required output size of the model</p></li>
<li><p><strong>downstream_input_stride</strong> (<em>int</em>) – the input feature’s stride (from 16 KHz)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUtteranceModel" title="s3prl.nn.interface.AbsUtteranceModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUtteranceModel</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearFSD.build_task">
<span class="sig-name descname"><span class="pre">build_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_fsd.html#HearFSD.build_task"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L242-L250"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearFSD.build_task" title="Permalink to this definition">#</a></dt>
<dd><p>Build the task, which defines the logics for every train/valid/test forward step for the <code class="code docutils literal notranslate"><span class="pre">model</span></code>,
and the logics for how to reduce all the batch results from multiple train/valid/test steps into metrics</p>
<p>By default build <code class="xref py py-obj docutils literal notranslate"><span class="pre">UtteranceClassificationTask</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearFSD.default_config" title="s3prl.problem.HearFSD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model built by <a class="reference internal" href="#s3prl.problem.HearFSD.build_model" title="s3prl.problem.HearFSD.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a></p></li>
<li><p><strong>encoder</strong> – the encoder built by <a class="reference internal" href="#s3prl.problem.HearFSD.build_encoder" title="s3prl.problem.HearFSD.build_encoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_encoder</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Task</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearFSD.build_collate_fn">
<span class="sig-name descname"><span class="pre">build_collate_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L143-L156"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearFSD.build_collate_fn" title="Permalink to this definition">#</a></dt>
<dd><p>By default returns <code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataset.base.default_collate_fn</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_collate_fn</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearFSD.default_config" title="s3prl.problem.HearFSD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train, valid, or test</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>callable</p>
<p>the collate_fn for torch DataLoader in train/valid/test <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearFSD.build_featurizer">
<span class="sig-name descname"><span class="pre">build_featurizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upstream</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L175-L192"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearFSD.build_featurizer" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the featurizer with <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearFSD.default_config" title="s3prl.problem.HearFSD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p></li>
<li><p><strong>upstream</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">AbsUpstream</span></code>) – the upstream model built by <a class="reference internal" href="#s3prl.problem.HearFSD.build_upstream" title="s3prl.problem.HearFSD.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsFeaturizer" title="s3prl.nn.interface.AbsFeaturizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsFeaturizer</span></code></a></p>
<p>Return the featurizer model. The featurizer is used to reduce the multiple
hidden states returned from the upstream model (built by <a class="reference internal" href="#s3prl.problem.HearFSD.build_upstream" title="s3prl.problem.HearFSD.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>)
into a single hidden state, so can be easliy fed into the downstream model</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearFSD.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L194-L231"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearFSD.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>By default build model with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearFSD.default_config" title="s3prl.problem.HearFSD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p></li>
<li><p><strong>model_output_size</strong> (<em>int</em>) – the required model’s output hidden size</p></li>
<li><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearFSD.default_config" title="s3prl.problem.HearFSD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearFSD.build_upstream" title="s3prl.problem.HearFSD.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearFSD.default_config" title="s3prl.problem.HearFSD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearFSD.build_featurizer" title="s3prl.problem.HearFSD.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a></p></li>
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearFSD.default_config" title="s3prl.problem.HearFSD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearFSD.build_downstream" title="s3prl.problem.HearFSD.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch.nn.Module</p>
<p>Return the entire model for the task, which takes the direct items from DataLoader as the input.
Usually, the components can be built by <a class="reference internal" href="#s3prl.problem.HearFSD.build_upstream" title="s3prl.problem.HearFSD.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>, <a class="reference internal" href="#s3prl.problem.HearFSD.build_featurizer" title="s3prl.problem.HearFSD.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a>,
<a class="reference internal" href="#s3prl.problem.HearFSD.build_downstream" title="s3prl.problem.HearFSD.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a>, and are concated together to get the final model.
The upstream extracts multiple hidden states, the featuizer reduce them into a single hidden state,
and the downstream takes the hidden states as the feature for the downstream-specific model.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearFSD.build_optimizer">
<span class="sig-name descname"><span class="pre">build_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L233-L258"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearFSD.build_optimizer" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_optimizer</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearFSD.default_config" title="s3prl.problem.HearFSD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to below</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the optimizer class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the optimizer class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;lr&quot;:</span> <span class="pre">1.0e-4}</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>parameters</strong> (<em>iterable</em>) – the standard params accepted by <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code></p>
<p>An optimizer following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearFSD.build_scheduler">
<span class="sig-name descname"><span class="pre">build_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L260-L285"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearFSD.build_scheduler" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_scheduler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearFSD.default_config" title="s3prl.problem.HearFSD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the scheduler class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the scheduler class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;gamma&quot;:</span> <span class="pre">0.01}</span></code> for <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler.StepLR</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>optimizer</strong> – the standard torch optimizer accepted by Scheduler in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch scheduler</p>
<p>A scheduler following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearFSD.build_upstream">
<span class="sig-name descname"><span class="pre">build_upstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L158-L173"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearFSD.build_upstream" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the upstream with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearFSD.default_config" title="s3prl.problem.HearFSD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUpstream" title="s3prl.nn.interface.AbsUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUpstream</span></code></a></p>
<p>Return an upstream model, whose forward takes the waveform input and returns
multiple hidden states as features.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearFSD.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L660-L707"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearFSD.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>The evaluate routine used by <a class="reference internal" href="#s3prl.problem.HearFSD.train" title="s3prl.problem.HearFSD.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> (during validation phase) and <a class="reference internal" href="#s3prl.problem.HearFSD.run" title="s3prl.problem.HearFSD.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>
(during testing phase).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evaluate</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearFSD.default_config" title="s3prl.problem.HearFSD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearFSD.get_class_from_name">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_class_from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L129-L141"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearFSD.get_class_from_name" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">__name__</span></code> of the problem class</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Problem</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearFSD.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L752-L772"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearFSD.load_model" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model_ckpt_dir</strong> (<em>str</em>) – Restore the model with <a class="reference internal" href="#s3prl.problem.HearFSD.build_model" title="s3prl.problem.HearFSD.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> and the checkpoint
saved in this directory.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearFSD.load_model_and_task">
<span class="sig-name descname"><span class="pre">load_model_and_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ckpts_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L884-L902"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearFSD.load_model_and_task" title="Permalink to this definition">#</a></dt>
<dd><p>This is a helper method to combine <a class="reference internal" href="#s3prl.problem.HearFSD.load_model" title="s3prl.problem.HearFSD.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a> and <a class="reference internal" href="#s3prl.problem.HearFSD.load_task" title="s3prl.problem.HearFSD.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>
together to directly load the model and the task. This method assumes
the model is saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'model'</span></code> and the task is
saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'task'</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>model (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>)</p></li>
<li><p>task (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a>)</p></li>
</ol>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearFSD.load_task">
<span class="sig-name descname"><span class="pre">load_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L833-L882"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearFSD.load_task" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – Restore the task with <a class="reference internal" href="#s3prl.problem.HearFSD.build_task" title="s3prl.problem.HearFSD.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> and the checkpoint
saved in this directory.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model for the task, since the model is separately saved
and is required for <a class="reference internal" href="#s3prl.problem.HearFSD.build_task" title="s3prl.problem.HearFSD.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a>.</p></li>
<li><p><strong>task_overrides</strong> (<em>dict</em>) – overrides the saved initialization arguments, so can change
the loaded task’s behavior. Like, change the decoding hyperparameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearFSD.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L954-L995"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearFSD.main" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearFSD.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_all_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cuda'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/run.py#L26-L318"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearFSD.run" title="Permalink to this definition">#</a></dt>
<dd><div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>stage</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Parse the corpus and save the metadata file (waveform path, label…)</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Build the encoder to encode the labels</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Train the model</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Evaluate the model on multiple test sets</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_dir</strong> (<em>str</em>) – The directory that stores the script result.</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – The directory that caches the processed data.
Default: /home/user/.cache/s3prl/data</p></li>
<li><p><strong>remove_all_cache</strong> (<em>bool</em>) – Whether to remove all the cache stored under <cite>cache_dir</cite>.
Default: False</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting stage of the problem script.
Default: 0</p></li>
<li><p><strong>stop</strong> (<em>int</em>) – The stoping stage of the problem script, set <cite>None</cite> to reach the final stage.
Default: None</p></li>
<li><p><strong>num_workers</strong> (<em>int</em>) – num_workers for all the torch DataLoder</p></li>
<li><p><strong>eval_batch</strong> (<em>int</em>) – During evaluation (valid or test), limit the number of batch.
This is helpful for the fast development to check everything won’t crash.
If is -1, disable this feature and evaluate the entire epoch.
Default: -1</p></li>
<li><p><strong>device</strong> (<em>str</em>) – The device type for all torch-related operation: “cpu” or “cuda”
Default: “cuda”</p></li>
<li><p><strong>world_size</strong> (<em>int</em>) – How many processes are running this script simultaneously (in parallel).
Usually this is just 1, however if you are runnig distributed training,
this should be &gt; 1.
Default: 1</p></li>
<li><p><strong>rank</strong> (<em>int</em>) – When distributed training, world_size &gt; 1. Take <code class="code docutils literal notranslate"><span class="pre">world_size</span> <span class="pre">==</span> <span class="pre">8</span></code> for
example, this means 8 processes (8 GPUs) are runing in parallel. The script
needs to know which process among 8 processes it is. In this case, <code class="code docutils literal notranslate"><span class="pre">rank</span></code>
can range from 0~7. All the 8 processes have the same <code class="code docutils literal notranslate"><span class="pre">world_size</span></code> but
different <code class="code docutils literal notranslate"><span class="pre">rank</span></code> (process id).</p></li>
<li><p><strong>test_ckpt_dir</strong> (<em>str</em>) – Specify the checkpoint path for testing. If not, use the validation best
checkpoint under the given <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> directory.</p></li>
<li><p><strong>**kwds</strong> – The other arguments like <code class="code docutils literal notranslate"><span class="pre">prepare_data</span></code> and <code class="code docutils literal notranslate"><span class="pre">build_model</span></code> are
method specific-arguments for methods like <a class="reference internal" href="#s3prl.problem.HearFSD.prepare_data" title="s3prl.problem.HearFSD.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> and
<a class="reference internal" href="#s3prl.problem.HearFSD.build_model" title="s3prl.problem.HearFSD.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>, and will not be used in the core <a class="reference internal" href="#s3prl.problem.HearFSD.run" title="s3prl.problem.HearFSD.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> logic.
See the specific method documentation for their supported arguments and
meaning</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearFSD.save_model">
<span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L709-L750"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearFSD.save_model" title="Permalink to this definition">#</a></dt>
<dd><p>Save the model state_dict and the model initialization arguments into the given directory.
If you override this method, it is highly possible you also need to override <a class="reference internal" href="#s3prl.problem.HearFSD.load_model" title="s3prl.problem.HearFSD.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearFSD.default_config" title="s3prl.problem.HearFSD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_model</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>model_ckpt_dir</strong> (<em>str</em>) – save the model into the this directory.</p></li>
<li><p><strong>build_model_all_args</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.HearFSD.build_model" title="s3prl.problem.HearFSD.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>.
By saving this dictionary, you can easily reconstruct the same model
by calling <a class="reference internal" href="#s3prl.problem.HearFSD.build_model" title="s3prl.problem.HearFSD.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearFSD.save_task">
<span class="sig-name descname"><span class="pre">save_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="s3prl.task.base.html#s3prl.task.base.Task" title="s3prl.task.base.Task"><span class="pre">Task</span></a></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L774-L831"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearFSD.save_task" title="Permalink to this definition">#</a></dt>
<dd><p>Save the task’s state, <code class="code docutils literal notranslate"><span class="pre">task.get_state()</span></code>, and the initialization arguments into the given
directory. If you override this method, it is highly possible you also need to override
<a class="reference internal" href="#s3prl.problem.HearFSD.load_task" title="s3prl.problem.HearFSD.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearFSD.default_config" title="s3prl.problem.HearFSD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_task</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – save the task into this directory.</p></li>
<li><p><strong>build_task_all_args_except_model</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.HearFSD.build_task" title="s3prl.problem.HearFSD.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> except
the <code class="code docutils literal notranslate"><span class="pre">model</span></code> argument since the model should be sapartely saved by
<a class="reference internal" href="#s3prl.problem.HearFSD.save_model" title="s3prl.problem.HearFSD.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a>. By saving this dictionary, you can easily reconstruct the same task
by calling <a class="reference internal" href="#s3prl.problem.HearFSD.build_task" title="s3prl.problem.HearFSD.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>task</strong> (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><em>Task</em></a>) – the task to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearFSD.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L287-L658"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearFSD.train" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearFSD.default_config" title="s3prl.problem.HearFSD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>total_steps</p></td>
<td><p>(int) - the total optimization steps</p></td>
</tr>
<tr class="row-odd"><td><p>log_step</p></td>
<td><p>(int) - logging frequency. log every <code class="code docutils literal notranslate"><span class="pre">log_step</span></code> step</p></td>
</tr>
<tr class="row-even"><td><p>eval_step</p></td>
<td><p>(int) - evaluation frequency. Evaluate every <code class="code docutils literal notranslate"><span class="pre">eval_step</span></code> step.                                                 Note that you can control how many batch to evaluate to speed up the                                                 development by the <code class="code docutils literal notranslate"><span class="pre">eval_batch</span></code> argument in <a class="reference internal" href="#s3prl.problem.HearFSD.run" title="s3prl.problem.HearFSD.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>save_step</p></td>
<td><p>(int) - save the checkpoint every <code class="code docutils literal notranslate"><span class="pre">save_step</span></code> step.</p></td>
</tr>
<tr class="row-even"><td><p>gradient_clipping</p></td>
<td><p>(float) - clip the gradient. important for RNNs.</p></td>
</tr>
<tr class="row-odd"><td><p>gradient_accumulate</p></td>
<td><p>(int) - accumulate multiple steps’ gradient before updating network parameters                                                 to simulate large-batch optimization.</p></td>
</tr>
<tr class="row-even"><td><p>valid_metric</p></td>
<td><p>(str) - the metric to select the best valid checkpoint. Different Tasks have different                                                 supported valid_metrics. See <a class="reference internal" href="#s3prl.problem.HearFSD.build_task" title="s3prl.problem.HearFSD.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> for the supported metrics.</p></td>
</tr>
<tr class="row-odd"><td><p>valid_higher_better</p></td>
<td><p>(bool) - some metrics are higher better, while some are lower better                                                 this will affect how to save the best validation checkpoint.</p></td>
</tr>
<tr class="row-even"><td><p>auto_resume</p></td>
<td><p>(bool) - if there are already the last checkpoint in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.HearFSD.run" title="s3prl.problem.HearFSD.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>),                                                 whether to resume from it or delete it and start a new training session.</p></td>
</tr>
<tr class="row-odd"><td><p>resume_ckpt_dir</p></td>
<td><p>(str) - you can directly specify the checkpoint path to resume which is not necessary                                                 in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.HearFSD.run" title="s3prl.problem.HearFSD.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>).</p></td>
</tr>
<tr class="row-even"><td><p>seed</p></td>
<td><p>(int) - fix the seed before the training start</p></td>
</tr>
<tr class="row-odd"><td><p>keep_num_ckpts</p></td>
<td><p>(int) - to prevent saving too many checkpoints, only save the <code class="code docutils literal notranslate"><span class="pre">keep_num_ckpts</span></code>                                                 latest checkpoints and delete the old ones.</p></td>
</tr>
<tr class="row-even"><td><p>use_scheduler</p></td>
<td><p>(bool) - whether to use the scheduler</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="hearesc50">
<h2>HearESC50<a class="headerlink" href="#hearesc50" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="s3prl.problem.HearESC50">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">s3prl.problem.</span></span><span class="sig-name descname"><span class="pre">HearESC50</span></span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_esc50.html#HearESC50"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_esc50.py#L81-L160"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearESC50" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="s3prl.problem.common.hear_fsd.html#s3prl.problem.common.hear_fsd.HearFSD" title="s3prl.problem.common.hear_fsd.HearFSD"><code class="xref py py-class docutils literal notranslate"><span class="pre">HearFSD</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearESC50.default_config">
<span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_esc50.html#HearESC50.default_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_esc50.py#L82-L149"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearESC50.default_config" title="Permalink to this definition">#</a></dt>
<dd><p>The default arguments for <a class="reference internal" href="#s3prl.problem.HearESC50.run" title="s3prl.problem.HearESC50.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> in yaml.
Note that for the fields with inner values, like <code class="code docutils literal notranslate"><span class="pre">build_model</span></code>,
the outer field name corresponds to a method name, so you can find the method
<a class="reference internal" href="#s3prl.problem.HearESC50.build_model" title="s3prl.problem.HearESC50.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>. Furthermore, the values inside that field will be
directly passed into the method. So by changing these inner values, you
can directly affect the behavior of the corresponding method. See the method
documentation for all the supported arguments and their meanings.</p>
<p>The methods affected by the following config are: <a class="reference internal" href="#s3prl.problem.HearESC50.prepare_data" title="s3prl.problem.HearESC50.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> <a class="reference internal" href="#s3prl.problem.HearESC50.build_batch_sampler" title="s3prl.problem.HearESC50.build_batch_sampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_batch_sampler</span></code></a> <a class="reference internal" href="#s3prl.problem.HearESC50.build_upstream" title="s3prl.problem.HearESC50.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a> <a class="reference internal" href="#s3prl.problem.HearESC50.build_featurizer" title="s3prl.problem.HearESC50.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a> <a class="reference internal" href="#s3prl.problem.HearESC50.build_downstream" title="s3prl.problem.HearESC50.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a> <a class="reference internal" href="#s3prl.problem.HearESC50.build_model" title="s3prl.problem.HearESC50.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> <a class="reference internal" href="#s3prl.problem.HearESC50.build_task" title="s3prl.problem.HearESC50.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> <a class="reference internal" href="#s3prl.problem.HearESC50.build_optimizer" title="s3prl.problem.HearESC50.build_optimizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_optimizer</span></code></a> <a class="reference internal" href="#s3prl.problem.HearESC50.build_scheduler" title="s3prl.problem.HearESC50.build_scheduler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_scheduler</span></code></a> <a class="reference internal" href="#s3prl.problem.HearESC50.save_model" title="s3prl.problem.HearESC50.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a> <a class="reference internal" href="#s3prl.problem.HearESC50.save_task" title="s3prl.problem.HearESC50.save_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_task</span></code></a> <a class="reference internal" href="#s3prl.problem.HearESC50.train" title="s3prl.problem.HearESC50.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> <a class="reference internal" href="#s3prl.problem.HearESC50.evaluate" title="s3prl.problem.HearESC50.evaluate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate</span></code></a></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">start</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="nt">stop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">target_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">cache_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">remove_all_cache</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">prepare_data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">dataset_root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="w">  </span><span class="nt">test_fold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="w">  </span><span class="nt">num_folds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="nt">build_batch_sampler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">train</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">32</span>
<span class="w">    </span><span class="nt">shuffle</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">valid</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">test</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="nt">build_upstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">build_featurizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">layer_selections</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="nt">normalize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_downstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">hidden_layers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">  </span><span class="nt">pooling_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MeanPooling</span>
<span class="nt">build_model</span><span class="p">:</span>
<span class="w">  </span><span class="nt">upstream_trainable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_task</span><span class="p">:</span>
<span class="w">  </span><span class="nt">prediction_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">multiclass</span>
<span class="w">  </span><span class="nt">scores</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top1_acc</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">d_prime</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aucroc</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mAP</span>
<span class="nt">build_optimizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Adam</span>
<span class="w">  </span><span class="nt">conf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">lr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.001</span>
<span class="nt">build_scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ExponentialLR</span>
<span class="w">  </span><span class="nt">gamma</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.9</span>
<span class="nt">save_model</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">save_task</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">train</span><span class="p">:</span>
<span class="w">  </span><span class="nt">total_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4000</span>
<span class="w">  </span><span class="nt">log_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">  </span><span class="nt">eval_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">500</span>
<span class="w">  </span><span class="nt">save_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">  </span><span class="nt">gradient_clipping</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0</span>
<span class="w">  </span><span class="nt">gradient_accumulate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4</span>
<span class="w">  </span><span class="nt">valid_metric</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top1_acc</span>
<span class="w">  </span><span class="nt">valid_higher_better</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">auto_resume</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">resume_ckpt_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">evaluate</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearESC50.prepare_data">
<span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_esc50.html#HearESC50.prepare_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_esc50.py#L151-L160"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearESC50.prepare_data" title="Permalink to this definition">#</a></dt>
<dd><p>Prepare the task-specific data metadata (path, labels…).
By default call <code class="xref py py-obj docutils literal notranslate"><span class="pre">voxceleb1_for_sid</span></code> with <code class="code docutils literal notranslate"><span class="pre">**prepare_data</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prepare_data</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearESC50.default_config" title="s3prl.problem.HearESC50.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments in <code class="xref py py-obj docutils literal notranslate"><span class="pre">voxceleb1_for_sid</span></code></p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Parse your corpus and save the csv file into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the parsing or preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>train_path (str)</p></li>
<li><p>valid_path (str)</p></li>
<li><p>test_paths (List[str])</p></li>
</ol>
<p>Each path (str) should be a csv file containing the following columns:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>column</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>(str) - the unique id for this data point</p></td>
</tr>
<tr class="row-odd"><td><p>wav_path</p></td>
<td><p>(str) - the absolute path of the waveform file</p></td>
</tr>
<tr class="row-even"><td><p>label</p></td>
<td><p>(str) - a string label of the waveform</p></td>
</tr>
<tr class="row-odd"><td><p>start_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">start_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load from the beginning.</p></td>
</tr>
<tr class="row-even"><td><p>end_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">end_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load to the end.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearESC50.build_batch_sampler">
<span class="sig-name descname"><span class="pre">build_batch_sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L213-L229"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearESC50.build_batch_sampler" title="Permalink to this definition">#</a></dt>
<dd><p>Return the batch sampler for torch DataLoader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_batch_sampler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearESC50.default_config" title="s3prl.problem.HearESC50.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>train</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>valid</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-even"><td><p>test</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">mode</span></code> specific csv from <a class="reference internal" href="#s3prl.problem.HearESC50.prepare_data" title="s3prl.problem.HearESC50.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>dataset</strong> – the dataset from <a class="reference internal" href="#s3prl.problem.HearESC50.build_dataset" title="s3prl.problem.HearESC50.build_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_dataset</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>batch sampler for torch DataLoader</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearESC50.build_collate_fn">
<span class="sig-name descname"><span class="pre">build_collate_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L143-L156"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearESC50.build_collate_fn" title="Permalink to this definition">#</a></dt>
<dd><p>By default returns <code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataset.base.default_collate_fn</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_collate_fn</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearESC50.default_config" title="s3prl.problem.HearESC50.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train, valid, or test</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>callable</p>
<p>the collate_fn for torch DataLoader in train/valid/test <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearESC50.build_dataset">
<span class="sig-name descname"><span class="pre">build_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_shift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L172-L211"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearESC50.build_dataset" title="Permalink to this definition">#</a></dt>
<dd><p>Build the dataset for train/valid/test.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_dataset</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearESC50.default_config" title="s3prl.problem.HearESC50.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>. with <code class="code docutils literal notranslate"><span class="pre">train</span></code>, <code class="code docutils literal notranslate"><span class="pre">valid</span></code>, <code class="code docutils literal notranslate"><span class="pre">test</span></code> keys, each
is a dictionary with the following supported options:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>max_secs</p></td>
<td><p>(float) - If a waveform is longer than <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds, randomly crop the waveform into <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds</p></td>
</tr>
<tr class="row-odd"><td><p>sox_effects</p></td>
<td><p>(List[List[str]]) - If not None, apply sox effects on the utterance</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – The metadata csv file for the specific <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p></li>
<li><p><strong>encoder_path</strong> (<em>str</em>) – The pickled encoder path for encoding the labels</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch Dataset</p>
<p>For all train/valid/test mode, the dataset should return each item as a dictionary
containing the following keys:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>x</p></td>
<td><p>(torch.FloatTensor) - the waveform in (seq_len, 1)</p></td>
</tr>
<tr class="row-odd"><td><p>x_len</p></td>
<td><p>(int) - the waveform length <code class="code docutils literal notranslate"><span class="pre">seq_len</span></code></p></td>
</tr>
<tr class="row-even"><td><p>class_id</p></td>
<td><p>(int) - the encoded class id</p></td>
</tr>
<tr class="row-odd"><td><p>label</p></td>
<td><p>(str) - the class name</p></td>
</tr>
<tr class="row-even"><td><p>unique_name</p></td>
<td><p>(str) - the unique id for this datapoint</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearESC50.build_downstream">
<span class="sig-name descname"><span class="pre">build_downstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L231-L240"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearESC50.build_downstream" title="Permalink to this definition">#</a></dt>
<dd><p>Return the task-specific downstream model.
By default build the <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code> model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearESC50.default_config" title="s3prl.problem.HearESC50.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments of <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code></p></li>
<li><p><strong>downstream_input_size</strong> (<em>int</em>) – the required input size of the model</p></li>
<li><p><strong>downstream_output_size</strong> (<em>int</em>) – the required output size of the model</p></li>
<li><p><strong>downstream_input_stride</strong> (<em>int</em>) – the input feature’s stride (from 16 KHz)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUtteranceModel" title="s3prl.nn.interface.AbsUtteranceModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUtteranceModel</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearESC50.build_encoder">
<span class="sig-name descname"><span class="pre">build_encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_csv_paths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L142-L170"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearESC50.build_encoder" title="Permalink to this definition">#</a></dt>
<dd><p>Build the encoder (for the labels) given the data metadata, and return the saved encoder path.
By default generate and save a <a class="reference internal" href="s3prl.dataio.encoder.html#s3prl.dataio.encoder.CategoryEncoder" title="s3prl.dataio.encoder.CategoryEncoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataio.encoder.CategoryEncoder</span></code></a> from the <code class="code docutils literal notranslate"><span class="pre">label</span></code> column of all the csv files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_encoder</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearESC50.default_config" title="s3prl.problem.HearESC50.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Save your encoder into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>train_csv_path</strong> (<em>str</em>) – the train path from <a class="reference internal" href="#s3prl.problem.HearESC50.prepare_data" title="s3prl.problem.HearESC50.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>valid_csv_path</strong> (<em>str</em>) – the valid path from <a class="reference internal" href="#s3prl.problem.HearESC50.prepare_data" title="s3prl.problem.HearESC50.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>test_csv_paths</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – the test paths from <a class="reference internal" href="#s3prl.problem.HearESC50.prepare_data" title="s3prl.problem.HearESC50.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>str</p>
<p>encoder_path: The encoder should be saved in the pickle format</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearESC50.build_featurizer">
<span class="sig-name descname"><span class="pre">build_featurizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upstream</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L175-L192"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearESC50.build_featurizer" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the featurizer with <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearESC50.default_config" title="s3prl.problem.HearESC50.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p></li>
<li><p><strong>upstream</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">AbsUpstream</span></code>) – the upstream model built by <a class="reference internal" href="#s3prl.problem.HearESC50.build_upstream" title="s3prl.problem.HearESC50.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsFeaturizer" title="s3prl.nn.interface.AbsFeaturizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsFeaturizer</span></code></a></p>
<p>Return the featurizer model. The featurizer is used to reduce the multiple
hidden states returned from the upstream model (built by <a class="reference internal" href="#s3prl.problem.HearESC50.build_upstream" title="s3prl.problem.HearESC50.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>)
into a single hidden state, so can be easliy fed into the downstream model</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearESC50.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L194-L231"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearESC50.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>By default build model with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearESC50.default_config" title="s3prl.problem.HearESC50.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p></li>
<li><p><strong>model_output_size</strong> (<em>int</em>) – the required model’s output hidden size</p></li>
<li><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearESC50.default_config" title="s3prl.problem.HearESC50.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearESC50.build_upstream" title="s3prl.problem.HearESC50.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearESC50.default_config" title="s3prl.problem.HearESC50.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearESC50.build_featurizer" title="s3prl.problem.HearESC50.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a></p></li>
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearESC50.default_config" title="s3prl.problem.HearESC50.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearESC50.build_downstream" title="s3prl.problem.HearESC50.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch.nn.Module</p>
<p>Return the entire model for the task, which takes the direct items from DataLoader as the input.
Usually, the components can be built by <a class="reference internal" href="#s3prl.problem.HearESC50.build_upstream" title="s3prl.problem.HearESC50.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>, <a class="reference internal" href="#s3prl.problem.HearESC50.build_featurizer" title="s3prl.problem.HearESC50.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a>,
<a class="reference internal" href="#s3prl.problem.HearESC50.build_downstream" title="s3prl.problem.HearESC50.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a>, and are concated together to get the final model.
The upstream extracts multiple hidden states, the featuizer reduce them into a single hidden state,
and the downstream takes the hidden states as the feature for the downstream-specific model.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearESC50.build_optimizer">
<span class="sig-name descname"><span class="pre">build_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L233-L258"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearESC50.build_optimizer" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_optimizer</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearESC50.default_config" title="s3prl.problem.HearESC50.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to below</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the optimizer class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the optimizer class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;lr&quot;:</span> <span class="pre">1.0e-4}</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>parameters</strong> (<em>iterable</em>) – the standard params accepted by <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code></p>
<p>An optimizer following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearESC50.build_scheduler">
<span class="sig-name descname"><span class="pre">build_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L260-L285"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearESC50.build_scheduler" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_scheduler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearESC50.default_config" title="s3prl.problem.HearESC50.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the scheduler class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the scheduler class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;gamma&quot;:</span> <span class="pre">0.01}</span></code> for <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler.StepLR</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>optimizer</strong> – the standard torch optimizer accepted by Scheduler in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch scheduler</p>
<p>A scheduler following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearESC50.build_task">
<span class="sig-name descname"><span class="pre">build_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L242-L250"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearESC50.build_task" title="Permalink to this definition">#</a></dt>
<dd><p>Build the task, which defines the logics for every train/valid/test forward step for the <code class="code docutils literal notranslate"><span class="pre">model</span></code>,
and the logics for how to reduce all the batch results from multiple train/valid/test steps into metrics</p>
<p>By default build <code class="xref py py-obj docutils literal notranslate"><span class="pre">UtteranceClassificationTask</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearESC50.default_config" title="s3prl.problem.HearESC50.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model built by <a class="reference internal" href="#s3prl.problem.HearESC50.build_model" title="s3prl.problem.HearESC50.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a></p></li>
<li><p><strong>encoder</strong> – the encoder built by <a class="reference internal" href="#s3prl.problem.HearESC50.build_encoder" title="s3prl.problem.HearESC50.build_encoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_encoder</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Task</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearESC50.build_upstream">
<span class="sig-name descname"><span class="pre">build_upstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L158-L173"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearESC50.build_upstream" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the upstream with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearESC50.default_config" title="s3prl.problem.HearESC50.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUpstream" title="s3prl.nn.interface.AbsUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUpstream</span></code></a></p>
<p>Return an upstream model, whose forward takes the waveform input and returns
multiple hidden states as features.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearESC50.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L660-L707"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearESC50.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>The evaluate routine used by <a class="reference internal" href="#s3prl.problem.HearESC50.train" title="s3prl.problem.HearESC50.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> (during validation phase) and <a class="reference internal" href="#s3prl.problem.HearESC50.run" title="s3prl.problem.HearESC50.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>
(during testing phase).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evaluate</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearESC50.default_config" title="s3prl.problem.HearESC50.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearESC50.get_class_from_name">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_class_from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L129-L141"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearESC50.get_class_from_name" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">__name__</span></code> of the problem class</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Problem</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearESC50.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L752-L772"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearESC50.load_model" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model_ckpt_dir</strong> (<em>str</em>) – Restore the model with <a class="reference internal" href="#s3prl.problem.HearESC50.build_model" title="s3prl.problem.HearESC50.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> and the checkpoint
saved in this directory.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearESC50.load_model_and_task">
<span class="sig-name descname"><span class="pre">load_model_and_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ckpts_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L884-L902"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearESC50.load_model_and_task" title="Permalink to this definition">#</a></dt>
<dd><p>This is a helper method to combine <a class="reference internal" href="#s3prl.problem.HearESC50.load_model" title="s3prl.problem.HearESC50.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a> and <a class="reference internal" href="#s3prl.problem.HearESC50.load_task" title="s3prl.problem.HearESC50.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>
together to directly load the model and the task. This method assumes
the model is saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'model'</span></code> and the task is
saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'task'</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>model (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>)</p></li>
<li><p>task (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a>)</p></li>
</ol>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearESC50.load_task">
<span class="sig-name descname"><span class="pre">load_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L833-L882"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearESC50.load_task" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – Restore the task with <a class="reference internal" href="#s3prl.problem.HearESC50.build_task" title="s3prl.problem.HearESC50.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> and the checkpoint
saved in this directory.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model for the task, since the model is separately saved
and is required for <a class="reference internal" href="#s3prl.problem.HearESC50.build_task" title="s3prl.problem.HearESC50.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a>.</p></li>
<li><p><strong>task_overrides</strong> (<em>dict</em>) – overrides the saved initialization arguments, so can change
the loaded task’s behavior. Like, change the decoding hyperparameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearESC50.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L954-L995"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearESC50.main" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearESC50.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_all_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cuda'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/run.py#L26-L318"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearESC50.run" title="Permalink to this definition">#</a></dt>
<dd><div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>stage</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Parse the corpus and save the metadata file (waveform path, label…)</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Build the encoder to encode the labels</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Train the model</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Evaluate the model on multiple test sets</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_dir</strong> (<em>str</em>) – The directory that stores the script result.</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – The directory that caches the processed data.
Default: /home/user/.cache/s3prl/data</p></li>
<li><p><strong>remove_all_cache</strong> (<em>bool</em>) – Whether to remove all the cache stored under <cite>cache_dir</cite>.
Default: False</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting stage of the problem script.
Default: 0</p></li>
<li><p><strong>stop</strong> (<em>int</em>) – The stoping stage of the problem script, set <cite>None</cite> to reach the final stage.
Default: None</p></li>
<li><p><strong>num_workers</strong> (<em>int</em>) – num_workers for all the torch DataLoder</p></li>
<li><p><strong>eval_batch</strong> (<em>int</em>) – During evaluation (valid or test), limit the number of batch.
This is helpful for the fast development to check everything won’t crash.
If is -1, disable this feature and evaluate the entire epoch.
Default: -1</p></li>
<li><p><strong>device</strong> (<em>str</em>) – The device type for all torch-related operation: “cpu” or “cuda”
Default: “cuda”</p></li>
<li><p><strong>world_size</strong> (<em>int</em>) – How many processes are running this script simultaneously (in parallel).
Usually this is just 1, however if you are runnig distributed training,
this should be &gt; 1.
Default: 1</p></li>
<li><p><strong>rank</strong> (<em>int</em>) – When distributed training, world_size &gt; 1. Take <code class="code docutils literal notranslate"><span class="pre">world_size</span> <span class="pre">==</span> <span class="pre">8</span></code> for
example, this means 8 processes (8 GPUs) are runing in parallel. The script
needs to know which process among 8 processes it is. In this case, <code class="code docutils literal notranslate"><span class="pre">rank</span></code>
can range from 0~7. All the 8 processes have the same <code class="code docutils literal notranslate"><span class="pre">world_size</span></code> but
different <code class="code docutils literal notranslate"><span class="pre">rank</span></code> (process id).</p></li>
<li><p><strong>test_ckpt_dir</strong> (<em>str</em>) – Specify the checkpoint path for testing. If not, use the validation best
checkpoint under the given <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> directory.</p></li>
<li><p><strong>**kwds</strong> – The other arguments like <code class="code docutils literal notranslate"><span class="pre">prepare_data</span></code> and <code class="code docutils literal notranslate"><span class="pre">build_model</span></code> are
method specific-arguments for methods like <a class="reference internal" href="#s3prl.problem.HearESC50.prepare_data" title="s3prl.problem.HearESC50.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> and
<a class="reference internal" href="#s3prl.problem.HearESC50.build_model" title="s3prl.problem.HearESC50.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>, and will not be used in the core <a class="reference internal" href="#s3prl.problem.HearESC50.run" title="s3prl.problem.HearESC50.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> logic.
See the specific method documentation for their supported arguments and
meaning</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearESC50.save_model">
<span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L709-L750"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearESC50.save_model" title="Permalink to this definition">#</a></dt>
<dd><p>Save the model state_dict and the model initialization arguments into the given directory.
If you override this method, it is highly possible you also need to override <a class="reference internal" href="#s3prl.problem.HearESC50.load_model" title="s3prl.problem.HearESC50.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearESC50.default_config" title="s3prl.problem.HearESC50.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_model</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>model_ckpt_dir</strong> (<em>str</em>) – save the model into the this directory.</p></li>
<li><p><strong>build_model_all_args</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.HearESC50.build_model" title="s3prl.problem.HearESC50.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>.
By saving this dictionary, you can easily reconstruct the same model
by calling <a class="reference internal" href="#s3prl.problem.HearESC50.build_model" title="s3prl.problem.HearESC50.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearESC50.save_task">
<span class="sig-name descname"><span class="pre">save_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="s3prl.task.base.html#s3prl.task.base.Task" title="s3prl.task.base.Task"><span class="pre">Task</span></a></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L774-L831"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearESC50.save_task" title="Permalink to this definition">#</a></dt>
<dd><p>Save the task’s state, <code class="code docutils literal notranslate"><span class="pre">task.get_state()</span></code>, and the initialization arguments into the given
directory. If you override this method, it is highly possible you also need to override
<a class="reference internal" href="#s3prl.problem.HearESC50.load_task" title="s3prl.problem.HearESC50.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearESC50.default_config" title="s3prl.problem.HearESC50.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_task</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – save the task into this directory.</p></li>
<li><p><strong>build_task_all_args_except_model</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.HearESC50.build_task" title="s3prl.problem.HearESC50.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> except
the <code class="code docutils literal notranslate"><span class="pre">model</span></code> argument since the model should be sapartely saved by
<a class="reference internal" href="#s3prl.problem.HearESC50.save_model" title="s3prl.problem.HearESC50.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a>. By saving this dictionary, you can easily reconstruct the same task
by calling <a class="reference internal" href="#s3prl.problem.HearESC50.build_task" title="s3prl.problem.HearESC50.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>task</strong> (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><em>Task</em></a>) – the task to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearESC50.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L287-L658"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearESC50.train" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearESC50.default_config" title="s3prl.problem.HearESC50.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>total_steps</p></td>
<td><p>(int) - the total optimization steps</p></td>
</tr>
<tr class="row-odd"><td><p>log_step</p></td>
<td><p>(int) - logging frequency. log every <code class="code docutils literal notranslate"><span class="pre">log_step</span></code> step</p></td>
</tr>
<tr class="row-even"><td><p>eval_step</p></td>
<td><p>(int) - evaluation frequency. Evaluate every <code class="code docutils literal notranslate"><span class="pre">eval_step</span></code> step.                                                 Note that you can control how many batch to evaluate to speed up the                                                 development by the <code class="code docutils literal notranslate"><span class="pre">eval_batch</span></code> argument in <a class="reference internal" href="#s3prl.problem.HearESC50.run" title="s3prl.problem.HearESC50.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>save_step</p></td>
<td><p>(int) - save the checkpoint every <code class="code docutils literal notranslate"><span class="pre">save_step</span></code> step.</p></td>
</tr>
<tr class="row-even"><td><p>gradient_clipping</p></td>
<td><p>(float) - clip the gradient. important for RNNs.</p></td>
</tr>
<tr class="row-odd"><td><p>gradient_accumulate</p></td>
<td><p>(int) - accumulate multiple steps’ gradient before updating network parameters                                                 to simulate large-batch optimization.</p></td>
</tr>
<tr class="row-even"><td><p>valid_metric</p></td>
<td><p>(str) - the metric to select the best valid checkpoint. Different Tasks have different                                                 supported valid_metrics. See <a class="reference internal" href="#s3prl.problem.HearESC50.build_task" title="s3prl.problem.HearESC50.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> for the supported metrics.</p></td>
</tr>
<tr class="row-odd"><td><p>valid_higher_better</p></td>
<td><p>(bool) - some metrics are higher better, while some are lower better                                                 this will affect how to save the best validation checkpoint.</p></td>
</tr>
<tr class="row-even"><td><p>auto_resume</p></td>
<td><p>(bool) - if there are already the last checkpoint in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.HearESC50.run" title="s3prl.problem.HearESC50.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>),                                                 whether to resume from it or delete it and start a new training session.</p></td>
</tr>
<tr class="row-odd"><td><p>resume_ckpt_dir</p></td>
<td><p>(str) - you can directly specify the checkpoint path to resume which is not necessary                                                 in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.HearESC50.run" title="s3prl.problem.HearESC50.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>).</p></td>
</tr>
<tr class="row-even"><td><p>seed</p></td>
<td><p>(int) - fix the seed before the training start</p></td>
</tr>
<tr class="row-odd"><td><p>keep_num_ckpts</p></td>
<td><p>(int) - to prevent saving too many checkpoints, only save the <code class="code docutils literal notranslate"><span class="pre">keep_num_ckpts</span></code>                                                 latest checkpoints and delete the old ones.</p></td>
</tr>
<tr class="row-even"><td><p>use_scheduler</p></td>
<td><p>(bool) - whether to use the scheduler</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="hearbeijingopera">
<h2>HearBeijingOpera<a class="headerlink" href="#hearbeijingopera" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="s3prl.problem.HearBeijingOpera">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">s3prl.problem.</span></span><span class="sig-name descname"><span class="pre">HearBeijingOpera</span></span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_beijing_opera.html#HearBeijingOpera"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_beijing_opera.py#L10-L78"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearBeijingOpera" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="s3prl.problem.common.hear_esc50.html#s3prl.problem.common.hear_esc50.HearESC50" title="s3prl.problem.common.hear_esc50.HearESC50"><code class="xref py py-class docutils literal notranslate"><span class="pre">HearESC50</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearBeijingOpera.default_config">
<span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_beijing_opera.html#HearBeijingOpera.default_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_beijing_opera.py#L11-L78"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearBeijingOpera.default_config" title="Permalink to this definition">#</a></dt>
<dd><p>The default arguments for <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.run" title="s3prl.problem.HearBeijingOpera.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> in yaml.
Note that for the fields with inner values, like <code class="code docutils literal notranslate"><span class="pre">build_model</span></code>,
the outer field name corresponds to a method name, so you can find the method
<a class="reference internal" href="#s3prl.problem.HearBeijingOpera.build_model" title="s3prl.problem.HearBeijingOpera.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>. Furthermore, the values inside that field will be
directly passed into the method. So by changing these inner values, you
can directly affect the behavior of the corresponding method. See the method
documentation for all the supported arguments and their meanings.</p>
<p>The methods affected by the following config are: <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.prepare_data" title="s3prl.problem.HearBeijingOpera.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.build_batch_sampler" title="s3prl.problem.HearBeijingOpera.build_batch_sampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_batch_sampler</span></code></a> <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.build_upstream" title="s3prl.problem.HearBeijingOpera.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a> <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.build_featurizer" title="s3prl.problem.HearBeijingOpera.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a> <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.build_downstream" title="s3prl.problem.HearBeijingOpera.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a> <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.build_model" title="s3prl.problem.HearBeijingOpera.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.build_task" title="s3prl.problem.HearBeijingOpera.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.build_optimizer" title="s3prl.problem.HearBeijingOpera.build_optimizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_optimizer</span></code></a> <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.build_scheduler" title="s3prl.problem.HearBeijingOpera.build_scheduler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_scheduler</span></code></a> <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.save_model" title="s3prl.problem.HearBeijingOpera.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a> <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.save_task" title="s3prl.problem.HearBeijingOpera.save_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_task</span></code></a> <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.train" title="s3prl.problem.HearBeijingOpera.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.evaluate" title="s3prl.problem.HearBeijingOpera.evaluate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate</span></code></a></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">start</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="nt">stop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">target_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">cache_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">remove_all_cache</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">prepare_data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">dataset_root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="w">  </span><span class="nt">test_fold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="w">  </span><span class="nt">num_folds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="nt">build_batch_sampler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">train</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">32</span>
<span class="w">    </span><span class="nt">shuffle</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">valid</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">test</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="nt">build_upstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">build_featurizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">layer_selections</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="nt">normalize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_downstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">hidden_layers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">  </span><span class="nt">pooling_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MeanPooling</span>
<span class="nt">build_model</span><span class="p">:</span>
<span class="w">  </span><span class="nt">upstream_trainable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_task</span><span class="p">:</span>
<span class="w">  </span><span class="nt">prediction_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">multiclass</span>
<span class="w">  </span><span class="nt">scores</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top1_acc</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">d_prime</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aucroc</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mAP</span>
<span class="nt">build_optimizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Adam</span>
<span class="w">  </span><span class="nt">conf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">lr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.001</span>
<span class="nt">build_scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ExponentialLR</span>
<span class="w">  </span><span class="nt">gamma</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.9</span>
<span class="nt">save_model</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">save_task</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">train</span><span class="p">:</span>
<span class="w">  </span><span class="nt">total_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">150000</span>
<span class="w">  </span><span class="nt">log_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">  </span><span class="nt">eval_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span>
<span class="w">  </span><span class="nt">save_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">  </span><span class="nt">gradient_clipping</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0</span>
<span class="w">  </span><span class="nt">gradient_accumulate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">valid_metric</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top1_acc</span>
<span class="w">  </span><span class="nt">valid_higher_better</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">auto_resume</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">resume_ckpt_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">evaluate</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearBeijingOpera.build_batch_sampler">
<span class="sig-name descname"><span class="pre">build_batch_sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L213-L229"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearBeijingOpera.build_batch_sampler" title="Permalink to this definition">#</a></dt>
<dd><p>Return the batch sampler for torch DataLoader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_batch_sampler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.default_config" title="s3prl.problem.HearBeijingOpera.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>train</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>valid</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-even"><td><p>test</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">mode</span></code> specific csv from <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.prepare_data" title="s3prl.problem.HearBeijingOpera.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>dataset</strong> – the dataset from <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.build_dataset" title="s3prl.problem.HearBeijingOpera.build_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_dataset</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>batch sampler for torch DataLoader</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearBeijingOpera.build_collate_fn">
<span class="sig-name descname"><span class="pre">build_collate_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L143-L156"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearBeijingOpera.build_collate_fn" title="Permalink to this definition">#</a></dt>
<dd><p>By default returns <code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataset.base.default_collate_fn</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_collate_fn</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.default_config" title="s3prl.problem.HearBeijingOpera.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train, valid, or test</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>callable</p>
<p>the collate_fn for torch DataLoader in train/valid/test <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearBeijingOpera.build_dataset">
<span class="sig-name descname"><span class="pre">build_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_shift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L172-L211"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearBeijingOpera.build_dataset" title="Permalink to this definition">#</a></dt>
<dd><p>Build the dataset for train/valid/test.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_dataset</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.default_config" title="s3prl.problem.HearBeijingOpera.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>. with <code class="code docutils literal notranslate"><span class="pre">train</span></code>, <code class="code docutils literal notranslate"><span class="pre">valid</span></code>, <code class="code docutils literal notranslate"><span class="pre">test</span></code> keys, each
is a dictionary with the following supported options:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>max_secs</p></td>
<td><p>(float) - If a waveform is longer than <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds, randomly crop the waveform into <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds</p></td>
</tr>
<tr class="row-odd"><td><p>sox_effects</p></td>
<td><p>(List[List[str]]) - If not None, apply sox effects on the utterance</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – The metadata csv file for the specific <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p></li>
<li><p><strong>encoder_path</strong> (<em>str</em>) – The pickled encoder path for encoding the labels</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch Dataset</p>
<p>For all train/valid/test mode, the dataset should return each item as a dictionary
containing the following keys:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>x</p></td>
<td><p>(torch.FloatTensor) - the waveform in (seq_len, 1)</p></td>
</tr>
<tr class="row-odd"><td><p>x_len</p></td>
<td><p>(int) - the waveform length <code class="code docutils literal notranslate"><span class="pre">seq_len</span></code></p></td>
</tr>
<tr class="row-even"><td><p>class_id</p></td>
<td><p>(int) - the encoded class id</p></td>
</tr>
<tr class="row-odd"><td><p>label</p></td>
<td><p>(str) - the class name</p></td>
</tr>
<tr class="row-even"><td><p>unique_name</p></td>
<td><p>(str) - the unique id for this datapoint</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearBeijingOpera.build_downstream">
<span class="sig-name descname"><span class="pre">build_downstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L231-L240"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearBeijingOpera.build_downstream" title="Permalink to this definition">#</a></dt>
<dd><p>Return the task-specific downstream model.
By default build the <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code> model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.default_config" title="s3prl.problem.HearBeijingOpera.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments of <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code></p></li>
<li><p><strong>downstream_input_size</strong> (<em>int</em>) – the required input size of the model</p></li>
<li><p><strong>downstream_output_size</strong> (<em>int</em>) – the required output size of the model</p></li>
<li><p><strong>downstream_input_stride</strong> (<em>int</em>) – the input feature’s stride (from 16 KHz)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUtteranceModel" title="s3prl.nn.interface.AbsUtteranceModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUtteranceModel</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearBeijingOpera.build_encoder">
<span class="sig-name descname"><span class="pre">build_encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_csv_paths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L142-L170"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearBeijingOpera.build_encoder" title="Permalink to this definition">#</a></dt>
<dd><p>Build the encoder (for the labels) given the data metadata, and return the saved encoder path.
By default generate and save a <a class="reference internal" href="s3prl.dataio.encoder.html#s3prl.dataio.encoder.CategoryEncoder" title="s3prl.dataio.encoder.CategoryEncoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataio.encoder.CategoryEncoder</span></code></a> from the <code class="code docutils literal notranslate"><span class="pre">label</span></code> column of all the csv files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_encoder</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.default_config" title="s3prl.problem.HearBeijingOpera.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Save your encoder into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>train_csv_path</strong> (<em>str</em>) – the train path from <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.prepare_data" title="s3prl.problem.HearBeijingOpera.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>valid_csv_path</strong> (<em>str</em>) – the valid path from <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.prepare_data" title="s3prl.problem.HearBeijingOpera.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>test_csv_paths</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – the test paths from <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.prepare_data" title="s3prl.problem.HearBeijingOpera.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>str</p>
<p>encoder_path: The encoder should be saved in the pickle format</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearBeijingOpera.build_featurizer">
<span class="sig-name descname"><span class="pre">build_featurizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upstream</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L175-L192"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearBeijingOpera.build_featurizer" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the featurizer with <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.default_config" title="s3prl.problem.HearBeijingOpera.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p></li>
<li><p><strong>upstream</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">AbsUpstream</span></code>) – the upstream model built by <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.build_upstream" title="s3prl.problem.HearBeijingOpera.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsFeaturizer" title="s3prl.nn.interface.AbsFeaturizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsFeaturizer</span></code></a></p>
<p>Return the featurizer model. The featurizer is used to reduce the multiple
hidden states returned from the upstream model (built by <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.build_upstream" title="s3prl.problem.HearBeijingOpera.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>)
into a single hidden state, so can be easliy fed into the downstream model</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearBeijingOpera.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L194-L231"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearBeijingOpera.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>By default build model with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.default_config" title="s3prl.problem.HearBeijingOpera.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p></li>
<li><p><strong>model_output_size</strong> (<em>int</em>) – the required model’s output hidden size</p></li>
<li><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.default_config" title="s3prl.problem.HearBeijingOpera.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.build_upstream" title="s3prl.problem.HearBeijingOpera.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.default_config" title="s3prl.problem.HearBeijingOpera.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.build_featurizer" title="s3prl.problem.HearBeijingOpera.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a></p></li>
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.default_config" title="s3prl.problem.HearBeijingOpera.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.build_downstream" title="s3prl.problem.HearBeijingOpera.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch.nn.Module</p>
<p>Return the entire model for the task, which takes the direct items from DataLoader as the input.
Usually, the components can be built by <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.build_upstream" title="s3prl.problem.HearBeijingOpera.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>, <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.build_featurizer" title="s3prl.problem.HearBeijingOpera.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a>,
<a class="reference internal" href="#s3prl.problem.HearBeijingOpera.build_downstream" title="s3prl.problem.HearBeijingOpera.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a>, and are concated together to get the final model.
The upstream extracts multiple hidden states, the featuizer reduce them into a single hidden state,
and the downstream takes the hidden states as the feature for the downstream-specific model.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearBeijingOpera.build_optimizer">
<span class="sig-name descname"><span class="pre">build_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L233-L258"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearBeijingOpera.build_optimizer" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_optimizer</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.default_config" title="s3prl.problem.HearBeijingOpera.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to below</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the optimizer class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the optimizer class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;lr&quot;:</span> <span class="pre">1.0e-4}</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>parameters</strong> (<em>iterable</em>) – the standard params accepted by <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code></p>
<p>An optimizer following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearBeijingOpera.build_scheduler">
<span class="sig-name descname"><span class="pre">build_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L260-L285"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearBeijingOpera.build_scheduler" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_scheduler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.default_config" title="s3prl.problem.HearBeijingOpera.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the scheduler class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the scheduler class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;gamma&quot;:</span> <span class="pre">0.01}</span></code> for <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler.StepLR</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>optimizer</strong> – the standard torch optimizer accepted by Scheduler in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch scheduler</p>
<p>A scheduler following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearBeijingOpera.build_task">
<span class="sig-name descname"><span class="pre">build_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L242-L250"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearBeijingOpera.build_task" title="Permalink to this definition">#</a></dt>
<dd><p>Build the task, which defines the logics for every train/valid/test forward step for the <code class="code docutils literal notranslate"><span class="pre">model</span></code>,
and the logics for how to reduce all the batch results from multiple train/valid/test steps into metrics</p>
<p>By default build <code class="xref py py-obj docutils literal notranslate"><span class="pre">UtteranceClassificationTask</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.default_config" title="s3prl.problem.HearBeijingOpera.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model built by <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.build_model" title="s3prl.problem.HearBeijingOpera.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a></p></li>
<li><p><strong>encoder</strong> – the encoder built by <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.build_encoder" title="s3prl.problem.HearBeijingOpera.build_encoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_encoder</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Task</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearBeijingOpera.build_upstream">
<span class="sig-name descname"><span class="pre">build_upstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L158-L173"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearBeijingOpera.build_upstream" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the upstream with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.default_config" title="s3prl.problem.HearBeijingOpera.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUpstream" title="s3prl.nn.interface.AbsUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUpstream</span></code></a></p>
<p>Return an upstream model, whose forward takes the waveform input and returns
multiple hidden states as features.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearBeijingOpera.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L660-L707"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearBeijingOpera.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>The evaluate routine used by <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.train" title="s3prl.problem.HearBeijingOpera.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> (during validation phase) and <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.run" title="s3prl.problem.HearBeijingOpera.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>
(during testing phase).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evaluate</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.default_config" title="s3prl.problem.HearBeijingOpera.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearBeijingOpera.get_class_from_name">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_class_from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L129-L141"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearBeijingOpera.get_class_from_name" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">__name__</span></code> of the problem class</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Problem</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearBeijingOpera.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L752-L772"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearBeijingOpera.load_model" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model_ckpt_dir</strong> (<em>str</em>) – Restore the model with <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.build_model" title="s3prl.problem.HearBeijingOpera.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> and the checkpoint
saved in this directory.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearBeijingOpera.load_model_and_task">
<span class="sig-name descname"><span class="pre">load_model_and_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ckpts_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L884-L902"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearBeijingOpera.load_model_and_task" title="Permalink to this definition">#</a></dt>
<dd><p>This is a helper method to combine <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.load_model" title="s3prl.problem.HearBeijingOpera.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a> and <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.load_task" title="s3prl.problem.HearBeijingOpera.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>
together to directly load the model and the task. This method assumes
the model is saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'model'</span></code> and the task is
saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'task'</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>model (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>)</p></li>
<li><p>task (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a>)</p></li>
</ol>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearBeijingOpera.load_task">
<span class="sig-name descname"><span class="pre">load_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L833-L882"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearBeijingOpera.load_task" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – Restore the task with <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.build_task" title="s3prl.problem.HearBeijingOpera.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> and the checkpoint
saved in this directory.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model for the task, since the model is separately saved
and is required for <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.build_task" title="s3prl.problem.HearBeijingOpera.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a>.</p></li>
<li><p><strong>task_overrides</strong> (<em>dict</em>) – overrides the saved initialization arguments, so can change
the loaded task’s behavior. Like, change the decoding hyperparameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearBeijingOpera.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L954-L995"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearBeijingOpera.main" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearBeijingOpera.prepare_data">
<span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_esc50.py#L151-L160"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearBeijingOpera.prepare_data" title="Permalink to this definition">#</a></dt>
<dd><p>Prepare the task-specific data metadata (path, labels…).
By default call <code class="xref py py-obj docutils literal notranslate"><span class="pre">voxceleb1_for_sid</span></code> with <code class="code docutils literal notranslate"><span class="pre">**prepare_data</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prepare_data</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.default_config" title="s3prl.problem.HearBeijingOpera.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments in <code class="xref py py-obj docutils literal notranslate"><span class="pre">voxceleb1_for_sid</span></code></p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Parse your corpus and save the csv file into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the parsing or preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>train_path (str)</p></li>
<li><p>valid_path (str)</p></li>
<li><p>test_paths (List[str])</p></li>
</ol>
<p>Each path (str) should be a csv file containing the following columns:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>column</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>(str) - the unique id for this data point</p></td>
</tr>
<tr class="row-odd"><td><p>wav_path</p></td>
<td><p>(str) - the absolute path of the waveform file</p></td>
</tr>
<tr class="row-even"><td><p>label</p></td>
<td><p>(str) - a string label of the waveform</p></td>
</tr>
<tr class="row-odd"><td><p>start_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">start_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load from the beginning.</p></td>
</tr>
<tr class="row-even"><td><p>end_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">end_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load to the end.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearBeijingOpera.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_all_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cuda'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/run.py#L26-L318"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearBeijingOpera.run" title="Permalink to this definition">#</a></dt>
<dd><div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>stage</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Parse the corpus and save the metadata file (waveform path, label…)</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Build the encoder to encode the labels</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Train the model</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Evaluate the model on multiple test sets</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_dir</strong> (<em>str</em>) – The directory that stores the script result.</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – The directory that caches the processed data.
Default: /home/user/.cache/s3prl/data</p></li>
<li><p><strong>remove_all_cache</strong> (<em>bool</em>) – Whether to remove all the cache stored under <cite>cache_dir</cite>.
Default: False</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting stage of the problem script.
Default: 0</p></li>
<li><p><strong>stop</strong> (<em>int</em>) – The stoping stage of the problem script, set <cite>None</cite> to reach the final stage.
Default: None</p></li>
<li><p><strong>num_workers</strong> (<em>int</em>) – num_workers for all the torch DataLoder</p></li>
<li><p><strong>eval_batch</strong> (<em>int</em>) – During evaluation (valid or test), limit the number of batch.
This is helpful for the fast development to check everything won’t crash.
If is -1, disable this feature and evaluate the entire epoch.
Default: -1</p></li>
<li><p><strong>device</strong> (<em>str</em>) – The device type for all torch-related operation: “cpu” or “cuda”
Default: “cuda”</p></li>
<li><p><strong>world_size</strong> (<em>int</em>) – How many processes are running this script simultaneously (in parallel).
Usually this is just 1, however if you are runnig distributed training,
this should be &gt; 1.
Default: 1</p></li>
<li><p><strong>rank</strong> (<em>int</em>) – When distributed training, world_size &gt; 1. Take <code class="code docutils literal notranslate"><span class="pre">world_size</span> <span class="pre">==</span> <span class="pre">8</span></code> for
example, this means 8 processes (8 GPUs) are runing in parallel. The script
needs to know which process among 8 processes it is. In this case, <code class="code docutils literal notranslate"><span class="pre">rank</span></code>
can range from 0~7. All the 8 processes have the same <code class="code docutils literal notranslate"><span class="pre">world_size</span></code> but
different <code class="code docutils literal notranslate"><span class="pre">rank</span></code> (process id).</p></li>
<li><p><strong>test_ckpt_dir</strong> (<em>str</em>) – Specify the checkpoint path for testing. If not, use the validation best
checkpoint under the given <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> directory.</p></li>
<li><p><strong>**kwds</strong> – The other arguments like <code class="code docutils literal notranslate"><span class="pre">prepare_data</span></code> and <code class="code docutils literal notranslate"><span class="pre">build_model</span></code> are
method specific-arguments for methods like <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.prepare_data" title="s3prl.problem.HearBeijingOpera.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> and
<a class="reference internal" href="#s3prl.problem.HearBeijingOpera.build_model" title="s3prl.problem.HearBeijingOpera.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>, and will not be used in the core <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.run" title="s3prl.problem.HearBeijingOpera.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> logic.
See the specific method documentation for their supported arguments and
meaning</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearBeijingOpera.save_model">
<span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L709-L750"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearBeijingOpera.save_model" title="Permalink to this definition">#</a></dt>
<dd><p>Save the model state_dict and the model initialization arguments into the given directory.
If you override this method, it is highly possible you also need to override <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.load_model" title="s3prl.problem.HearBeijingOpera.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.default_config" title="s3prl.problem.HearBeijingOpera.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_model</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>model_ckpt_dir</strong> (<em>str</em>) – save the model into the this directory.</p></li>
<li><p><strong>build_model_all_args</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.build_model" title="s3prl.problem.HearBeijingOpera.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>.
By saving this dictionary, you can easily reconstruct the same model
by calling <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.build_model" title="s3prl.problem.HearBeijingOpera.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearBeijingOpera.save_task">
<span class="sig-name descname"><span class="pre">save_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="s3prl.task.base.html#s3prl.task.base.Task" title="s3prl.task.base.Task"><span class="pre">Task</span></a></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L774-L831"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearBeijingOpera.save_task" title="Permalink to this definition">#</a></dt>
<dd><p>Save the task’s state, <code class="code docutils literal notranslate"><span class="pre">task.get_state()</span></code>, and the initialization arguments into the given
directory. If you override this method, it is highly possible you also need to override
<a class="reference internal" href="#s3prl.problem.HearBeijingOpera.load_task" title="s3prl.problem.HearBeijingOpera.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.default_config" title="s3prl.problem.HearBeijingOpera.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_task</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – save the task into this directory.</p></li>
<li><p><strong>build_task_all_args_except_model</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.build_task" title="s3prl.problem.HearBeijingOpera.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> except
the <code class="code docutils literal notranslate"><span class="pre">model</span></code> argument since the model should be sapartely saved by
<a class="reference internal" href="#s3prl.problem.HearBeijingOpera.save_model" title="s3prl.problem.HearBeijingOpera.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a>. By saving this dictionary, you can easily reconstruct the same task
by calling <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.build_task" title="s3prl.problem.HearBeijingOpera.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>task</strong> (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><em>Task</em></a>) – the task to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearBeijingOpera.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L287-L658"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearBeijingOpera.train" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.default_config" title="s3prl.problem.HearBeijingOpera.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>total_steps</p></td>
<td><p>(int) - the total optimization steps</p></td>
</tr>
<tr class="row-odd"><td><p>log_step</p></td>
<td><p>(int) - logging frequency. log every <code class="code docutils literal notranslate"><span class="pre">log_step</span></code> step</p></td>
</tr>
<tr class="row-even"><td><p>eval_step</p></td>
<td><p>(int) - evaluation frequency. Evaluate every <code class="code docutils literal notranslate"><span class="pre">eval_step</span></code> step.                                                 Note that you can control how many batch to evaluate to speed up the                                                 development by the <code class="code docutils literal notranslate"><span class="pre">eval_batch</span></code> argument in <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.run" title="s3prl.problem.HearBeijingOpera.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>save_step</p></td>
<td><p>(int) - save the checkpoint every <code class="code docutils literal notranslate"><span class="pre">save_step</span></code> step.</p></td>
</tr>
<tr class="row-even"><td><p>gradient_clipping</p></td>
<td><p>(float) - clip the gradient. important for RNNs.</p></td>
</tr>
<tr class="row-odd"><td><p>gradient_accumulate</p></td>
<td><p>(int) - accumulate multiple steps’ gradient before updating network parameters                                                 to simulate large-batch optimization.</p></td>
</tr>
<tr class="row-even"><td><p>valid_metric</p></td>
<td><p>(str) - the metric to select the best valid checkpoint. Different Tasks have different                                                 supported valid_metrics. See <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.build_task" title="s3prl.problem.HearBeijingOpera.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> for the supported metrics.</p></td>
</tr>
<tr class="row-odd"><td><p>valid_higher_better</p></td>
<td><p>(bool) - some metrics are higher better, while some are lower better                                                 this will affect how to save the best validation checkpoint.</p></td>
</tr>
<tr class="row-even"><td><p>auto_resume</p></td>
<td><p>(bool) - if there are already the last checkpoint in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.run" title="s3prl.problem.HearBeijingOpera.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>),                                                 whether to resume from it or delete it and start a new training session.</p></td>
</tr>
<tr class="row-odd"><td><p>resume_ckpt_dir</p></td>
<td><p>(str) - you can directly specify the checkpoint path to resume which is not necessary                                                 in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.HearBeijingOpera.run" title="s3prl.problem.HearBeijingOpera.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>).</p></td>
</tr>
<tr class="row-even"><td><p>seed</p></td>
<td><p>(int) - fix the seed before the training start</p></td>
</tr>
<tr class="row-odd"><td><p>keep_num_ckpts</p></td>
<td><p>(int) - to prevent saving too many checkpoints, only save the <code class="code docutils literal notranslate"><span class="pre">keep_num_ckpts</span></code>                                                 latest checkpoints and delete the old ones.</p></td>
</tr>
<tr class="row-even"><td><p>use_scheduler</p></td>
<td><p>(bool) - whether to use the scheduler</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="hearcremad">
<h2>HearCremaD<a class="headerlink" href="#hearcremad" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="s3prl.problem.HearCremaD">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">s3prl.problem.</span></span><span class="sig-name descname"><span class="pre">HearCremaD</span></span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_cremad.html#HearCremaD"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_cremad.py#L10-L78"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearCremaD" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="s3prl.problem.common.hear_esc50.html#s3prl.problem.common.hear_esc50.HearESC50" title="s3prl.problem.common.hear_esc50.HearESC50"><code class="xref py py-class docutils literal notranslate"><span class="pre">HearESC50</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearCremaD.default_config">
<span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_cremad.html#HearCremaD.default_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_cremad.py#L11-L78"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearCremaD.default_config" title="Permalink to this definition">#</a></dt>
<dd><p>The default arguments for <a class="reference internal" href="#s3prl.problem.HearCremaD.run" title="s3prl.problem.HearCremaD.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> in yaml.
Note that for the fields with inner values, like <code class="code docutils literal notranslate"><span class="pre">build_model</span></code>,
the outer field name corresponds to a method name, so you can find the method
<a class="reference internal" href="#s3prl.problem.HearCremaD.build_model" title="s3prl.problem.HearCremaD.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>. Furthermore, the values inside that field will be
directly passed into the method. So by changing these inner values, you
can directly affect the behavior of the corresponding method. See the method
documentation for all the supported arguments and their meanings.</p>
<p>The methods affected by the following config are: <a class="reference internal" href="#s3prl.problem.HearCremaD.prepare_data" title="s3prl.problem.HearCremaD.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> <a class="reference internal" href="#s3prl.problem.HearCremaD.build_batch_sampler" title="s3prl.problem.HearCremaD.build_batch_sampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_batch_sampler</span></code></a> <a class="reference internal" href="#s3prl.problem.HearCremaD.build_upstream" title="s3prl.problem.HearCremaD.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a> <a class="reference internal" href="#s3prl.problem.HearCremaD.build_featurizer" title="s3prl.problem.HearCremaD.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a> <a class="reference internal" href="#s3prl.problem.HearCremaD.build_downstream" title="s3prl.problem.HearCremaD.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a> <a class="reference internal" href="#s3prl.problem.HearCremaD.build_model" title="s3prl.problem.HearCremaD.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> <a class="reference internal" href="#s3prl.problem.HearCremaD.build_task" title="s3prl.problem.HearCremaD.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> <a class="reference internal" href="#s3prl.problem.HearCremaD.build_optimizer" title="s3prl.problem.HearCremaD.build_optimizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_optimizer</span></code></a> <a class="reference internal" href="#s3prl.problem.HearCremaD.build_scheduler" title="s3prl.problem.HearCremaD.build_scheduler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_scheduler</span></code></a> <a class="reference internal" href="#s3prl.problem.HearCremaD.save_model" title="s3prl.problem.HearCremaD.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a> <a class="reference internal" href="#s3prl.problem.HearCremaD.save_task" title="s3prl.problem.HearCremaD.save_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_task</span></code></a> <a class="reference internal" href="#s3prl.problem.HearCremaD.train" title="s3prl.problem.HearCremaD.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> <a class="reference internal" href="#s3prl.problem.HearCremaD.evaluate" title="s3prl.problem.HearCremaD.evaluate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate</span></code></a></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">start</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="nt">stop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">target_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">cache_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">remove_all_cache</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">prepare_data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">dataset_root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="w">  </span><span class="nt">test_fold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="w">  </span><span class="nt">num_folds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="nt">build_batch_sampler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">train</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">32</span>
<span class="w">    </span><span class="nt">shuffle</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">valid</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">test</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="nt">build_upstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">build_featurizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">layer_selections</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="nt">normalize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_downstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">hidden_layers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">  </span><span class="nt">pooling_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MeanPooling</span>
<span class="nt">build_model</span><span class="p">:</span>
<span class="w">  </span><span class="nt">upstream_trainable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_task</span><span class="p">:</span>
<span class="w">  </span><span class="nt">prediction_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">multiclass</span>
<span class="w">  </span><span class="nt">scores</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top1_acc</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mAP</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">d_prime</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aucroc</span>
<span class="nt">build_optimizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Adam</span>
<span class="w">  </span><span class="nt">conf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">lr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0001</span>
<span class="nt">build_scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ExponentialLR</span>
<span class="w">  </span><span class="nt">gamma</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.9</span>
<span class="nt">save_model</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">save_task</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">train</span><span class="p">:</span>
<span class="w">  </span><span class="nt">total_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">150000</span>
<span class="w">  </span><span class="nt">log_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">  </span><span class="nt">eval_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span>
<span class="w">  </span><span class="nt">save_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">  </span><span class="nt">gradient_clipping</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0</span>
<span class="w">  </span><span class="nt">gradient_accumulate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">valid_metric</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top1_acc</span>
<span class="w">  </span><span class="nt">valid_higher_better</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">auto_resume</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">resume_ckpt_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">evaluate</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearCremaD.build_batch_sampler">
<span class="sig-name descname"><span class="pre">build_batch_sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L213-L229"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearCremaD.build_batch_sampler" title="Permalink to this definition">#</a></dt>
<dd><p>Return the batch sampler for torch DataLoader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_batch_sampler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearCremaD.default_config" title="s3prl.problem.HearCremaD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>train</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>valid</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-even"><td><p>test</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">mode</span></code> specific csv from <a class="reference internal" href="#s3prl.problem.HearCremaD.prepare_data" title="s3prl.problem.HearCremaD.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>dataset</strong> – the dataset from <a class="reference internal" href="#s3prl.problem.HearCremaD.build_dataset" title="s3prl.problem.HearCremaD.build_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_dataset</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>batch sampler for torch DataLoader</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearCremaD.build_collate_fn">
<span class="sig-name descname"><span class="pre">build_collate_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L143-L156"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearCremaD.build_collate_fn" title="Permalink to this definition">#</a></dt>
<dd><p>By default returns <code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataset.base.default_collate_fn</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_collate_fn</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearCremaD.default_config" title="s3prl.problem.HearCremaD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train, valid, or test</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>callable</p>
<p>the collate_fn for torch DataLoader in train/valid/test <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearCremaD.build_dataset">
<span class="sig-name descname"><span class="pre">build_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_shift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L172-L211"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearCremaD.build_dataset" title="Permalink to this definition">#</a></dt>
<dd><p>Build the dataset for train/valid/test.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_dataset</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearCremaD.default_config" title="s3prl.problem.HearCremaD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>. with <code class="code docutils literal notranslate"><span class="pre">train</span></code>, <code class="code docutils literal notranslate"><span class="pre">valid</span></code>, <code class="code docutils literal notranslate"><span class="pre">test</span></code> keys, each
is a dictionary with the following supported options:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>max_secs</p></td>
<td><p>(float) - If a waveform is longer than <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds, randomly crop the waveform into <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds</p></td>
</tr>
<tr class="row-odd"><td><p>sox_effects</p></td>
<td><p>(List[List[str]]) - If not None, apply sox effects on the utterance</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – The metadata csv file for the specific <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p></li>
<li><p><strong>encoder_path</strong> (<em>str</em>) – The pickled encoder path for encoding the labels</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch Dataset</p>
<p>For all train/valid/test mode, the dataset should return each item as a dictionary
containing the following keys:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>x</p></td>
<td><p>(torch.FloatTensor) - the waveform in (seq_len, 1)</p></td>
</tr>
<tr class="row-odd"><td><p>x_len</p></td>
<td><p>(int) - the waveform length <code class="code docutils literal notranslate"><span class="pre">seq_len</span></code></p></td>
</tr>
<tr class="row-even"><td><p>class_id</p></td>
<td><p>(int) - the encoded class id</p></td>
</tr>
<tr class="row-odd"><td><p>label</p></td>
<td><p>(str) - the class name</p></td>
</tr>
<tr class="row-even"><td><p>unique_name</p></td>
<td><p>(str) - the unique id for this datapoint</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearCremaD.build_downstream">
<span class="sig-name descname"><span class="pre">build_downstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L231-L240"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearCremaD.build_downstream" title="Permalink to this definition">#</a></dt>
<dd><p>Return the task-specific downstream model.
By default build the <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code> model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearCremaD.default_config" title="s3prl.problem.HearCremaD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments of <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code></p></li>
<li><p><strong>downstream_input_size</strong> (<em>int</em>) – the required input size of the model</p></li>
<li><p><strong>downstream_output_size</strong> (<em>int</em>) – the required output size of the model</p></li>
<li><p><strong>downstream_input_stride</strong> (<em>int</em>) – the input feature’s stride (from 16 KHz)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUtteranceModel" title="s3prl.nn.interface.AbsUtteranceModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUtteranceModel</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearCremaD.build_encoder">
<span class="sig-name descname"><span class="pre">build_encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_csv_paths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L142-L170"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearCremaD.build_encoder" title="Permalink to this definition">#</a></dt>
<dd><p>Build the encoder (for the labels) given the data metadata, and return the saved encoder path.
By default generate and save a <a class="reference internal" href="s3prl.dataio.encoder.html#s3prl.dataio.encoder.CategoryEncoder" title="s3prl.dataio.encoder.CategoryEncoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataio.encoder.CategoryEncoder</span></code></a> from the <code class="code docutils literal notranslate"><span class="pre">label</span></code> column of all the csv files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_encoder</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearCremaD.default_config" title="s3prl.problem.HearCremaD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Save your encoder into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>train_csv_path</strong> (<em>str</em>) – the train path from <a class="reference internal" href="#s3prl.problem.HearCremaD.prepare_data" title="s3prl.problem.HearCremaD.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>valid_csv_path</strong> (<em>str</em>) – the valid path from <a class="reference internal" href="#s3prl.problem.HearCremaD.prepare_data" title="s3prl.problem.HearCremaD.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>test_csv_paths</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – the test paths from <a class="reference internal" href="#s3prl.problem.HearCremaD.prepare_data" title="s3prl.problem.HearCremaD.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>str</p>
<p>encoder_path: The encoder should be saved in the pickle format</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearCremaD.build_featurizer">
<span class="sig-name descname"><span class="pre">build_featurizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upstream</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L175-L192"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearCremaD.build_featurizer" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the featurizer with <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearCremaD.default_config" title="s3prl.problem.HearCremaD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p></li>
<li><p><strong>upstream</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">AbsUpstream</span></code>) – the upstream model built by <a class="reference internal" href="#s3prl.problem.HearCremaD.build_upstream" title="s3prl.problem.HearCremaD.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsFeaturizer" title="s3prl.nn.interface.AbsFeaturizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsFeaturizer</span></code></a></p>
<p>Return the featurizer model. The featurizer is used to reduce the multiple
hidden states returned from the upstream model (built by <a class="reference internal" href="#s3prl.problem.HearCremaD.build_upstream" title="s3prl.problem.HearCremaD.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>)
into a single hidden state, so can be easliy fed into the downstream model</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearCremaD.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L194-L231"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearCremaD.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>By default build model with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearCremaD.default_config" title="s3prl.problem.HearCremaD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p></li>
<li><p><strong>model_output_size</strong> (<em>int</em>) – the required model’s output hidden size</p></li>
<li><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearCremaD.default_config" title="s3prl.problem.HearCremaD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearCremaD.build_upstream" title="s3prl.problem.HearCremaD.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearCremaD.default_config" title="s3prl.problem.HearCremaD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearCremaD.build_featurizer" title="s3prl.problem.HearCremaD.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a></p></li>
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearCremaD.default_config" title="s3prl.problem.HearCremaD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearCremaD.build_downstream" title="s3prl.problem.HearCremaD.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch.nn.Module</p>
<p>Return the entire model for the task, which takes the direct items from DataLoader as the input.
Usually, the components can be built by <a class="reference internal" href="#s3prl.problem.HearCremaD.build_upstream" title="s3prl.problem.HearCremaD.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>, <a class="reference internal" href="#s3prl.problem.HearCremaD.build_featurizer" title="s3prl.problem.HearCremaD.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a>,
<a class="reference internal" href="#s3prl.problem.HearCremaD.build_downstream" title="s3prl.problem.HearCremaD.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a>, and are concated together to get the final model.
The upstream extracts multiple hidden states, the featuizer reduce them into a single hidden state,
and the downstream takes the hidden states as the feature for the downstream-specific model.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearCremaD.build_optimizer">
<span class="sig-name descname"><span class="pre">build_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L233-L258"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearCremaD.build_optimizer" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_optimizer</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearCremaD.default_config" title="s3prl.problem.HearCremaD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to below</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the optimizer class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the optimizer class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;lr&quot;:</span> <span class="pre">1.0e-4}</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>parameters</strong> (<em>iterable</em>) – the standard params accepted by <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code></p>
<p>An optimizer following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearCremaD.build_scheduler">
<span class="sig-name descname"><span class="pre">build_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L260-L285"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearCremaD.build_scheduler" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_scheduler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearCremaD.default_config" title="s3prl.problem.HearCremaD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the scheduler class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the scheduler class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;gamma&quot;:</span> <span class="pre">0.01}</span></code> for <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler.StepLR</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>optimizer</strong> – the standard torch optimizer accepted by Scheduler in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch scheduler</p>
<p>A scheduler following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearCremaD.build_task">
<span class="sig-name descname"><span class="pre">build_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L242-L250"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearCremaD.build_task" title="Permalink to this definition">#</a></dt>
<dd><p>Build the task, which defines the logics for every train/valid/test forward step for the <code class="code docutils literal notranslate"><span class="pre">model</span></code>,
and the logics for how to reduce all the batch results from multiple train/valid/test steps into metrics</p>
<p>By default build <code class="xref py py-obj docutils literal notranslate"><span class="pre">UtteranceClassificationTask</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearCremaD.default_config" title="s3prl.problem.HearCremaD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model built by <a class="reference internal" href="#s3prl.problem.HearCremaD.build_model" title="s3prl.problem.HearCremaD.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a></p></li>
<li><p><strong>encoder</strong> – the encoder built by <a class="reference internal" href="#s3prl.problem.HearCremaD.build_encoder" title="s3prl.problem.HearCremaD.build_encoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_encoder</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Task</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearCremaD.build_upstream">
<span class="sig-name descname"><span class="pre">build_upstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L158-L173"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearCremaD.build_upstream" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the upstream with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearCremaD.default_config" title="s3prl.problem.HearCremaD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUpstream" title="s3prl.nn.interface.AbsUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUpstream</span></code></a></p>
<p>Return an upstream model, whose forward takes the waveform input and returns
multiple hidden states as features.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearCremaD.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L660-L707"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearCremaD.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>The evaluate routine used by <a class="reference internal" href="#s3prl.problem.HearCremaD.train" title="s3prl.problem.HearCremaD.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> (during validation phase) and <a class="reference internal" href="#s3prl.problem.HearCremaD.run" title="s3prl.problem.HearCremaD.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>
(during testing phase).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evaluate</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearCremaD.default_config" title="s3prl.problem.HearCremaD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearCremaD.get_class_from_name">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_class_from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L129-L141"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearCremaD.get_class_from_name" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">__name__</span></code> of the problem class</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Problem</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearCremaD.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L752-L772"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearCremaD.load_model" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model_ckpt_dir</strong> (<em>str</em>) – Restore the model with <a class="reference internal" href="#s3prl.problem.HearCremaD.build_model" title="s3prl.problem.HearCremaD.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> and the checkpoint
saved in this directory.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearCremaD.load_model_and_task">
<span class="sig-name descname"><span class="pre">load_model_and_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ckpts_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L884-L902"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearCremaD.load_model_and_task" title="Permalink to this definition">#</a></dt>
<dd><p>This is a helper method to combine <a class="reference internal" href="#s3prl.problem.HearCremaD.load_model" title="s3prl.problem.HearCremaD.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a> and <a class="reference internal" href="#s3prl.problem.HearCremaD.load_task" title="s3prl.problem.HearCremaD.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>
together to directly load the model and the task. This method assumes
the model is saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'model'</span></code> and the task is
saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'task'</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>model (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>)</p></li>
<li><p>task (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a>)</p></li>
</ol>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearCremaD.load_task">
<span class="sig-name descname"><span class="pre">load_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L833-L882"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearCremaD.load_task" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – Restore the task with <a class="reference internal" href="#s3prl.problem.HearCremaD.build_task" title="s3prl.problem.HearCremaD.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> and the checkpoint
saved in this directory.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model for the task, since the model is separately saved
and is required for <a class="reference internal" href="#s3prl.problem.HearCremaD.build_task" title="s3prl.problem.HearCremaD.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a>.</p></li>
<li><p><strong>task_overrides</strong> (<em>dict</em>) – overrides the saved initialization arguments, so can change
the loaded task’s behavior. Like, change the decoding hyperparameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearCremaD.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L954-L995"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearCremaD.main" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearCremaD.prepare_data">
<span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_esc50.py#L151-L160"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearCremaD.prepare_data" title="Permalink to this definition">#</a></dt>
<dd><p>Prepare the task-specific data metadata (path, labels…).
By default call <code class="xref py py-obj docutils literal notranslate"><span class="pre">voxceleb1_for_sid</span></code> with <code class="code docutils literal notranslate"><span class="pre">**prepare_data</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prepare_data</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearCremaD.default_config" title="s3prl.problem.HearCremaD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments in <code class="xref py py-obj docutils literal notranslate"><span class="pre">voxceleb1_for_sid</span></code></p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Parse your corpus and save the csv file into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the parsing or preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>train_path (str)</p></li>
<li><p>valid_path (str)</p></li>
<li><p>test_paths (List[str])</p></li>
</ol>
<p>Each path (str) should be a csv file containing the following columns:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>column</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>(str) - the unique id for this data point</p></td>
</tr>
<tr class="row-odd"><td><p>wav_path</p></td>
<td><p>(str) - the absolute path of the waveform file</p></td>
</tr>
<tr class="row-even"><td><p>label</p></td>
<td><p>(str) - a string label of the waveform</p></td>
</tr>
<tr class="row-odd"><td><p>start_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">start_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load from the beginning.</p></td>
</tr>
<tr class="row-even"><td><p>end_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">end_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load to the end.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearCremaD.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_all_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cuda'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/run.py#L26-L318"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearCremaD.run" title="Permalink to this definition">#</a></dt>
<dd><div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>stage</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Parse the corpus and save the metadata file (waveform path, label…)</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Build the encoder to encode the labels</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Train the model</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Evaluate the model on multiple test sets</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_dir</strong> (<em>str</em>) – The directory that stores the script result.</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – The directory that caches the processed data.
Default: /home/user/.cache/s3prl/data</p></li>
<li><p><strong>remove_all_cache</strong> (<em>bool</em>) – Whether to remove all the cache stored under <cite>cache_dir</cite>.
Default: False</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting stage of the problem script.
Default: 0</p></li>
<li><p><strong>stop</strong> (<em>int</em>) – The stoping stage of the problem script, set <cite>None</cite> to reach the final stage.
Default: None</p></li>
<li><p><strong>num_workers</strong> (<em>int</em>) – num_workers for all the torch DataLoder</p></li>
<li><p><strong>eval_batch</strong> (<em>int</em>) – During evaluation (valid or test), limit the number of batch.
This is helpful for the fast development to check everything won’t crash.
If is -1, disable this feature and evaluate the entire epoch.
Default: -1</p></li>
<li><p><strong>device</strong> (<em>str</em>) – The device type for all torch-related operation: “cpu” or “cuda”
Default: “cuda”</p></li>
<li><p><strong>world_size</strong> (<em>int</em>) – How many processes are running this script simultaneously (in parallel).
Usually this is just 1, however if you are runnig distributed training,
this should be &gt; 1.
Default: 1</p></li>
<li><p><strong>rank</strong> (<em>int</em>) – When distributed training, world_size &gt; 1. Take <code class="code docutils literal notranslate"><span class="pre">world_size</span> <span class="pre">==</span> <span class="pre">8</span></code> for
example, this means 8 processes (8 GPUs) are runing in parallel. The script
needs to know which process among 8 processes it is. In this case, <code class="code docutils literal notranslate"><span class="pre">rank</span></code>
can range from 0~7. All the 8 processes have the same <code class="code docutils literal notranslate"><span class="pre">world_size</span></code> but
different <code class="code docutils literal notranslate"><span class="pre">rank</span></code> (process id).</p></li>
<li><p><strong>test_ckpt_dir</strong> (<em>str</em>) – Specify the checkpoint path for testing. If not, use the validation best
checkpoint under the given <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> directory.</p></li>
<li><p><strong>**kwds</strong> – The other arguments like <code class="code docutils literal notranslate"><span class="pre">prepare_data</span></code> and <code class="code docutils literal notranslate"><span class="pre">build_model</span></code> are
method specific-arguments for methods like <a class="reference internal" href="#s3prl.problem.HearCremaD.prepare_data" title="s3prl.problem.HearCremaD.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> and
<a class="reference internal" href="#s3prl.problem.HearCremaD.build_model" title="s3prl.problem.HearCremaD.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>, and will not be used in the core <a class="reference internal" href="#s3prl.problem.HearCremaD.run" title="s3prl.problem.HearCremaD.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> logic.
See the specific method documentation for their supported arguments and
meaning</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearCremaD.save_model">
<span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L709-L750"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearCremaD.save_model" title="Permalink to this definition">#</a></dt>
<dd><p>Save the model state_dict and the model initialization arguments into the given directory.
If you override this method, it is highly possible you also need to override <a class="reference internal" href="#s3prl.problem.HearCremaD.load_model" title="s3prl.problem.HearCremaD.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearCremaD.default_config" title="s3prl.problem.HearCremaD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_model</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>model_ckpt_dir</strong> (<em>str</em>) – save the model into the this directory.</p></li>
<li><p><strong>build_model_all_args</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.HearCremaD.build_model" title="s3prl.problem.HearCremaD.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>.
By saving this dictionary, you can easily reconstruct the same model
by calling <a class="reference internal" href="#s3prl.problem.HearCremaD.build_model" title="s3prl.problem.HearCremaD.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearCremaD.save_task">
<span class="sig-name descname"><span class="pre">save_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="s3prl.task.base.html#s3prl.task.base.Task" title="s3prl.task.base.Task"><span class="pre">Task</span></a></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L774-L831"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearCremaD.save_task" title="Permalink to this definition">#</a></dt>
<dd><p>Save the task’s state, <code class="code docutils literal notranslate"><span class="pre">task.get_state()</span></code>, and the initialization arguments into the given
directory. If you override this method, it is highly possible you also need to override
<a class="reference internal" href="#s3prl.problem.HearCremaD.load_task" title="s3prl.problem.HearCremaD.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearCremaD.default_config" title="s3prl.problem.HearCremaD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_task</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – save the task into this directory.</p></li>
<li><p><strong>build_task_all_args_except_model</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.HearCremaD.build_task" title="s3prl.problem.HearCremaD.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> except
the <code class="code docutils literal notranslate"><span class="pre">model</span></code> argument since the model should be sapartely saved by
<a class="reference internal" href="#s3prl.problem.HearCremaD.save_model" title="s3prl.problem.HearCremaD.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a>. By saving this dictionary, you can easily reconstruct the same task
by calling <a class="reference internal" href="#s3prl.problem.HearCremaD.build_task" title="s3prl.problem.HearCremaD.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>task</strong> (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><em>Task</em></a>) – the task to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearCremaD.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L287-L658"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearCremaD.train" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearCremaD.default_config" title="s3prl.problem.HearCremaD.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>total_steps</p></td>
<td><p>(int) - the total optimization steps</p></td>
</tr>
<tr class="row-odd"><td><p>log_step</p></td>
<td><p>(int) - logging frequency. log every <code class="code docutils literal notranslate"><span class="pre">log_step</span></code> step</p></td>
</tr>
<tr class="row-even"><td><p>eval_step</p></td>
<td><p>(int) - evaluation frequency. Evaluate every <code class="code docutils literal notranslate"><span class="pre">eval_step</span></code> step.                                                 Note that you can control how many batch to evaluate to speed up the                                                 development by the <code class="code docutils literal notranslate"><span class="pre">eval_batch</span></code> argument in <a class="reference internal" href="#s3prl.problem.HearCremaD.run" title="s3prl.problem.HearCremaD.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>save_step</p></td>
<td><p>(int) - save the checkpoint every <code class="code docutils literal notranslate"><span class="pre">save_step</span></code> step.</p></td>
</tr>
<tr class="row-even"><td><p>gradient_clipping</p></td>
<td><p>(float) - clip the gradient. important for RNNs.</p></td>
</tr>
<tr class="row-odd"><td><p>gradient_accumulate</p></td>
<td><p>(int) - accumulate multiple steps’ gradient before updating network parameters                                                 to simulate large-batch optimization.</p></td>
</tr>
<tr class="row-even"><td><p>valid_metric</p></td>
<td><p>(str) - the metric to select the best valid checkpoint. Different Tasks have different                                                 supported valid_metrics. See <a class="reference internal" href="#s3prl.problem.HearCremaD.build_task" title="s3prl.problem.HearCremaD.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> for the supported metrics.</p></td>
</tr>
<tr class="row-odd"><td><p>valid_higher_better</p></td>
<td><p>(bool) - some metrics are higher better, while some are lower better                                                 this will affect how to save the best validation checkpoint.</p></td>
</tr>
<tr class="row-even"><td><p>auto_resume</p></td>
<td><p>(bool) - if there are already the last checkpoint in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.HearCremaD.run" title="s3prl.problem.HearCremaD.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>),                                                 whether to resume from it or delete it and start a new training session.</p></td>
</tr>
<tr class="row-odd"><td><p>resume_ckpt_dir</p></td>
<td><p>(str) - you can directly specify the checkpoint path to resume which is not necessary                                                 in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.HearCremaD.run" title="s3prl.problem.HearCremaD.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>).</p></td>
</tr>
<tr class="row-even"><td><p>seed</p></td>
<td><p>(int) - fix the seed before the training start</p></td>
</tr>
<tr class="row-odd"><td><p>keep_num_ckpts</p></td>
<td><p>(int) - to prevent saving too many checkpoints, only save the <code class="code docutils literal notranslate"><span class="pre">keep_num_ckpts</span></code>                                                 latest checkpoints and delete the old ones.</p></td>
</tr>
<tr class="row-even"><td><p>use_scheduler</p></td>
<td><p>(bool) - whether to use the scheduler</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="heargsc5hr">
<h2>HearGSC5hr<a class="headerlink" href="#heargsc5hr" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="s3prl.problem.HearGSC5hr">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">s3prl.problem.</span></span><span class="sig-name descname"><span class="pre">HearGSC5hr</span></span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_gsc5hr.html#HearGSC5hr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_gsc5hr.py#L8-L74"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGSC5hr" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="s3prl.problem.common.hear_fsd.html#s3prl.problem.common.hear_fsd.HearFSD" title="s3prl.problem.common.hear_fsd.HearFSD"><code class="xref py py-class docutils literal notranslate"><span class="pre">HearFSD</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGSC5hr.default_config">
<span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_gsc5hr.html#HearGSC5hr.default_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_gsc5hr.py#L9-L74"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGSC5hr.default_config" title="Permalink to this definition">#</a></dt>
<dd><p>The default arguments for <a class="reference internal" href="#s3prl.problem.HearGSC5hr.run" title="s3prl.problem.HearGSC5hr.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> in yaml.
Note that for the fields with inner values, like <code class="code docutils literal notranslate"><span class="pre">build_model</span></code>,
the outer field name corresponds to a method name, so you can find the method
<a class="reference internal" href="#s3prl.problem.HearGSC5hr.build_model" title="s3prl.problem.HearGSC5hr.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>. Furthermore, the values inside that field will be
directly passed into the method. So by changing these inner values, you
can directly affect the behavior of the corresponding method. See the method
documentation for all the supported arguments and their meanings.</p>
<p>The methods affected by the following config are: <a class="reference internal" href="#s3prl.problem.HearGSC5hr.prepare_data" title="s3prl.problem.HearGSC5hr.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGSC5hr.build_batch_sampler" title="s3prl.problem.HearGSC5hr.build_batch_sampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_batch_sampler</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGSC5hr.build_upstream" title="s3prl.problem.HearGSC5hr.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGSC5hr.build_featurizer" title="s3prl.problem.HearGSC5hr.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGSC5hr.build_downstream" title="s3prl.problem.HearGSC5hr.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGSC5hr.build_model" title="s3prl.problem.HearGSC5hr.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGSC5hr.build_task" title="s3prl.problem.HearGSC5hr.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGSC5hr.build_optimizer" title="s3prl.problem.HearGSC5hr.build_optimizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_optimizer</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGSC5hr.build_scheduler" title="s3prl.problem.HearGSC5hr.build_scheduler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_scheduler</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGSC5hr.save_model" title="s3prl.problem.HearGSC5hr.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGSC5hr.save_task" title="s3prl.problem.HearGSC5hr.save_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_task</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGSC5hr.train" title="s3prl.problem.HearGSC5hr.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGSC5hr.evaluate" title="s3prl.problem.HearGSC5hr.evaluate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate</span></code></a></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">start</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="nt">stop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">target_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">cache_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">remove_all_cache</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">prepare_data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">dataset_root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">build_batch_sampler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">train</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">32</span>
<span class="w">    </span><span class="nt">shuffle</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">valid</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">test</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="nt">build_upstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">build_featurizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">layer_selections</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="nt">normalize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_downstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">hidden_layers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">  </span><span class="nt">pooling_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MeanPooling</span>
<span class="nt">build_model</span><span class="p">:</span>
<span class="w">  </span><span class="nt">upstream_trainable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_task</span><span class="p">:</span>
<span class="w">  </span><span class="nt">prediction_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">multiclass</span>
<span class="w">  </span><span class="nt">scores</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top1_acc</span>
<span class="nt">build_optimizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Adam</span>
<span class="w">  </span><span class="nt">conf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">lr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.001</span>
<span class="nt">build_scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ExponentialLR</span>
<span class="w">  </span><span class="nt">gamma</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.9</span>
<span class="nt">save_model</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">save_task</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">train</span><span class="p">:</span>
<span class="w">  </span><span class="nt">total_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">150000</span>
<span class="w">  </span><span class="nt">log_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">  </span><span class="nt">eval_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span>
<span class="w">  </span><span class="nt">save_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">  </span><span class="nt">gradient_clipping</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0</span>
<span class="w">  </span><span class="nt">gradient_accumulate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">valid_metric</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top1_acc</span>
<span class="w">  </span><span class="nt">valid_higher_better</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">auto_resume</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">resume_ckpt_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">evaluate</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGSC5hr.build_batch_sampler">
<span class="sig-name descname"><span class="pre">build_batch_sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L213-L229"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGSC5hr.build_batch_sampler" title="Permalink to this definition">#</a></dt>
<dd><p>Return the batch sampler for torch DataLoader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_batch_sampler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearGSC5hr.default_config" title="s3prl.problem.HearGSC5hr.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>train</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>valid</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-even"><td><p>test</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">mode</span></code> specific csv from <a class="reference internal" href="#s3prl.problem.HearGSC5hr.prepare_data" title="s3prl.problem.HearGSC5hr.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>dataset</strong> – the dataset from <a class="reference internal" href="#s3prl.problem.HearGSC5hr.build_dataset" title="s3prl.problem.HearGSC5hr.build_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_dataset</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>batch sampler for torch DataLoader</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGSC5hr.build_collate_fn">
<span class="sig-name descname"><span class="pre">build_collate_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L143-L156"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGSC5hr.build_collate_fn" title="Permalink to this definition">#</a></dt>
<dd><p>By default returns <code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataset.base.default_collate_fn</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_collate_fn</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGSC5hr.default_config" title="s3prl.problem.HearGSC5hr.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train, valid, or test</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>callable</p>
<p>the collate_fn for torch DataLoader in train/valid/test <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGSC5hr.build_dataset">
<span class="sig-name descname"><span class="pre">build_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_shift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L172-L211"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGSC5hr.build_dataset" title="Permalink to this definition">#</a></dt>
<dd><p>Build the dataset for train/valid/test.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_dataset</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearGSC5hr.default_config" title="s3prl.problem.HearGSC5hr.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>. with <code class="code docutils literal notranslate"><span class="pre">train</span></code>, <code class="code docutils literal notranslate"><span class="pre">valid</span></code>, <code class="code docutils literal notranslate"><span class="pre">test</span></code> keys, each
is a dictionary with the following supported options:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>max_secs</p></td>
<td><p>(float) - If a waveform is longer than <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds, randomly crop the waveform into <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds</p></td>
</tr>
<tr class="row-odd"><td><p>sox_effects</p></td>
<td><p>(List[List[str]]) - If not None, apply sox effects on the utterance</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – The metadata csv file for the specific <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p></li>
<li><p><strong>encoder_path</strong> (<em>str</em>) – The pickled encoder path for encoding the labels</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch Dataset</p>
<p>For all train/valid/test mode, the dataset should return each item as a dictionary
containing the following keys:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>x</p></td>
<td><p>(torch.FloatTensor) - the waveform in (seq_len, 1)</p></td>
</tr>
<tr class="row-odd"><td><p>x_len</p></td>
<td><p>(int) - the waveform length <code class="code docutils literal notranslate"><span class="pre">seq_len</span></code></p></td>
</tr>
<tr class="row-even"><td><p>class_id</p></td>
<td><p>(int) - the encoded class id</p></td>
</tr>
<tr class="row-odd"><td><p>label</p></td>
<td><p>(str) - the class name</p></td>
</tr>
<tr class="row-even"><td><p>unique_name</p></td>
<td><p>(str) - the unique id for this datapoint</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGSC5hr.build_downstream">
<span class="sig-name descname"><span class="pre">build_downstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L231-L240"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGSC5hr.build_downstream" title="Permalink to this definition">#</a></dt>
<dd><p>Return the task-specific downstream model.
By default build the <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code> model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGSC5hr.default_config" title="s3prl.problem.HearGSC5hr.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments of <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code></p></li>
<li><p><strong>downstream_input_size</strong> (<em>int</em>) – the required input size of the model</p></li>
<li><p><strong>downstream_output_size</strong> (<em>int</em>) – the required output size of the model</p></li>
<li><p><strong>downstream_input_stride</strong> (<em>int</em>) – the input feature’s stride (from 16 KHz)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUtteranceModel" title="s3prl.nn.interface.AbsUtteranceModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUtteranceModel</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGSC5hr.build_encoder">
<span class="sig-name descname"><span class="pre">build_encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_csv_paths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L142-L170"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGSC5hr.build_encoder" title="Permalink to this definition">#</a></dt>
<dd><p>Build the encoder (for the labels) given the data metadata, and return the saved encoder path.
By default generate and save a <a class="reference internal" href="s3prl.dataio.encoder.html#s3prl.dataio.encoder.CategoryEncoder" title="s3prl.dataio.encoder.CategoryEncoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataio.encoder.CategoryEncoder</span></code></a> from the <code class="code docutils literal notranslate"><span class="pre">label</span></code> column of all the csv files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_encoder</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGSC5hr.default_config" title="s3prl.problem.HearGSC5hr.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Save your encoder into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>train_csv_path</strong> (<em>str</em>) – the train path from <a class="reference internal" href="#s3prl.problem.HearGSC5hr.prepare_data" title="s3prl.problem.HearGSC5hr.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>valid_csv_path</strong> (<em>str</em>) – the valid path from <a class="reference internal" href="#s3prl.problem.HearGSC5hr.prepare_data" title="s3prl.problem.HearGSC5hr.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>test_csv_paths</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – the test paths from <a class="reference internal" href="#s3prl.problem.HearGSC5hr.prepare_data" title="s3prl.problem.HearGSC5hr.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>str</p>
<p>encoder_path: The encoder should be saved in the pickle format</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGSC5hr.build_featurizer">
<span class="sig-name descname"><span class="pre">build_featurizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upstream</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L175-L192"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGSC5hr.build_featurizer" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the featurizer with <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGSC5hr.default_config" title="s3prl.problem.HearGSC5hr.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p></li>
<li><p><strong>upstream</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">AbsUpstream</span></code>) – the upstream model built by <a class="reference internal" href="#s3prl.problem.HearGSC5hr.build_upstream" title="s3prl.problem.HearGSC5hr.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsFeaturizer" title="s3prl.nn.interface.AbsFeaturizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsFeaturizer</span></code></a></p>
<p>Return the featurizer model. The featurizer is used to reduce the multiple
hidden states returned from the upstream model (built by <a class="reference internal" href="#s3prl.problem.HearGSC5hr.build_upstream" title="s3prl.problem.HearGSC5hr.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>)
into a single hidden state, so can be easliy fed into the downstream model</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGSC5hr.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L194-L231"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGSC5hr.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>By default build model with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGSC5hr.default_config" title="s3prl.problem.HearGSC5hr.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p></li>
<li><p><strong>model_output_size</strong> (<em>int</em>) – the required model’s output hidden size</p></li>
<li><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGSC5hr.default_config" title="s3prl.problem.HearGSC5hr.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearGSC5hr.build_upstream" title="s3prl.problem.HearGSC5hr.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGSC5hr.default_config" title="s3prl.problem.HearGSC5hr.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearGSC5hr.build_featurizer" title="s3prl.problem.HearGSC5hr.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a></p></li>
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGSC5hr.default_config" title="s3prl.problem.HearGSC5hr.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearGSC5hr.build_downstream" title="s3prl.problem.HearGSC5hr.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch.nn.Module</p>
<p>Return the entire model for the task, which takes the direct items from DataLoader as the input.
Usually, the components can be built by <a class="reference internal" href="#s3prl.problem.HearGSC5hr.build_upstream" title="s3prl.problem.HearGSC5hr.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>, <a class="reference internal" href="#s3prl.problem.HearGSC5hr.build_featurizer" title="s3prl.problem.HearGSC5hr.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a>,
<a class="reference internal" href="#s3prl.problem.HearGSC5hr.build_downstream" title="s3prl.problem.HearGSC5hr.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a>, and are concated together to get the final model.
The upstream extracts multiple hidden states, the featuizer reduce them into a single hidden state,
and the downstream takes the hidden states as the feature for the downstream-specific model.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGSC5hr.build_optimizer">
<span class="sig-name descname"><span class="pre">build_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L233-L258"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGSC5hr.build_optimizer" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_optimizer</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearGSC5hr.default_config" title="s3prl.problem.HearGSC5hr.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to below</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the optimizer class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the optimizer class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;lr&quot;:</span> <span class="pre">1.0e-4}</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>parameters</strong> (<em>iterable</em>) – the standard params accepted by <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code></p>
<p>An optimizer following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGSC5hr.build_scheduler">
<span class="sig-name descname"><span class="pre">build_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L260-L285"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGSC5hr.build_scheduler" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_scheduler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearGSC5hr.default_config" title="s3prl.problem.HearGSC5hr.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the scheduler class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the scheduler class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;gamma&quot;:</span> <span class="pre">0.01}</span></code> for <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler.StepLR</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>optimizer</strong> – the standard torch optimizer accepted by Scheduler in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch scheduler</p>
<p>A scheduler following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGSC5hr.build_task">
<span class="sig-name descname"><span class="pre">build_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L242-L250"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGSC5hr.build_task" title="Permalink to this definition">#</a></dt>
<dd><p>Build the task, which defines the logics for every train/valid/test forward step for the <code class="code docutils literal notranslate"><span class="pre">model</span></code>,
and the logics for how to reduce all the batch results from multiple train/valid/test steps into metrics</p>
<p>By default build <code class="xref py py-obj docutils literal notranslate"><span class="pre">UtteranceClassificationTask</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGSC5hr.default_config" title="s3prl.problem.HearGSC5hr.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model built by <a class="reference internal" href="#s3prl.problem.HearGSC5hr.build_model" title="s3prl.problem.HearGSC5hr.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a></p></li>
<li><p><strong>encoder</strong> – the encoder built by <a class="reference internal" href="#s3prl.problem.HearGSC5hr.build_encoder" title="s3prl.problem.HearGSC5hr.build_encoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_encoder</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Task</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGSC5hr.build_upstream">
<span class="sig-name descname"><span class="pre">build_upstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L158-L173"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGSC5hr.build_upstream" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the upstream with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGSC5hr.default_config" title="s3prl.problem.HearGSC5hr.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUpstream" title="s3prl.nn.interface.AbsUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUpstream</span></code></a></p>
<p>Return an upstream model, whose forward takes the waveform input and returns
multiple hidden states as features.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGSC5hr.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L660-L707"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGSC5hr.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>The evaluate routine used by <a class="reference internal" href="#s3prl.problem.HearGSC5hr.train" title="s3prl.problem.HearGSC5hr.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> (during validation phase) and <a class="reference internal" href="#s3prl.problem.HearGSC5hr.run" title="s3prl.problem.HearGSC5hr.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>
(during testing phase).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evaluate</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGSC5hr.default_config" title="s3prl.problem.HearGSC5hr.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGSC5hr.get_class_from_name">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_class_from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L129-L141"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGSC5hr.get_class_from_name" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">__name__</span></code> of the problem class</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Problem</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGSC5hr.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L752-L772"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGSC5hr.load_model" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model_ckpt_dir</strong> (<em>str</em>) – Restore the model with <a class="reference internal" href="#s3prl.problem.HearGSC5hr.build_model" title="s3prl.problem.HearGSC5hr.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> and the checkpoint
saved in this directory.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGSC5hr.load_model_and_task">
<span class="sig-name descname"><span class="pre">load_model_and_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ckpts_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L884-L902"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGSC5hr.load_model_and_task" title="Permalink to this definition">#</a></dt>
<dd><p>This is a helper method to combine <a class="reference internal" href="#s3prl.problem.HearGSC5hr.load_model" title="s3prl.problem.HearGSC5hr.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a> and <a class="reference internal" href="#s3prl.problem.HearGSC5hr.load_task" title="s3prl.problem.HearGSC5hr.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>
together to directly load the model and the task. This method assumes
the model is saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'model'</span></code> and the task is
saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'task'</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>model (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>)</p></li>
<li><p>task (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a>)</p></li>
</ol>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGSC5hr.load_task">
<span class="sig-name descname"><span class="pre">load_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L833-L882"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGSC5hr.load_task" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – Restore the task with <a class="reference internal" href="#s3prl.problem.HearGSC5hr.build_task" title="s3prl.problem.HearGSC5hr.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> and the checkpoint
saved in this directory.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model for the task, since the model is separately saved
and is required for <a class="reference internal" href="#s3prl.problem.HearGSC5hr.build_task" title="s3prl.problem.HearGSC5hr.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a>.</p></li>
<li><p><strong>task_overrides</strong> (<em>dict</em>) – overrides the saved initialization arguments, so can change
the loaded task’s behavior. Like, change the decoding hyperparameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGSC5hr.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L954-L995"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGSC5hr.main" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGSC5hr.prepare_data">
<span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L131-L140"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGSC5hr.prepare_data" title="Permalink to this definition">#</a></dt>
<dd><p>Prepare the task-specific data metadata (path, labels…).
By default call <code class="xref py py-obj docutils literal notranslate"><span class="pre">voxceleb1_for_sid</span></code> with <code class="code docutils literal notranslate"><span class="pre">**prepare_data</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prepare_data</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGSC5hr.default_config" title="s3prl.problem.HearGSC5hr.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments in <code class="xref py py-obj docutils literal notranslate"><span class="pre">voxceleb1_for_sid</span></code></p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Parse your corpus and save the csv file into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the parsing or preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>train_path (str)</p></li>
<li><p>valid_path (str)</p></li>
<li><p>test_paths (List[str])</p></li>
</ol>
<p>Each path (str) should be a csv file containing the following columns:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>column</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>(str) - the unique id for this data point</p></td>
</tr>
<tr class="row-odd"><td><p>wav_path</p></td>
<td><p>(str) - the absolute path of the waveform file</p></td>
</tr>
<tr class="row-even"><td><p>label</p></td>
<td><p>(str) - a string label of the waveform</p></td>
</tr>
<tr class="row-odd"><td><p>start_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">start_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load from the beginning.</p></td>
</tr>
<tr class="row-even"><td><p>end_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">end_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load to the end.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGSC5hr.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_all_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cuda'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/run.py#L26-L318"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGSC5hr.run" title="Permalink to this definition">#</a></dt>
<dd><div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>stage</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Parse the corpus and save the metadata file (waveform path, label…)</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Build the encoder to encode the labels</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Train the model</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Evaluate the model on multiple test sets</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_dir</strong> (<em>str</em>) – The directory that stores the script result.</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – The directory that caches the processed data.
Default: /home/user/.cache/s3prl/data</p></li>
<li><p><strong>remove_all_cache</strong> (<em>bool</em>) – Whether to remove all the cache stored under <cite>cache_dir</cite>.
Default: False</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting stage of the problem script.
Default: 0</p></li>
<li><p><strong>stop</strong> (<em>int</em>) – The stoping stage of the problem script, set <cite>None</cite> to reach the final stage.
Default: None</p></li>
<li><p><strong>num_workers</strong> (<em>int</em>) – num_workers for all the torch DataLoder</p></li>
<li><p><strong>eval_batch</strong> (<em>int</em>) – During evaluation (valid or test), limit the number of batch.
This is helpful for the fast development to check everything won’t crash.
If is -1, disable this feature and evaluate the entire epoch.
Default: -1</p></li>
<li><p><strong>device</strong> (<em>str</em>) – The device type for all torch-related operation: “cpu” or “cuda”
Default: “cuda”</p></li>
<li><p><strong>world_size</strong> (<em>int</em>) – How many processes are running this script simultaneously (in parallel).
Usually this is just 1, however if you are runnig distributed training,
this should be &gt; 1.
Default: 1</p></li>
<li><p><strong>rank</strong> (<em>int</em>) – When distributed training, world_size &gt; 1. Take <code class="code docutils literal notranslate"><span class="pre">world_size</span> <span class="pre">==</span> <span class="pre">8</span></code> for
example, this means 8 processes (8 GPUs) are runing in parallel. The script
needs to know which process among 8 processes it is. In this case, <code class="code docutils literal notranslate"><span class="pre">rank</span></code>
can range from 0~7. All the 8 processes have the same <code class="code docutils literal notranslate"><span class="pre">world_size</span></code> but
different <code class="code docutils literal notranslate"><span class="pre">rank</span></code> (process id).</p></li>
<li><p><strong>test_ckpt_dir</strong> (<em>str</em>) – Specify the checkpoint path for testing. If not, use the validation best
checkpoint under the given <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> directory.</p></li>
<li><p><strong>**kwds</strong> – The other arguments like <code class="code docutils literal notranslate"><span class="pre">prepare_data</span></code> and <code class="code docutils literal notranslate"><span class="pre">build_model</span></code> are
method specific-arguments for methods like <a class="reference internal" href="#s3prl.problem.HearGSC5hr.prepare_data" title="s3prl.problem.HearGSC5hr.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> and
<a class="reference internal" href="#s3prl.problem.HearGSC5hr.build_model" title="s3prl.problem.HearGSC5hr.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>, and will not be used in the core <a class="reference internal" href="#s3prl.problem.HearGSC5hr.run" title="s3prl.problem.HearGSC5hr.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> logic.
See the specific method documentation for their supported arguments and
meaning</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGSC5hr.save_model">
<span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L709-L750"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGSC5hr.save_model" title="Permalink to this definition">#</a></dt>
<dd><p>Save the model state_dict and the model initialization arguments into the given directory.
If you override this method, it is highly possible you also need to override <a class="reference internal" href="#s3prl.problem.HearGSC5hr.load_model" title="s3prl.problem.HearGSC5hr.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGSC5hr.default_config" title="s3prl.problem.HearGSC5hr.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_model</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>model_ckpt_dir</strong> (<em>str</em>) – save the model into the this directory.</p></li>
<li><p><strong>build_model_all_args</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.HearGSC5hr.build_model" title="s3prl.problem.HearGSC5hr.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>.
By saving this dictionary, you can easily reconstruct the same model
by calling <a class="reference internal" href="#s3prl.problem.HearGSC5hr.build_model" title="s3prl.problem.HearGSC5hr.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGSC5hr.save_task">
<span class="sig-name descname"><span class="pre">save_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="s3prl.task.base.html#s3prl.task.base.Task" title="s3prl.task.base.Task"><span class="pre">Task</span></a></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L774-L831"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGSC5hr.save_task" title="Permalink to this definition">#</a></dt>
<dd><p>Save the task’s state, <code class="code docutils literal notranslate"><span class="pre">task.get_state()</span></code>, and the initialization arguments into the given
directory. If you override this method, it is highly possible you also need to override
<a class="reference internal" href="#s3prl.problem.HearGSC5hr.load_task" title="s3prl.problem.HearGSC5hr.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGSC5hr.default_config" title="s3prl.problem.HearGSC5hr.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_task</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – save the task into this directory.</p></li>
<li><p><strong>build_task_all_args_except_model</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.HearGSC5hr.build_task" title="s3prl.problem.HearGSC5hr.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> except
the <code class="code docutils literal notranslate"><span class="pre">model</span></code> argument since the model should be sapartely saved by
<a class="reference internal" href="#s3prl.problem.HearGSC5hr.save_model" title="s3prl.problem.HearGSC5hr.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a>. By saving this dictionary, you can easily reconstruct the same task
by calling <a class="reference internal" href="#s3prl.problem.HearGSC5hr.build_task" title="s3prl.problem.HearGSC5hr.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>task</strong> (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><em>Task</em></a>) – the task to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGSC5hr.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L287-L658"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGSC5hr.train" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearGSC5hr.default_config" title="s3prl.problem.HearGSC5hr.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>total_steps</p></td>
<td><p>(int) - the total optimization steps</p></td>
</tr>
<tr class="row-odd"><td><p>log_step</p></td>
<td><p>(int) - logging frequency. log every <code class="code docutils literal notranslate"><span class="pre">log_step</span></code> step</p></td>
</tr>
<tr class="row-even"><td><p>eval_step</p></td>
<td><p>(int) - evaluation frequency. Evaluate every <code class="code docutils literal notranslate"><span class="pre">eval_step</span></code> step.                                                 Note that you can control how many batch to evaluate to speed up the                                                 development by the <code class="code docutils literal notranslate"><span class="pre">eval_batch</span></code> argument in <a class="reference internal" href="#s3prl.problem.HearGSC5hr.run" title="s3prl.problem.HearGSC5hr.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>save_step</p></td>
<td><p>(int) - save the checkpoint every <code class="code docutils literal notranslate"><span class="pre">save_step</span></code> step.</p></td>
</tr>
<tr class="row-even"><td><p>gradient_clipping</p></td>
<td><p>(float) - clip the gradient. important for RNNs.</p></td>
</tr>
<tr class="row-odd"><td><p>gradient_accumulate</p></td>
<td><p>(int) - accumulate multiple steps’ gradient before updating network parameters                                                 to simulate large-batch optimization.</p></td>
</tr>
<tr class="row-even"><td><p>valid_metric</p></td>
<td><p>(str) - the metric to select the best valid checkpoint. Different Tasks have different                                                 supported valid_metrics. See <a class="reference internal" href="#s3prl.problem.HearGSC5hr.build_task" title="s3prl.problem.HearGSC5hr.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> for the supported metrics.</p></td>
</tr>
<tr class="row-odd"><td><p>valid_higher_better</p></td>
<td><p>(bool) - some metrics are higher better, while some are lower better                                                 this will affect how to save the best validation checkpoint.</p></td>
</tr>
<tr class="row-even"><td><p>auto_resume</p></td>
<td><p>(bool) - if there are already the last checkpoint in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.HearGSC5hr.run" title="s3prl.problem.HearGSC5hr.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>),                                                 whether to resume from it or delete it and start a new training session.</p></td>
</tr>
<tr class="row-odd"><td><p>resume_ckpt_dir</p></td>
<td><p>(str) - you can directly specify the checkpoint path to resume which is not necessary                                                 in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.HearGSC5hr.run" title="s3prl.problem.HearGSC5hr.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>).</p></td>
</tr>
<tr class="row-even"><td><p>seed</p></td>
<td><p>(int) - fix the seed before the training start</p></td>
</tr>
<tr class="row-odd"><td><p>keep_num_ckpts</p></td>
<td><p>(int) - to prevent saving too many checkpoints, only save the <code class="code docutils literal notranslate"><span class="pre">keep_num_ckpts</span></code>                                                 latest checkpoints and delete the old ones.</p></td>
</tr>
<tr class="row-even"><td><p>use_scheduler</p></td>
<td><p>(bool) - whether to use the scheduler</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="heargtzanmusicspeech">
<h2>HearGtzanMusicSpeech<a class="headerlink" href="#heargtzanmusicspeech" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzanMusicSpeech">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">s3prl.problem.</span></span><span class="sig-name descname"><span class="pre">HearGtzanMusicSpeech</span></span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_gtzan_music_speech.html#HearGtzanMusicSpeech"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_gtzan_music_speech.py#L10-L78"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzanMusicSpeech" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="s3prl.problem.common.hear_esc50.html#s3prl.problem.common.hear_esc50.HearESC50" title="s3prl.problem.common.hear_esc50.HearESC50"><code class="xref py py-class docutils literal notranslate"><span class="pre">HearESC50</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzanMusicSpeech.default_config">
<span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_gtzan_music_speech.html#HearGtzanMusicSpeech.default_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_gtzan_music_speech.py#L11-L78"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzanMusicSpeech.default_config" title="Permalink to this definition">#</a></dt>
<dd><p>The default arguments for <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.run" title="s3prl.problem.HearGtzanMusicSpeech.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> in yaml.
Note that for the fields with inner values, like <code class="code docutils literal notranslate"><span class="pre">build_model</span></code>,
the outer field name corresponds to a method name, so you can find the method
<a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.build_model" title="s3prl.problem.HearGtzanMusicSpeech.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>. Furthermore, the values inside that field will be
directly passed into the method. So by changing these inner values, you
can directly affect the behavior of the corresponding method. See the method
documentation for all the supported arguments and their meanings.</p>
<p>The methods affected by the following config are: <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.prepare_data" title="s3prl.problem.HearGtzanMusicSpeech.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.build_batch_sampler" title="s3prl.problem.HearGtzanMusicSpeech.build_batch_sampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_batch_sampler</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.build_upstream" title="s3prl.problem.HearGtzanMusicSpeech.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.build_featurizer" title="s3prl.problem.HearGtzanMusicSpeech.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.build_downstream" title="s3prl.problem.HearGtzanMusicSpeech.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.build_model" title="s3prl.problem.HearGtzanMusicSpeech.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.build_task" title="s3prl.problem.HearGtzanMusicSpeech.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.build_optimizer" title="s3prl.problem.HearGtzanMusicSpeech.build_optimizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_optimizer</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.build_scheduler" title="s3prl.problem.HearGtzanMusicSpeech.build_scheduler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_scheduler</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.save_model" title="s3prl.problem.HearGtzanMusicSpeech.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.save_task" title="s3prl.problem.HearGtzanMusicSpeech.save_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_task</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.train" title="s3prl.problem.HearGtzanMusicSpeech.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.evaluate" title="s3prl.problem.HearGtzanMusicSpeech.evaluate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate</span></code></a></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">start</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="nt">stop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">target_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">cache_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">remove_all_cache</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">prepare_data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">dataset_root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="w">  </span><span class="nt">test_fold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="w">  </span><span class="nt">num_folds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="nt">build_batch_sampler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">train</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">32</span>
<span class="w">    </span><span class="nt">shuffle</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">valid</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">test</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="nt">build_upstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">build_featurizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">layer_selections</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="nt">normalize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_downstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">hidden_layers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">  </span><span class="nt">pooling_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MeanPooling</span>
<span class="nt">build_model</span><span class="p">:</span>
<span class="w">  </span><span class="nt">upstream_trainable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_task</span><span class="p">:</span>
<span class="w">  </span><span class="nt">prediction_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">multiclass</span>
<span class="w">  </span><span class="nt">scores</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top1_acc</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mAP</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">d_prime</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aucroc</span>
<span class="nt">build_optimizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Adam</span>
<span class="w">  </span><span class="nt">conf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">lr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.001</span>
<span class="nt">build_scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ExponentialLR</span>
<span class="w">  </span><span class="nt">gamma</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.9</span>
<span class="nt">save_model</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">save_task</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">train</span><span class="p">:</span>
<span class="w">  </span><span class="nt">total_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">150000</span>
<span class="w">  </span><span class="nt">log_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">  </span><span class="nt">eval_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span>
<span class="w">  </span><span class="nt">save_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">  </span><span class="nt">gradient_clipping</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0</span>
<span class="w">  </span><span class="nt">gradient_accumulate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">valid_metric</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top1_acc</span>
<span class="w">  </span><span class="nt">valid_higher_better</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">auto_resume</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">resume_ckpt_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">evaluate</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzanMusicSpeech.build_batch_sampler">
<span class="sig-name descname"><span class="pre">build_batch_sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L213-L229"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzanMusicSpeech.build_batch_sampler" title="Permalink to this definition">#</a></dt>
<dd><p>Return the batch sampler for torch DataLoader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_batch_sampler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.default_config" title="s3prl.problem.HearGtzanMusicSpeech.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>train</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>valid</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-even"><td><p>test</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">mode</span></code> specific csv from <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.prepare_data" title="s3prl.problem.HearGtzanMusicSpeech.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>dataset</strong> – the dataset from <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.build_dataset" title="s3prl.problem.HearGtzanMusicSpeech.build_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_dataset</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>batch sampler for torch DataLoader</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzanMusicSpeech.build_collate_fn">
<span class="sig-name descname"><span class="pre">build_collate_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L143-L156"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzanMusicSpeech.build_collate_fn" title="Permalink to this definition">#</a></dt>
<dd><p>By default returns <code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataset.base.default_collate_fn</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_collate_fn</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.default_config" title="s3prl.problem.HearGtzanMusicSpeech.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train, valid, or test</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>callable</p>
<p>the collate_fn for torch DataLoader in train/valid/test <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzanMusicSpeech.build_dataset">
<span class="sig-name descname"><span class="pre">build_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_shift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L172-L211"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzanMusicSpeech.build_dataset" title="Permalink to this definition">#</a></dt>
<dd><p>Build the dataset for train/valid/test.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_dataset</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.default_config" title="s3prl.problem.HearGtzanMusicSpeech.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>. with <code class="code docutils literal notranslate"><span class="pre">train</span></code>, <code class="code docutils literal notranslate"><span class="pre">valid</span></code>, <code class="code docutils literal notranslate"><span class="pre">test</span></code> keys, each
is a dictionary with the following supported options:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>max_secs</p></td>
<td><p>(float) - If a waveform is longer than <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds, randomly crop the waveform into <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds</p></td>
</tr>
<tr class="row-odd"><td><p>sox_effects</p></td>
<td><p>(List[List[str]]) - If not None, apply sox effects on the utterance</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – The metadata csv file for the specific <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p></li>
<li><p><strong>encoder_path</strong> (<em>str</em>) – The pickled encoder path for encoding the labels</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch Dataset</p>
<p>For all train/valid/test mode, the dataset should return each item as a dictionary
containing the following keys:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>x</p></td>
<td><p>(torch.FloatTensor) - the waveform in (seq_len, 1)</p></td>
</tr>
<tr class="row-odd"><td><p>x_len</p></td>
<td><p>(int) - the waveform length <code class="code docutils literal notranslate"><span class="pre">seq_len</span></code></p></td>
</tr>
<tr class="row-even"><td><p>class_id</p></td>
<td><p>(int) - the encoded class id</p></td>
</tr>
<tr class="row-odd"><td><p>label</p></td>
<td><p>(str) - the class name</p></td>
</tr>
<tr class="row-even"><td><p>unique_name</p></td>
<td><p>(str) - the unique id for this datapoint</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzanMusicSpeech.build_downstream">
<span class="sig-name descname"><span class="pre">build_downstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L231-L240"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzanMusicSpeech.build_downstream" title="Permalink to this definition">#</a></dt>
<dd><p>Return the task-specific downstream model.
By default build the <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code> model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.default_config" title="s3prl.problem.HearGtzanMusicSpeech.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments of <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code></p></li>
<li><p><strong>downstream_input_size</strong> (<em>int</em>) – the required input size of the model</p></li>
<li><p><strong>downstream_output_size</strong> (<em>int</em>) – the required output size of the model</p></li>
<li><p><strong>downstream_input_stride</strong> (<em>int</em>) – the input feature’s stride (from 16 KHz)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUtteranceModel" title="s3prl.nn.interface.AbsUtteranceModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUtteranceModel</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzanMusicSpeech.build_encoder">
<span class="sig-name descname"><span class="pre">build_encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_csv_paths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L142-L170"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzanMusicSpeech.build_encoder" title="Permalink to this definition">#</a></dt>
<dd><p>Build the encoder (for the labels) given the data metadata, and return the saved encoder path.
By default generate and save a <a class="reference internal" href="s3prl.dataio.encoder.html#s3prl.dataio.encoder.CategoryEncoder" title="s3prl.dataio.encoder.CategoryEncoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataio.encoder.CategoryEncoder</span></code></a> from the <code class="code docutils literal notranslate"><span class="pre">label</span></code> column of all the csv files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_encoder</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.default_config" title="s3prl.problem.HearGtzanMusicSpeech.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Save your encoder into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>train_csv_path</strong> (<em>str</em>) – the train path from <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.prepare_data" title="s3prl.problem.HearGtzanMusicSpeech.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>valid_csv_path</strong> (<em>str</em>) – the valid path from <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.prepare_data" title="s3prl.problem.HearGtzanMusicSpeech.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>test_csv_paths</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – the test paths from <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.prepare_data" title="s3prl.problem.HearGtzanMusicSpeech.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>str</p>
<p>encoder_path: The encoder should be saved in the pickle format</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzanMusicSpeech.build_featurizer">
<span class="sig-name descname"><span class="pre">build_featurizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upstream</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L175-L192"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzanMusicSpeech.build_featurizer" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the featurizer with <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.default_config" title="s3prl.problem.HearGtzanMusicSpeech.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p></li>
<li><p><strong>upstream</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">AbsUpstream</span></code>) – the upstream model built by <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.build_upstream" title="s3prl.problem.HearGtzanMusicSpeech.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsFeaturizer" title="s3prl.nn.interface.AbsFeaturizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsFeaturizer</span></code></a></p>
<p>Return the featurizer model. The featurizer is used to reduce the multiple
hidden states returned from the upstream model (built by <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.build_upstream" title="s3prl.problem.HearGtzanMusicSpeech.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>)
into a single hidden state, so can be easliy fed into the downstream model</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzanMusicSpeech.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L194-L231"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzanMusicSpeech.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>By default build model with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.default_config" title="s3prl.problem.HearGtzanMusicSpeech.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p></li>
<li><p><strong>model_output_size</strong> (<em>int</em>) – the required model’s output hidden size</p></li>
<li><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.default_config" title="s3prl.problem.HearGtzanMusicSpeech.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.build_upstream" title="s3prl.problem.HearGtzanMusicSpeech.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.default_config" title="s3prl.problem.HearGtzanMusicSpeech.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.build_featurizer" title="s3prl.problem.HearGtzanMusicSpeech.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a></p></li>
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.default_config" title="s3prl.problem.HearGtzanMusicSpeech.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.build_downstream" title="s3prl.problem.HearGtzanMusicSpeech.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch.nn.Module</p>
<p>Return the entire model for the task, which takes the direct items from DataLoader as the input.
Usually, the components can be built by <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.build_upstream" title="s3prl.problem.HearGtzanMusicSpeech.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>, <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.build_featurizer" title="s3prl.problem.HearGtzanMusicSpeech.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a>,
<a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.build_downstream" title="s3prl.problem.HearGtzanMusicSpeech.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a>, and are concated together to get the final model.
The upstream extracts multiple hidden states, the featuizer reduce them into a single hidden state,
and the downstream takes the hidden states as the feature for the downstream-specific model.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzanMusicSpeech.build_optimizer">
<span class="sig-name descname"><span class="pre">build_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L233-L258"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzanMusicSpeech.build_optimizer" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_optimizer</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.default_config" title="s3prl.problem.HearGtzanMusicSpeech.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to below</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the optimizer class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the optimizer class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;lr&quot;:</span> <span class="pre">1.0e-4}</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>parameters</strong> (<em>iterable</em>) – the standard params accepted by <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code></p>
<p>An optimizer following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzanMusicSpeech.build_scheduler">
<span class="sig-name descname"><span class="pre">build_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L260-L285"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzanMusicSpeech.build_scheduler" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_scheduler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.default_config" title="s3prl.problem.HearGtzanMusicSpeech.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the scheduler class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the scheduler class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;gamma&quot;:</span> <span class="pre">0.01}</span></code> for <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler.StepLR</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>optimizer</strong> – the standard torch optimizer accepted by Scheduler in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch scheduler</p>
<p>A scheduler following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzanMusicSpeech.build_task">
<span class="sig-name descname"><span class="pre">build_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L242-L250"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzanMusicSpeech.build_task" title="Permalink to this definition">#</a></dt>
<dd><p>Build the task, which defines the logics for every train/valid/test forward step for the <code class="code docutils literal notranslate"><span class="pre">model</span></code>,
and the logics for how to reduce all the batch results from multiple train/valid/test steps into metrics</p>
<p>By default build <code class="xref py py-obj docutils literal notranslate"><span class="pre">UtteranceClassificationTask</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.default_config" title="s3prl.problem.HearGtzanMusicSpeech.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model built by <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.build_model" title="s3prl.problem.HearGtzanMusicSpeech.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a></p></li>
<li><p><strong>encoder</strong> – the encoder built by <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.build_encoder" title="s3prl.problem.HearGtzanMusicSpeech.build_encoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_encoder</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Task</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzanMusicSpeech.build_upstream">
<span class="sig-name descname"><span class="pre">build_upstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L158-L173"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzanMusicSpeech.build_upstream" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the upstream with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.default_config" title="s3prl.problem.HearGtzanMusicSpeech.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUpstream" title="s3prl.nn.interface.AbsUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUpstream</span></code></a></p>
<p>Return an upstream model, whose forward takes the waveform input and returns
multiple hidden states as features.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzanMusicSpeech.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L660-L707"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzanMusicSpeech.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>The evaluate routine used by <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.train" title="s3prl.problem.HearGtzanMusicSpeech.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> (during validation phase) and <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.run" title="s3prl.problem.HearGtzanMusicSpeech.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>
(during testing phase).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evaluate</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.default_config" title="s3prl.problem.HearGtzanMusicSpeech.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzanMusicSpeech.get_class_from_name">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_class_from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L129-L141"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzanMusicSpeech.get_class_from_name" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">__name__</span></code> of the problem class</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Problem</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzanMusicSpeech.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L752-L772"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzanMusicSpeech.load_model" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model_ckpt_dir</strong> (<em>str</em>) – Restore the model with <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.build_model" title="s3prl.problem.HearGtzanMusicSpeech.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> and the checkpoint
saved in this directory.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzanMusicSpeech.load_model_and_task">
<span class="sig-name descname"><span class="pre">load_model_and_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ckpts_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L884-L902"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzanMusicSpeech.load_model_and_task" title="Permalink to this definition">#</a></dt>
<dd><p>This is a helper method to combine <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.load_model" title="s3prl.problem.HearGtzanMusicSpeech.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a> and <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.load_task" title="s3prl.problem.HearGtzanMusicSpeech.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>
together to directly load the model and the task. This method assumes
the model is saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'model'</span></code> and the task is
saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'task'</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>model (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>)</p></li>
<li><p>task (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a>)</p></li>
</ol>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzanMusicSpeech.load_task">
<span class="sig-name descname"><span class="pre">load_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L833-L882"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzanMusicSpeech.load_task" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – Restore the task with <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.build_task" title="s3prl.problem.HearGtzanMusicSpeech.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> and the checkpoint
saved in this directory.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model for the task, since the model is separately saved
and is required for <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.build_task" title="s3prl.problem.HearGtzanMusicSpeech.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a>.</p></li>
<li><p><strong>task_overrides</strong> (<em>dict</em>) – overrides the saved initialization arguments, so can change
the loaded task’s behavior. Like, change the decoding hyperparameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzanMusicSpeech.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L954-L995"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzanMusicSpeech.main" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzanMusicSpeech.prepare_data">
<span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_esc50.py#L151-L160"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzanMusicSpeech.prepare_data" title="Permalink to this definition">#</a></dt>
<dd><p>Prepare the task-specific data metadata (path, labels…).
By default call <code class="xref py py-obj docutils literal notranslate"><span class="pre">voxceleb1_for_sid</span></code> with <code class="code docutils literal notranslate"><span class="pre">**prepare_data</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prepare_data</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.default_config" title="s3prl.problem.HearGtzanMusicSpeech.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments in <code class="xref py py-obj docutils literal notranslate"><span class="pre">voxceleb1_for_sid</span></code></p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Parse your corpus and save the csv file into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the parsing or preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>train_path (str)</p></li>
<li><p>valid_path (str)</p></li>
<li><p>test_paths (List[str])</p></li>
</ol>
<p>Each path (str) should be a csv file containing the following columns:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>column</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>(str) - the unique id for this data point</p></td>
</tr>
<tr class="row-odd"><td><p>wav_path</p></td>
<td><p>(str) - the absolute path of the waveform file</p></td>
</tr>
<tr class="row-even"><td><p>label</p></td>
<td><p>(str) - a string label of the waveform</p></td>
</tr>
<tr class="row-odd"><td><p>start_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">start_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load from the beginning.</p></td>
</tr>
<tr class="row-even"><td><p>end_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">end_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load to the end.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzanMusicSpeech.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_all_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cuda'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/run.py#L26-L318"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzanMusicSpeech.run" title="Permalink to this definition">#</a></dt>
<dd><div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>stage</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Parse the corpus and save the metadata file (waveform path, label…)</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Build the encoder to encode the labels</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Train the model</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Evaluate the model on multiple test sets</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_dir</strong> (<em>str</em>) – The directory that stores the script result.</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – The directory that caches the processed data.
Default: /home/user/.cache/s3prl/data</p></li>
<li><p><strong>remove_all_cache</strong> (<em>bool</em>) – Whether to remove all the cache stored under <cite>cache_dir</cite>.
Default: False</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting stage of the problem script.
Default: 0</p></li>
<li><p><strong>stop</strong> (<em>int</em>) – The stoping stage of the problem script, set <cite>None</cite> to reach the final stage.
Default: None</p></li>
<li><p><strong>num_workers</strong> (<em>int</em>) – num_workers for all the torch DataLoder</p></li>
<li><p><strong>eval_batch</strong> (<em>int</em>) – During evaluation (valid or test), limit the number of batch.
This is helpful for the fast development to check everything won’t crash.
If is -1, disable this feature and evaluate the entire epoch.
Default: -1</p></li>
<li><p><strong>device</strong> (<em>str</em>) – The device type for all torch-related operation: “cpu” or “cuda”
Default: “cuda”</p></li>
<li><p><strong>world_size</strong> (<em>int</em>) – How many processes are running this script simultaneously (in parallel).
Usually this is just 1, however if you are runnig distributed training,
this should be &gt; 1.
Default: 1</p></li>
<li><p><strong>rank</strong> (<em>int</em>) – When distributed training, world_size &gt; 1. Take <code class="code docutils literal notranslate"><span class="pre">world_size</span> <span class="pre">==</span> <span class="pre">8</span></code> for
example, this means 8 processes (8 GPUs) are runing in parallel. The script
needs to know which process among 8 processes it is. In this case, <code class="code docutils literal notranslate"><span class="pre">rank</span></code>
can range from 0~7. All the 8 processes have the same <code class="code docutils literal notranslate"><span class="pre">world_size</span></code> but
different <code class="code docutils literal notranslate"><span class="pre">rank</span></code> (process id).</p></li>
<li><p><strong>test_ckpt_dir</strong> (<em>str</em>) – Specify the checkpoint path for testing. If not, use the validation best
checkpoint under the given <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> directory.</p></li>
<li><p><strong>**kwds</strong> – The other arguments like <code class="code docutils literal notranslate"><span class="pre">prepare_data</span></code> and <code class="code docutils literal notranslate"><span class="pre">build_model</span></code> are
method specific-arguments for methods like <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.prepare_data" title="s3prl.problem.HearGtzanMusicSpeech.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> and
<a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.build_model" title="s3prl.problem.HearGtzanMusicSpeech.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>, and will not be used in the core <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.run" title="s3prl.problem.HearGtzanMusicSpeech.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> logic.
See the specific method documentation for their supported arguments and
meaning</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzanMusicSpeech.save_model">
<span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L709-L750"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzanMusicSpeech.save_model" title="Permalink to this definition">#</a></dt>
<dd><p>Save the model state_dict and the model initialization arguments into the given directory.
If you override this method, it is highly possible you also need to override <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.load_model" title="s3prl.problem.HearGtzanMusicSpeech.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.default_config" title="s3prl.problem.HearGtzanMusicSpeech.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_model</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>model_ckpt_dir</strong> (<em>str</em>) – save the model into the this directory.</p></li>
<li><p><strong>build_model_all_args</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.build_model" title="s3prl.problem.HearGtzanMusicSpeech.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>.
By saving this dictionary, you can easily reconstruct the same model
by calling <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.build_model" title="s3prl.problem.HearGtzanMusicSpeech.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzanMusicSpeech.save_task">
<span class="sig-name descname"><span class="pre">save_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="s3prl.task.base.html#s3prl.task.base.Task" title="s3prl.task.base.Task"><span class="pre">Task</span></a></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L774-L831"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzanMusicSpeech.save_task" title="Permalink to this definition">#</a></dt>
<dd><p>Save the task’s state, <code class="code docutils literal notranslate"><span class="pre">task.get_state()</span></code>, and the initialization arguments into the given
directory. If you override this method, it is highly possible you also need to override
<a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.load_task" title="s3prl.problem.HearGtzanMusicSpeech.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.default_config" title="s3prl.problem.HearGtzanMusicSpeech.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_task</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – save the task into this directory.</p></li>
<li><p><strong>build_task_all_args_except_model</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.build_task" title="s3prl.problem.HearGtzanMusicSpeech.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> except
the <code class="code docutils literal notranslate"><span class="pre">model</span></code> argument since the model should be sapartely saved by
<a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.save_model" title="s3prl.problem.HearGtzanMusicSpeech.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a>. By saving this dictionary, you can easily reconstruct the same task
by calling <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.build_task" title="s3prl.problem.HearGtzanMusicSpeech.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>task</strong> (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><em>Task</em></a>) – the task to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzanMusicSpeech.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L287-L658"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzanMusicSpeech.train" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.default_config" title="s3prl.problem.HearGtzanMusicSpeech.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>total_steps</p></td>
<td><p>(int) - the total optimization steps</p></td>
</tr>
<tr class="row-odd"><td><p>log_step</p></td>
<td><p>(int) - logging frequency. log every <code class="code docutils literal notranslate"><span class="pre">log_step</span></code> step</p></td>
</tr>
<tr class="row-even"><td><p>eval_step</p></td>
<td><p>(int) - evaluation frequency. Evaluate every <code class="code docutils literal notranslate"><span class="pre">eval_step</span></code> step.                                                 Note that you can control how many batch to evaluate to speed up the                                                 development by the <code class="code docutils literal notranslate"><span class="pre">eval_batch</span></code> argument in <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.run" title="s3prl.problem.HearGtzanMusicSpeech.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>save_step</p></td>
<td><p>(int) - save the checkpoint every <code class="code docutils literal notranslate"><span class="pre">save_step</span></code> step.</p></td>
</tr>
<tr class="row-even"><td><p>gradient_clipping</p></td>
<td><p>(float) - clip the gradient. important for RNNs.</p></td>
</tr>
<tr class="row-odd"><td><p>gradient_accumulate</p></td>
<td><p>(int) - accumulate multiple steps’ gradient before updating network parameters                                                 to simulate large-batch optimization.</p></td>
</tr>
<tr class="row-even"><td><p>valid_metric</p></td>
<td><p>(str) - the metric to select the best valid checkpoint. Different Tasks have different                                                 supported valid_metrics. See <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.build_task" title="s3prl.problem.HearGtzanMusicSpeech.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> for the supported metrics.</p></td>
</tr>
<tr class="row-odd"><td><p>valid_higher_better</p></td>
<td><p>(bool) - some metrics are higher better, while some are lower better                                                 this will affect how to save the best validation checkpoint.</p></td>
</tr>
<tr class="row-even"><td><p>auto_resume</p></td>
<td><p>(bool) - if there are already the last checkpoint in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.run" title="s3prl.problem.HearGtzanMusicSpeech.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>),                                                 whether to resume from it or delete it and start a new training session.</p></td>
</tr>
<tr class="row-odd"><td><p>resume_ckpt_dir</p></td>
<td><p>(str) - you can directly specify the checkpoint path to resume which is not necessary                                                 in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.HearGtzanMusicSpeech.run" title="s3prl.problem.HearGtzanMusicSpeech.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>).</p></td>
</tr>
<tr class="row-even"><td><p>seed</p></td>
<td><p>(int) - fix the seed before the training start</p></td>
</tr>
<tr class="row-odd"><td><p>keep_num_ckpts</p></td>
<td><p>(int) - to prevent saving too many checkpoints, only save the <code class="code docutils literal notranslate"><span class="pre">keep_num_ckpts</span></code>                                                 latest checkpoints and delete the old ones.</p></td>
</tr>
<tr class="row-even"><td><p>use_scheduler</p></td>
<td><p>(bool) - whether to use the scheduler</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="heargtzan">
<h2>HearGtzan<a class="headerlink" href="#heargtzan" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzan">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">s3prl.problem.</span></span><span class="sig-name descname"><span class="pre">HearGtzan</span></span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_gtzan.html#HearGtzan"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_gtzan.py#L10-L78"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzan" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="s3prl.problem.common.hear_esc50.html#s3prl.problem.common.hear_esc50.HearESC50" title="s3prl.problem.common.hear_esc50.HearESC50"><code class="xref py py-class docutils literal notranslate"><span class="pre">HearESC50</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzan.default_config">
<span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_gtzan.html#HearGtzan.default_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_gtzan.py#L11-L78"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzan.default_config" title="Permalink to this definition">#</a></dt>
<dd><p>The default arguments for <a class="reference internal" href="#s3prl.problem.HearGtzan.run" title="s3prl.problem.HearGtzan.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> in yaml.
Note that for the fields with inner values, like <code class="code docutils literal notranslate"><span class="pre">build_model</span></code>,
the outer field name corresponds to a method name, so you can find the method
<a class="reference internal" href="#s3prl.problem.HearGtzan.build_model" title="s3prl.problem.HearGtzan.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>. Furthermore, the values inside that field will be
directly passed into the method. So by changing these inner values, you
can directly affect the behavior of the corresponding method. See the method
documentation for all the supported arguments and their meanings.</p>
<p>The methods affected by the following config are: <a class="reference internal" href="#s3prl.problem.HearGtzan.prepare_data" title="s3prl.problem.HearGtzan.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGtzan.build_batch_sampler" title="s3prl.problem.HearGtzan.build_batch_sampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_batch_sampler</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGtzan.build_upstream" title="s3prl.problem.HearGtzan.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGtzan.build_featurizer" title="s3prl.problem.HearGtzan.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGtzan.build_downstream" title="s3prl.problem.HearGtzan.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGtzan.build_model" title="s3prl.problem.HearGtzan.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGtzan.build_task" title="s3prl.problem.HearGtzan.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGtzan.build_optimizer" title="s3prl.problem.HearGtzan.build_optimizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_optimizer</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGtzan.build_scheduler" title="s3prl.problem.HearGtzan.build_scheduler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_scheduler</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGtzan.save_model" title="s3prl.problem.HearGtzan.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGtzan.save_task" title="s3prl.problem.HearGtzan.save_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_task</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGtzan.train" title="s3prl.problem.HearGtzan.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGtzan.evaluate" title="s3prl.problem.HearGtzan.evaluate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate</span></code></a></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">start</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="nt">stop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">target_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">cache_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">remove_all_cache</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">prepare_data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">dataset_root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="w">  </span><span class="nt">test_fold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="w">  </span><span class="nt">num_folds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="nt">build_batch_sampler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">train</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">32</span>
<span class="w">    </span><span class="nt">shuffle</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">valid</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">test</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="nt">build_upstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">build_featurizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">layer_selections</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="nt">normalize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_downstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">hidden_layers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">  </span><span class="nt">pooling_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MeanPooling</span>
<span class="nt">build_model</span><span class="p">:</span>
<span class="w">  </span><span class="nt">upstream_trainable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_task</span><span class="p">:</span>
<span class="w">  </span><span class="nt">prediction_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">multiclass</span>
<span class="w">  </span><span class="nt">scores</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top1_acc</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mAP</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">d_prime</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aucroc</span>
<span class="nt">build_optimizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Adam</span>
<span class="w">  </span><span class="nt">conf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">lr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.001</span>
<span class="nt">build_scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ExponentialLR</span>
<span class="w">  </span><span class="nt">gamma</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.9</span>
<span class="nt">save_model</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">save_task</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">train</span><span class="p">:</span>
<span class="w">  </span><span class="nt">total_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">150000</span>
<span class="w">  </span><span class="nt">log_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">  </span><span class="nt">eval_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span>
<span class="w">  </span><span class="nt">save_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">  </span><span class="nt">gradient_clipping</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0</span>
<span class="w">  </span><span class="nt">gradient_accumulate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">valid_metric</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top1_acc</span>
<span class="w">  </span><span class="nt">valid_higher_better</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">auto_resume</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">resume_ckpt_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">evaluate</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzan.build_batch_sampler">
<span class="sig-name descname"><span class="pre">build_batch_sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L213-L229"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzan.build_batch_sampler" title="Permalink to this definition">#</a></dt>
<dd><p>Return the batch sampler for torch DataLoader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_batch_sampler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearGtzan.default_config" title="s3prl.problem.HearGtzan.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>train</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>valid</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-even"><td><p>test</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">mode</span></code> specific csv from <a class="reference internal" href="#s3prl.problem.HearGtzan.prepare_data" title="s3prl.problem.HearGtzan.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>dataset</strong> – the dataset from <a class="reference internal" href="#s3prl.problem.HearGtzan.build_dataset" title="s3prl.problem.HearGtzan.build_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_dataset</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>batch sampler for torch DataLoader</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzan.build_collate_fn">
<span class="sig-name descname"><span class="pre">build_collate_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L143-L156"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzan.build_collate_fn" title="Permalink to this definition">#</a></dt>
<dd><p>By default returns <code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataset.base.default_collate_fn</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_collate_fn</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGtzan.default_config" title="s3prl.problem.HearGtzan.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train, valid, or test</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>callable</p>
<p>the collate_fn for torch DataLoader in train/valid/test <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzan.build_dataset">
<span class="sig-name descname"><span class="pre">build_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_shift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L172-L211"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzan.build_dataset" title="Permalink to this definition">#</a></dt>
<dd><p>Build the dataset for train/valid/test.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_dataset</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearGtzan.default_config" title="s3prl.problem.HearGtzan.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>. with <code class="code docutils literal notranslate"><span class="pre">train</span></code>, <code class="code docutils literal notranslate"><span class="pre">valid</span></code>, <code class="code docutils literal notranslate"><span class="pre">test</span></code> keys, each
is a dictionary with the following supported options:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>max_secs</p></td>
<td><p>(float) - If a waveform is longer than <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds, randomly crop the waveform into <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds</p></td>
</tr>
<tr class="row-odd"><td><p>sox_effects</p></td>
<td><p>(List[List[str]]) - If not None, apply sox effects on the utterance</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – The metadata csv file for the specific <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p></li>
<li><p><strong>encoder_path</strong> (<em>str</em>) – The pickled encoder path for encoding the labels</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch Dataset</p>
<p>For all train/valid/test mode, the dataset should return each item as a dictionary
containing the following keys:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>x</p></td>
<td><p>(torch.FloatTensor) - the waveform in (seq_len, 1)</p></td>
</tr>
<tr class="row-odd"><td><p>x_len</p></td>
<td><p>(int) - the waveform length <code class="code docutils literal notranslate"><span class="pre">seq_len</span></code></p></td>
</tr>
<tr class="row-even"><td><p>class_id</p></td>
<td><p>(int) - the encoded class id</p></td>
</tr>
<tr class="row-odd"><td><p>label</p></td>
<td><p>(str) - the class name</p></td>
</tr>
<tr class="row-even"><td><p>unique_name</p></td>
<td><p>(str) - the unique id for this datapoint</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzan.build_downstream">
<span class="sig-name descname"><span class="pre">build_downstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L231-L240"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzan.build_downstream" title="Permalink to this definition">#</a></dt>
<dd><p>Return the task-specific downstream model.
By default build the <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code> model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGtzan.default_config" title="s3prl.problem.HearGtzan.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments of <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code></p></li>
<li><p><strong>downstream_input_size</strong> (<em>int</em>) – the required input size of the model</p></li>
<li><p><strong>downstream_output_size</strong> (<em>int</em>) – the required output size of the model</p></li>
<li><p><strong>downstream_input_stride</strong> (<em>int</em>) – the input feature’s stride (from 16 KHz)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUtteranceModel" title="s3prl.nn.interface.AbsUtteranceModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUtteranceModel</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzan.build_encoder">
<span class="sig-name descname"><span class="pre">build_encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_csv_paths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L142-L170"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzan.build_encoder" title="Permalink to this definition">#</a></dt>
<dd><p>Build the encoder (for the labels) given the data metadata, and return the saved encoder path.
By default generate and save a <a class="reference internal" href="s3prl.dataio.encoder.html#s3prl.dataio.encoder.CategoryEncoder" title="s3prl.dataio.encoder.CategoryEncoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataio.encoder.CategoryEncoder</span></code></a> from the <code class="code docutils literal notranslate"><span class="pre">label</span></code> column of all the csv files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_encoder</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGtzan.default_config" title="s3prl.problem.HearGtzan.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Save your encoder into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>train_csv_path</strong> (<em>str</em>) – the train path from <a class="reference internal" href="#s3prl.problem.HearGtzan.prepare_data" title="s3prl.problem.HearGtzan.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>valid_csv_path</strong> (<em>str</em>) – the valid path from <a class="reference internal" href="#s3prl.problem.HearGtzan.prepare_data" title="s3prl.problem.HearGtzan.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>test_csv_paths</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – the test paths from <a class="reference internal" href="#s3prl.problem.HearGtzan.prepare_data" title="s3prl.problem.HearGtzan.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>str</p>
<p>encoder_path: The encoder should be saved in the pickle format</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzan.build_featurizer">
<span class="sig-name descname"><span class="pre">build_featurizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upstream</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L175-L192"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzan.build_featurizer" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the featurizer with <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGtzan.default_config" title="s3prl.problem.HearGtzan.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p></li>
<li><p><strong>upstream</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">AbsUpstream</span></code>) – the upstream model built by <a class="reference internal" href="#s3prl.problem.HearGtzan.build_upstream" title="s3prl.problem.HearGtzan.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsFeaturizer" title="s3prl.nn.interface.AbsFeaturizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsFeaturizer</span></code></a></p>
<p>Return the featurizer model. The featurizer is used to reduce the multiple
hidden states returned from the upstream model (built by <a class="reference internal" href="#s3prl.problem.HearGtzan.build_upstream" title="s3prl.problem.HearGtzan.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>)
into a single hidden state, so can be easliy fed into the downstream model</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzan.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L194-L231"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzan.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>By default build model with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGtzan.default_config" title="s3prl.problem.HearGtzan.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p></li>
<li><p><strong>model_output_size</strong> (<em>int</em>) – the required model’s output hidden size</p></li>
<li><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGtzan.default_config" title="s3prl.problem.HearGtzan.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearGtzan.build_upstream" title="s3prl.problem.HearGtzan.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGtzan.default_config" title="s3prl.problem.HearGtzan.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearGtzan.build_featurizer" title="s3prl.problem.HearGtzan.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a></p></li>
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGtzan.default_config" title="s3prl.problem.HearGtzan.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearGtzan.build_downstream" title="s3prl.problem.HearGtzan.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch.nn.Module</p>
<p>Return the entire model for the task, which takes the direct items from DataLoader as the input.
Usually, the components can be built by <a class="reference internal" href="#s3prl.problem.HearGtzan.build_upstream" title="s3prl.problem.HearGtzan.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>, <a class="reference internal" href="#s3prl.problem.HearGtzan.build_featurizer" title="s3prl.problem.HearGtzan.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a>,
<a class="reference internal" href="#s3prl.problem.HearGtzan.build_downstream" title="s3prl.problem.HearGtzan.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a>, and are concated together to get the final model.
The upstream extracts multiple hidden states, the featuizer reduce them into a single hidden state,
and the downstream takes the hidden states as the feature for the downstream-specific model.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzan.build_optimizer">
<span class="sig-name descname"><span class="pre">build_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L233-L258"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzan.build_optimizer" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_optimizer</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearGtzan.default_config" title="s3prl.problem.HearGtzan.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to below</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the optimizer class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the optimizer class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;lr&quot;:</span> <span class="pre">1.0e-4}</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>parameters</strong> (<em>iterable</em>) – the standard params accepted by <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code></p>
<p>An optimizer following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzan.build_scheduler">
<span class="sig-name descname"><span class="pre">build_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L260-L285"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzan.build_scheduler" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_scheduler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearGtzan.default_config" title="s3prl.problem.HearGtzan.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the scheduler class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the scheduler class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;gamma&quot;:</span> <span class="pre">0.01}</span></code> for <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler.StepLR</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>optimizer</strong> – the standard torch optimizer accepted by Scheduler in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch scheduler</p>
<p>A scheduler following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzan.build_task">
<span class="sig-name descname"><span class="pre">build_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L242-L250"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzan.build_task" title="Permalink to this definition">#</a></dt>
<dd><p>Build the task, which defines the logics for every train/valid/test forward step for the <code class="code docutils literal notranslate"><span class="pre">model</span></code>,
and the logics for how to reduce all the batch results from multiple train/valid/test steps into metrics</p>
<p>By default build <code class="xref py py-obj docutils literal notranslate"><span class="pre">UtteranceClassificationTask</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGtzan.default_config" title="s3prl.problem.HearGtzan.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model built by <a class="reference internal" href="#s3prl.problem.HearGtzan.build_model" title="s3prl.problem.HearGtzan.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a></p></li>
<li><p><strong>encoder</strong> – the encoder built by <a class="reference internal" href="#s3prl.problem.HearGtzan.build_encoder" title="s3prl.problem.HearGtzan.build_encoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_encoder</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Task</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzan.build_upstream">
<span class="sig-name descname"><span class="pre">build_upstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L158-L173"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzan.build_upstream" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the upstream with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGtzan.default_config" title="s3prl.problem.HearGtzan.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUpstream" title="s3prl.nn.interface.AbsUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUpstream</span></code></a></p>
<p>Return an upstream model, whose forward takes the waveform input and returns
multiple hidden states as features.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzan.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L660-L707"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzan.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>The evaluate routine used by <a class="reference internal" href="#s3prl.problem.HearGtzan.train" title="s3prl.problem.HearGtzan.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> (during validation phase) and <a class="reference internal" href="#s3prl.problem.HearGtzan.run" title="s3prl.problem.HearGtzan.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>
(during testing phase).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evaluate</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGtzan.default_config" title="s3prl.problem.HearGtzan.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzan.get_class_from_name">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_class_from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L129-L141"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzan.get_class_from_name" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">__name__</span></code> of the problem class</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Problem</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzan.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L752-L772"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzan.load_model" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model_ckpt_dir</strong> (<em>str</em>) – Restore the model with <a class="reference internal" href="#s3prl.problem.HearGtzan.build_model" title="s3prl.problem.HearGtzan.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> and the checkpoint
saved in this directory.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzan.load_model_and_task">
<span class="sig-name descname"><span class="pre">load_model_and_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ckpts_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L884-L902"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzan.load_model_and_task" title="Permalink to this definition">#</a></dt>
<dd><p>This is a helper method to combine <a class="reference internal" href="#s3prl.problem.HearGtzan.load_model" title="s3prl.problem.HearGtzan.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a> and <a class="reference internal" href="#s3prl.problem.HearGtzan.load_task" title="s3prl.problem.HearGtzan.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>
together to directly load the model and the task. This method assumes
the model is saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'model'</span></code> and the task is
saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'task'</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>model (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>)</p></li>
<li><p>task (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a>)</p></li>
</ol>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzan.load_task">
<span class="sig-name descname"><span class="pre">load_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L833-L882"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzan.load_task" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – Restore the task with <a class="reference internal" href="#s3prl.problem.HearGtzan.build_task" title="s3prl.problem.HearGtzan.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> and the checkpoint
saved in this directory.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model for the task, since the model is separately saved
and is required for <a class="reference internal" href="#s3prl.problem.HearGtzan.build_task" title="s3prl.problem.HearGtzan.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a>.</p></li>
<li><p><strong>task_overrides</strong> (<em>dict</em>) – overrides the saved initialization arguments, so can change
the loaded task’s behavior. Like, change the decoding hyperparameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzan.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L954-L995"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzan.main" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzan.prepare_data">
<span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_esc50.py#L151-L160"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzan.prepare_data" title="Permalink to this definition">#</a></dt>
<dd><p>Prepare the task-specific data metadata (path, labels…).
By default call <code class="xref py py-obj docutils literal notranslate"><span class="pre">voxceleb1_for_sid</span></code> with <code class="code docutils literal notranslate"><span class="pre">**prepare_data</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prepare_data</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGtzan.default_config" title="s3prl.problem.HearGtzan.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments in <code class="xref py py-obj docutils literal notranslate"><span class="pre">voxceleb1_for_sid</span></code></p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Parse your corpus and save the csv file into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the parsing or preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>train_path (str)</p></li>
<li><p>valid_path (str)</p></li>
<li><p>test_paths (List[str])</p></li>
</ol>
<p>Each path (str) should be a csv file containing the following columns:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>column</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>(str) - the unique id for this data point</p></td>
</tr>
<tr class="row-odd"><td><p>wav_path</p></td>
<td><p>(str) - the absolute path of the waveform file</p></td>
</tr>
<tr class="row-even"><td><p>label</p></td>
<td><p>(str) - a string label of the waveform</p></td>
</tr>
<tr class="row-odd"><td><p>start_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">start_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load from the beginning.</p></td>
</tr>
<tr class="row-even"><td><p>end_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">end_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load to the end.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzan.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_all_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cuda'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/run.py#L26-L318"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzan.run" title="Permalink to this definition">#</a></dt>
<dd><div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>stage</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Parse the corpus and save the metadata file (waveform path, label…)</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Build the encoder to encode the labels</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Train the model</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Evaluate the model on multiple test sets</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_dir</strong> (<em>str</em>) – The directory that stores the script result.</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – The directory that caches the processed data.
Default: /home/user/.cache/s3prl/data</p></li>
<li><p><strong>remove_all_cache</strong> (<em>bool</em>) – Whether to remove all the cache stored under <cite>cache_dir</cite>.
Default: False</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting stage of the problem script.
Default: 0</p></li>
<li><p><strong>stop</strong> (<em>int</em>) – The stoping stage of the problem script, set <cite>None</cite> to reach the final stage.
Default: None</p></li>
<li><p><strong>num_workers</strong> (<em>int</em>) – num_workers for all the torch DataLoder</p></li>
<li><p><strong>eval_batch</strong> (<em>int</em>) – During evaluation (valid or test), limit the number of batch.
This is helpful for the fast development to check everything won’t crash.
If is -1, disable this feature and evaluate the entire epoch.
Default: -1</p></li>
<li><p><strong>device</strong> (<em>str</em>) – The device type for all torch-related operation: “cpu” or “cuda”
Default: “cuda”</p></li>
<li><p><strong>world_size</strong> (<em>int</em>) – How many processes are running this script simultaneously (in parallel).
Usually this is just 1, however if you are runnig distributed training,
this should be &gt; 1.
Default: 1</p></li>
<li><p><strong>rank</strong> (<em>int</em>) – When distributed training, world_size &gt; 1. Take <code class="code docutils literal notranslate"><span class="pre">world_size</span> <span class="pre">==</span> <span class="pre">8</span></code> for
example, this means 8 processes (8 GPUs) are runing in parallel. The script
needs to know which process among 8 processes it is. In this case, <code class="code docutils literal notranslate"><span class="pre">rank</span></code>
can range from 0~7. All the 8 processes have the same <code class="code docutils literal notranslate"><span class="pre">world_size</span></code> but
different <code class="code docutils literal notranslate"><span class="pre">rank</span></code> (process id).</p></li>
<li><p><strong>test_ckpt_dir</strong> (<em>str</em>) – Specify the checkpoint path for testing. If not, use the validation best
checkpoint under the given <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> directory.</p></li>
<li><p><strong>**kwds</strong> – The other arguments like <code class="code docutils literal notranslate"><span class="pre">prepare_data</span></code> and <code class="code docutils literal notranslate"><span class="pre">build_model</span></code> are
method specific-arguments for methods like <a class="reference internal" href="#s3prl.problem.HearGtzan.prepare_data" title="s3prl.problem.HearGtzan.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> and
<a class="reference internal" href="#s3prl.problem.HearGtzan.build_model" title="s3prl.problem.HearGtzan.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>, and will not be used in the core <a class="reference internal" href="#s3prl.problem.HearGtzan.run" title="s3prl.problem.HearGtzan.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> logic.
See the specific method documentation for their supported arguments and
meaning</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzan.save_model">
<span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L709-L750"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzan.save_model" title="Permalink to this definition">#</a></dt>
<dd><p>Save the model state_dict and the model initialization arguments into the given directory.
If you override this method, it is highly possible you also need to override <a class="reference internal" href="#s3prl.problem.HearGtzan.load_model" title="s3prl.problem.HearGtzan.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGtzan.default_config" title="s3prl.problem.HearGtzan.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_model</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>model_ckpt_dir</strong> (<em>str</em>) – save the model into the this directory.</p></li>
<li><p><strong>build_model_all_args</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.HearGtzan.build_model" title="s3prl.problem.HearGtzan.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>.
By saving this dictionary, you can easily reconstruct the same model
by calling <a class="reference internal" href="#s3prl.problem.HearGtzan.build_model" title="s3prl.problem.HearGtzan.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzan.save_task">
<span class="sig-name descname"><span class="pre">save_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="s3prl.task.base.html#s3prl.task.base.Task" title="s3prl.task.base.Task"><span class="pre">Task</span></a></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L774-L831"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzan.save_task" title="Permalink to this definition">#</a></dt>
<dd><p>Save the task’s state, <code class="code docutils literal notranslate"><span class="pre">task.get_state()</span></code>, and the initialization arguments into the given
directory. If you override this method, it is highly possible you also need to override
<a class="reference internal" href="#s3prl.problem.HearGtzan.load_task" title="s3prl.problem.HearGtzan.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGtzan.default_config" title="s3prl.problem.HearGtzan.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_task</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – save the task into this directory.</p></li>
<li><p><strong>build_task_all_args_except_model</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.HearGtzan.build_task" title="s3prl.problem.HearGtzan.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> except
the <code class="code docutils literal notranslate"><span class="pre">model</span></code> argument since the model should be sapartely saved by
<a class="reference internal" href="#s3prl.problem.HearGtzan.save_model" title="s3prl.problem.HearGtzan.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a>. By saving this dictionary, you can easily reconstruct the same task
by calling <a class="reference internal" href="#s3prl.problem.HearGtzan.build_task" title="s3prl.problem.HearGtzan.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>task</strong> (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><em>Task</em></a>) – the task to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGtzan.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L287-L658"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGtzan.train" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearGtzan.default_config" title="s3prl.problem.HearGtzan.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>total_steps</p></td>
<td><p>(int) - the total optimization steps</p></td>
</tr>
<tr class="row-odd"><td><p>log_step</p></td>
<td><p>(int) - logging frequency. log every <code class="code docutils literal notranslate"><span class="pre">log_step</span></code> step</p></td>
</tr>
<tr class="row-even"><td><p>eval_step</p></td>
<td><p>(int) - evaluation frequency. Evaluate every <code class="code docutils literal notranslate"><span class="pre">eval_step</span></code> step.                                                 Note that you can control how many batch to evaluate to speed up the                                                 development by the <code class="code docutils literal notranslate"><span class="pre">eval_batch</span></code> argument in <a class="reference internal" href="#s3prl.problem.HearGtzan.run" title="s3prl.problem.HearGtzan.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>save_step</p></td>
<td><p>(int) - save the checkpoint every <code class="code docutils literal notranslate"><span class="pre">save_step</span></code> step.</p></td>
</tr>
<tr class="row-even"><td><p>gradient_clipping</p></td>
<td><p>(float) - clip the gradient. important for RNNs.</p></td>
</tr>
<tr class="row-odd"><td><p>gradient_accumulate</p></td>
<td><p>(int) - accumulate multiple steps’ gradient before updating network parameters                                                 to simulate large-batch optimization.</p></td>
</tr>
<tr class="row-even"><td><p>valid_metric</p></td>
<td><p>(str) - the metric to select the best valid checkpoint. Different Tasks have different                                                 supported valid_metrics. See <a class="reference internal" href="#s3prl.problem.HearGtzan.build_task" title="s3prl.problem.HearGtzan.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> for the supported metrics.</p></td>
</tr>
<tr class="row-odd"><td><p>valid_higher_better</p></td>
<td><p>(bool) - some metrics are higher better, while some are lower better                                                 this will affect how to save the best validation checkpoint.</p></td>
</tr>
<tr class="row-even"><td><p>auto_resume</p></td>
<td><p>(bool) - if there are already the last checkpoint in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.HearGtzan.run" title="s3prl.problem.HearGtzan.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>),                                                 whether to resume from it or delete it and start a new training session.</p></td>
</tr>
<tr class="row-odd"><td><p>resume_ckpt_dir</p></td>
<td><p>(str) - you can directly specify the checkpoint path to resume which is not necessary                                                 in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.HearGtzan.run" title="s3prl.problem.HearGtzan.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>).</p></td>
</tr>
<tr class="row-even"><td><p>seed</p></td>
<td><p>(int) - fix the seed before the training start</p></td>
</tr>
<tr class="row-odd"><td><p>keep_num_ckpts</p></td>
<td><p>(int) - to prevent saving too many checkpoints, only save the <code class="code docutils literal notranslate"><span class="pre">keep_num_ckpts</span></code>                                                 latest checkpoints and delete the old ones.</p></td>
</tr>
<tr class="row-even"><td><p>use_scheduler</p></td>
<td><p>(bool) - whether to use the scheduler</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="heargunshot">
<h2>HearGunshot<a class="headerlink" href="#heargunshot" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="s3prl.problem.HearGunshot">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">s3prl.problem.</span></span><span class="sig-name descname"><span class="pre">HearGunshot</span></span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_gunshot.html#HearGunshot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_gunshot.py#L10-L78"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGunshot" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="s3prl.problem.common.hear_esc50.html#s3prl.problem.common.hear_esc50.HearESC50" title="s3prl.problem.common.hear_esc50.HearESC50"><code class="xref py py-class docutils literal notranslate"><span class="pre">HearESC50</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGunshot.default_config">
<span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_gunshot.html#HearGunshot.default_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_gunshot.py#L11-L78"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGunshot.default_config" title="Permalink to this definition">#</a></dt>
<dd><p>The default arguments for <a class="reference internal" href="#s3prl.problem.HearGunshot.run" title="s3prl.problem.HearGunshot.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> in yaml.
Note that for the fields with inner values, like <code class="code docutils literal notranslate"><span class="pre">build_model</span></code>,
the outer field name corresponds to a method name, so you can find the method
<a class="reference internal" href="#s3prl.problem.HearGunshot.build_model" title="s3prl.problem.HearGunshot.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>. Furthermore, the values inside that field will be
directly passed into the method. So by changing these inner values, you
can directly affect the behavior of the corresponding method. See the method
documentation for all the supported arguments and their meanings.</p>
<p>The methods affected by the following config are: <a class="reference internal" href="#s3prl.problem.HearGunshot.prepare_data" title="s3prl.problem.HearGunshot.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGunshot.build_batch_sampler" title="s3prl.problem.HearGunshot.build_batch_sampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_batch_sampler</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGunshot.build_upstream" title="s3prl.problem.HearGunshot.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGunshot.build_featurizer" title="s3prl.problem.HearGunshot.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGunshot.build_downstream" title="s3prl.problem.HearGunshot.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGunshot.build_model" title="s3prl.problem.HearGunshot.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGunshot.build_task" title="s3prl.problem.HearGunshot.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGunshot.build_optimizer" title="s3prl.problem.HearGunshot.build_optimizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_optimizer</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGunshot.build_scheduler" title="s3prl.problem.HearGunshot.build_scheduler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_scheduler</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGunshot.save_model" title="s3prl.problem.HearGunshot.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGunshot.save_task" title="s3prl.problem.HearGunshot.save_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_task</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGunshot.train" title="s3prl.problem.HearGunshot.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> <a class="reference internal" href="#s3prl.problem.HearGunshot.evaluate" title="s3prl.problem.HearGunshot.evaluate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate</span></code></a></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">start</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="nt">stop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">target_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">cache_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">remove_all_cache</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">prepare_data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">dataset_root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="w">  </span><span class="nt">test_fold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="w">  </span><span class="nt">num_folds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">7</span>
<span class="nt">build_batch_sampler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">train</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">32</span>
<span class="w">    </span><span class="nt">shuffle</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">valid</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">test</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="nt">build_upstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">build_featurizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">layer_selections</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="nt">normalize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_downstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">hidden_layers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">  </span><span class="nt">pooling_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MeanPooling</span>
<span class="nt">build_model</span><span class="p">:</span>
<span class="w">  </span><span class="nt">upstream_trainable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_task</span><span class="p">:</span>
<span class="w">  </span><span class="nt">prediction_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">multiclass</span>
<span class="w">  </span><span class="nt">scores</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top1_acc</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">d_prime</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aucroc</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mAP</span>
<span class="nt">build_optimizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Adam</span>
<span class="w">  </span><span class="nt">conf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">lr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.001</span>
<span class="nt">build_scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ExponentialLR</span>
<span class="w">  </span><span class="nt">gamma</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.9</span>
<span class="nt">save_model</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">save_task</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">train</span><span class="p">:</span>
<span class="w">  </span><span class="nt">total_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">150000</span>
<span class="w">  </span><span class="nt">log_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">  </span><span class="nt">eval_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span>
<span class="w">  </span><span class="nt">save_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">  </span><span class="nt">gradient_clipping</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0</span>
<span class="w">  </span><span class="nt">gradient_accumulate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">valid_metric</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top1_acc</span>
<span class="w">  </span><span class="nt">valid_higher_better</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">auto_resume</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">resume_ckpt_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">evaluate</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGunshot.build_batch_sampler">
<span class="sig-name descname"><span class="pre">build_batch_sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L213-L229"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGunshot.build_batch_sampler" title="Permalink to this definition">#</a></dt>
<dd><p>Return the batch sampler for torch DataLoader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_batch_sampler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearGunshot.default_config" title="s3prl.problem.HearGunshot.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>train</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>valid</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-even"><td><p>test</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">mode</span></code> specific csv from <a class="reference internal" href="#s3prl.problem.HearGunshot.prepare_data" title="s3prl.problem.HearGunshot.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>dataset</strong> – the dataset from <a class="reference internal" href="#s3prl.problem.HearGunshot.build_dataset" title="s3prl.problem.HearGunshot.build_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_dataset</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>batch sampler for torch DataLoader</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGunshot.build_collate_fn">
<span class="sig-name descname"><span class="pre">build_collate_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L143-L156"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGunshot.build_collate_fn" title="Permalink to this definition">#</a></dt>
<dd><p>By default returns <code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataset.base.default_collate_fn</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_collate_fn</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGunshot.default_config" title="s3prl.problem.HearGunshot.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train, valid, or test</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>callable</p>
<p>the collate_fn for torch DataLoader in train/valid/test <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGunshot.build_dataset">
<span class="sig-name descname"><span class="pre">build_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_shift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L172-L211"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGunshot.build_dataset" title="Permalink to this definition">#</a></dt>
<dd><p>Build the dataset for train/valid/test.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_dataset</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearGunshot.default_config" title="s3prl.problem.HearGunshot.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>. with <code class="code docutils literal notranslate"><span class="pre">train</span></code>, <code class="code docutils literal notranslate"><span class="pre">valid</span></code>, <code class="code docutils literal notranslate"><span class="pre">test</span></code> keys, each
is a dictionary with the following supported options:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>max_secs</p></td>
<td><p>(float) - If a waveform is longer than <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds, randomly crop the waveform into <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds</p></td>
</tr>
<tr class="row-odd"><td><p>sox_effects</p></td>
<td><p>(List[List[str]]) - If not None, apply sox effects on the utterance</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – The metadata csv file for the specific <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p></li>
<li><p><strong>encoder_path</strong> (<em>str</em>) – The pickled encoder path for encoding the labels</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch Dataset</p>
<p>For all train/valid/test mode, the dataset should return each item as a dictionary
containing the following keys:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>x</p></td>
<td><p>(torch.FloatTensor) - the waveform in (seq_len, 1)</p></td>
</tr>
<tr class="row-odd"><td><p>x_len</p></td>
<td><p>(int) - the waveform length <code class="code docutils literal notranslate"><span class="pre">seq_len</span></code></p></td>
</tr>
<tr class="row-even"><td><p>class_id</p></td>
<td><p>(int) - the encoded class id</p></td>
</tr>
<tr class="row-odd"><td><p>label</p></td>
<td><p>(str) - the class name</p></td>
</tr>
<tr class="row-even"><td><p>unique_name</p></td>
<td><p>(str) - the unique id for this datapoint</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGunshot.build_downstream">
<span class="sig-name descname"><span class="pre">build_downstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L231-L240"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGunshot.build_downstream" title="Permalink to this definition">#</a></dt>
<dd><p>Return the task-specific downstream model.
By default build the <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code> model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGunshot.default_config" title="s3prl.problem.HearGunshot.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments of <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code></p></li>
<li><p><strong>downstream_input_size</strong> (<em>int</em>) – the required input size of the model</p></li>
<li><p><strong>downstream_output_size</strong> (<em>int</em>) – the required output size of the model</p></li>
<li><p><strong>downstream_input_stride</strong> (<em>int</em>) – the input feature’s stride (from 16 KHz)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUtteranceModel" title="s3prl.nn.interface.AbsUtteranceModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUtteranceModel</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGunshot.build_encoder">
<span class="sig-name descname"><span class="pre">build_encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_csv_paths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L142-L170"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGunshot.build_encoder" title="Permalink to this definition">#</a></dt>
<dd><p>Build the encoder (for the labels) given the data metadata, and return the saved encoder path.
By default generate and save a <a class="reference internal" href="s3prl.dataio.encoder.html#s3prl.dataio.encoder.CategoryEncoder" title="s3prl.dataio.encoder.CategoryEncoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataio.encoder.CategoryEncoder</span></code></a> from the <code class="code docutils literal notranslate"><span class="pre">label</span></code> column of all the csv files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_encoder</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGunshot.default_config" title="s3prl.problem.HearGunshot.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Save your encoder into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>train_csv_path</strong> (<em>str</em>) – the train path from <a class="reference internal" href="#s3prl.problem.HearGunshot.prepare_data" title="s3prl.problem.HearGunshot.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>valid_csv_path</strong> (<em>str</em>) – the valid path from <a class="reference internal" href="#s3prl.problem.HearGunshot.prepare_data" title="s3prl.problem.HearGunshot.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>test_csv_paths</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – the test paths from <a class="reference internal" href="#s3prl.problem.HearGunshot.prepare_data" title="s3prl.problem.HearGunshot.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>str</p>
<p>encoder_path: The encoder should be saved in the pickle format</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGunshot.build_featurizer">
<span class="sig-name descname"><span class="pre">build_featurizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upstream</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L175-L192"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGunshot.build_featurizer" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the featurizer with <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGunshot.default_config" title="s3prl.problem.HearGunshot.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p></li>
<li><p><strong>upstream</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">AbsUpstream</span></code>) – the upstream model built by <a class="reference internal" href="#s3prl.problem.HearGunshot.build_upstream" title="s3prl.problem.HearGunshot.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsFeaturizer" title="s3prl.nn.interface.AbsFeaturizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsFeaturizer</span></code></a></p>
<p>Return the featurizer model. The featurizer is used to reduce the multiple
hidden states returned from the upstream model (built by <a class="reference internal" href="#s3prl.problem.HearGunshot.build_upstream" title="s3prl.problem.HearGunshot.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>)
into a single hidden state, so can be easliy fed into the downstream model</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGunshot.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L194-L231"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGunshot.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>By default build model with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGunshot.default_config" title="s3prl.problem.HearGunshot.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p></li>
<li><p><strong>model_output_size</strong> (<em>int</em>) – the required model’s output hidden size</p></li>
<li><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGunshot.default_config" title="s3prl.problem.HearGunshot.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearGunshot.build_upstream" title="s3prl.problem.HearGunshot.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGunshot.default_config" title="s3prl.problem.HearGunshot.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearGunshot.build_featurizer" title="s3prl.problem.HearGunshot.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a></p></li>
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGunshot.default_config" title="s3prl.problem.HearGunshot.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearGunshot.build_downstream" title="s3prl.problem.HearGunshot.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch.nn.Module</p>
<p>Return the entire model for the task, which takes the direct items from DataLoader as the input.
Usually, the components can be built by <a class="reference internal" href="#s3prl.problem.HearGunshot.build_upstream" title="s3prl.problem.HearGunshot.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>, <a class="reference internal" href="#s3prl.problem.HearGunshot.build_featurizer" title="s3prl.problem.HearGunshot.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a>,
<a class="reference internal" href="#s3prl.problem.HearGunshot.build_downstream" title="s3prl.problem.HearGunshot.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a>, and are concated together to get the final model.
The upstream extracts multiple hidden states, the featuizer reduce them into a single hidden state,
and the downstream takes the hidden states as the feature for the downstream-specific model.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGunshot.build_optimizer">
<span class="sig-name descname"><span class="pre">build_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L233-L258"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGunshot.build_optimizer" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_optimizer</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearGunshot.default_config" title="s3prl.problem.HearGunshot.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to below</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the optimizer class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the optimizer class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;lr&quot;:</span> <span class="pre">1.0e-4}</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>parameters</strong> (<em>iterable</em>) – the standard params accepted by <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code></p>
<p>An optimizer following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGunshot.build_scheduler">
<span class="sig-name descname"><span class="pre">build_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L260-L285"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGunshot.build_scheduler" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_scheduler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearGunshot.default_config" title="s3prl.problem.HearGunshot.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the scheduler class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the scheduler class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;gamma&quot;:</span> <span class="pre">0.01}</span></code> for <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler.StepLR</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>optimizer</strong> – the standard torch optimizer accepted by Scheduler in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch scheduler</p>
<p>A scheduler following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGunshot.build_task">
<span class="sig-name descname"><span class="pre">build_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L242-L250"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGunshot.build_task" title="Permalink to this definition">#</a></dt>
<dd><p>Build the task, which defines the logics for every train/valid/test forward step for the <code class="code docutils literal notranslate"><span class="pre">model</span></code>,
and the logics for how to reduce all the batch results from multiple train/valid/test steps into metrics</p>
<p>By default build <code class="xref py py-obj docutils literal notranslate"><span class="pre">UtteranceClassificationTask</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGunshot.default_config" title="s3prl.problem.HearGunshot.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model built by <a class="reference internal" href="#s3prl.problem.HearGunshot.build_model" title="s3prl.problem.HearGunshot.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a></p></li>
<li><p><strong>encoder</strong> – the encoder built by <a class="reference internal" href="#s3prl.problem.HearGunshot.build_encoder" title="s3prl.problem.HearGunshot.build_encoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_encoder</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Task</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGunshot.build_upstream">
<span class="sig-name descname"><span class="pre">build_upstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L158-L173"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGunshot.build_upstream" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the upstream with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGunshot.default_config" title="s3prl.problem.HearGunshot.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUpstream" title="s3prl.nn.interface.AbsUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUpstream</span></code></a></p>
<p>Return an upstream model, whose forward takes the waveform input and returns
multiple hidden states as features.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGunshot.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L660-L707"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGunshot.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>The evaluate routine used by <a class="reference internal" href="#s3prl.problem.HearGunshot.train" title="s3prl.problem.HearGunshot.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> (during validation phase) and <a class="reference internal" href="#s3prl.problem.HearGunshot.run" title="s3prl.problem.HearGunshot.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>
(during testing phase).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evaluate</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGunshot.default_config" title="s3prl.problem.HearGunshot.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGunshot.get_class_from_name">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_class_from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L129-L141"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGunshot.get_class_from_name" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">__name__</span></code> of the problem class</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Problem</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGunshot.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L752-L772"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGunshot.load_model" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model_ckpt_dir</strong> (<em>str</em>) – Restore the model with <a class="reference internal" href="#s3prl.problem.HearGunshot.build_model" title="s3prl.problem.HearGunshot.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> and the checkpoint
saved in this directory.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGunshot.load_model_and_task">
<span class="sig-name descname"><span class="pre">load_model_and_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ckpts_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L884-L902"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGunshot.load_model_and_task" title="Permalink to this definition">#</a></dt>
<dd><p>This is a helper method to combine <a class="reference internal" href="#s3prl.problem.HearGunshot.load_model" title="s3prl.problem.HearGunshot.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a> and <a class="reference internal" href="#s3prl.problem.HearGunshot.load_task" title="s3prl.problem.HearGunshot.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>
together to directly load the model and the task. This method assumes
the model is saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'model'</span></code> and the task is
saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'task'</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>model (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>)</p></li>
<li><p>task (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a>)</p></li>
</ol>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGunshot.load_task">
<span class="sig-name descname"><span class="pre">load_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L833-L882"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGunshot.load_task" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – Restore the task with <a class="reference internal" href="#s3prl.problem.HearGunshot.build_task" title="s3prl.problem.HearGunshot.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> and the checkpoint
saved in this directory.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model for the task, since the model is separately saved
and is required for <a class="reference internal" href="#s3prl.problem.HearGunshot.build_task" title="s3prl.problem.HearGunshot.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a>.</p></li>
<li><p><strong>task_overrides</strong> (<em>dict</em>) – overrides the saved initialization arguments, so can change
the loaded task’s behavior. Like, change the decoding hyperparameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGunshot.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L954-L995"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGunshot.main" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGunshot.prepare_data">
<span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_esc50.py#L151-L160"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGunshot.prepare_data" title="Permalink to this definition">#</a></dt>
<dd><p>Prepare the task-specific data metadata (path, labels…).
By default call <code class="xref py py-obj docutils literal notranslate"><span class="pre">voxceleb1_for_sid</span></code> with <code class="code docutils literal notranslate"><span class="pre">**prepare_data</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prepare_data</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGunshot.default_config" title="s3prl.problem.HearGunshot.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments in <code class="xref py py-obj docutils literal notranslate"><span class="pre">voxceleb1_for_sid</span></code></p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Parse your corpus and save the csv file into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the parsing or preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>train_path (str)</p></li>
<li><p>valid_path (str)</p></li>
<li><p>test_paths (List[str])</p></li>
</ol>
<p>Each path (str) should be a csv file containing the following columns:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>column</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>(str) - the unique id for this data point</p></td>
</tr>
<tr class="row-odd"><td><p>wav_path</p></td>
<td><p>(str) - the absolute path of the waveform file</p></td>
</tr>
<tr class="row-even"><td><p>label</p></td>
<td><p>(str) - a string label of the waveform</p></td>
</tr>
<tr class="row-odd"><td><p>start_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">start_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load from the beginning.</p></td>
</tr>
<tr class="row-even"><td><p>end_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">end_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load to the end.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGunshot.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_all_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cuda'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/run.py#L26-L318"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGunshot.run" title="Permalink to this definition">#</a></dt>
<dd><div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>stage</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Parse the corpus and save the metadata file (waveform path, label…)</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Build the encoder to encode the labels</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Train the model</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Evaluate the model on multiple test sets</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_dir</strong> (<em>str</em>) – The directory that stores the script result.</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – The directory that caches the processed data.
Default: /home/user/.cache/s3prl/data</p></li>
<li><p><strong>remove_all_cache</strong> (<em>bool</em>) – Whether to remove all the cache stored under <cite>cache_dir</cite>.
Default: False</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting stage of the problem script.
Default: 0</p></li>
<li><p><strong>stop</strong> (<em>int</em>) – The stoping stage of the problem script, set <cite>None</cite> to reach the final stage.
Default: None</p></li>
<li><p><strong>num_workers</strong> (<em>int</em>) – num_workers for all the torch DataLoder</p></li>
<li><p><strong>eval_batch</strong> (<em>int</em>) – During evaluation (valid or test), limit the number of batch.
This is helpful for the fast development to check everything won’t crash.
If is -1, disable this feature and evaluate the entire epoch.
Default: -1</p></li>
<li><p><strong>device</strong> (<em>str</em>) – The device type for all torch-related operation: “cpu” or “cuda”
Default: “cuda”</p></li>
<li><p><strong>world_size</strong> (<em>int</em>) – How many processes are running this script simultaneously (in parallel).
Usually this is just 1, however if you are runnig distributed training,
this should be &gt; 1.
Default: 1</p></li>
<li><p><strong>rank</strong> (<em>int</em>) – When distributed training, world_size &gt; 1. Take <code class="code docutils literal notranslate"><span class="pre">world_size</span> <span class="pre">==</span> <span class="pre">8</span></code> for
example, this means 8 processes (8 GPUs) are runing in parallel. The script
needs to know which process among 8 processes it is. In this case, <code class="code docutils literal notranslate"><span class="pre">rank</span></code>
can range from 0~7. All the 8 processes have the same <code class="code docutils literal notranslate"><span class="pre">world_size</span></code> but
different <code class="code docutils literal notranslate"><span class="pre">rank</span></code> (process id).</p></li>
<li><p><strong>test_ckpt_dir</strong> (<em>str</em>) – Specify the checkpoint path for testing. If not, use the validation best
checkpoint under the given <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> directory.</p></li>
<li><p><strong>**kwds</strong> – The other arguments like <code class="code docutils literal notranslate"><span class="pre">prepare_data</span></code> and <code class="code docutils literal notranslate"><span class="pre">build_model</span></code> are
method specific-arguments for methods like <a class="reference internal" href="#s3prl.problem.HearGunshot.prepare_data" title="s3prl.problem.HearGunshot.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> and
<a class="reference internal" href="#s3prl.problem.HearGunshot.build_model" title="s3prl.problem.HearGunshot.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>, and will not be used in the core <a class="reference internal" href="#s3prl.problem.HearGunshot.run" title="s3prl.problem.HearGunshot.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> logic.
See the specific method documentation for their supported arguments and
meaning</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGunshot.save_model">
<span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L709-L750"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGunshot.save_model" title="Permalink to this definition">#</a></dt>
<dd><p>Save the model state_dict and the model initialization arguments into the given directory.
If you override this method, it is highly possible you also need to override <a class="reference internal" href="#s3prl.problem.HearGunshot.load_model" title="s3prl.problem.HearGunshot.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGunshot.default_config" title="s3prl.problem.HearGunshot.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_model</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>model_ckpt_dir</strong> (<em>str</em>) – save the model into the this directory.</p></li>
<li><p><strong>build_model_all_args</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.HearGunshot.build_model" title="s3prl.problem.HearGunshot.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>.
By saving this dictionary, you can easily reconstruct the same model
by calling <a class="reference internal" href="#s3prl.problem.HearGunshot.build_model" title="s3prl.problem.HearGunshot.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGunshot.save_task">
<span class="sig-name descname"><span class="pre">save_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="s3prl.task.base.html#s3prl.task.base.Task" title="s3prl.task.base.Task"><span class="pre">Task</span></a></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L774-L831"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGunshot.save_task" title="Permalink to this definition">#</a></dt>
<dd><p>Save the task’s state, <code class="code docutils literal notranslate"><span class="pre">task.get_state()</span></code>, and the initialization arguments into the given
directory. If you override this method, it is highly possible you also need to override
<a class="reference internal" href="#s3prl.problem.HearGunshot.load_task" title="s3prl.problem.HearGunshot.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearGunshot.default_config" title="s3prl.problem.HearGunshot.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_task</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – save the task into this directory.</p></li>
<li><p><strong>build_task_all_args_except_model</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.HearGunshot.build_task" title="s3prl.problem.HearGunshot.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> except
the <code class="code docutils literal notranslate"><span class="pre">model</span></code> argument since the model should be sapartely saved by
<a class="reference internal" href="#s3prl.problem.HearGunshot.save_model" title="s3prl.problem.HearGunshot.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a>. By saving this dictionary, you can easily reconstruct the same task
by calling <a class="reference internal" href="#s3prl.problem.HearGunshot.build_task" title="s3prl.problem.HearGunshot.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>task</strong> (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><em>Task</em></a>) – the task to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearGunshot.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L287-L658"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearGunshot.train" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearGunshot.default_config" title="s3prl.problem.HearGunshot.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>total_steps</p></td>
<td><p>(int) - the total optimization steps</p></td>
</tr>
<tr class="row-odd"><td><p>log_step</p></td>
<td><p>(int) - logging frequency. log every <code class="code docutils literal notranslate"><span class="pre">log_step</span></code> step</p></td>
</tr>
<tr class="row-even"><td><p>eval_step</p></td>
<td><p>(int) - evaluation frequency. Evaluate every <code class="code docutils literal notranslate"><span class="pre">eval_step</span></code> step.                                                 Note that you can control how many batch to evaluate to speed up the                                                 development by the <code class="code docutils literal notranslate"><span class="pre">eval_batch</span></code> argument in <a class="reference internal" href="#s3prl.problem.HearGunshot.run" title="s3prl.problem.HearGunshot.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>save_step</p></td>
<td><p>(int) - save the checkpoint every <code class="code docutils literal notranslate"><span class="pre">save_step</span></code> step.</p></td>
</tr>
<tr class="row-even"><td><p>gradient_clipping</p></td>
<td><p>(float) - clip the gradient. important for RNNs.</p></td>
</tr>
<tr class="row-odd"><td><p>gradient_accumulate</p></td>
<td><p>(int) - accumulate multiple steps’ gradient before updating network parameters                                                 to simulate large-batch optimization.</p></td>
</tr>
<tr class="row-even"><td><p>valid_metric</p></td>
<td><p>(str) - the metric to select the best valid checkpoint. Different Tasks have different                                                 supported valid_metrics. See <a class="reference internal" href="#s3prl.problem.HearGunshot.build_task" title="s3prl.problem.HearGunshot.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> for the supported metrics.</p></td>
</tr>
<tr class="row-odd"><td><p>valid_higher_better</p></td>
<td><p>(bool) - some metrics are higher better, while some are lower better                                                 this will affect how to save the best validation checkpoint.</p></td>
</tr>
<tr class="row-even"><td><p>auto_resume</p></td>
<td><p>(bool) - if there are already the last checkpoint in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.HearGunshot.run" title="s3prl.problem.HearGunshot.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>),                                                 whether to resume from it or delete it and start a new training session.</p></td>
</tr>
<tr class="row-odd"><td><p>resume_ckpt_dir</p></td>
<td><p>(str) - you can directly specify the checkpoint path to resume which is not necessary                                                 in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.HearGunshot.run" title="s3prl.problem.HearGunshot.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>).</p></td>
</tr>
<tr class="row-even"><td><p>seed</p></td>
<td><p>(int) - fix the seed before the training start</p></td>
</tr>
<tr class="row-odd"><td><p>keep_num_ckpts</p></td>
<td><p>(int) - to prevent saving too many checkpoints, only save the <code class="code docutils literal notranslate"><span class="pre">keep_num_ckpts</span></code>                                                 latest checkpoints and delete the old ones.</p></td>
</tr>
<tr class="row-even"><td><p>use_scheduler</p></td>
<td><p>(bool) - whether to use the scheduler</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="hearlibricount">
<h2>HearLibriCount<a class="headerlink" href="#hearlibricount" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="s3prl.problem.HearLibriCount">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">s3prl.problem.</span></span><span class="sig-name descname"><span class="pre">HearLibriCount</span></span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_libricount.html#HearLibriCount"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_libricount.py#L10-L78"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearLibriCount" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="s3prl.problem.common.hear_esc50.html#s3prl.problem.common.hear_esc50.HearESC50" title="s3prl.problem.common.hear_esc50.HearESC50"><code class="xref py py-class docutils literal notranslate"><span class="pre">HearESC50</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearLibriCount.default_config">
<span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_libricount.html#HearLibriCount.default_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_libricount.py#L11-L78"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearLibriCount.default_config" title="Permalink to this definition">#</a></dt>
<dd><p>The default arguments for <a class="reference internal" href="#s3prl.problem.HearLibriCount.run" title="s3prl.problem.HearLibriCount.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> in yaml.
Note that for the fields with inner values, like <code class="code docutils literal notranslate"><span class="pre">build_model</span></code>,
the outer field name corresponds to a method name, so you can find the method
<a class="reference internal" href="#s3prl.problem.HearLibriCount.build_model" title="s3prl.problem.HearLibriCount.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>. Furthermore, the values inside that field will be
directly passed into the method. So by changing these inner values, you
can directly affect the behavior of the corresponding method. See the method
documentation for all the supported arguments and their meanings.</p>
<p>The methods affected by the following config are: <a class="reference internal" href="#s3prl.problem.HearLibriCount.prepare_data" title="s3prl.problem.HearLibriCount.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> <a class="reference internal" href="#s3prl.problem.HearLibriCount.build_batch_sampler" title="s3prl.problem.HearLibriCount.build_batch_sampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_batch_sampler</span></code></a> <a class="reference internal" href="#s3prl.problem.HearLibriCount.build_upstream" title="s3prl.problem.HearLibriCount.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a> <a class="reference internal" href="#s3prl.problem.HearLibriCount.build_featurizer" title="s3prl.problem.HearLibriCount.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a> <a class="reference internal" href="#s3prl.problem.HearLibriCount.build_downstream" title="s3prl.problem.HearLibriCount.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a> <a class="reference internal" href="#s3prl.problem.HearLibriCount.build_model" title="s3prl.problem.HearLibriCount.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> <a class="reference internal" href="#s3prl.problem.HearLibriCount.build_task" title="s3prl.problem.HearLibriCount.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> <a class="reference internal" href="#s3prl.problem.HearLibriCount.build_optimizer" title="s3prl.problem.HearLibriCount.build_optimizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_optimizer</span></code></a> <a class="reference internal" href="#s3prl.problem.HearLibriCount.build_scheduler" title="s3prl.problem.HearLibriCount.build_scheduler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_scheduler</span></code></a> <a class="reference internal" href="#s3prl.problem.HearLibriCount.save_model" title="s3prl.problem.HearLibriCount.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a> <a class="reference internal" href="#s3prl.problem.HearLibriCount.save_task" title="s3prl.problem.HearLibriCount.save_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_task</span></code></a> <a class="reference internal" href="#s3prl.problem.HearLibriCount.train" title="s3prl.problem.HearLibriCount.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> <a class="reference internal" href="#s3prl.problem.HearLibriCount.evaluate" title="s3prl.problem.HearLibriCount.evaluate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate</span></code></a></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">start</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="nt">stop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">target_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">cache_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">remove_all_cache</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">prepare_data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">dataset_root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="w">  </span><span class="nt">test_fold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="w">  </span><span class="nt">num_folds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="nt">build_batch_sampler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">train</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">32</span>
<span class="w">    </span><span class="nt">shuffle</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">valid</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">test</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="nt">build_upstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">build_featurizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">layer_selections</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="nt">normalize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_downstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">hidden_layers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">  </span><span class="nt">pooling_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MeanPooling</span>
<span class="nt">build_model</span><span class="p">:</span>
<span class="w">  </span><span class="nt">upstream_trainable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_task</span><span class="p">:</span>
<span class="w">  </span><span class="nt">prediction_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">multiclass</span>
<span class="w">  </span><span class="nt">scores</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top1_acc</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">d_prime</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aucroc</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mAP</span>
<span class="nt">build_optimizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Adam</span>
<span class="w">  </span><span class="nt">conf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">lr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.001</span>
<span class="nt">build_scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ExponentialLR</span>
<span class="w">  </span><span class="nt">gamma</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.9</span>
<span class="nt">save_model</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">save_task</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">train</span><span class="p">:</span>
<span class="w">  </span><span class="nt">total_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">150000</span>
<span class="w">  </span><span class="nt">log_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">  </span><span class="nt">eval_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span>
<span class="w">  </span><span class="nt">save_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">  </span><span class="nt">gradient_clipping</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0</span>
<span class="w">  </span><span class="nt">gradient_accumulate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">valid_metric</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top1_acc</span>
<span class="w">  </span><span class="nt">valid_higher_better</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">auto_resume</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">resume_ckpt_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">evaluate</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearLibriCount.build_batch_sampler">
<span class="sig-name descname"><span class="pre">build_batch_sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L213-L229"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearLibriCount.build_batch_sampler" title="Permalink to this definition">#</a></dt>
<dd><p>Return the batch sampler for torch DataLoader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_batch_sampler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearLibriCount.default_config" title="s3prl.problem.HearLibriCount.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>train</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>valid</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-even"><td><p>test</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">mode</span></code> specific csv from <a class="reference internal" href="#s3prl.problem.HearLibriCount.prepare_data" title="s3prl.problem.HearLibriCount.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>dataset</strong> – the dataset from <a class="reference internal" href="#s3prl.problem.HearLibriCount.build_dataset" title="s3prl.problem.HearLibriCount.build_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_dataset</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>batch sampler for torch DataLoader</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearLibriCount.build_collate_fn">
<span class="sig-name descname"><span class="pre">build_collate_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L143-L156"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearLibriCount.build_collate_fn" title="Permalink to this definition">#</a></dt>
<dd><p>By default returns <code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataset.base.default_collate_fn</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_collate_fn</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearLibriCount.default_config" title="s3prl.problem.HearLibriCount.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train, valid, or test</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>callable</p>
<p>the collate_fn for torch DataLoader in train/valid/test <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearLibriCount.build_dataset">
<span class="sig-name descname"><span class="pre">build_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_shift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L172-L211"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearLibriCount.build_dataset" title="Permalink to this definition">#</a></dt>
<dd><p>Build the dataset for train/valid/test.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_dataset</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearLibriCount.default_config" title="s3prl.problem.HearLibriCount.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>. with <code class="code docutils literal notranslate"><span class="pre">train</span></code>, <code class="code docutils literal notranslate"><span class="pre">valid</span></code>, <code class="code docutils literal notranslate"><span class="pre">test</span></code> keys, each
is a dictionary with the following supported options:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>max_secs</p></td>
<td><p>(float) - If a waveform is longer than <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds, randomly crop the waveform into <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds</p></td>
</tr>
<tr class="row-odd"><td><p>sox_effects</p></td>
<td><p>(List[List[str]]) - If not None, apply sox effects on the utterance</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – The metadata csv file for the specific <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p></li>
<li><p><strong>encoder_path</strong> (<em>str</em>) – The pickled encoder path for encoding the labels</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch Dataset</p>
<p>For all train/valid/test mode, the dataset should return each item as a dictionary
containing the following keys:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>x</p></td>
<td><p>(torch.FloatTensor) - the waveform in (seq_len, 1)</p></td>
</tr>
<tr class="row-odd"><td><p>x_len</p></td>
<td><p>(int) - the waveform length <code class="code docutils literal notranslate"><span class="pre">seq_len</span></code></p></td>
</tr>
<tr class="row-even"><td><p>class_id</p></td>
<td><p>(int) - the encoded class id</p></td>
</tr>
<tr class="row-odd"><td><p>label</p></td>
<td><p>(str) - the class name</p></td>
</tr>
<tr class="row-even"><td><p>unique_name</p></td>
<td><p>(str) - the unique id for this datapoint</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearLibriCount.build_downstream">
<span class="sig-name descname"><span class="pre">build_downstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L231-L240"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearLibriCount.build_downstream" title="Permalink to this definition">#</a></dt>
<dd><p>Return the task-specific downstream model.
By default build the <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code> model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearLibriCount.default_config" title="s3prl.problem.HearLibriCount.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments of <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code></p></li>
<li><p><strong>downstream_input_size</strong> (<em>int</em>) – the required input size of the model</p></li>
<li><p><strong>downstream_output_size</strong> (<em>int</em>) – the required output size of the model</p></li>
<li><p><strong>downstream_input_stride</strong> (<em>int</em>) – the input feature’s stride (from 16 KHz)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUtteranceModel" title="s3prl.nn.interface.AbsUtteranceModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUtteranceModel</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearLibriCount.build_encoder">
<span class="sig-name descname"><span class="pre">build_encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_csv_paths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L142-L170"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearLibriCount.build_encoder" title="Permalink to this definition">#</a></dt>
<dd><p>Build the encoder (for the labels) given the data metadata, and return the saved encoder path.
By default generate and save a <a class="reference internal" href="s3prl.dataio.encoder.html#s3prl.dataio.encoder.CategoryEncoder" title="s3prl.dataio.encoder.CategoryEncoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataio.encoder.CategoryEncoder</span></code></a> from the <code class="code docutils literal notranslate"><span class="pre">label</span></code> column of all the csv files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_encoder</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearLibriCount.default_config" title="s3prl.problem.HearLibriCount.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Save your encoder into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>train_csv_path</strong> (<em>str</em>) – the train path from <a class="reference internal" href="#s3prl.problem.HearLibriCount.prepare_data" title="s3prl.problem.HearLibriCount.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>valid_csv_path</strong> (<em>str</em>) – the valid path from <a class="reference internal" href="#s3prl.problem.HearLibriCount.prepare_data" title="s3prl.problem.HearLibriCount.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>test_csv_paths</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – the test paths from <a class="reference internal" href="#s3prl.problem.HearLibriCount.prepare_data" title="s3prl.problem.HearLibriCount.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>str</p>
<p>encoder_path: The encoder should be saved in the pickle format</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearLibriCount.build_featurizer">
<span class="sig-name descname"><span class="pre">build_featurizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upstream</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L175-L192"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearLibriCount.build_featurizer" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the featurizer with <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearLibriCount.default_config" title="s3prl.problem.HearLibriCount.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p></li>
<li><p><strong>upstream</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">AbsUpstream</span></code>) – the upstream model built by <a class="reference internal" href="#s3prl.problem.HearLibriCount.build_upstream" title="s3prl.problem.HearLibriCount.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsFeaturizer" title="s3prl.nn.interface.AbsFeaturizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsFeaturizer</span></code></a></p>
<p>Return the featurizer model. The featurizer is used to reduce the multiple
hidden states returned from the upstream model (built by <a class="reference internal" href="#s3prl.problem.HearLibriCount.build_upstream" title="s3prl.problem.HearLibriCount.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>)
into a single hidden state, so can be easliy fed into the downstream model</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearLibriCount.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L194-L231"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearLibriCount.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>By default build model with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearLibriCount.default_config" title="s3prl.problem.HearLibriCount.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p></li>
<li><p><strong>model_output_size</strong> (<em>int</em>) – the required model’s output hidden size</p></li>
<li><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearLibriCount.default_config" title="s3prl.problem.HearLibriCount.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearLibriCount.build_upstream" title="s3prl.problem.HearLibriCount.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearLibriCount.default_config" title="s3prl.problem.HearLibriCount.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearLibriCount.build_featurizer" title="s3prl.problem.HearLibriCount.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a></p></li>
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearLibriCount.default_config" title="s3prl.problem.HearLibriCount.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearLibriCount.build_downstream" title="s3prl.problem.HearLibriCount.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch.nn.Module</p>
<p>Return the entire model for the task, which takes the direct items from DataLoader as the input.
Usually, the components can be built by <a class="reference internal" href="#s3prl.problem.HearLibriCount.build_upstream" title="s3prl.problem.HearLibriCount.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>, <a class="reference internal" href="#s3prl.problem.HearLibriCount.build_featurizer" title="s3prl.problem.HearLibriCount.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a>,
<a class="reference internal" href="#s3prl.problem.HearLibriCount.build_downstream" title="s3prl.problem.HearLibriCount.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a>, and are concated together to get the final model.
The upstream extracts multiple hidden states, the featuizer reduce them into a single hidden state,
and the downstream takes the hidden states as the feature for the downstream-specific model.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearLibriCount.build_optimizer">
<span class="sig-name descname"><span class="pre">build_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L233-L258"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearLibriCount.build_optimizer" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_optimizer</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearLibriCount.default_config" title="s3prl.problem.HearLibriCount.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to below</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the optimizer class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the optimizer class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;lr&quot;:</span> <span class="pre">1.0e-4}</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>parameters</strong> (<em>iterable</em>) – the standard params accepted by <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code></p>
<p>An optimizer following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearLibriCount.build_scheduler">
<span class="sig-name descname"><span class="pre">build_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L260-L285"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearLibriCount.build_scheduler" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_scheduler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearLibriCount.default_config" title="s3prl.problem.HearLibriCount.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the scheduler class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the scheduler class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;gamma&quot;:</span> <span class="pre">0.01}</span></code> for <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler.StepLR</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>optimizer</strong> – the standard torch optimizer accepted by Scheduler in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch scheduler</p>
<p>A scheduler following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearLibriCount.build_task">
<span class="sig-name descname"><span class="pre">build_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L242-L250"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearLibriCount.build_task" title="Permalink to this definition">#</a></dt>
<dd><p>Build the task, which defines the logics for every train/valid/test forward step for the <code class="code docutils literal notranslate"><span class="pre">model</span></code>,
and the logics for how to reduce all the batch results from multiple train/valid/test steps into metrics</p>
<p>By default build <code class="xref py py-obj docutils literal notranslate"><span class="pre">UtteranceClassificationTask</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearLibriCount.default_config" title="s3prl.problem.HearLibriCount.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model built by <a class="reference internal" href="#s3prl.problem.HearLibriCount.build_model" title="s3prl.problem.HearLibriCount.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a></p></li>
<li><p><strong>encoder</strong> – the encoder built by <a class="reference internal" href="#s3prl.problem.HearLibriCount.build_encoder" title="s3prl.problem.HearLibriCount.build_encoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_encoder</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Task</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearLibriCount.build_upstream">
<span class="sig-name descname"><span class="pre">build_upstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L158-L173"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearLibriCount.build_upstream" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the upstream with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearLibriCount.default_config" title="s3prl.problem.HearLibriCount.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUpstream" title="s3prl.nn.interface.AbsUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUpstream</span></code></a></p>
<p>Return an upstream model, whose forward takes the waveform input and returns
multiple hidden states as features.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearLibriCount.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L660-L707"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearLibriCount.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>The evaluate routine used by <a class="reference internal" href="#s3prl.problem.HearLibriCount.train" title="s3prl.problem.HearLibriCount.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> (during validation phase) and <a class="reference internal" href="#s3prl.problem.HearLibriCount.run" title="s3prl.problem.HearLibriCount.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>
(during testing phase).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evaluate</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearLibriCount.default_config" title="s3prl.problem.HearLibriCount.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearLibriCount.get_class_from_name">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_class_from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L129-L141"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearLibriCount.get_class_from_name" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">__name__</span></code> of the problem class</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Problem</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearLibriCount.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L752-L772"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearLibriCount.load_model" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model_ckpt_dir</strong> (<em>str</em>) – Restore the model with <a class="reference internal" href="#s3prl.problem.HearLibriCount.build_model" title="s3prl.problem.HearLibriCount.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> and the checkpoint
saved in this directory.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearLibriCount.load_model_and_task">
<span class="sig-name descname"><span class="pre">load_model_and_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ckpts_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L884-L902"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearLibriCount.load_model_and_task" title="Permalink to this definition">#</a></dt>
<dd><p>This is a helper method to combine <a class="reference internal" href="#s3prl.problem.HearLibriCount.load_model" title="s3prl.problem.HearLibriCount.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a> and <a class="reference internal" href="#s3prl.problem.HearLibriCount.load_task" title="s3prl.problem.HearLibriCount.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>
together to directly load the model and the task. This method assumes
the model is saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'model'</span></code> and the task is
saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'task'</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>model (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>)</p></li>
<li><p>task (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a>)</p></li>
</ol>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearLibriCount.load_task">
<span class="sig-name descname"><span class="pre">load_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L833-L882"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearLibriCount.load_task" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – Restore the task with <a class="reference internal" href="#s3prl.problem.HearLibriCount.build_task" title="s3prl.problem.HearLibriCount.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> and the checkpoint
saved in this directory.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model for the task, since the model is separately saved
and is required for <a class="reference internal" href="#s3prl.problem.HearLibriCount.build_task" title="s3prl.problem.HearLibriCount.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a>.</p></li>
<li><p><strong>task_overrides</strong> (<em>dict</em>) – overrides the saved initialization arguments, so can change
the loaded task’s behavior. Like, change the decoding hyperparameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearLibriCount.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L954-L995"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearLibriCount.main" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearLibriCount.prepare_data">
<span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_esc50.py#L151-L160"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearLibriCount.prepare_data" title="Permalink to this definition">#</a></dt>
<dd><p>Prepare the task-specific data metadata (path, labels…).
By default call <code class="xref py py-obj docutils literal notranslate"><span class="pre">voxceleb1_for_sid</span></code> with <code class="code docutils literal notranslate"><span class="pre">**prepare_data</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prepare_data</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearLibriCount.default_config" title="s3prl.problem.HearLibriCount.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments in <code class="xref py py-obj docutils literal notranslate"><span class="pre">voxceleb1_for_sid</span></code></p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Parse your corpus and save the csv file into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the parsing or preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>train_path (str)</p></li>
<li><p>valid_path (str)</p></li>
<li><p>test_paths (List[str])</p></li>
</ol>
<p>Each path (str) should be a csv file containing the following columns:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>column</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>(str) - the unique id for this data point</p></td>
</tr>
<tr class="row-odd"><td><p>wav_path</p></td>
<td><p>(str) - the absolute path of the waveform file</p></td>
</tr>
<tr class="row-even"><td><p>label</p></td>
<td><p>(str) - a string label of the waveform</p></td>
</tr>
<tr class="row-odd"><td><p>start_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">start_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load from the beginning.</p></td>
</tr>
<tr class="row-even"><td><p>end_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">end_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load to the end.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearLibriCount.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_all_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cuda'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/run.py#L26-L318"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearLibriCount.run" title="Permalink to this definition">#</a></dt>
<dd><div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>stage</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Parse the corpus and save the metadata file (waveform path, label…)</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Build the encoder to encode the labels</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Train the model</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Evaluate the model on multiple test sets</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_dir</strong> (<em>str</em>) – The directory that stores the script result.</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – The directory that caches the processed data.
Default: /home/user/.cache/s3prl/data</p></li>
<li><p><strong>remove_all_cache</strong> (<em>bool</em>) – Whether to remove all the cache stored under <cite>cache_dir</cite>.
Default: False</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting stage of the problem script.
Default: 0</p></li>
<li><p><strong>stop</strong> (<em>int</em>) – The stoping stage of the problem script, set <cite>None</cite> to reach the final stage.
Default: None</p></li>
<li><p><strong>num_workers</strong> (<em>int</em>) – num_workers for all the torch DataLoder</p></li>
<li><p><strong>eval_batch</strong> (<em>int</em>) – During evaluation (valid or test), limit the number of batch.
This is helpful for the fast development to check everything won’t crash.
If is -1, disable this feature and evaluate the entire epoch.
Default: -1</p></li>
<li><p><strong>device</strong> (<em>str</em>) – The device type for all torch-related operation: “cpu” or “cuda”
Default: “cuda”</p></li>
<li><p><strong>world_size</strong> (<em>int</em>) – How many processes are running this script simultaneously (in parallel).
Usually this is just 1, however if you are runnig distributed training,
this should be &gt; 1.
Default: 1</p></li>
<li><p><strong>rank</strong> (<em>int</em>) – When distributed training, world_size &gt; 1. Take <code class="code docutils literal notranslate"><span class="pre">world_size</span> <span class="pre">==</span> <span class="pre">8</span></code> for
example, this means 8 processes (8 GPUs) are runing in parallel. The script
needs to know which process among 8 processes it is. In this case, <code class="code docutils literal notranslate"><span class="pre">rank</span></code>
can range from 0~7. All the 8 processes have the same <code class="code docutils literal notranslate"><span class="pre">world_size</span></code> but
different <code class="code docutils literal notranslate"><span class="pre">rank</span></code> (process id).</p></li>
<li><p><strong>test_ckpt_dir</strong> (<em>str</em>) – Specify the checkpoint path for testing. If not, use the validation best
checkpoint under the given <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> directory.</p></li>
<li><p><strong>**kwds</strong> – The other arguments like <code class="code docutils literal notranslate"><span class="pre">prepare_data</span></code> and <code class="code docutils literal notranslate"><span class="pre">build_model</span></code> are
method specific-arguments for methods like <a class="reference internal" href="#s3prl.problem.HearLibriCount.prepare_data" title="s3prl.problem.HearLibriCount.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> and
<a class="reference internal" href="#s3prl.problem.HearLibriCount.build_model" title="s3prl.problem.HearLibriCount.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>, and will not be used in the core <a class="reference internal" href="#s3prl.problem.HearLibriCount.run" title="s3prl.problem.HearLibriCount.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> logic.
See the specific method documentation for their supported arguments and
meaning</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearLibriCount.save_model">
<span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L709-L750"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearLibriCount.save_model" title="Permalink to this definition">#</a></dt>
<dd><p>Save the model state_dict and the model initialization arguments into the given directory.
If you override this method, it is highly possible you also need to override <a class="reference internal" href="#s3prl.problem.HearLibriCount.load_model" title="s3prl.problem.HearLibriCount.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearLibriCount.default_config" title="s3prl.problem.HearLibriCount.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_model</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>model_ckpt_dir</strong> (<em>str</em>) – save the model into the this directory.</p></li>
<li><p><strong>build_model_all_args</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.HearLibriCount.build_model" title="s3prl.problem.HearLibriCount.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>.
By saving this dictionary, you can easily reconstruct the same model
by calling <a class="reference internal" href="#s3prl.problem.HearLibriCount.build_model" title="s3prl.problem.HearLibriCount.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearLibriCount.save_task">
<span class="sig-name descname"><span class="pre">save_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="s3prl.task.base.html#s3prl.task.base.Task" title="s3prl.task.base.Task"><span class="pre">Task</span></a></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L774-L831"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearLibriCount.save_task" title="Permalink to this definition">#</a></dt>
<dd><p>Save the task’s state, <code class="code docutils literal notranslate"><span class="pre">task.get_state()</span></code>, and the initialization arguments into the given
directory. If you override this method, it is highly possible you also need to override
<a class="reference internal" href="#s3prl.problem.HearLibriCount.load_task" title="s3prl.problem.HearLibriCount.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearLibriCount.default_config" title="s3prl.problem.HearLibriCount.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_task</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – save the task into this directory.</p></li>
<li><p><strong>build_task_all_args_except_model</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.HearLibriCount.build_task" title="s3prl.problem.HearLibriCount.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> except
the <code class="code docutils literal notranslate"><span class="pre">model</span></code> argument since the model should be sapartely saved by
<a class="reference internal" href="#s3prl.problem.HearLibriCount.save_model" title="s3prl.problem.HearLibriCount.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a>. By saving this dictionary, you can easily reconstruct the same task
by calling <a class="reference internal" href="#s3prl.problem.HearLibriCount.build_task" title="s3prl.problem.HearLibriCount.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>task</strong> (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><em>Task</em></a>) – the task to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearLibriCount.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L287-L658"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearLibriCount.train" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearLibriCount.default_config" title="s3prl.problem.HearLibriCount.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>total_steps</p></td>
<td><p>(int) - the total optimization steps</p></td>
</tr>
<tr class="row-odd"><td><p>log_step</p></td>
<td><p>(int) - logging frequency. log every <code class="code docutils literal notranslate"><span class="pre">log_step</span></code> step</p></td>
</tr>
<tr class="row-even"><td><p>eval_step</p></td>
<td><p>(int) - evaluation frequency. Evaluate every <code class="code docutils literal notranslate"><span class="pre">eval_step</span></code> step.                                                 Note that you can control how many batch to evaluate to speed up the                                                 development by the <code class="code docutils literal notranslate"><span class="pre">eval_batch</span></code> argument in <a class="reference internal" href="#s3prl.problem.HearLibriCount.run" title="s3prl.problem.HearLibriCount.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>save_step</p></td>
<td><p>(int) - save the checkpoint every <code class="code docutils literal notranslate"><span class="pre">save_step</span></code> step.</p></td>
</tr>
<tr class="row-even"><td><p>gradient_clipping</p></td>
<td><p>(float) - clip the gradient. important for RNNs.</p></td>
</tr>
<tr class="row-odd"><td><p>gradient_accumulate</p></td>
<td><p>(int) - accumulate multiple steps’ gradient before updating network parameters                                                 to simulate large-batch optimization.</p></td>
</tr>
<tr class="row-even"><td><p>valid_metric</p></td>
<td><p>(str) - the metric to select the best valid checkpoint. Different Tasks have different                                                 supported valid_metrics. See <a class="reference internal" href="#s3prl.problem.HearLibriCount.build_task" title="s3prl.problem.HearLibriCount.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> for the supported metrics.</p></td>
</tr>
<tr class="row-odd"><td><p>valid_higher_better</p></td>
<td><p>(bool) - some metrics are higher better, while some are lower better                                                 this will affect how to save the best validation checkpoint.</p></td>
</tr>
<tr class="row-even"><td><p>auto_resume</p></td>
<td><p>(bool) - if there are already the last checkpoint in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.HearLibriCount.run" title="s3prl.problem.HearLibriCount.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>),                                                 whether to resume from it or delete it and start a new training session.</p></td>
</tr>
<tr class="row-odd"><td><p>resume_ckpt_dir</p></td>
<td><p>(str) - you can directly specify the checkpoint path to resume which is not necessary                                                 in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.HearLibriCount.run" title="s3prl.problem.HearLibriCount.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>).</p></td>
</tr>
<tr class="row-even"><td><p>seed</p></td>
<td><p>(int) - fix the seed before the training start</p></td>
</tr>
<tr class="row-odd"><td><p>keep_num_ckpts</p></td>
<td><p>(int) - to prevent saving too many checkpoints, only save the <code class="code docutils literal notranslate"><span class="pre">keep_num_ckpts</span></code>                                                 latest checkpoints and delete the old ones.</p></td>
</tr>
<tr class="row-even"><td><p>use_scheduler</p></td>
<td><p>(bool) - whether to use the scheduler</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="hearnsynth5hr">
<h2>HearNsynth5hr<a class="headerlink" href="#hearnsynth5hr" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="s3prl.problem.HearNsynth5hr">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">s3prl.problem.</span></span><span class="sig-name descname"><span class="pre">HearNsynth5hr</span></span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_nsynth5hr.html#HearNsynth5hr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_nsynth5hr.py#L8-L74"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearNsynth5hr" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="s3prl.problem.common.hear_fsd.html#s3prl.problem.common.hear_fsd.HearFSD" title="s3prl.problem.common.hear_fsd.HearFSD"><code class="xref py py-class docutils literal notranslate"><span class="pre">HearFSD</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearNsynth5hr.default_config">
<span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_nsynth5hr.html#HearNsynth5hr.default_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_nsynth5hr.py#L9-L74"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearNsynth5hr.default_config" title="Permalink to this definition">#</a></dt>
<dd><p>The default arguments for <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.run" title="s3prl.problem.HearNsynth5hr.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> in yaml.
Note that for the fields with inner values, like <code class="code docutils literal notranslate"><span class="pre">build_model</span></code>,
the outer field name corresponds to a method name, so you can find the method
<a class="reference internal" href="#s3prl.problem.HearNsynth5hr.build_model" title="s3prl.problem.HearNsynth5hr.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>. Furthermore, the values inside that field will be
directly passed into the method. So by changing these inner values, you
can directly affect the behavior of the corresponding method. See the method
documentation for all the supported arguments and their meanings.</p>
<p>The methods affected by the following config are: <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.prepare_data" title="s3prl.problem.HearNsynth5hr.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.build_batch_sampler" title="s3prl.problem.HearNsynth5hr.build_batch_sampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_batch_sampler</span></code></a> <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.build_upstream" title="s3prl.problem.HearNsynth5hr.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a> <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.build_featurizer" title="s3prl.problem.HearNsynth5hr.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a> <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.build_downstream" title="s3prl.problem.HearNsynth5hr.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a> <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.build_model" title="s3prl.problem.HearNsynth5hr.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.build_task" title="s3prl.problem.HearNsynth5hr.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.build_optimizer" title="s3prl.problem.HearNsynth5hr.build_optimizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_optimizer</span></code></a> <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.build_scheduler" title="s3prl.problem.HearNsynth5hr.build_scheduler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_scheduler</span></code></a> <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.save_model" title="s3prl.problem.HearNsynth5hr.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a> <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.save_task" title="s3prl.problem.HearNsynth5hr.save_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_task</span></code></a> <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.train" title="s3prl.problem.HearNsynth5hr.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.evaluate" title="s3prl.problem.HearNsynth5hr.evaluate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate</span></code></a></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">start</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="nt">stop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">target_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">cache_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">remove_all_cache</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">prepare_data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">dataset_root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">build_batch_sampler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">train</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">32</span>
<span class="w">    </span><span class="nt">shuffle</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">valid</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">test</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="nt">build_upstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">build_featurizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">layer_selections</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="nt">normalize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_downstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">hidden_layers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">  </span><span class="nt">pooling_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MeanPooling</span>
<span class="nt">build_model</span><span class="p">:</span>
<span class="w">  </span><span class="nt">upstream_trainable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_task</span><span class="p">:</span>
<span class="w">  </span><span class="nt">prediction_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">multiclass</span>
<span class="w">  </span><span class="nt">scores</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pitch_acc</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">chroma_acc</span>
<span class="nt">build_optimizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Adam</span>
<span class="w">  </span><span class="nt">conf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">lr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.001</span>
<span class="nt">build_scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ExponentialLR</span>
<span class="w">  </span><span class="nt">gamma</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.9</span>
<span class="nt">save_model</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">save_task</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">train</span><span class="p">:</span>
<span class="w">  </span><span class="nt">total_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">150000</span>
<span class="w">  </span><span class="nt">log_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">  </span><span class="nt">eval_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span>
<span class="w">  </span><span class="nt">save_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">  </span><span class="nt">gradient_clipping</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0</span>
<span class="w">  </span><span class="nt">gradient_accumulate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">valid_metric</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pitch_acc</span>
<span class="w">  </span><span class="nt">valid_higher_better</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">auto_resume</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">resume_ckpt_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">evaluate</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearNsynth5hr.build_batch_sampler">
<span class="sig-name descname"><span class="pre">build_batch_sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L213-L229"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearNsynth5hr.build_batch_sampler" title="Permalink to this definition">#</a></dt>
<dd><p>Return the batch sampler for torch DataLoader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_batch_sampler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.default_config" title="s3prl.problem.HearNsynth5hr.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>train</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>valid</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-even"><td><p>test</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">mode</span></code> specific csv from <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.prepare_data" title="s3prl.problem.HearNsynth5hr.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>dataset</strong> – the dataset from <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.build_dataset" title="s3prl.problem.HearNsynth5hr.build_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_dataset</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>batch sampler for torch DataLoader</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearNsynth5hr.build_collate_fn">
<span class="sig-name descname"><span class="pre">build_collate_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L143-L156"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearNsynth5hr.build_collate_fn" title="Permalink to this definition">#</a></dt>
<dd><p>By default returns <code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataset.base.default_collate_fn</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_collate_fn</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.default_config" title="s3prl.problem.HearNsynth5hr.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train, valid, or test</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>callable</p>
<p>the collate_fn for torch DataLoader in train/valid/test <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearNsynth5hr.build_dataset">
<span class="sig-name descname"><span class="pre">build_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_shift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L172-L211"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearNsynth5hr.build_dataset" title="Permalink to this definition">#</a></dt>
<dd><p>Build the dataset for train/valid/test.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_dataset</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.default_config" title="s3prl.problem.HearNsynth5hr.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>. with <code class="code docutils literal notranslate"><span class="pre">train</span></code>, <code class="code docutils literal notranslate"><span class="pre">valid</span></code>, <code class="code docutils literal notranslate"><span class="pre">test</span></code> keys, each
is a dictionary with the following supported options:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>max_secs</p></td>
<td><p>(float) - If a waveform is longer than <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds, randomly crop the waveform into <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds</p></td>
</tr>
<tr class="row-odd"><td><p>sox_effects</p></td>
<td><p>(List[List[str]]) - If not None, apply sox effects on the utterance</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – The metadata csv file for the specific <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p></li>
<li><p><strong>encoder_path</strong> (<em>str</em>) – The pickled encoder path for encoding the labels</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch Dataset</p>
<p>For all train/valid/test mode, the dataset should return each item as a dictionary
containing the following keys:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>x</p></td>
<td><p>(torch.FloatTensor) - the waveform in (seq_len, 1)</p></td>
</tr>
<tr class="row-odd"><td><p>x_len</p></td>
<td><p>(int) - the waveform length <code class="code docutils literal notranslate"><span class="pre">seq_len</span></code></p></td>
</tr>
<tr class="row-even"><td><p>class_id</p></td>
<td><p>(int) - the encoded class id</p></td>
</tr>
<tr class="row-odd"><td><p>label</p></td>
<td><p>(str) - the class name</p></td>
</tr>
<tr class="row-even"><td><p>unique_name</p></td>
<td><p>(str) - the unique id for this datapoint</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearNsynth5hr.build_downstream">
<span class="sig-name descname"><span class="pre">build_downstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L231-L240"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearNsynth5hr.build_downstream" title="Permalink to this definition">#</a></dt>
<dd><p>Return the task-specific downstream model.
By default build the <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code> model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.default_config" title="s3prl.problem.HearNsynth5hr.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments of <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code></p></li>
<li><p><strong>downstream_input_size</strong> (<em>int</em>) – the required input size of the model</p></li>
<li><p><strong>downstream_output_size</strong> (<em>int</em>) – the required output size of the model</p></li>
<li><p><strong>downstream_input_stride</strong> (<em>int</em>) – the input feature’s stride (from 16 KHz)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUtteranceModel" title="s3prl.nn.interface.AbsUtteranceModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUtteranceModel</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearNsynth5hr.build_encoder">
<span class="sig-name descname"><span class="pre">build_encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_csv_paths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L142-L170"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearNsynth5hr.build_encoder" title="Permalink to this definition">#</a></dt>
<dd><p>Build the encoder (for the labels) given the data metadata, and return the saved encoder path.
By default generate and save a <a class="reference internal" href="s3prl.dataio.encoder.html#s3prl.dataio.encoder.CategoryEncoder" title="s3prl.dataio.encoder.CategoryEncoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataio.encoder.CategoryEncoder</span></code></a> from the <code class="code docutils literal notranslate"><span class="pre">label</span></code> column of all the csv files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_encoder</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.default_config" title="s3prl.problem.HearNsynth5hr.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Save your encoder into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>train_csv_path</strong> (<em>str</em>) – the train path from <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.prepare_data" title="s3prl.problem.HearNsynth5hr.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>valid_csv_path</strong> (<em>str</em>) – the valid path from <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.prepare_data" title="s3prl.problem.HearNsynth5hr.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>test_csv_paths</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – the test paths from <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.prepare_data" title="s3prl.problem.HearNsynth5hr.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>str</p>
<p>encoder_path: The encoder should be saved in the pickle format</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearNsynth5hr.build_featurizer">
<span class="sig-name descname"><span class="pre">build_featurizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upstream</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L175-L192"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearNsynth5hr.build_featurizer" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the featurizer with <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.default_config" title="s3prl.problem.HearNsynth5hr.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p></li>
<li><p><strong>upstream</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">AbsUpstream</span></code>) – the upstream model built by <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.build_upstream" title="s3prl.problem.HearNsynth5hr.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsFeaturizer" title="s3prl.nn.interface.AbsFeaturizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsFeaturizer</span></code></a></p>
<p>Return the featurizer model. The featurizer is used to reduce the multiple
hidden states returned from the upstream model (built by <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.build_upstream" title="s3prl.problem.HearNsynth5hr.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>)
into a single hidden state, so can be easliy fed into the downstream model</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearNsynth5hr.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L194-L231"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearNsynth5hr.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>By default build model with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.default_config" title="s3prl.problem.HearNsynth5hr.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p></li>
<li><p><strong>model_output_size</strong> (<em>int</em>) – the required model’s output hidden size</p></li>
<li><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.default_config" title="s3prl.problem.HearNsynth5hr.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.build_upstream" title="s3prl.problem.HearNsynth5hr.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.default_config" title="s3prl.problem.HearNsynth5hr.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.build_featurizer" title="s3prl.problem.HearNsynth5hr.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a></p></li>
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.default_config" title="s3prl.problem.HearNsynth5hr.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.build_downstream" title="s3prl.problem.HearNsynth5hr.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch.nn.Module</p>
<p>Return the entire model for the task, which takes the direct items from DataLoader as the input.
Usually, the components can be built by <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.build_upstream" title="s3prl.problem.HearNsynth5hr.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>, <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.build_featurizer" title="s3prl.problem.HearNsynth5hr.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a>,
<a class="reference internal" href="#s3prl.problem.HearNsynth5hr.build_downstream" title="s3prl.problem.HearNsynth5hr.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a>, and are concated together to get the final model.
The upstream extracts multiple hidden states, the featuizer reduce them into a single hidden state,
and the downstream takes the hidden states as the feature for the downstream-specific model.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearNsynth5hr.build_optimizer">
<span class="sig-name descname"><span class="pre">build_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L233-L258"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearNsynth5hr.build_optimizer" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_optimizer</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.default_config" title="s3prl.problem.HearNsynth5hr.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to below</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the optimizer class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the optimizer class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;lr&quot;:</span> <span class="pre">1.0e-4}</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>parameters</strong> (<em>iterable</em>) – the standard params accepted by <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code></p>
<p>An optimizer following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearNsynth5hr.build_scheduler">
<span class="sig-name descname"><span class="pre">build_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L260-L285"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearNsynth5hr.build_scheduler" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_scheduler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.default_config" title="s3prl.problem.HearNsynth5hr.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the scheduler class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the scheduler class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;gamma&quot;:</span> <span class="pre">0.01}</span></code> for <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler.StepLR</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>optimizer</strong> – the standard torch optimizer accepted by Scheduler in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch scheduler</p>
<p>A scheduler following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearNsynth5hr.build_task">
<span class="sig-name descname"><span class="pre">build_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L242-L250"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearNsynth5hr.build_task" title="Permalink to this definition">#</a></dt>
<dd><p>Build the task, which defines the logics for every train/valid/test forward step for the <code class="code docutils literal notranslate"><span class="pre">model</span></code>,
and the logics for how to reduce all the batch results from multiple train/valid/test steps into metrics</p>
<p>By default build <code class="xref py py-obj docutils literal notranslate"><span class="pre">UtteranceClassificationTask</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.default_config" title="s3prl.problem.HearNsynth5hr.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model built by <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.build_model" title="s3prl.problem.HearNsynth5hr.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a></p></li>
<li><p><strong>encoder</strong> – the encoder built by <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.build_encoder" title="s3prl.problem.HearNsynth5hr.build_encoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_encoder</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Task</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearNsynth5hr.build_upstream">
<span class="sig-name descname"><span class="pre">build_upstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L158-L173"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearNsynth5hr.build_upstream" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the upstream with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.default_config" title="s3prl.problem.HearNsynth5hr.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUpstream" title="s3prl.nn.interface.AbsUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUpstream</span></code></a></p>
<p>Return an upstream model, whose forward takes the waveform input and returns
multiple hidden states as features.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearNsynth5hr.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L660-L707"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearNsynth5hr.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>The evaluate routine used by <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.train" title="s3prl.problem.HearNsynth5hr.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> (during validation phase) and <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.run" title="s3prl.problem.HearNsynth5hr.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>
(during testing phase).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evaluate</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.default_config" title="s3prl.problem.HearNsynth5hr.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearNsynth5hr.get_class_from_name">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_class_from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L129-L141"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearNsynth5hr.get_class_from_name" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">__name__</span></code> of the problem class</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Problem</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearNsynth5hr.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L752-L772"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearNsynth5hr.load_model" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model_ckpt_dir</strong> (<em>str</em>) – Restore the model with <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.build_model" title="s3prl.problem.HearNsynth5hr.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> and the checkpoint
saved in this directory.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearNsynth5hr.load_model_and_task">
<span class="sig-name descname"><span class="pre">load_model_and_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ckpts_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L884-L902"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearNsynth5hr.load_model_and_task" title="Permalink to this definition">#</a></dt>
<dd><p>This is a helper method to combine <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.load_model" title="s3prl.problem.HearNsynth5hr.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a> and <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.load_task" title="s3prl.problem.HearNsynth5hr.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>
together to directly load the model and the task. This method assumes
the model is saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'model'</span></code> and the task is
saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'task'</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>model (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>)</p></li>
<li><p>task (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a>)</p></li>
</ol>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearNsynth5hr.load_task">
<span class="sig-name descname"><span class="pre">load_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L833-L882"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearNsynth5hr.load_task" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – Restore the task with <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.build_task" title="s3prl.problem.HearNsynth5hr.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> and the checkpoint
saved in this directory.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model for the task, since the model is separately saved
and is required for <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.build_task" title="s3prl.problem.HearNsynth5hr.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a>.</p></li>
<li><p><strong>task_overrides</strong> (<em>dict</em>) – overrides the saved initialization arguments, so can change
the loaded task’s behavior. Like, change the decoding hyperparameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearNsynth5hr.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L954-L995"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearNsynth5hr.main" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearNsynth5hr.prepare_data">
<span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L131-L140"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearNsynth5hr.prepare_data" title="Permalink to this definition">#</a></dt>
<dd><p>Prepare the task-specific data metadata (path, labels…).
By default call <code class="xref py py-obj docutils literal notranslate"><span class="pre">voxceleb1_for_sid</span></code> with <code class="code docutils literal notranslate"><span class="pre">**prepare_data</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prepare_data</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.default_config" title="s3prl.problem.HearNsynth5hr.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments in <code class="xref py py-obj docutils literal notranslate"><span class="pre">voxceleb1_for_sid</span></code></p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Parse your corpus and save the csv file into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the parsing or preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>train_path (str)</p></li>
<li><p>valid_path (str)</p></li>
<li><p>test_paths (List[str])</p></li>
</ol>
<p>Each path (str) should be a csv file containing the following columns:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>column</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>(str) - the unique id for this data point</p></td>
</tr>
<tr class="row-odd"><td><p>wav_path</p></td>
<td><p>(str) - the absolute path of the waveform file</p></td>
</tr>
<tr class="row-even"><td><p>label</p></td>
<td><p>(str) - a string label of the waveform</p></td>
</tr>
<tr class="row-odd"><td><p>start_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">start_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load from the beginning.</p></td>
</tr>
<tr class="row-even"><td><p>end_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">end_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load to the end.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearNsynth5hr.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_all_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cuda'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/run.py#L26-L318"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearNsynth5hr.run" title="Permalink to this definition">#</a></dt>
<dd><div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>stage</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Parse the corpus and save the metadata file (waveform path, label…)</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Build the encoder to encode the labels</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Train the model</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Evaluate the model on multiple test sets</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_dir</strong> (<em>str</em>) – The directory that stores the script result.</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – The directory that caches the processed data.
Default: /home/user/.cache/s3prl/data</p></li>
<li><p><strong>remove_all_cache</strong> (<em>bool</em>) – Whether to remove all the cache stored under <cite>cache_dir</cite>.
Default: False</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting stage of the problem script.
Default: 0</p></li>
<li><p><strong>stop</strong> (<em>int</em>) – The stoping stage of the problem script, set <cite>None</cite> to reach the final stage.
Default: None</p></li>
<li><p><strong>num_workers</strong> (<em>int</em>) – num_workers for all the torch DataLoder</p></li>
<li><p><strong>eval_batch</strong> (<em>int</em>) – During evaluation (valid or test), limit the number of batch.
This is helpful for the fast development to check everything won’t crash.
If is -1, disable this feature and evaluate the entire epoch.
Default: -1</p></li>
<li><p><strong>device</strong> (<em>str</em>) – The device type for all torch-related operation: “cpu” or “cuda”
Default: “cuda”</p></li>
<li><p><strong>world_size</strong> (<em>int</em>) – How many processes are running this script simultaneously (in parallel).
Usually this is just 1, however if you are runnig distributed training,
this should be &gt; 1.
Default: 1</p></li>
<li><p><strong>rank</strong> (<em>int</em>) – When distributed training, world_size &gt; 1. Take <code class="code docutils literal notranslate"><span class="pre">world_size</span> <span class="pre">==</span> <span class="pre">8</span></code> for
example, this means 8 processes (8 GPUs) are runing in parallel. The script
needs to know which process among 8 processes it is. In this case, <code class="code docutils literal notranslate"><span class="pre">rank</span></code>
can range from 0~7. All the 8 processes have the same <code class="code docutils literal notranslate"><span class="pre">world_size</span></code> but
different <code class="code docutils literal notranslate"><span class="pre">rank</span></code> (process id).</p></li>
<li><p><strong>test_ckpt_dir</strong> (<em>str</em>) – Specify the checkpoint path for testing. If not, use the validation best
checkpoint under the given <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> directory.</p></li>
<li><p><strong>**kwds</strong> – The other arguments like <code class="code docutils literal notranslate"><span class="pre">prepare_data</span></code> and <code class="code docutils literal notranslate"><span class="pre">build_model</span></code> are
method specific-arguments for methods like <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.prepare_data" title="s3prl.problem.HearNsynth5hr.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> and
<a class="reference internal" href="#s3prl.problem.HearNsynth5hr.build_model" title="s3prl.problem.HearNsynth5hr.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>, and will not be used in the core <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.run" title="s3prl.problem.HearNsynth5hr.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> logic.
See the specific method documentation for their supported arguments and
meaning</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearNsynth5hr.save_model">
<span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L709-L750"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearNsynth5hr.save_model" title="Permalink to this definition">#</a></dt>
<dd><p>Save the model state_dict and the model initialization arguments into the given directory.
If you override this method, it is highly possible you also need to override <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.load_model" title="s3prl.problem.HearNsynth5hr.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.default_config" title="s3prl.problem.HearNsynth5hr.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_model</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>model_ckpt_dir</strong> (<em>str</em>) – save the model into the this directory.</p></li>
<li><p><strong>build_model_all_args</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.build_model" title="s3prl.problem.HearNsynth5hr.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>.
By saving this dictionary, you can easily reconstruct the same model
by calling <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.build_model" title="s3prl.problem.HearNsynth5hr.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearNsynth5hr.save_task">
<span class="sig-name descname"><span class="pre">save_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="s3prl.task.base.html#s3prl.task.base.Task" title="s3prl.task.base.Task"><span class="pre">Task</span></a></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L774-L831"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearNsynth5hr.save_task" title="Permalink to this definition">#</a></dt>
<dd><p>Save the task’s state, <code class="code docutils literal notranslate"><span class="pre">task.get_state()</span></code>, and the initialization arguments into the given
directory. If you override this method, it is highly possible you also need to override
<a class="reference internal" href="#s3prl.problem.HearNsynth5hr.load_task" title="s3prl.problem.HearNsynth5hr.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.default_config" title="s3prl.problem.HearNsynth5hr.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_task</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – save the task into this directory.</p></li>
<li><p><strong>build_task_all_args_except_model</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.build_task" title="s3prl.problem.HearNsynth5hr.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> except
the <code class="code docutils literal notranslate"><span class="pre">model</span></code> argument since the model should be sapartely saved by
<a class="reference internal" href="#s3prl.problem.HearNsynth5hr.save_model" title="s3prl.problem.HearNsynth5hr.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a>. By saving this dictionary, you can easily reconstruct the same task
by calling <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.build_task" title="s3prl.problem.HearNsynth5hr.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>task</strong> (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><em>Task</em></a>) – the task to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearNsynth5hr.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L287-L658"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearNsynth5hr.train" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.default_config" title="s3prl.problem.HearNsynth5hr.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>total_steps</p></td>
<td><p>(int) - the total optimization steps</p></td>
</tr>
<tr class="row-odd"><td><p>log_step</p></td>
<td><p>(int) - logging frequency. log every <code class="code docutils literal notranslate"><span class="pre">log_step</span></code> step</p></td>
</tr>
<tr class="row-even"><td><p>eval_step</p></td>
<td><p>(int) - evaluation frequency. Evaluate every <code class="code docutils literal notranslate"><span class="pre">eval_step</span></code> step.                                                 Note that you can control how many batch to evaluate to speed up the                                                 development by the <code class="code docutils literal notranslate"><span class="pre">eval_batch</span></code> argument in <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.run" title="s3prl.problem.HearNsynth5hr.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>save_step</p></td>
<td><p>(int) - save the checkpoint every <code class="code docutils literal notranslate"><span class="pre">save_step</span></code> step.</p></td>
</tr>
<tr class="row-even"><td><p>gradient_clipping</p></td>
<td><p>(float) - clip the gradient. important for RNNs.</p></td>
</tr>
<tr class="row-odd"><td><p>gradient_accumulate</p></td>
<td><p>(int) - accumulate multiple steps’ gradient before updating network parameters                                                 to simulate large-batch optimization.</p></td>
</tr>
<tr class="row-even"><td><p>valid_metric</p></td>
<td><p>(str) - the metric to select the best valid checkpoint. Different Tasks have different                                                 supported valid_metrics. See <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.build_task" title="s3prl.problem.HearNsynth5hr.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> for the supported metrics.</p></td>
</tr>
<tr class="row-odd"><td><p>valid_higher_better</p></td>
<td><p>(bool) - some metrics are higher better, while some are lower better                                                 this will affect how to save the best validation checkpoint.</p></td>
</tr>
<tr class="row-even"><td><p>auto_resume</p></td>
<td><p>(bool) - if there are already the last checkpoint in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.run" title="s3prl.problem.HearNsynth5hr.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>),                                                 whether to resume from it or delete it and start a new training session.</p></td>
</tr>
<tr class="row-odd"><td><p>resume_ckpt_dir</p></td>
<td><p>(str) - you can directly specify the checkpoint path to resume which is not necessary                                                 in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.HearNsynth5hr.run" title="s3prl.problem.HearNsynth5hr.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>).</p></td>
</tr>
<tr class="row-even"><td><p>seed</p></td>
<td><p>(int) - fix the seed before the training start</p></td>
</tr>
<tr class="row-odd"><td><p>keep_num_ckpts</p></td>
<td><p>(int) - to prevent saving too many checkpoints, only save the <code class="code docutils literal notranslate"><span class="pre">keep_num_ckpts</span></code>                                                 latest checkpoints and delete the old ones.</p></td>
</tr>
<tr class="row-even"><td><p>use_scheduler</p></td>
<td><p>(bool) - whether to use the scheduler</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="hearstroke">
<h2>HearStroke<a class="headerlink" href="#hearstroke" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="s3prl.problem.HearStroke">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">s3prl.problem.</span></span><span class="sig-name descname"><span class="pre">HearStroke</span></span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_stroke.html#HearStroke"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_stroke.py#L10-L78"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearStroke" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="s3prl.problem.common.hear_esc50.html#s3prl.problem.common.hear_esc50.HearESC50" title="s3prl.problem.common.hear_esc50.HearESC50"><code class="xref py py-class docutils literal notranslate"><span class="pre">HearESC50</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearStroke.default_config">
<span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_stroke.html#HearStroke.default_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_stroke.py#L11-L78"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearStroke.default_config" title="Permalink to this definition">#</a></dt>
<dd><p>The default arguments for <a class="reference internal" href="#s3prl.problem.HearStroke.run" title="s3prl.problem.HearStroke.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> in yaml.
Note that for the fields with inner values, like <code class="code docutils literal notranslate"><span class="pre">build_model</span></code>,
the outer field name corresponds to a method name, so you can find the method
<a class="reference internal" href="#s3prl.problem.HearStroke.build_model" title="s3prl.problem.HearStroke.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>. Furthermore, the values inside that field will be
directly passed into the method. So by changing these inner values, you
can directly affect the behavior of the corresponding method. See the method
documentation for all the supported arguments and their meanings.</p>
<p>The methods affected by the following config are: <a class="reference internal" href="#s3prl.problem.HearStroke.prepare_data" title="s3prl.problem.HearStroke.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> <a class="reference internal" href="#s3prl.problem.HearStroke.build_batch_sampler" title="s3prl.problem.HearStroke.build_batch_sampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_batch_sampler</span></code></a> <a class="reference internal" href="#s3prl.problem.HearStroke.build_upstream" title="s3prl.problem.HearStroke.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a> <a class="reference internal" href="#s3prl.problem.HearStroke.build_featurizer" title="s3prl.problem.HearStroke.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a> <a class="reference internal" href="#s3prl.problem.HearStroke.build_downstream" title="s3prl.problem.HearStroke.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a> <a class="reference internal" href="#s3prl.problem.HearStroke.build_model" title="s3prl.problem.HearStroke.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> <a class="reference internal" href="#s3prl.problem.HearStroke.build_task" title="s3prl.problem.HearStroke.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> <a class="reference internal" href="#s3prl.problem.HearStroke.build_optimizer" title="s3prl.problem.HearStroke.build_optimizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_optimizer</span></code></a> <a class="reference internal" href="#s3prl.problem.HearStroke.build_scheduler" title="s3prl.problem.HearStroke.build_scheduler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_scheduler</span></code></a> <a class="reference internal" href="#s3prl.problem.HearStroke.save_model" title="s3prl.problem.HearStroke.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a> <a class="reference internal" href="#s3prl.problem.HearStroke.save_task" title="s3prl.problem.HearStroke.save_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_task</span></code></a> <a class="reference internal" href="#s3prl.problem.HearStroke.train" title="s3prl.problem.HearStroke.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> <a class="reference internal" href="#s3prl.problem.HearStroke.evaluate" title="s3prl.problem.HearStroke.evaluate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate</span></code></a></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">start</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="nt">stop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">target_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">cache_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">remove_all_cache</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">prepare_data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">dataset_root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="w">  </span><span class="nt">test_fold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="w">  </span><span class="nt">num_folds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="nt">build_batch_sampler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">train</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">32</span>
<span class="w">    </span><span class="nt">shuffle</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">valid</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">test</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="nt">build_upstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">build_featurizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">layer_selections</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="nt">normalize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_downstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">hidden_layers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">  </span><span class="nt">pooling_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MeanPooling</span>
<span class="nt">build_model</span><span class="p">:</span>
<span class="w">  </span><span class="nt">upstream_trainable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_task</span><span class="p">:</span>
<span class="w">  </span><span class="nt">prediction_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">multiclass</span>
<span class="w">  </span><span class="nt">scores</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top1_acc</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">d_prime</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aucroc</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mAP</span>
<span class="nt">build_optimizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Adam</span>
<span class="w">  </span><span class="nt">conf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">lr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.001</span>
<span class="nt">build_scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ExponentialLR</span>
<span class="w">  </span><span class="nt">gamma</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.9</span>
<span class="nt">save_model</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">save_task</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">train</span><span class="p">:</span>
<span class="w">  </span><span class="nt">total_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">150000</span>
<span class="w">  </span><span class="nt">log_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">  </span><span class="nt">eval_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span>
<span class="w">  </span><span class="nt">save_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">  </span><span class="nt">gradient_clipping</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0</span>
<span class="w">  </span><span class="nt">gradient_accumulate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">valid_metric</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top1_acc</span>
<span class="w">  </span><span class="nt">valid_higher_better</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">auto_resume</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">resume_ckpt_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">evaluate</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearStroke.build_batch_sampler">
<span class="sig-name descname"><span class="pre">build_batch_sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L213-L229"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearStroke.build_batch_sampler" title="Permalink to this definition">#</a></dt>
<dd><p>Return the batch sampler for torch DataLoader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_batch_sampler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearStroke.default_config" title="s3prl.problem.HearStroke.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>train</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>valid</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-even"><td><p>test</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">mode</span></code> specific csv from <a class="reference internal" href="#s3prl.problem.HearStroke.prepare_data" title="s3prl.problem.HearStroke.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>dataset</strong> – the dataset from <a class="reference internal" href="#s3prl.problem.HearStroke.build_dataset" title="s3prl.problem.HearStroke.build_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_dataset</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>batch sampler for torch DataLoader</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearStroke.build_collate_fn">
<span class="sig-name descname"><span class="pre">build_collate_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L143-L156"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearStroke.build_collate_fn" title="Permalink to this definition">#</a></dt>
<dd><p>By default returns <code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataset.base.default_collate_fn</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_collate_fn</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearStroke.default_config" title="s3prl.problem.HearStroke.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train, valid, or test</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>callable</p>
<p>the collate_fn for torch DataLoader in train/valid/test <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearStroke.build_dataset">
<span class="sig-name descname"><span class="pre">build_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_shift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L172-L211"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearStroke.build_dataset" title="Permalink to this definition">#</a></dt>
<dd><p>Build the dataset for train/valid/test.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_dataset</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearStroke.default_config" title="s3prl.problem.HearStroke.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>. with <code class="code docutils literal notranslate"><span class="pre">train</span></code>, <code class="code docutils literal notranslate"><span class="pre">valid</span></code>, <code class="code docutils literal notranslate"><span class="pre">test</span></code> keys, each
is a dictionary with the following supported options:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>max_secs</p></td>
<td><p>(float) - If a waveform is longer than <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds, randomly crop the waveform into <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds</p></td>
</tr>
<tr class="row-odd"><td><p>sox_effects</p></td>
<td><p>(List[List[str]]) - If not None, apply sox effects on the utterance</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – The metadata csv file for the specific <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p></li>
<li><p><strong>encoder_path</strong> (<em>str</em>) – The pickled encoder path for encoding the labels</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch Dataset</p>
<p>For all train/valid/test mode, the dataset should return each item as a dictionary
containing the following keys:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>x</p></td>
<td><p>(torch.FloatTensor) - the waveform in (seq_len, 1)</p></td>
</tr>
<tr class="row-odd"><td><p>x_len</p></td>
<td><p>(int) - the waveform length <code class="code docutils literal notranslate"><span class="pre">seq_len</span></code></p></td>
</tr>
<tr class="row-even"><td><p>class_id</p></td>
<td><p>(int) - the encoded class id</p></td>
</tr>
<tr class="row-odd"><td><p>label</p></td>
<td><p>(str) - the class name</p></td>
</tr>
<tr class="row-even"><td><p>unique_name</p></td>
<td><p>(str) - the unique id for this datapoint</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearStroke.build_downstream">
<span class="sig-name descname"><span class="pre">build_downstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L231-L240"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearStroke.build_downstream" title="Permalink to this definition">#</a></dt>
<dd><p>Return the task-specific downstream model.
By default build the <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code> model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearStroke.default_config" title="s3prl.problem.HearStroke.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments of <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code></p></li>
<li><p><strong>downstream_input_size</strong> (<em>int</em>) – the required input size of the model</p></li>
<li><p><strong>downstream_output_size</strong> (<em>int</em>) – the required output size of the model</p></li>
<li><p><strong>downstream_input_stride</strong> (<em>int</em>) – the input feature’s stride (from 16 KHz)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUtteranceModel" title="s3prl.nn.interface.AbsUtteranceModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUtteranceModel</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearStroke.build_encoder">
<span class="sig-name descname"><span class="pre">build_encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_csv_paths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L142-L170"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearStroke.build_encoder" title="Permalink to this definition">#</a></dt>
<dd><p>Build the encoder (for the labels) given the data metadata, and return the saved encoder path.
By default generate and save a <a class="reference internal" href="s3prl.dataio.encoder.html#s3prl.dataio.encoder.CategoryEncoder" title="s3prl.dataio.encoder.CategoryEncoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataio.encoder.CategoryEncoder</span></code></a> from the <code class="code docutils literal notranslate"><span class="pre">label</span></code> column of all the csv files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_encoder</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearStroke.default_config" title="s3prl.problem.HearStroke.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Save your encoder into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>train_csv_path</strong> (<em>str</em>) – the train path from <a class="reference internal" href="#s3prl.problem.HearStroke.prepare_data" title="s3prl.problem.HearStroke.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>valid_csv_path</strong> (<em>str</em>) – the valid path from <a class="reference internal" href="#s3prl.problem.HearStroke.prepare_data" title="s3prl.problem.HearStroke.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>test_csv_paths</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – the test paths from <a class="reference internal" href="#s3prl.problem.HearStroke.prepare_data" title="s3prl.problem.HearStroke.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>str</p>
<p>encoder_path: The encoder should be saved in the pickle format</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearStroke.build_featurizer">
<span class="sig-name descname"><span class="pre">build_featurizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upstream</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L175-L192"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearStroke.build_featurizer" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the featurizer with <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearStroke.default_config" title="s3prl.problem.HearStroke.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p></li>
<li><p><strong>upstream</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">AbsUpstream</span></code>) – the upstream model built by <a class="reference internal" href="#s3prl.problem.HearStroke.build_upstream" title="s3prl.problem.HearStroke.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsFeaturizer" title="s3prl.nn.interface.AbsFeaturizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsFeaturizer</span></code></a></p>
<p>Return the featurizer model. The featurizer is used to reduce the multiple
hidden states returned from the upstream model (built by <a class="reference internal" href="#s3prl.problem.HearStroke.build_upstream" title="s3prl.problem.HearStroke.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>)
into a single hidden state, so can be easliy fed into the downstream model</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearStroke.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L194-L231"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearStroke.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>By default build model with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearStroke.default_config" title="s3prl.problem.HearStroke.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p></li>
<li><p><strong>model_output_size</strong> (<em>int</em>) – the required model’s output hidden size</p></li>
<li><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearStroke.default_config" title="s3prl.problem.HearStroke.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearStroke.build_upstream" title="s3prl.problem.HearStroke.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearStroke.default_config" title="s3prl.problem.HearStroke.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearStroke.build_featurizer" title="s3prl.problem.HearStroke.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a></p></li>
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearStroke.default_config" title="s3prl.problem.HearStroke.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearStroke.build_downstream" title="s3prl.problem.HearStroke.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch.nn.Module</p>
<p>Return the entire model for the task, which takes the direct items from DataLoader as the input.
Usually, the components can be built by <a class="reference internal" href="#s3prl.problem.HearStroke.build_upstream" title="s3prl.problem.HearStroke.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>, <a class="reference internal" href="#s3prl.problem.HearStroke.build_featurizer" title="s3prl.problem.HearStroke.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a>,
<a class="reference internal" href="#s3prl.problem.HearStroke.build_downstream" title="s3prl.problem.HearStroke.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a>, and are concated together to get the final model.
The upstream extracts multiple hidden states, the featuizer reduce them into a single hidden state,
and the downstream takes the hidden states as the feature for the downstream-specific model.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearStroke.build_optimizer">
<span class="sig-name descname"><span class="pre">build_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L233-L258"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearStroke.build_optimizer" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_optimizer</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearStroke.default_config" title="s3prl.problem.HearStroke.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to below</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the optimizer class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the optimizer class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;lr&quot;:</span> <span class="pre">1.0e-4}</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>parameters</strong> (<em>iterable</em>) – the standard params accepted by <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code></p>
<p>An optimizer following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearStroke.build_scheduler">
<span class="sig-name descname"><span class="pre">build_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L260-L285"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearStroke.build_scheduler" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_scheduler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearStroke.default_config" title="s3prl.problem.HearStroke.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the scheduler class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the scheduler class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;gamma&quot;:</span> <span class="pre">0.01}</span></code> for <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler.StepLR</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>optimizer</strong> – the standard torch optimizer accepted by Scheduler in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch scheduler</p>
<p>A scheduler following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearStroke.build_task">
<span class="sig-name descname"><span class="pre">build_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L242-L250"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearStroke.build_task" title="Permalink to this definition">#</a></dt>
<dd><p>Build the task, which defines the logics for every train/valid/test forward step for the <code class="code docutils literal notranslate"><span class="pre">model</span></code>,
and the logics for how to reduce all the batch results from multiple train/valid/test steps into metrics</p>
<p>By default build <code class="xref py py-obj docutils literal notranslate"><span class="pre">UtteranceClassificationTask</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearStroke.default_config" title="s3prl.problem.HearStroke.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model built by <a class="reference internal" href="#s3prl.problem.HearStroke.build_model" title="s3prl.problem.HearStroke.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a></p></li>
<li><p><strong>encoder</strong> – the encoder built by <a class="reference internal" href="#s3prl.problem.HearStroke.build_encoder" title="s3prl.problem.HearStroke.build_encoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_encoder</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Task</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearStroke.build_upstream">
<span class="sig-name descname"><span class="pre">build_upstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L158-L173"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearStroke.build_upstream" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the upstream with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearStroke.default_config" title="s3prl.problem.HearStroke.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUpstream" title="s3prl.nn.interface.AbsUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUpstream</span></code></a></p>
<p>Return an upstream model, whose forward takes the waveform input and returns
multiple hidden states as features.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearStroke.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L660-L707"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearStroke.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>The evaluate routine used by <a class="reference internal" href="#s3prl.problem.HearStroke.train" title="s3prl.problem.HearStroke.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> (during validation phase) and <a class="reference internal" href="#s3prl.problem.HearStroke.run" title="s3prl.problem.HearStroke.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>
(during testing phase).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evaluate</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearStroke.default_config" title="s3prl.problem.HearStroke.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearStroke.get_class_from_name">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_class_from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L129-L141"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearStroke.get_class_from_name" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">__name__</span></code> of the problem class</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Problem</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearStroke.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L752-L772"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearStroke.load_model" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model_ckpt_dir</strong> (<em>str</em>) – Restore the model with <a class="reference internal" href="#s3prl.problem.HearStroke.build_model" title="s3prl.problem.HearStroke.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> and the checkpoint
saved in this directory.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearStroke.load_model_and_task">
<span class="sig-name descname"><span class="pre">load_model_and_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ckpts_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L884-L902"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearStroke.load_model_and_task" title="Permalink to this definition">#</a></dt>
<dd><p>This is a helper method to combine <a class="reference internal" href="#s3prl.problem.HearStroke.load_model" title="s3prl.problem.HearStroke.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a> and <a class="reference internal" href="#s3prl.problem.HearStroke.load_task" title="s3prl.problem.HearStroke.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>
together to directly load the model and the task. This method assumes
the model is saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'model'</span></code> and the task is
saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'task'</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>model (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>)</p></li>
<li><p>task (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a>)</p></li>
</ol>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearStroke.load_task">
<span class="sig-name descname"><span class="pre">load_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L833-L882"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearStroke.load_task" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – Restore the task with <a class="reference internal" href="#s3prl.problem.HearStroke.build_task" title="s3prl.problem.HearStroke.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> and the checkpoint
saved in this directory.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model for the task, since the model is separately saved
and is required for <a class="reference internal" href="#s3prl.problem.HearStroke.build_task" title="s3prl.problem.HearStroke.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a>.</p></li>
<li><p><strong>task_overrides</strong> (<em>dict</em>) – overrides the saved initialization arguments, so can change
the loaded task’s behavior. Like, change the decoding hyperparameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearStroke.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L954-L995"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearStroke.main" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearStroke.prepare_data">
<span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_esc50.py#L151-L160"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearStroke.prepare_data" title="Permalink to this definition">#</a></dt>
<dd><p>Prepare the task-specific data metadata (path, labels…).
By default call <code class="xref py py-obj docutils literal notranslate"><span class="pre">voxceleb1_for_sid</span></code> with <code class="code docutils literal notranslate"><span class="pre">**prepare_data</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prepare_data</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearStroke.default_config" title="s3prl.problem.HearStroke.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments in <code class="xref py py-obj docutils literal notranslate"><span class="pre">voxceleb1_for_sid</span></code></p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Parse your corpus and save the csv file into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the parsing or preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>train_path (str)</p></li>
<li><p>valid_path (str)</p></li>
<li><p>test_paths (List[str])</p></li>
</ol>
<p>Each path (str) should be a csv file containing the following columns:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>column</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>(str) - the unique id for this data point</p></td>
</tr>
<tr class="row-odd"><td><p>wav_path</p></td>
<td><p>(str) - the absolute path of the waveform file</p></td>
</tr>
<tr class="row-even"><td><p>label</p></td>
<td><p>(str) - a string label of the waveform</p></td>
</tr>
<tr class="row-odd"><td><p>start_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">start_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load from the beginning.</p></td>
</tr>
<tr class="row-even"><td><p>end_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">end_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load to the end.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearStroke.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_all_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cuda'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/run.py#L26-L318"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearStroke.run" title="Permalink to this definition">#</a></dt>
<dd><div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>stage</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Parse the corpus and save the metadata file (waveform path, label…)</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Build the encoder to encode the labels</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Train the model</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Evaluate the model on multiple test sets</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_dir</strong> (<em>str</em>) – The directory that stores the script result.</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – The directory that caches the processed data.
Default: /home/user/.cache/s3prl/data</p></li>
<li><p><strong>remove_all_cache</strong> (<em>bool</em>) – Whether to remove all the cache stored under <cite>cache_dir</cite>.
Default: False</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting stage of the problem script.
Default: 0</p></li>
<li><p><strong>stop</strong> (<em>int</em>) – The stoping stage of the problem script, set <cite>None</cite> to reach the final stage.
Default: None</p></li>
<li><p><strong>num_workers</strong> (<em>int</em>) – num_workers for all the torch DataLoder</p></li>
<li><p><strong>eval_batch</strong> (<em>int</em>) – During evaluation (valid or test), limit the number of batch.
This is helpful for the fast development to check everything won’t crash.
If is -1, disable this feature and evaluate the entire epoch.
Default: -1</p></li>
<li><p><strong>device</strong> (<em>str</em>) – The device type for all torch-related operation: “cpu” or “cuda”
Default: “cuda”</p></li>
<li><p><strong>world_size</strong> (<em>int</em>) – How many processes are running this script simultaneously (in parallel).
Usually this is just 1, however if you are runnig distributed training,
this should be &gt; 1.
Default: 1</p></li>
<li><p><strong>rank</strong> (<em>int</em>) – When distributed training, world_size &gt; 1. Take <code class="code docutils literal notranslate"><span class="pre">world_size</span> <span class="pre">==</span> <span class="pre">8</span></code> for
example, this means 8 processes (8 GPUs) are runing in parallel. The script
needs to know which process among 8 processes it is. In this case, <code class="code docutils literal notranslate"><span class="pre">rank</span></code>
can range from 0~7. All the 8 processes have the same <code class="code docutils literal notranslate"><span class="pre">world_size</span></code> but
different <code class="code docutils literal notranslate"><span class="pre">rank</span></code> (process id).</p></li>
<li><p><strong>test_ckpt_dir</strong> (<em>str</em>) – Specify the checkpoint path for testing. If not, use the validation best
checkpoint under the given <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> directory.</p></li>
<li><p><strong>**kwds</strong> – The other arguments like <code class="code docutils literal notranslate"><span class="pre">prepare_data</span></code> and <code class="code docutils literal notranslate"><span class="pre">build_model</span></code> are
method specific-arguments for methods like <a class="reference internal" href="#s3prl.problem.HearStroke.prepare_data" title="s3prl.problem.HearStroke.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> and
<a class="reference internal" href="#s3prl.problem.HearStroke.build_model" title="s3prl.problem.HearStroke.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>, and will not be used in the core <a class="reference internal" href="#s3prl.problem.HearStroke.run" title="s3prl.problem.HearStroke.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> logic.
See the specific method documentation for their supported arguments and
meaning</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearStroke.save_model">
<span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L709-L750"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearStroke.save_model" title="Permalink to this definition">#</a></dt>
<dd><p>Save the model state_dict and the model initialization arguments into the given directory.
If you override this method, it is highly possible you also need to override <a class="reference internal" href="#s3prl.problem.HearStroke.load_model" title="s3prl.problem.HearStroke.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearStroke.default_config" title="s3prl.problem.HearStroke.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_model</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>model_ckpt_dir</strong> (<em>str</em>) – save the model into the this directory.</p></li>
<li><p><strong>build_model_all_args</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.HearStroke.build_model" title="s3prl.problem.HearStroke.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>.
By saving this dictionary, you can easily reconstruct the same model
by calling <a class="reference internal" href="#s3prl.problem.HearStroke.build_model" title="s3prl.problem.HearStroke.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearStroke.save_task">
<span class="sig-name descname"><span class="pre">save_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="s3prl.task.base.html#s3prl.task.base.Task" title="s3prl.task.base.Task"><span class="pre">Task</span></a></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L774-L831"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearStroke.save_task" title="Permalink to this definition">#</a></dt>
<dd><p>Save the task’s state, <code class="code docutils literal notranslate"><span class="pre">task.get_state()</span></code>, and the initialization arguments into the given
directory. If you override this method, it is highly possible you also need to override
<a class="reference internal" href="#s3prl.problem.HearStroke.load_task" title="s3prl.problem.HearStroke.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearStroke.default_config" title="s3prl.problem.HearStroke.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_task</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – save the task into this directory.</p></li>
<li><p><strong>build_task_all_args_except_model</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.HearStroke.build_task" title="s3prl.problem.HearStroke.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> except
the <code class="code docutils literal notranslate"><span class="pre">model</span></code> argument since the model should be sapartely saved by
<a class="reference internal" href="#s3prl.problem.HearStroke.save_model" title="s3prl.problem.HearStroke.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a>. By saving this dictionary, you can easily reconstruct the same task
by calling <a class="reference internal" href="#s3prl.problem.HearStroke.build_task" title="s3prl.problem.HearStroke.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>task</strong> (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><em>Task</em></a>) – the task to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearStroke.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L287-L658"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearStroke.train" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearStroke.default_config" title="s3prl.problem.HearStroke.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>total_steps</p></td>
<td><p>(int) - the total optimization steps</p></td>
</tr>
<tr class="row-odd"><td><p>log_step</p></td>
<td><p>(int) - logging frequency. log every <code class="code docutils literal notranslate"><span class="pre">log_step</span></code> step</p></td>
</tr>
<tr class="row-even"><td><p>eval_step</p></td>
<td><p>(int) - evaluation frequency. Evaluate every <code class="code docutils literal notranslate"><span class="pre">eval_step</span></code> step.                                                 Note that you can control how many batch to evaluate to speed up the                                                 development by the <code class="code docutils literal notranslate"><span class="pre">eval_batch</span></code> argument in <a class="reference internal" href="#s3prl.problem.HearStroke.run" title="s3prl.problem.HearStroke.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>save_step</p></td>
<td><p>(int) - save the checkpoint every <code class="code docutils literal notranslate"><span class="pre">save_step</span></code> step.</p></td>
</tr>
<tr class="row-even"><td><p>gradient_clipping</p></td>
<td><p>(float) - clip the gradient. important for RNNs.</p></td>
</tr>
<tr class="row-odd"><td><p>gradient_accumulate</p></td>
<td><p>(int) - accumulate multiple steps’ gradient before updating network parameters                                                 to simulate large-batch optimization.</p></td>
</tr>
<tr class="row-even"><td><p>valid_metric</p></td>
<td><p>(str) - the metric to select the best valid checkpoint. Different Tasks have different                                                 supported valid_metrics. See <a class="reference internal" href="#s3prl.problem.HearStroke.build_task" title="s3prl.problem.HearStroke.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> for the supported metrics.</p></td>
</tr>
<tr class="row-odd"><td><p>valid_higher_better</p></td>
<td><p>(bool) - some metrics are higher better, while some are lower better                                                 this will affect how to save the best validation checkpoint.</p></td>
</tr>
<tr class="row-even"><td><p>auto_resume</p></td>
<td><p>(bool) - if there are already the last checkpoint in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.HearStroke.run" title="s3prl.problem.HearStroke.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>),                                                 whether to resume from it or delete it and start a new training session.</p></td>
</tr>
<tr class="row-odd"><td><p>resume_ckpt_dir</p></td>
<td><p>(str) - you can directly specify the checkpoint path to resume which is not necessary                                                 in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.HearStroke.run" title="s3prl.problem.HearStroke.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>).</p></td>
</tr>
<tr class="row-even"><td><p>seed</p></td>
<td><p>(int) - fix the seed before the training start</p></td>
</tr>
<tr class="row-odd"><td><p>keep_num_ckpts</p></td>
<td><p>(int) - to prevent saving too many checkpoints, only save the <code class="code docutils literal notranslate"><span class="pre">keep_num_ckpts</span></code>                                                 latest checkpoints and delete the old ones.</p></td>
</tr>
<tr class="row-even"><td><p>use_scheduler</p></td>
<td><p>(bool) - whether to use the scheduler</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="heartonic">
<h2>HearTonic<a class="headerlink" href="#heartonic" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="s3prl.problem.HearTonic">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">s3prl.problem.</span></span><span class="sig-name descname"><span class="pre">HearTonic</span></span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_tonic.html#HearTonic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_tonic.py#L10-L78"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearTonic" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="s3prl.problem.common.hear_esc50.html#s3prl.problem.common.hear_esc50.HearESC50" title="s3prl.problem.common.hear_esc50.HearESC50"><code class="xref py py-class docutils literal notranslate"><span class="pre">HearESC50</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearTonic.default_config">
<span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_tonic.html#HearTonic.default_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_tonic.py#L11-L78"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearTonic.default_config" title="Permalink to this definition">#</a></dt>
<dd><p>The default arguments for <a class="reference internal" href="#s3prl.problem.HearTonic.run" title="s3prl.problem.HearTonic.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> in yaml.
Note that for the fields with inner values, like <code class="code docutils literal notranslate"><span class="pre">build_model</span></code>,
the outer field name corresponds to a method name, so you can find the method
<a class="reference internal" href="#s3prl.problem.HearTonic.build_model" title="s3prl.problem.HearTonic.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>. Furthermore, the values inside that field will be
directly passed into the method. So by changing these inner values, you
can directly affect the behavior of the corresponding method. See the method
documentation for all the supported arguments and their meanings.</p>
<p>The methods affected by the following config are: <a class="reference internal" href="#s3prl.problem.HearTonic.prepare_data" title="s3prl.problem.HearTonic.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> <a class="reference internal" href="#s3prl.problem.HearTonic.build_batch_sampler" title="s3prl.problem.HearTonic.build_batch_sampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_batch_sampler</span></code></a> <a class="reference internal" href="#s3prl.problem.HearTonic.build_upstream" title="s3prl.problem.HearTonic.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a> <a class="reference internal" href="#s3prl.problem.HearTonic.build_featurizer" title="s3prl.problem.HearTonic.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a> <a class="reference internal" href="#s3prl.problem.HearTonic.build_downstream" title="s3prl.problem.HearTonic.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a> <a class="reference internal" href="#s3prl.problem.HearTonic.build_model" title="s3prl.problem.HearTonic.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> <a class="reference internal" href="#s3prl.problem.HearTonic.build_task" title="s3prl.problem.HearTonic.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> <a class="reference internal" href="#s3prl.problem.HearTonic.build_optimizer" title="s3prl.problem.HearTonic.build_optimizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_optimizer</span></code></a> <a class="reference internal" href="#s3prl.problem.HearTonic.build_scheduler" title="s3prl.problem.HearTonic.build_scheduler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_scheduler</span></code></a> <a class="reference internal" href="#s3prl.problem.HearTonic.save_model" title="s3prl.problem.HearTonic.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a> <a class="reference internal" href="#s3prl.problem.HearTonic.save_task" title="s3prl.problem.HearTonic.save_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_task</span></code></a> <a class="reference internal" href="#s3prl.problem.HearTonic.train" title="s3prl.problem.HearTonic.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> <a class="reference internal" href="#s3prl.problem.HearTonic.evaluate" title="s3prl.problem.HearTonic.evaluate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate</span></code></a></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">start</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="nt">stop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">target_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">cache_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">remove_all_cache</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">prepare_data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">dataset_root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="w">  </span><span class="nt">test_fold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="w">  </span><span class="nt">num_folds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="nt">build_batch_sampler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">train</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">32</span>
<span class="w">    </span><span class="nt">shuffle</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">valid</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">test</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="nt">build_upstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">build_featurizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">layer_selections</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="nt">normalize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_downstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">hidden_layers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">  </span><span class="nt">pooling_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MeanPooling</span>
<span class="nt">build_model</span><span class="p">:</span>
<span class="w">  </span><span class="nt">upstream_trainable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_task</span><span class="p">:</span>
<span class="w">  </span><span class="nt">prediction_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">multiclass</span>
<span class="w">  </span><span class="nt">scores</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top1_acc</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">d_prime</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aucroc</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mAP</span>
<span class="nt">build_optimizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Adam</span>
<span class="w">  </span><span class="nt">conf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">lr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.001</span>
<span class="nt">build_scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ExponentialLR</span>
<span class="w">  </span><span class="nt">gamma</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.9</span>
<span class="nt">save_model</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">save_task</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">train</span><span class="p">:</span>
<span class="w">  </span><span class="nt">total_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">150000</span>
<span class="w">  </span><span class="nt">log_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">  </span><span class="nt">eval_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span>
<span class="w">  </span><span class="nt">save_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">  </span><span class="nt">gradient_clipping</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0</span>
<span class="w">  </span><span class="nt">gradient_accumulate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">valid_metric</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top1_acc</span>
<span class="w">  </span><span class="nt">valid_higher_better</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">auto_resume</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">resume_ckpt_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">evaluate</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearTonic.build_batch_sampler">
<span class="sig-name descname"><span class="pre">build_batch_sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L213-L229"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearTonic.build_batch_sampler" title="Permalink to this definition">#</a></dt>
<dd><p>Return the batch sampler for torch DataLoader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_batch_sampler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearTonic.default_config" title="s3prl.problem.HearTonic.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>train</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>valid</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-even"><td><p>test</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">mode</span></code> specific csv from <a class="reference internal" href="#s3prl.problem.HearTonic.prepare_data" title="s3prl.problem.HearTonic.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>dataset</strong> – the dataset from <a class="reference internal" href="#s3prl.problem.HearTonic.build_dataset" title="s3prl.problem.HearTonic.build_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_dataset</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>batch sampler for torch DataLoader</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearTonic.build_collate_fn">
<span class="sig-name descname"><span class="pre">build_collate_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L143-L156"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearTonic.build_collate_fn" title="Permalink to this definition">#</a></dt>
<dd><p>By default returns <code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataset.base.default_collate_fn</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_collate_fn</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearTonic.default_config" title="s3prl.problem.HearTonic.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train, valid, or test</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>callable</p>
<p>the collate_fn for torch DataLoader in train/valid/test <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearTonic.build_dataset">
<span class="sig-name descname"><span class="pre">build_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_shift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L172-L211"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearTonic.build_dataset" title="Permalink to this definition">#</a></dt>
<dd><p>Build the dataset for train/valid/test.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_dataset</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearTonic.default_config" title="s3prl.problem.HearTonic.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>. with <code class="code docutils literal notranslate"><span class="pre">train</span></code>, <code class="code docutils literal notranslate"><span class="pre">valid</span></code>, <code class="code docutils literal notranslate"><span class="pre">test</span></code> keys, each
is a dictionary with the following supported options:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>max_secs</p></td>
<td><p>(float) - If a waveform is longer than <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds, randomly crop the waveform into <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds</p></td>
</tr>
<tr class="row-odd"><td><p>sox_effects</p></td>
<td><p>(List[List[str]]) - If not None, apply sox effects on the utterance</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – The metadata csv file for the specific <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p></li>
<li><p><strong>encoder_path</strong> (<em>str</em>) – The pickled encoder path for encoding the labels</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch Dataset</p>
<p>For all train/valid/test mode, the dataset should return each item as a dictionary
containing the following keys:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>x</p></td>
<td><p>(torch.FloatTensor) - the waveform in (seq_len, 1)</p></td>
</tr>
<tr class="row-odd"><td><p>x_len</p></td>
<td><p>(int) - the waveform length <code class="code docutils literal notranslate"><span class="pre">seq_len</span></code></p></td>
</tr>
<tr class="row-even"><td><p>class_id</p></td>
<td><p>(int) - the encoded class id</p></td>
</tr>
<tr class="row-odd"><td><p>label</p></td>
<td><p>(str) - the class name</p></td>
</tr>
<tr class="row-even"><td><p>unique_name</p></td>
<td><p>(str) - the unique id for this datapoint</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearTonic.build_downstream">
<span class="sig-name descname"><span class="pre">build_downstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L231-L240"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearTonic.build_downstream" title="Permalink to this definition">#</a></dt>
<dd><p>Return the task-specific downstream model.
By default build the <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code> model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearTonic.default_config" title="s3prl.problem.HearTonic.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments of <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code></p></li>
<li><p><strong>downstream_input_size</strong> (<em>int</em>) – the required input size of the model</p></li>
<li><p><strong>downstream_output_size</strong> (<em>int</em>) – the required output size of the model</p></li>
<li><p><strong>downstream_input_stride</strong> (<em>int</em>) – the input feature’s stride (from 16 KHz)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUtteranceModel" title="s3prl.nn.interface.AbsUtteranceModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUtteranceModel</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearTonic.build_encoder">
<span class="sig-name descname"><span class="pre">build_encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_csv_paths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L142-L170"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearTonic.build_encoder" title="Permalink to this definition">#</a></dt>
<dd><p>Build the encoder (for the labels) given the data metadata, and return the saved encoder path.
By default generate and save a <a class="reference internal" href="s3prl.dataio.encoder.html#s3prl.dataio.encoder.CategoryEncoder" title="s3prl.dataio.encoder.CategoryEncoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataio.encoder.CategoryEncoder</span></code></a> from the <code class="code docutils literal notranslate"><span class="pre">label</span></code> column of all the csv files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_encoder</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearTonic.default_config" title="s3prl.problem.HearTonic.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Save your encoder into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>train_csv_path</strong> (<em>str</em>) – the train path from <a class="reference internal" href="#s3prl.problem.HearTonic.prepare_data" title="s3prl.problem.HearTonic.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>valid_csv_path</strong> (<em>str</em>) – the valid path from <a class="reference internal" href="#s3prl.problem.HearTonic.prepare_data" title="s3prl.problem.HearTonic.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>test_csv_paths</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – the test paths from <a class="reference internal" href="#s3prl.problem.HearTonic.prepare_data" title="s3prl.problem.HearTonic.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>str</p>
<p>encoder_path: The encoder should be saved in the pickle format</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearTonic.build_featurizer">
<span class="sig-name descname"><span class="pre">build_featurizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upstream</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L175-L192"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearTonic.build_featurizer" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the featurizer with <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearTonic.default_config" title="s3prl.problem.HearTonic.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p></li>
<li><p><strong>upstream</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">AbsUpstream</span></code>) – the upstream model built by <a class="reference internal" href="#s3prl.problem.HearTonic.build_upstream" title="s3prl.problem.HearTonic.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsFeaturizer" title="s3prl.nn.interface.AbsFeaturizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsFeaturizer</span></code></a></p>
<p>Return the featurizer model. The featurizer is used to reduce the multiple
hidden states returned from the upstream model (built by <a class="reference internal" href="#s3prl.problem.HearTonic.build_upstream" title="s3prl.problem.HearTonic.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>)
into a single hidden state, so can be easliy fed into the downstream model</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearTonic.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L194-L231"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearTonic.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>By default build model with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearTonic.default_config" title="s3prl.problem.HearTonic.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p></li>
<li><p><strong>model_output_size</strong> (<em>int</em>) – the required model’s output hidden size</p></li>
<li><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearTonic.default_config" title="s3prl.problem.HearTonic.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearTonic.build_upstream" title="s3prl.problem.HearTonic.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearTonic.default_config" title="s3prl.problem.HearTonic.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearTonic.build_featurizer" title="s3prl.problem.HearTonic.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a></p></li>
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearTonic.default_config" title="s3prl.problem.HearTonic.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearTonic.build_downstream" title="s3prl.problem.HearTonic.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch.nn.Module</p>
<p>Return the entire model for the task, which takes the direct items from DataLoader as the input.
Usually, the components can be built by <a class="reference internal" href="#s3prl.problem.HearTonic.build_upstream" title="s3prl.problem.HearTonic.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>, <a class="reference internal" href="#s3prl.problem.HearTonic.build_featurizer" title="s3prl.problem.HearTonic.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a>,
<a class="reference internal" href="#s3prl.problem.HearTonic.build_downstream" title="s3prl.problem.HearTonic.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a>, and are concated together to get the final model.
The upstream extracts multiple hidden states, the featuizer reduce them into a single hidden state,
and the downstream takes the hidden states as the feature for the downstream-specific model.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearTonic.build_optimizer">
<span class="sig-name descname"><span class="pre">build_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L233-L258"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearTonic.build_optimizer" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_optimizer</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearTonic.default_config" title="s3prl.problem.HearTonic.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to below</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the optimizer class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the optimizer class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;lr&quot;:</span> <span class="pre">1.0e-4}</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>parameters</strong> (<em>iterable</em>) – the standard params accepted by <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code></p>
<p>An optimizer following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearTonic.build_scheduler">
<span class="sig-name descname"><span class="pre">build_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L260-L285"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearTonic.build_scheduler" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_scheduler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearTonic.default_config" title="s3prl.problem.HearTonic.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the scheduler class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the scheduler class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;gamma&quot;:</span> <span class="pre">0.01}</span></code> for <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler.StepLR</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>optimizer</strong> – the standard torch optimizer accepted by Scheduler in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch scheduler</p>
<p>A scheduler following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearTonic.build_task">
<span class="sig-name descname"><span class="pre">build_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L242-L250"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearTonic.build_task" title="Permalink to this definition">#</a></dt>
<dd><p>Build the task, which defines the logics for every train/valid/test forward step for the <code class="code docutils literal notranslate"><span class="pre">model</span></code>,
and the logics for how to reduce all the batch results from multiple train/valid/test steps into metrics</p>
<p>By default build <code class="xref py py-obj docutils literal notranslate"><span class="pre">UtteranceClassificationTask</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearTonic.default_config" title="s3prl.problem.HearTonic.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model built by <a class="reference internal" href="#s3prl.problem.HearTonic.build_model" title="s3prl.problem.HearTonic.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a></p></li>
<li><p><strong>encoder</strong> – the encoder built by <a class="reference internal" href="#s3prl.problem.HearTonic.build_encoder" title="s3prl.problem.HearTonic.build_encoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_encoder</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Task</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearTonic.build_upstream">
<span class="sig-name descname"><span class="pre">build_upstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L158-L173"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearTonic.build_upstream" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the upstream with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearTonic.default_config" title="s3prl.problem.HearTonic.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUpstream" title="s3prl.nn.interface.AbsUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUpstream</span></code></a></p>
<p>Return an upstream model, whose forward takes the waveform input and returns
multiple hidden states as features.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearTonic.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L660-L707"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearTonic.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>The evaluate routine used by <a class="reference internal" href="#s3prl.problem.HearTonic.train" title="s3prl.problem.HearTonic.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> (during validation phase) and <a class="reference internal" href="#s3prl.problem.HearTonic.run" title="s3prl.problem.HearTonic.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>
(during testing phase).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evaluate</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearTonic.default_config" title="s3prl.problem.HearTonic.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearTonic.get_class_from_name">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_class_from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L129-L141"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearTonic.get_class_from_name" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">__name__</span></code> of the problem class</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Problem</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearTonic.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L752-L772"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearTonic.load_model" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model_ckpt_dir</strong> (<em>str</em>) – Restore the model with <a class="reference internal" href="#s3prl.problem.HearTonic.build_model" title="s3prl.problem.HearTonic.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> and the checkpoint
saved in this directory.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearTonic.load_model_and_task">
<span class="sig-name descname"><span class="pre">load_model_and_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ckpts_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L884-L902"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearTonic.load_model_and_task" title="Permalink to this definition">#</a></dt>
<dd><p>This is a helper method to combine <a class="reference internal" href="#s3prl.problem.HearTonic.load_model" title="s3prl.problem.HearTonic.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a> and <a class="reference internal" href="#s3prl.problem.HearTonic.load_task" title="s3prl.problem.HearTonic.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>
together to directly load the model and the task. This method assumes
the model is saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'model'</span></code> and the task is
saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'task'</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>model (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>)</p></li>
<li><p>task (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a>)</p></li>
</ol>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearTonic.load_task">
<span class="sig-name descname"><span class="pre">load_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L833-L882"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearTonic.load_task" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – Restore the task with <a class="reference internal" href="#s3prl.problem.HearTonic.build_task" title="s3prl.problem.HearTonic.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> and the checkpoint
saved in this directory.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model for the task, since the model is separately saved
and is required for <a class="reference internal" href="#s3prl.problem.HearTonic.build_task" title="s3prl.problem.HearTonic.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a>.</p></li>
<li><p><strong>task_overrides</strong> (<em>dict</em>) – overrides the saved initialization arguments, so can change
the loaded task’s behavior. Like, change the decoding hyperparameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearTonic.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L954-L995"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearTonic.main" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearTonic.prepare_data">
<span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_esc50.py#L151-L160"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearTonic.prepare_data" title="Permalink to this definition">#</a></dt>
<dd><p>Prepare the task-specific data metadata (path, labels…).
By default call <code class="xref py py-obj docutils literal notranslate"><span class="pre">voxceleb1_for_sid</span></code> with <code class="code docutils literal notranslate"><span class="pre">**prepare_data</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prepare_data</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearTonic.default_config" title="s3prl.problem.HearTonic.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments in <code class="xref py py-obj docutils literal notranslate"><span class="pre">voxceleb1_for_sid</span></code></p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Parse your corpus and save the csv file into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the parsing or preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>train_path (str)</p></li>
<li><p>valid_path (str)</p></li>
<li><p>test_paths (List[str])</p></li>
</ol>
<p>Each path (str) should be a csv file containing the following columns:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>column</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>(str) - the unique id for this data point</p></td>
</tr>
<tr class="row-odd"><td><p>wav_path</p></td>
<td><p>(str) - the absolute path of the waveform file</p></td>
</tr>
<tr class="row-even"><td><p>label</p></td>
<td><p>(str) - a string label of the waveform</p></td>
</tr>
<tr class="row-odd"><td><p>start_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">start_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load from the beginning.</p></td>
</tr>
<tr class="row-even"><td><p>end_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">end_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load to the end.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearTonic.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_all_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cuda'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/run.py#L26-L318"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearTonic.run" title="Permalink to this definition">#</a></dt>
<dd><div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>stage</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Parse the corpus and save the metadata file (waveform path, label…)</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Build the encoder to encode the labels</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Train the model</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Evaluate the model on multiple test sets</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_dir</strong> (<em>str</em>) – The directory that stores the script result.</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – The directory that caches the processed data.
Default: /home/user/.cache/s3prl/data</p></li>
<li><p><strong>remove_all_cache</strong> (<em>bool</em>) – Whether to remove all the cache stored under <cite>cache_dir</cite>.
Default: False</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting stage of the problem script.
Default: 0</p></li>
<li><p><strong>stop</strong> (<em>int</em>) – The stoping stage of the problem script, set <cite>None</cite> to reach the final stage.
Default: None</p></li>
<li><p><strong>num_workers</strong> (<em>int</em>) – num_workers for all the torch DataLoder</p></li>
<li><p><strong>eval_batch</strong> (<em>int</em>) – During evaluation (valid or test), limit the number of batch.
This is helpful for the fast development to check everything won’t crash.
If is -1, disable this feature and evaluate the entire epoch.
Default: -1</p></li>
<li><p><strong>device</strong> (<em>str</em>) – The device type for all torch-related operation: “cpu” or “cuda”
Default: “cuda”</p></li>
<li><p><strong>world_size</strong> (<em>int</em>) – How many processes are running this script simultaneously (in parallel).
Usually this is just 1, however if you are runnig distributed training,
this should be &gt; 1.
Default: 1</p></li>
<li><p><strong>rank</strong> (<em>int</em>) – When distributed training, world_size &gt; 1. Take <code class="code docutils literal notranslate"><span class="pre">world_size</span> <span class="pre">==</span> <span class="pre">8</span></code> for
example, this means 8 processes (8 GPUs) are runing in parallel. The script
needs to know which process among 8 processes it is. In this case, <code class="code docutils literal notranslate"><span class="pre">rank</span></code>
can range from 0~7. All the 8 processes have the same <code class="code docutils literal notranslate"><span class="pre">world_size</span></code> but
different <code class="code docutils literal notranslate"><span class="pre">rank</span></code> (process id).</p></li>
<li><p><strong>test_ckpt_dir</strong> (<em>str</em>) – Specify the checkpoint path for testing. If not, use the validation best
checkpoint under the given <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> directory.</p></li>
<li><p><strong>**kwds</strong> – The other arguments like <code class="code docutils literal notranslate"><span class="pre">prepare_data</span></code> and <code class="code docutils literal notranslate"><span class="pre">build_model</span></code> are
method specific-arguments for methods like <a class="reference internal" href="#s3prl.problem.HearTonic.prepare_data" title="s3prl.problem.HearTonic.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> and
<a class="reference internal" href="#s3prl.problem.HearTonic.build_model" title="s3prl.problem.HearTonic.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>, and will not be used in the core <a class="reference internal" href="#s3prl.problem.HearTonic.run" title="s3prl.problem.HearTonic.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> logic.
See the specific method documentation for their supported arguments and
meaning</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearTonic.save_model">
<span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L709-L750"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearTonic.save_model" title="Permalink to this definition">#</a></dt>
<dd><p>Save the model state_dict and the model initialization arguments into the given directory.
If you override this method, it is highly possible you also need to override <a class="reference internal" href="#s3prl.problem.HearTonic.load_model" title="s3prl.problem.HearTonic.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearTonic.default_config" title="s3prl.problem.HearTonic.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_model</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>model_ckpt_dir</strong> (<em>str</em>) – save the model into the this directory.</p></li>
<li><p><strong>build_model_all_args</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.HearTonic.build_model" title="s3prl.problem.HearTonic.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>.
By saving this dictionary, you can easily reconstruct the same model
by calling <a class="reference internal" href="#s3prl.problem.HearTonic.build_model" title="s3prl.problem.HearTonic.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearTonic.save_task">
<span class="sig-name descname"><span class="pre">save_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="s3prl.task.base.html#s3prl.task.base.Task" title="s3prl.task.base.Task"><span class="pre">Task</span></a></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L774-L831"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearTonic.save_task" title="Permalink to this definition">#</a></dt>
<dd><p>Save the task’s state, <code class="code docutils literal notranslate"><span class="pre">task.get_state()</span></code>, and the initialization arguments into the given
directory. If you override this method, it is highly possible you also need to override
<a class="reference internal" href="#s3prl.problem.HearTonic.load_task" title="s3prl.problem.HearTonic.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearTonic.default_config" title="s3prl.problem.HearTonic.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_task</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – save the task into this directory.</p></li>
<li><p><strong>build_task_all_args_except_model</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.HearTonic.build_task" title="s3prl.problem.HearTonic.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> except
the <code class="code docutils literal notranslate"><span class="pre">model</span></code> argument since the model should be sapartely saved by
<a class="reference internal" href="#s3prl.problem.HearTonic.save_model" title="s3prl.problem.HearTonic.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a>. By saving this dictionary, you can easily reconstruct the same task
by calling <a class="reference internal" href="#s3prl.problem.HearTonic.build_task" title="s3prl.problem.HearTonic.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>task</strong> (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><em>Task</em></a>) – the task to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearTonic.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L287-L658"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearTonic.train" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearTonic.default_config" title="s3prl.problem.HearTonic.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>total_steps</p></td>
<td><p>(int) - the total optimization steps</p></td>
</tr>
<tr class="row-odd"><td><p>log_step</p></td>
<td><p>(int) - logging frequency. log every <code class="code docutils literal notranslate"><span class="pre">log_step</span></code> step</p></td>
</tr>
<tr class="row-even"><td><p>eval_step</p></td>
<td><p>(int) - evaluation frequency. Evaluate every <code class="code docutils literal notranslate"><span class="pre">eval_step</span></code> step.                                                 Note that you can control how many batch to evaluate to speed up the                                                 development by the <code class="code docutils literal notranslate"><span class="pre">eval_batch</span></code> argument in <a class="reference internal" href="#s3prl.problem.HearTonic.run" title="s3prl.problem.HearTonic.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>save_step</p></td>
<td><p>(int) - save the checkpoint every <code class="code docutils literal notranslate"><span class="pre">save_step</span></code> step.</p></td>
</tr>
<tr class="row-even"><td><p>gradient_clipping</p></td>
<td><p>(float) - clip the gradient. important for RNNs.</p></td>
</tr>
<tr class="row-odd"><td><p>gradient_accumulate</p></td>
<td><p>(int) - accumulate multiple steps’ gradient before updating network parameters                                                 to simulate large-batch optimization.</p></td>
</tr>
<tr class="row-even"><td><p>valid_metric</p></td>
<td><p>(str) - the metric to select the best valid checkpoint. Different Tasks have different                                                 supported valid_metrics. See <a class="reference internal" href="#s3prl.problem.HearTonic.build_task" title="s3prl.problem.HearTonic.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> for the supported metrics.</p></td>
</tr>
<tr class="row-odd"><td><p>valid_higher_better</p></td>
<td><p>(bool) - some metrics are higher better, while some are lower better                                                 this will affect how to save the best validation checkpoint.</p></td>
</tr>
<tr class="row-even"><td><p>auto_resume</p></td>
<td><p>(bool) - if there are already the last checkpoint in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.HearTonic.run" title="s3prl.problem.HearTonic.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>),                                                 whether to resume from it or delete it and start a new training session.</p></td>
</tr>
<tr class="row-odd"><td><p>resume_ckpt_dir</p></td>
<td><p>(str) - you can directly specify the checkpoint path to resume which is not necessary                                                 in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.HearTonic.run" title="s3prl.problem.HearTonic.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>).</p></td>
</tr>
<tr class="row-even"><td><p>seed</p></td>
<td><p>(int) - fix the seed before the training start</p></td>
</tr>
<tr class="row-odd"><td><p>keep_num_ckpts</p></td>
<td><p>(int) - to prevent saving too many checkpoints, only save the <code class="code docutils literal notranslate"><span class="pre">keep_num_ckpts</span></code>                                                 latest checkpoints and delete the old ones.</p></td>
</tr>
<tr class="row-even"><td><p>use_scheduler</p></td>
<td><p>(bool) - whether to use the scheduler</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="hearvocal">
<h2>HearVocal<a class="headerlink" href="#hearvocal" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="s3prl.problem.HearVocal">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">s3prl.problem.</span></span><span class="sig-name descname"><span class="pre">HearVocal</span></span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_vocal.html#HearVocal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_vocal.py#L10-L78"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVocal" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="s3prl.problem.common.hear_esc50.html#s3prl.problem.common.hear_esc50.HearESC50" title="s3prl.problem.common.hear_esc50.HearESC50"><code class="xref py py-class docutils literal notranslate"><span class="pre">HearESC50</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVocal.default_config">
<span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_vocal.html#HearVocal.default_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_vocal.py#L11-L78"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVocal.default_config" title="Permalink to this definition">#</a></dt>
<dd><p>The default arguments for <a class="reference internal" href="#s3prl.problem.HearVocal.run" title="s3prl.problem.HearVocal.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> in yaml.
Note that for the fields with inner values, like <code class="code docutils literal notranslate"><span class="pre">build_model</span></code>,
the outer field name corresponds to a method name, so you can find the method
<a class="reference internal" href="#s3prl.problem.HearVocal.build_model" title="s3prl.problem.HearVocal.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>. Furthermore, the values inside that field will be
directly passed into the method. So by changing these inner values, you
can directly affect the behavior of the corresponding method. See the method
documentation for all the supported arguments and their meanings.</p>
<p>The methods affected by the following config are: <a class="reference internal" href="#s3prl.problem.HearVocal.prepare_data" title="s3prl.problem.HearVocal.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> <a class="reference internal" href="#s3prl.problem.HearVocal.build_batch_sampler" title="s3prl.problem.HearVocal.build_batch_sampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_batch_sampler</span></code></a> <a class="reference internal" href="#s3prl.problem.HearVocal.build_upstream" title="s3prl.problem.HearVocal.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a> <a class="reference internal" href="#s3prl.problem.HearVocal.build_featurizer" title="s3prl.problem.HearVocal.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a> <a class="reference internal" href="#s3prl.problem.HearVocal.build_downstream" title="s3prl.problem.HearVocal.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a> <a class="reference internal" href="#s3prl.problem.HearVocal.build_model" title="s3prl.problem.HearVocal.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> <a class="reference internal" href="#s3prl.problem.HearVocal.build_task" title="s3prl.problem.HearVocal.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> <a class="reference internal" href="#s3prl.problem.HearVocal.build_optimizer" title="s3prl.problem.HearVocal.build_optimizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_optimizer</span></code></a> <a class="reference internal" href="#s3prl.problem.HearVocal.build_scheduler" title="s3prl.problem.HearVocal.build_scheduler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_scheduler</span></code></a> <a class="reference internal" href="#s3prl.problem.HearVocal.save_model" title="s3prl.problem.HearVocal.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a> <a class="reference internal" href="#s3prl.problem.HearVocal.save_task" title="s3prl.problem.HearVocal.save_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_task</span></code></a> <a class="reference internal" href="#s3prl.problem.HearVocal.train" title="s3prl.problem.HearVocal.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> <a class="reference internal" href="#s3prl.problem.HearVocal.evaluate" title="s3prl.problem.HearVocal.evaluate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate</span></code></a></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">start</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="nt">stop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">target_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">cache_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">remove_all_cache</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">prepare_data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">dataset_root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="w">  </span><span class="nt">test_fold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="w">  </span><span class="nt">num_folds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">3</span>
<span class="nt">build_batch_sampler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">train</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">32</span>
<span class="w">    </span><span class="nt">shuffle</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">valid</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">test</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="nt">build_upstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">build_featurizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">layer_selections</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="nt">normalize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_downstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">hidden_layers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">  </span><span class="nt">pooling_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MeanPooling</span>
<span class="nt">build_model</span><span class="p">:</span>
<span class="w">  </span><span class="nt">upstream_trainable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_task</span><span class="p">:</span>
<span class="w">  </span><span class="nt">prediction_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">multiclass</span>
<span class="w">  </span><span class="nt">scores</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mAP</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top1_acc</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">d_prime</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aucroc</span>
<span class="nt">build_optimizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Adam</span>
<span class="w">  </span><span class="nt">conf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">lr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.001</span>
<span class="nt">build_scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ExponentialLR</span>
<span class="w">  </span><span class="nt">gamma</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.9</span>
<span class="nt">save_model</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">save_task</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">train</span><span class="p">:</span>
<span class="w">  </span><span class="nt">total_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">150000</span>
<span class="w">  </span><span class="nt">log_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">  </span><span class="nt">eval_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span>
<span class="w">  </span><span class="nt">save_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">  </span><span class="nt">gradient_clipping</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0</span>
<span class="w">  </span><span class="nt">gradient_accumulate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">valid_metric</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mAP</span>
<span class="w">  </span><span class="nt">valid_higher_better</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">auto_resume</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">resume_ckpt_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">evaluate</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVocal.build_batch_sampler">
<span class="sig-name descname"><span class="pre">build_batch_sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L213-L229"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVocal.build_batch_sampler" title="Permalink to this definition">#</a></dt>
<dd><p>Return the batch sampler for torch DataLoader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_batch_sampler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearVocal.default_config" title="s3prl.problem.HearVocal.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>train</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>valid</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-even"><td><p>test</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">mode</span></code> specific csv from <a class="reference internal" href="#s3prl.problem.HearVocal.prepare_data" title="s3prl.problem.HearVocal.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>dataset</strong> – the dataset from <a class="reference internal" href="#s3prl.problem.HearVocal.build_dataset" title="s3prl.problem.HearVocal.build_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_dataset</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>batch sampler for torch DataLoader</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVocal.build_collate_fn">
<span class="sig-name descname"><span class="pre">build_collate_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L143-L156"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVocal.build_collate_fn" title="Permalink to this definition">#</a></dt>
<dd><p>By default returns <code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataset.base.default_collate_fn</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_collate_fn</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearVocal.default_config" title="s3prl.problem.HearVocal.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train, valid, or test</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>callable</p>
<p>the collate_fn for torch DataLoader in train/valid/test <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVocal.build_dataset">
<span class="sig-name descname"><span class="pre">build_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_shift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L172-L211"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVocal.build_dataset" title="Permalink to this definition">#</a></dt>
<dd><p>Build the dataset for train/valid/test.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_dataset</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearVocal.default_config" title="s3prl.problem.HearVocal.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>. with <code class="code docutils literal notranslate"><span class="pre">train</span></code>, <code class="code docutils literal notranslate"><span class="pre">valid</span></code>, <code class="code docutils literal notranslate"><span class="pre">test</span></code> keys, each
is a dictionary with the following supported options:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>max_secs</p></td>
<td><p>(float) - If a waveform is longer than <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds, randomly crop the waveform into <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds</p></td>
</tr>
<tr class="row-odd"><td><p>sox_effects</p></td>
<td><p>(List[List[str]]) - If not None, apply sox effects on the utterance</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – The metadata csv file for the specific <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p></li>
<li><p><strong>encoder_path</strong> (<em>str</em>) – The pickled encoder path for encoding the labels</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch Dataset</p>
<p>For all train/valid/test mode, the dataset should return each item as a dictionary
containing the following keys:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>x</p></td>
<td><p>(torch.FloatTensor) - the waveform in (seq_len, 1)</p></td>
</tr>
<tr class="row-odd"><td><p>x_len</p></td>
<td><p>(int) - the waveform length <code class="code docutils literal notranslate"><span class="pre">seq_len</span></code></p></td>
</tr>
<tr class="row-even"><td><p>class_id</p></td>
<td><p>(int) - the encoded class id</p></td>
</tr>
<tr class="row-odd"><td><p>label</p></td>
<td><p>(str) - the class name</p></td>
</tr>
<tr class="row-even"><td><p>unique_name</p></td>
<td><p>(str) - the unique id for this datapoint</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVocal.build_downstream">
<span class="sig-name descname"><span class="pre">build_downstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L231-L240"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVocal.build_downstream" title="Permalink to this definition">#</a></dt>
<dd><p>Return the task-specific downstream model.
By default build the <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code> model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearVocal.default_config" title="s3prl.problem.HearVocal.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments of <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code></p></li>
<li><p><strong>downstream_input_size</strong> (<em>int</em>) – the required input size of the model</p></li>
<li><p><strong>downstream_output_size</strong> (<em>int</em>) – the required output size of the model</p></li>
<li><p><strong>downstream_input_stride</strong> (<em>int</em>) – the input feature’s stride (from 16 KHz)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUtteranceModel" title="s3prl.nn.interface.AbsUtteranceModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUtteranceModel</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVocal.build_encoder">
<span class="sig-name descname"><span class="pre">build_encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_csv_paths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L142-L170"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVocal.build_encoder" title="Permalink to this definition">#</a></dt>
<dd><p>Build the encoder (for the labels) given the data metadata, and return the saved encoder path.
By default generate and save a <a class="reference internal" href="s3prl.dataio.encoder.html#s3prl.dataio.encoder.CategoryEncoder" title="s3prl.dataio.encoder.CategoryEncoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataio.encoder.CategoryEncoder</span></code></a> from the <code class="code docutils literal notranslate"><span class="pre">label</span></code> column of all the csv files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_encoder</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearVocal.default_config" title="s3prl.problem.HearVocal.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Save your encoder into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>train_csv_path</strong> (<em>str</em>) – the train path from <a class="reference internal" href="#s3prl.problem.HearVocal.prepare_data" title="s3prl.problem.HearVocal.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>valid_csv_path</strong> (<em>str</em>) – the valid path from <a class="reference internal" href="#s3prl.problem.HearVocal.prepare_data" title="s3prl.problem.HearVocal.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>test_csv_paths</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – the test paths from <a class="reference internal" href="#s3prl.problem.HearVocal.prepare_data" title="s3prl.problem.HearVocal.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>str</p>
<p>encoder_path: The encoder should be saved in the pickle format</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVocal.build_featurizer">
<span class="sig-name descname"><span class="pre">build_featurizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upstream</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L175-L192"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVocal.build_featurizer" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the featurizer with <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearVocal.default_config" title="s3prl.problem.HearVocal.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p></li>
<li><p><strong>upstream</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">AbsUpstream</span></code>) – the upstream model built by <a class="reference internal" href="#s3prl.problem.HearVocal.build_upstream" title="s3prl.problem.HearVocal.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsFeaturizer" title="s3prl.nn.interface.AbsFeaturizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsFeaturizer</span></code></a></p>
<p>Return the featurizer model. The featurizer is used to reduce the multiple
hidden states returned from the upstream model (built by <a class="reference internal" href="#s3prl.problem.HearVocal.build_upstream" title="s3prl.problem.HearVocal.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>)
into a single hidden state, so can be easliy fed into the downstream model</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVocal.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L194-L231"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVocal.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>By default build model with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearVocal.default_config" title="s3prl.problem.HearVocal.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p></li>
<li><p><strong>model_output_size</strong> (<em>int</em>) – the required model’s output hidden size</p></li>
<li><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearVocal.default_config" title="s3prl.problem.HearVocal.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearVocal.build_upstream" title="s3prl.problem.HearVocal.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearVocal.default_config" title="s3prl.problem.HearVocal.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearVocal.build_featurizer" title="s3prl.problem.HearVocal.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a></p></li>
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearVocal.default_config" title="s3prl.problem.HearVocal.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearVocal.build_downstream" title="s3prl.problem.HearVocal.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch.nn.Module</p>
<p>Return the entire model for the task, which takes the direct items from DataLoader as the input.
Usually, the components can be built by <a class="reference internal" href="#s3prl.problem.HearVocal.build_upstream" title="s3prl.problem.HearVocal.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>, <a class="reference internal" href="#s3prl.problem.HearVocal.build_featurizer" title="s3prl.problem.HearVocal.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a>,
<a class="reference internal" href="#s3prl.problem.HearVocal.build_downstream" title="s3prl.problem.HearVocal.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a>, and are concated together to get the final model.
The upstream extracts multiple hidden states, the featuizer reduce them into a single hidden state,
and the downstream takes the hidden states as the feature for the downstream-specific model.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVocal.build_optimizer">
<span class="sig-name descname"><span class="pre">build_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L233-L258"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVocal.build_optimizer" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_optimizer</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearVocal.default_config" title="s3prl.problem.HearVocal.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to below</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the optimizer class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the optimizer class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;lr&quot;:</span> <span class="pre">1.0e-4}</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>parameters</strong> (<em>iterable</em>) – the standard params accepted by <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code></p>
<p>An optimizer following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVocal.build_scheduler">
<span class="sig-name descname"><span class="pre">build_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L260-L285"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVocal.build_scheduler" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_scheduler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearVocal.default_config" title="s3prl.problem.HearVocal.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the scheduler class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the scheduler class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;gamma&quot;:</span> <span class="pre">0.01}</span></code> for <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler.StepLR</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>optimizer</strong> – the standard torch optimizer accepted by Scheduler in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch scheduler</p>
<p>A scheduler following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVocal.build_task">
<span class="sig-name descname"><span class="pre">build_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L242-L250"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVocal.build_task" title="Permalink to this definition">#</a></dt>
<dd><p>Build the task, which defines the logics for every train/valid/test forward step for the <code class="code docutils literal notranslate"><span class="pre">model</span></code>,
and the logics for how to reduce all the batch results from multiple train/valid/test steps into metrics</p>
<p>By default build <code class="xref py py-obj docutils literal notranslate"><span class="pre">UtteranceClassificationTask</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearVocal.default_config" title="s3prl.problem.HearVocal.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model built by <a class="reference internal" href="#s3prl.problem.HearVocal.build_model" title="s3prl.problem.HearVocal.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a></p></li>
<li><p><strong>encoder</strong> – the encoder built by <a class="reference internal" href="#s3prl.problem.HearVocal.build_encoder" title="s3prl.problem.HearVocal.build_encoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_encoder</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Task</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVocal.build_upstream">
<span class="sig-name descname"><span class="pre">build_upstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L158-L173"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVocal.build_upstream" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the upstream with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearVocal.default_config" title="s3prl.problem.HearVocal.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUpstream" title="s3prl.nn.interface.AbsUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUpstream</span></code></a></p>
<p>Return an upstream model, whose forward takes the waveform input and returns
multiple hidden states as features.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVocal.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L660-L707"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVocal.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>The evaluate routine used by <a class="reference internal" href="#s3prl.problem.HearVocal.train" title="s3prl.problem.HearVocal.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> (during validation phase) and <a class="reference internal" href="#s3prl.problem.HearVocal.run" title="s3prl.problem.HearVocal.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>
(during testing phase).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evaluate</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearVocal.default_config" title="s3prl.problem.HearVocal.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVocal.get_class_from_name">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_class_from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L129-L141"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVocal.get_class_from_name" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">__name__</span></code> of the problem class</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Problem</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVocal.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L752-L772"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVocal.load_model" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model_ckpt_dir</strong> (<em>str</em>) – Restore the model with <a class="reference internal" href="#s3prl.problem.HearVocal.build_model" title="s3prl.problem.HearVocal.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> and the checkpoint
saved in this directory.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVocal.load_model_and_task">
<span class="sig-name descname"><span class="pre">load_model_and_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ckpts_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L884-L902"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVocal.load_model_and_task" title="Permalink to this definition">#</a></dt>
<dd><p>This is a helper method to combine <a class="reference internal" href="#s3prl.problem.HearVocal.load_model" title="s3prl.problem.HearVocal.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a> and <a class="reference internal" href="#s3prl.problem.HearVocal.load_task" title="s3prl.problem.HearVocal.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>
together to directly load the model and the task. This method assumes
the model is saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'model'</span></code> and the task is
saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'task'</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>model (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>)</p></li>
<li><p>task (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a>)</p></li>
</ol>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVocal.load_task">
<span class="sig-name descname"><span class="pre">load_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L833-L882"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVocal.load_task" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – Restore the task with <a class="reference internal" href="#s3prl.problem.HearVocal.build_task" title="s3prl.problem.HearVocal.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> and the checkpoint
saved in this directory.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model for the task, since the model is separately saved
and is required for <a class="reference internal" href="#s3prl.problem.HearVocal.build_task" title="s3prl.problem.HearVocal.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a>.</p></li>
<li><p><strong>task_overrides</strong> (<em>dict</em>) – overrides the saved initialization arguments, so can change
the loaded task’s behavior. Like, change the decoding hyperparameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVocal.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L954-L995"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVocal.main" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVocal.prepare_data">
<span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_esc50.py#L151-L160"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVocal.prepare_data" title="Permalink to this definition">#</a></dt>
<dd><p>Prepare the task-specific data metadata (path, labels…).
By default call <code class="xref py py-obj docutils literal notranslate"><span class="pre">voxceleb1_for_sid</span></code> with <code class="code docutils literal notranslate"><span class="pre">**prepare_data</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prepare_data</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearVocal.default_config" title="s3prl.problem.HearVocal.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments in <code class="xref py py-obj docutils literal notranslate"><span class="pre">voxceleb1_for_sid</span></code></p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Parse your corpus and save the csv file into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the parsing or preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>train_path (str)</p></li>
<li><p>valid_path (str)</p></li>
<li><p>test_paths (List[str])</p></li>
</ol>
<p>Each path (str) should be a csv file containing the following columns:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>column</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>(str) - the unique id for this data point</p></td>
</tr>
<tr class="row-odd"><td><p>wav_path</p></td>
<td><p>(str) - the absolute path of the waveform file</p></td>
</tr>
<tr class="row-even"><td><p>label</p></td>
<td><p>(str) - a string label of the waveform</p></td>
</tr>
<tr class="row-odd"><td><p>start_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">start_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load from the beginning.</p></td>
</tr>
<tr class="row-even"><td><p>end_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">end_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load to the end.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVocal.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_all_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cuda'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/run.py#L26-L318"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVocal.run" title="Permalink to this definition">#</a></dt>
<dd><div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>stage</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Parse the corpus and save the metadata file (waveform path, label…)</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Build the encoder to encode the labels</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Train the model</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Evaluate the model on multiple test sets</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_dir</strong> (<em>str</em>) – The directory that stores the script result.</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – The directory that caches the processed data.
Default: /home/user/.cache/s3prl/data</p></li>
<li><p><strong>remove_all_cache</strong> (<em>bool</em>) – Whether to remove all the cache stored under <cite>cache_dir</cite>.
Default: False</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting stage of the problem script.
Default: 0</p></li>
<li><p><strong>stop</strong> (<em>int</em>) – The stoping stage of the problem script, set <cite>None</cite> to reach the final stage.
Default: None</p></li>
<li><p><strong>num_workers</strong> (<em>int</em>) – num_workers for all the torch DataLoder</p></li>
<li><p><strong>eval_batch</strong> (<em>int</em>) – During evaluation (valid or test), limit the number of batch.
This is helpful for the fast development to check everything won’t crash.
If is -1, disable this feature and evaluate the entire epoch.
Default: -1</p></li>
<li><p><strong>device</strong> (<em>str</em>) – The device type for all torch-related operation: “cpu” or “cuda”
Default: “cuda”</p></li>
<li><p><strong>world_size</strong> (<em>int</em>) – How many processes are running this script simultaneously (in parallel).
Usually this is just 1, however if you are runnig distributed training,
this should be &gt; 1.
Default: 1</p></li>
<li><p><strong>rank</strong> (<em>int</em>) – When distributed training, world_size &gt; 1. Take <code class="code docutils literal notranslate"><span class="pre">world_size</span> <span class="pre">==</span> <span class="pre">8</span></code> for
example, this means 8 processes (8 GPUs) are runing in parallel. The script
needs to know which process among 8 processes it is. In this case, <code class="code docutils literal notranslate"><span class="pre">rank</span></code>
can range from 0~7. All the 8 processes have the same <code class="code docutils literal notranslate"><span class="pre">world_size</span></code> but
different <code class="code docutils literal notranslate"><span class="pre">rank</span></code> (process id).</p></li>
<li><p><strong>test_ckpt_dir</strong> (<em>str</em>) – Specify the checkpoint path for testing. If not, use the validation best
checkpoint under the given <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> directory.</p></li>
<li><p><strong>**kwds</strong> – The other arguments like <code class="code docutils literal notranslate"><span class="pre">prepare_data</span></code> and <code class="code docutils literal notranslate"><span class="pre">build_model</span></code> are
method specific-arguments for methods like <a class="reference internal" href="#s3prl.problem.HearVocal.prepare_data" title="s3prl.problem.HearVocal.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> and
<a class="reference internal" href="#s3prl.problem.HearVocal.build_model" title="s3prl.problem.HearVocal.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>, and will not be used in the core <a class="reference internal" href="#s3prl.problem.HearVocal.run" title="s3prl.problem.HearVocal.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> logic.
See the specific method documentation for their supported arguments and
meaning</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVocal.save_model">
<span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L709-L750"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVocal.save_model" title="Permalink to this definition">#</a></dt>
<dd><p>Save the model state_dict and the model initialization arguments into the given directory.
If you override this method, it is highly possible you also need to override <a class="reference internal" href="#s3prl.problem.HearVocal.load_model" title="s3prl.problem.HearVocal.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearVocal.default_config" title="s3prl.problem.HearVocal.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_model</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>model_ckpt_dir</strong> (<em>str</em>) – save the model into the this directory.</p></li>
<li><p><strong>build_model_all_args</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.HearVocal.build_model" title="s3prl.problem.HearVocal.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>.
By saving this dictionary, you can easily reconstruct the same model
by calling <a class="reference internal" href="#s3prl.problem.HearVocal.build_model" title="s3prl.problem.HearVocal.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVocal.save_task">
<span class="sig-name descname"><span class="pre">save_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="s3prl.task.base.html#s3prl.task.base.Task" title="s3prl.task.base.Task"><span class="pre">Task</span></a></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L774-L831"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVocal.save_task" title="Permalink to this definition">#</a></dt>
<dd><p>Save the task’s state, <code class="code docutils literal notranslate"><span class="pre">task.get_state()</span></code>, and the initialization arguments into the given
directory. If you override this method, it is highly possible you also need to override
<a class="reference internal" href="#s3prl.problem.HearVocal.load_task" title="s3prl.problem.HearVocal.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearVocal.default_config" title="s3prl.problem.HearVocal.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_task</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – save the task into this directory.</p></li>
<li><p><strong>build_task_all_args_except_model</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.HearVocal.build_task" title="s3prl.problem.HearVocal.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> except
the <code class="code docutils literal notranslate"><span class="pre">model</span></code> argument since the model should be sapartely saved by
<a class="reference internal" href="#s3prl.problem.HearVocal.save_model" title="s3prl.problem.HearVocal.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a>. By saving this dictionary, you can easily reconstruct the same task
by calling <a class="reference internal" href="#s3prl.problem.HearVocal.build_task" title="s3prl.problem.HearVocal.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>task</strong> (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><em>Task</em></a>) – the task to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVocal.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L287-L658"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVocal.train" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearVocal.default_config" title="s3prl.problem.HearVocal.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>total_steps</p></td>
<td><p>(int) - the total optimization steps</p></td>
</tr>
<tr class="row-odd"><td><p>log_step</p></td>
<td><p>(int) - logging frequency. log every <code class="code docutils literal notranslate"><span class="pre">log_step</span></code> step</p></td>
</tr>
<tr class="row-even"><td><p>eval_step</p></td>
<td><p>(int) - evaluation frequency. Evaluate every <code class="code docutils literal notranslate"><span class="pre">eval_step</span></code> step.                                                 Note that you can control how many batch to evaluate to speed up the                                                 development by the <code class="code docutils literal notranslate"><span class="pre">eval_batch</span></code> argument in <a class="reference internal" href="#s3prl.problem.HearVocal.run" title="s3prl.problem.HearVocal.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>save_step</p></td>
<td><p>(int) - save the checkpoint every <code class="code docutils literal notranslate"><span class="pre">save_step</span></code> step.</p></td>
</tr>
<tr class="row-even"><td><p>gradient_clipping</p></td>
<td><p>(float) - clip the gradient. important for RNNs.</p></td>
</tr>
<tr class="row-odd"><td><p>gradient_accumulate</p></td>
<td><p>(int) - accumulate multiple steps’ gradient before updating network parameters                                                 to simulate large-batch optimization.</p></td>
</tr>
<tr class="row-even"><td><p>valid_metric</p></td>
<td><p>(str) - the metric to select the best valid checkpoint. Different Tasks have different                                                 supported valid_metrics. See <a class="reference internal" href="#s3prl.problem.HearVocal.build_task" title="s3prl.problem.HearVocal.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> for the supported metrics.</p></td>
</tr>
<tr class="row-odd"><td><p>valid_higher_better</p></td>
<td><p>(bool) - some metrics are higher better, while some are lower better                                                 this will affect how to save the best validation checkpoint.</p></td>
</tr>
<tr class="row-even"><td><p>auto_resume</p></td>
<td><p>(bool) - if there are already the last checkpoint in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.HearVocal.run" title="s3prl.problem.HearVocal.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>),                                                 whether to resume from it or delete it and start a new training session.</p></td>
</tr>
<tr class="row-odd"><td><p>resume_ckpt_dir</p></td>
<td><p>(str) - you can directly specify the checkpoint path to resume which is not necessary                                                 in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.HearVocal.run" title="s3prl.problem.HearVocal.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>).</p></td>
</tr>
<tr class="row-even"><td><p>seed</p></td>
<td><p>(int) - fix the seed before the training start</p></td>
</tr>
<tr class="row-odd"><td><p>keep_num_ckpts</p></td>
<td><p>(int) - to prevent saving too many checkpoints, only save the <code class="code docutils literal notranslate"><span class="pre">keep_num_ckpts</span></code>                                                 latest checkpoints and delete the old ones.</p></td>
</tr>
<tr class="row-even"><td><p>use_scheduler</p></td>
<td><p>(bool) - whether to use the scheduler</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="hearvoxlingual">
<h2>HearVoxLingual<a class="headerlink" href="#hearvoxlingual" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="s3prl.problem.HearVoxLingual">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">s3prl.problem.</span></span><span class="sig-name descname"><span class="pre">HearVoxLingual</span></span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_vox_lingual.html#HearVoxLingual"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_vox_lingual.py#L10-L78"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVoxLingual" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="s3prl.problem.common.hear_esc50.html#s3prl.problem.common.hear_esc50.HearESC50" title="s3prl.problem.common.hear_esc50.HearESC50"><code class="xref py py-class docutils literal notranslate"><span class="pre">HearESC50</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVoxLingual.default_config">
<span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_vox_lingual.html#HearVoxLingual.default_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_vox_lingual.py#L11-L78"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVoxLingual.default_config" title="Permalink to this definition">#</a></dt>
<dd><p>The default arguments for <a class="reference internal" href="#s3prl.problem.HearVoxLingual.run" title="s3prl.problem.HearVoxLingual.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> in yaml.
Note that for the fields with inner values, like <code class="code docutils literal notranslate"><span class="pre">build_model</span></code>,
the outer field name corresponds to a method name, so you can find the method
<a class="reference internal" href="#s3prl.problem.HearVoxLingual.build_model" title="s3prl.problem.HearVoxLingual.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>. Furthermore, the values inside that field will be
directly passed into the method. So by changing these inner values, you
can directly affect the behavior of the corresponding method. See the method
documentation for all the supported arguments and their meanings.</p>
<p>The methods affected by the following config are: <a class="reference internal" href="#s3prl.problem.HearVoxLingual.prepare_data" title="s3prl.problem.HearVoxLingual.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> <a class="reference internal" href="#s3prl.problem.HearVoxLingual.build_batch_sampler" title="s3prl.problem.HearVoxLingual.build_batch_sampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_batch_sampler</span></code></a> <a class="reference internal" href="#s3prl.problem.HearVoxLingual.build_upstream" title="s3prl.problem.HearVoxLingual.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a> <a class="reference internal" href="#s3prl.problem.HearVoxLingual.build_featurizer" title="s3prl.problem.HearVoxLingual.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a> <a class="reference internal" href="#s3prl.problem.HearVoxLingual.build_downstream" title="s3prl.problem.HearVoxLingual.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a> <a class="reference internal" href="#s3prl.problem.HearVoxLingual.build_model" title="s3prl.problem.HearVoxLingual.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> <a class="reference internal" href="#s3prl.problem.HearVoxLingual.build_task" title="s3prl.problem.HearVoxLingual.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> <a class="reference internal" href="#s3prl.problem.HearVoxLingual.build_optimizer" title="s3prl.problem.HearVoxLingual.build_optimizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_optimizer</span></code></a> <a class="reference internal" href="#s3prl.problem.HearVoxLingual.build_scheduler" title="s3prl.problem.HearVoxLingual.build_scheduler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_scheduler</span></code></a> <a class="reference internal" href="#s3prl.problem.HearVoxLingual.save_model" title="s3prl.problem.HearVoxLingual.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a> <a class="reference internal" href="#s3prl.problem.HearVoxLingual.save_task" title="s3prl.problem.HearVoxLingual.save_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_task</span></code></a> <a class="reference internal" href="#s3prl.problem.HearVoxLingual.train" title="s3prl.problem.HearVoxLingual.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> <a class="reference internal" href="#s3prl.problem.HearVoxLingual.evaluate" title="s3prl.problem.HearVoxLingual.evaluate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate</span></code></a></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">start</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="nt">stop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">target_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">cache_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">remove_all_cache</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">prepare_data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">dataset_root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="w">  </span><span class="nt">test_fold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="w">  </span><span class="nt">num_folds</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="nt">build_batch_sampler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">train</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">32</span>
<span class="w">    </span><span class="nt">shuffle</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">valid</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">test</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="nt">build_upstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">build_featurizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">layer_selections</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="nt">normalize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_downstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">hidden_layers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="w">  </span><span class="nt">pooling_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MeanPooling</span>
<span class="nt">build_model</span><span class="p">:</span>
<span class="w">  </span><span class="nt">upstream_trainable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_task</span><span class="p">:</span>
<span class="w">  </span><span class="nt">prediction_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">multiclass</span>
<span class="w">  </span><span class="nt">scores</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top1_acc</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">d_prime</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">aucroc</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mAP</span>
<span class="nt">build_optimizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Adam</span>
<span class="w">  </span><span class="nt">conf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">lr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.001</span>
<span class="nt">build_scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ExponentialLR</span>
<span class="w">  </span><span class="nt">gamma</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.9</span>
<span class="nt">save_model</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">save_task</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">train</span><span class="p">:</span>
<span class="w">  </span><span class="nt">total_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">150000</span>
<span class="w">  </span><span class="nt">log_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">  </span><span class="nt">eval_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1000</span>
<span class="w">  </span><span class="nt">save_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">  </span><span class="nt">gradient_clipping</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0</span>
<span class="w">  </span><span class="nt">gradient_accumulate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">valid_metric</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">top1_acc</span>
<span class="w">  </span><span class="nt">valid_higher_better</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">auto_resume</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">resume_ckpt_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">evaluate</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVoxLingual.build_batch_sampler">
<span class="sig-name descname"><span class="pre">build_batch_sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L213-L229"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVoxLingual.build_batch_sampler" title="Permalink to this definition">#</a></dt>
<dd><p>Return the batch sampler for torch DataLoader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_batch_sampler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearVoxLingual.default_config" title="s3prl.problem.HearVoxLingual.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>train</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>valid</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-even"><td><p>test</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">mode</span></code> specific csv from <a class="reference internal" href="#s3prl.problem.HearVoxLingual.prepare_data" title="s3prl.problem.HearVoxLingual.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>dataset</strong> – the dataset from <a class="reference internal" href="#s3prl.problem.HearVoxLingual.build_dataset" title="s3prl.problem.HearVoxLingual.build_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_dataset</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>batch sampler for torch DataLoader</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVoxLingual.build_collate_fn">
<span class="sig-name descname"><span class="pre">build_collate_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L143-L156"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVoxLingual.build_collate_fn" title="Permalink to this definition">#</a></dt>
<dd><p>By default returns <code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataset.base.default_collate_fn</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_collate_fn</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearVoxLingual.default_config" title="s3prl.problem.HearVoxLingual.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train, valid, or test</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>callable</p>
<p>the collate_fn for torch DataLoader in train/valid/test <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVoxLingual.build_dataset">
<span class="sig-name descname"><span class="pre">build_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_shift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L172-L211"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVoxLingual.build_dataset" title="Permalink to this definition">#</a></dt>
<dd><p>Build the dataset for train/valid/test.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_dataset</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearVoxLingual.default_config" title="s3prl.problem.HearVoxLingual.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>. with <code class="code docutils literal notranslate"><span class="pre">train</span></code>, <code class="code docutils literal notranslate"><span class="pre">valid</span></code>, <code class="code docutils literal notranslate"><span class="pre">test</span></code> keys, each
is a dictionary with the following supported options:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>max_secs</p></td>
<td><p>(float) - If a waveform is longer than <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds, randomly crop the waveform into <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds</p></td>
</tr>
<tr class="row-odd"><td><p>sox_effects</p></td>
<td><p>(List[List[str]]) - If not None, apply sox effects on the utterance</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – The metadata csv file for the specific <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p></li>
<li><p><strong>encoder_path</strong> (<em>str</em>) – The pickled encoder path for encoding the labels</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch Dataset</p>
<p>For all train/valid/test mode, the dataset should return each item as a dictionary
containing the following keys:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>x</p></td>
<td><p>(torch.FloatTensor) - the waveform in (seq_len, 1)</p></td>
</tr>
<tr class="row-odd"><td><p>x_len</p></td>
<td><p>(int) - the waveform length <code class="code docutils literal notranslate"><span class="pre">seq_len</span></code></p></td>
</tr>
<tr class="row-even"><td><p>class_id</p></td>
<td><p>(int) - the encoded class id</p></td>
</tr>
<tr class="row-odd"><td><p>label</p></td>
<td><p>(str) - the class name</p></td>
</tr>
<tr class="row-even"><td><p>unique_name</p></td>
<td><p>(str) - the unique id for this datapoint</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVoxLingual.build_downstream">
<span class="sig-name descname"><span class="pre">build_downstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L231-L240"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVoxLingual.build_downstream" title="Permalink to this definition">#</a></dt>
<dd><p>Return the task-specific downstream model.
By default build the <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code> model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearVoxLingual.default_config" title="s3prl.problem.HearVoxLingual.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments of <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code></p></li>
<li><p><strong>downstream_input_size</strong> (<em>int</em>) – the required input size of the model</p></li>
<li><p><strong>downstream_output_size</strong> (<em>int</em>) – the required output size of the model</p></li>
<li><p><strong>downstream_input_stride</strong> (<em>int</em>) – the input feature’s stride (from 16 KHz)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUtteranceModel" title="s3prl.nn.interface.AbsUtteranceModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUtteranceModel</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVoxLingual.build_encoder">
<span class="sig-name descname"><span class="pre">build_encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_csv_paths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L142-L170"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVoxLingual.build_encoder" title="Permalink to this definition">#</a></dt>
<dd><p>Build the encoder (for the labels) given the data metadata, and return the saved encoder path.
By default generate and save a <a class="reference internal" href="s3prl.dataio.encoder.html#s3prl.dataio.encoder.CategoryEncoder" title="s3prl.dataio.encoder.CategoryEncoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataio.encoder.CategoryEncoder</span></code></a> from the <code class="code docutils literal notranslate"><span class="pre">label</span></code> column of all the csv files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_encoder</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearVoxLingual.default_config" title="s3prl.problem.HearVoxLingual.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Save your encoder into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>train_csv_path</strong> (<em>str</em>) – the train path from <a class="reference internal" href="#s3prl.problem.HearVoxLingual.prepare_data" title="s3prl.problem.HearVoxLingual.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>valid_csv_path</strong> (<em>str</em>) – the valid path from <a class="reference internal" href="#s3prl.problem.HearVoxLingual.prepare_data" title="s3prl.problem.HearVoxLingual.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>test_csv_paths</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – the test paths from <a class="reference internal" href="#s3prl.problem.HearVoxLingual.prepare_data" title="s3prl.problem.HearVoxLingual.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>str</p>
<p>encoder_path: The encoder should be saved in the pickle format</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVoxLingual.build_featurizer">
<span class="sig-name descname"><span class="pre">build_featurizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upstream</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L175-L192"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVoxLingual.build_featurizer" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the featurizer with <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearVoxLingual.default_config" title="s3prl.problem.HearVoxLingual.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p></li>
<li><p><strong>upstream</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">AbsUpstream</span></code>) – the upstream model built by <a class="reference internal" href="#s3prl.problem.HearVoxLingual.build_upstream" title="s3prl.problem.HearVoxLingual.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsFeaturizer" title="s3prl.nn.interface.AbsFeaturizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsFeaturizer</span></code></a></p>
<p>Return the featurizer model. The featurizer is used to reduce the multiple
hidden states returned from the upstream model (built by <a class="reference internal" href="#s3prl.problem.HearVoxLingual.build_upstream" title="s3prl.problem.HearVoxLingual.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>)
into a single hidden state, so can be easliy fed into the downstream model</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVoxLingual.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L194-L231"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVoxLingual.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>By default build model with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearVoxLingual.default_config" title="s3prl.problem.HearVoxLingual.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p></li>
<li><p><strong>model_output_size</strong> (<em>int</em>) – the required model’s output hidden size</p></li>
<li><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearVoxLingual.default_config" title="s3prl.problem.HearVoxLingual.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearVoxLingual.build_upstream" title="s3prl.problem.HearVoxLingual.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearVoxLingual.default_config" title="s3prl.problem.HearVoxLingual.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearVoxLingual.build_featurizer" title="s3prl.problem.HearVoxLingual.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a></p></li>
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearVoxLingual.default_config" title="s3prl.problem.HearVoxLingual.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearVoxLingual.build_downstream" title="s3prl.problem.HearVoxLingual.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch.nn.Module</p>
<p>Return the entire model for the task, which takes the direct items from DataLoader as the input.
Usually, the components can be built by <a class="reference internal" href="#s3prl.problem.HearVoxLingual.build_upstream" title="s3prl.problem.HearVoxLingual.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>, <a class="reference internal" href="#s3prl.problem.HearVoxLingual.build_featurizer" title="s3prl.problem.HearVoxLingual.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a>,
<a class="reference internal" href="#s3prl.problem.HearVoxLingual.build_downstream" title="s3prl.problem.HearVoxLingual.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a>, and are concated together to get the final model.
The upstream extracts multiple hidden states, the featuizer reduce them into a single hidden state,
and the downstream takes the hidden states as the feature for the downstream-specific model.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVoxLingual.build_optimizer">
<span class="sig-name descname"><span class="pre">build_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L233-L258"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVoxLingual.build_optimizer" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_optimizer</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearVoxLingual.default_config" title="s3prl.problem.HearVoxLingual.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to below</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the optimizer class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the optimizer class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;lr&quot;:</span> <span class="pre">1.0e-4}</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>parameters</strong> (<em>iterable</em>) – the standard params accepted by <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code></p>
<p>An optimizer following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVoxLingual.build_scheduler">
<span class="sig-name descname"><span class="pre">build_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L260-L285"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVoxLingual.build_scheduler" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_scheduler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearVoxLingual.default_config" title="s3prl.problem.HearVoxLingual.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the scheduler class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the scheduler class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;gamma&quot;:</span> <span class="pre">0.01}</span></code> for <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler.StepLR</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>optimizer</strong> – the standard torch optimizer accepted by Scheduler in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch scheduler</p>
<p>A scheduler following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVoxLingual.build_task">
<span class="sig-name descname"><span class="pre">build_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L242-L250"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVoxLingual.build_task" title="Permalink to this definition">#</a></dt>
<dd><p>Build the task, which defines the logics for every train/valid/test forward step for the <code class="code docutils literal notranslate"><span class="pre">model</span></code>,
and the logics for how to reduce all the batch results from multiple train/valid/test steps into metrics</p>
<p>By default build <code class="xref py py-obj docutils literal notranslate"><span class="pre">UtteranceClassificationTask</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearVoxLingual.default_config" title="s3prl.problem.HearVoxLingual.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model built by <a class="reference internal" href="#s3prl.problem.HearVoxLingual.build_model" title="s3prl.problem.HearVoxLingual.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a></p></li>
<li><p><strong>encoder</strong> – the encoder built by <a class="reference internal" href="#s3prl.problem.HearVoxLingual.build_encoder" title="s3prl.problem.HearVoxLingual.build_encoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_encoder</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Task</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVoxLingual.build_upstream">
<span class="sig-name descname"><span class="pre">build_upstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L158-L173"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVoxLingual.build_upstream" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the upstream with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearVoxLingual.default_config" title="s3prl.problem.HearVoxLingual.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUpstream" title="s3prl.nn.interface.AbsUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUpstream</span></code></a></p>
<p>Return an upstream model, whose forward takes the waveform input and returns
multiple hidden states as features.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVoxLingual.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L660-L707"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVoxLingual.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>The evaluate routine used by <a class="reference internal" href="#s3prl.problem.HearVoxLingual.train" title="s3prl.problem.HearVoxLingual.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> (during validation phase) and <a class="reference internal" href="#s3prl.problem.HearVoxLingual.run" title="s3prl.problem.HearVoxLingual.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>
(during testing phase).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evaluate</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearVoxLingual.default_config" title="s3prl.problem.HearVoxLingual.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVoxLingual.get_class_from_name">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_class_from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L129-L141"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVoxLingual.get_class_from_name" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">__name__</span></code> of the problem class</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Problem</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVoxLingual.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L752-L772"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVoxLingual.load_model" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model_ckpt_dir</strong> (<em>str</em>) – Restore the model with <a class="reference internal" href="#s3prl.problem.HearVoxLingual.build_model" title="s3prl.problem.HearVoxLingual.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> and the checkpoint
saved in this directory.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVoxLingual.load_model_and_task">
<span class="sig-name descname"><span class="pre">load_model_and_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ckpts_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L884-L902"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVoxLingual.load_model_and_task" title="Permalink to this definition">#</a></dt>
<dd><p>This is a helper method to combine <a class="reference internal" href="#s3prl.problem.HearVoxLingual.load_model" title="s3prl.problem.HearVoxLingual.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a> and <a class="reference internal" href="#s3prl.problem.HearVoxLingual.load_task" title="s3prl.problem.HearVoxLingual.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>
together to directly load the model and the task. This method assumes
the model is saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'model'</span></code> and the task is
saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'task'</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>model (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>)</p></li>
<li><p>task (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a>)</p></li>
</ol>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVoxLingual.load_task">
<span class="sig-name descname"><span class="pre">load_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L833-L882"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVoxLingual.load_task" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – Restore the task with <a class="reference internal" href="#s3prl.problem.HearVoxLingual.build_task" title="s3prl.problem.HearVoxLingual.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> and the checkpoint
saved in this directory.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model for the task, since the model is separately saved
and is required for <a class="reference internal" href="#s3prl.problem.HearVoxLingual.build_task" title="s3prl.problem.HearVoxLingual.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a>.</p></li>
<li><p><strong>task_overrides</strong> (<em>dict</em>) – overrides the saved initialization arguments, so can change
the loaded task’s behavior. Like, change the decoding hyperparameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVoxLingual.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L954-L995"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVoxLingual.main" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVoxLingual.prepare_data">
<span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_esc50.py#L151-L160"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVoxLingual.prepare_data" title="Permalink to this definition">#</a></dt>
<dd><p>Prepare the task-specific data metadata (path, labels…).
By default call <code class="xref py py-obj docutils literal notranslate"><span class="pre">voxceleb1_for_sid</span></code> with <code class="code docutils literal notranslate"><span class="pre">**prepare_data</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prepare_data</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearVoxLingual.default_config" title="s3prl.problem.HearVoxLingual.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments in <code class="xref py py-obj docutils literal notranslate"><span class="pre">voxceleb1_for_sid</span></code></p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Parse your corpus and save the csv file into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the parsing or preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>train_path (str)</p></li>
<li><p>valid_path (str)</p></li>
<li><p>test_paths (List[str])</p></li>
</ol>
<p>Each path (str) should be a csv file containing the following columns:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>column</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>(str) - the unique id for this data point</p></td>
</tr>
<tr class="row-odd"><td><p>wav_path</p></td>
<td><p>(str) - the absolute path of the waveform file</p></td>
</tr>
<tr class="row-even"><td><p>label</p></td>
<td><p>(str) - a string label of the waveform</p></td>
</tr>
<tr class="row-odd"><td><p>start_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">start_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load from the beginning.</p></td>
</tr>
<tr class="row-even"><td><p>end_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">end_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load to the end.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVoxLingual.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_all_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cuda'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/run.py#L26-L318"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVoxLingual.run" title="Permalink to this definition">#</a></dt>
<dd><div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>stage</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Parse the corpus and save the metadata file (waveform path, label…)</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Build the encoder to encode the labels</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Train the model</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Evaluate the model on multiple test sets</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_dir</strong> (<em>str</em>) – The directory that stores the script result.</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – The directory that caches the processed data.
Default: /home/user/.cache/s3prl/data</p></li>
<li><p><strong>remove_all_cache</strong> (<em>bool</em>) – Whether to remove all the cache stored under <cite>cache_dir</cite>.
Default: False</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting stage of the problem script.
Default: 0</p></li>
<li><p><strong>stop</strong> (<em>int</em>) – The stoping stage of the problem script, set <cite>None</cite> to reach the final stage.
Default: None</p></li>
<li><p><strong>num_workers</strong> (<em>int</em>) – num_workers for all the torch DataLoder</p></li>
<li><p><strong>eval_batch</strong> (<em>int</em>) – During evaluation (valid or test), limit the number of batch.
This is helpful for the fast development to check everything won’t crash.
If is -1, disable this feature and evaluate the entire epoch.
Default: -1</p></li>
<li><p><strong>device</strong> (<em>str</em>) – The device type for all torch-related operation: “cpu” or “cuda”
Default: “cuda”</p></li>
<li><p><strong>world_size</strong> (<em>int</em>) – How many processes are running this script simultaneously (in parallel).
Usually this is just 1, however if you are runnig distributed training,
this should be &gt; 1.
Default: 1</p></li>
<li><p><strong>rank</strong> (<em>int</em>) – When distributed training, world_size &gt; 1. Take <code class="code docutils literal notranslate"><span class="pre">world_size</span> <span class="pre">==</span> <span class="pre">8</span></code> for
example, this means 8 processes (8 GPUs) are runing in parallel. The script
needs to know which process among 8 processes it is. In this case, <code class="code docutils literal notranslate"><span class="pre">rank</span></code>
can range from 0~7. All the 8 processes have the same <code class="code docutils literal notranslate"><span class="pre">world_size</span></code> but
different <code class="code docutils literal notranslate"><span class="pre">rank</span></code> (process id).</p></li>
<li><p><strong>test_ckpt_dir</strong> (<em>str</em>) – Specify the checkpoint path for testing. If not, use the validation best
checkpoint under the given <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> directory.</p></li>
<li><p><strong>**kwds</strong> – The other arguments like <code class="code docutils literal notranslate"><span class="pre">prepare_data</span></code> and <code class="code docutils literal notranslate"><span class="pre">build_model</span></code> are
method specific-arguments for methods like <a class="reference internal" href="#s3prl.problem.HearVoxLingual.prepare_data" title="s3prl.problem.HearVoxLingual.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> and
<a class="reference internal" href="#s3prl.problem.HearVoxLingual.build_model" title="s3prl.problem.HearVoxLingual.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>, and will not be used in the core <a class="reference internal" href="#s3prl.problem.HearVoxLingual.run" title="s3prl.problem.HearVoxLingual.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> logic.
See the specific method documentation for their supported arguments and
meaning</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVoxLingual.save_model">
<span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L709-L750"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVoxLingual.save_model" title="Permalink to this definition">#</a></dt>
<dd><p>Save the model state_dict and the model initialization arguments into the given directory.
If you override this method, it is highly possible you also need to override <a class="reference internal" href="#s3prl.problem.HearVoxLingual.load_model" title="s3prl.problem.HearVoxLingual.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearVoxLingual.default_config" title="s3prl.problem.HearVoxLingual.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_model</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>model_ckpt_dir</strong> (<em>str</em>) – save the model into the this directory.</p></li>
<li><p><strong>build_model_all_args</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.HearVoxLingual.build_model" title="s3prl.problem.HearVoxLingual.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>.
By saving this dictionary, you can easily reconstruct the same model
by calling <a class="reference internal" href="#s3prl.problem.HearVoxLingual.build_model" title="s3prl.problem.HearVoxLingual.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVoxLingual.save_task">
<span class="sig-name descname"><span class="pre">save_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="s3prl.task.base.html#s3prl.task.base.Task" title="s3prl.task.base.Task"><span class="pre">Task</span></a></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L774-L831"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVoxLingual.save_task" title="Permalink to this definition">#</a></dt>
<dd><p>Save the task’s state, <code class="code docutils literal notranslate"><span class="pre">task.get_state()</span></code>, and the initialization arguments into the given
directory. If you override this method, it is highly possible you also need to override
<a class="reference internal" href="#s3prl.problem.HearVoxLingual.load_task" title="s3prl.problem.HearVoxLingual.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearVoxLingual.default_config" title="s3prl.problem.HearVoxLingual.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_task</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – save the task into this directory.</p></li>
<li><p><strong>build_task_all_args_except_model</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.HearVoxLingual.build_task" title="s3prl.problem.HearVoxLingual.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> except
the <code class="code docutils literal notranslate"><span class="pre">model</span></code> argument since the model should be sapartely saved by
<a class="reference internal" href="#s3prl.problem.HearVoxLingual.save_model" title="s3prl.problem.HearVoxLingual.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a>. By saving this dictionary, you can easily reconstruct the same task
by calling <a class="reference internal" href="#s3prl.problem.HearVoxLingual.build_task" title="s3prl.problem.HearVoxLingual.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>task</strong> (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><em>Task</em></a>) – the task to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearVoxLingual.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L287-L658"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearVoxLingual.train" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearVoxLingual.default_config" title="s3prl.problem.HearVoxLingual.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>total_steps</p></td>
<td><p>(int) - the total optimization steps</p></td>
</tr>
<tr class="row-odd"><td><p>log_step</p></td>
<td><p>(int) - logging frequency. log every <code class="code docutils literal notranslate"><span class="pre">log_step</span></code> step</p></td>
</tr>
<tr class="row-even"><td><p>eval_step</p></td>
<td><p>(int) - evaluation frequency. Evaluate every <code class="code docutils literal notranslate"><span class="pre">eval_step</span></code> step.                                                 Note that you can control how many batch to evaluate to speed up the                                                 development by the <code class="code docutils literal notranslate"><span class="pre">eval_batch</span></code> argument in <a class="reference internal" href="#s3prl.problem.HearVoxLingual.run" title="s3prl.problem.HearVoxLingual.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>save_step</p></td>
<td><p>(int) - save the checkpoint every <code class="code docutils literal notranslate"><span class="pre">save_step</span></code> step.</p></td>
</tr>
<tr class="row-even"><td><p>gradient_clipping</p></td>
<td><p>(float) - clip the gradient. important for RNNs.</p></td>
</tr>
<tr class="row-odd"><td><p>gradient_accumulate</p></td>
<td><p>(int) - accumulate multiple steps’ gradient before updating network parameters                                                 to simulate large-batch optimization.</p></td>
</tr>
<tr class="row-even"><td><p>valid_metric</p></td>
<td><p>(str) - the metric to select the best valid checkpoint. Different Tasks have different                                                 supported valid_metrics. See <a class="reference internal" href="#s3prl.problem.HearVoxLingual.build_task" title="s3prl.problem.HearVoxLingual.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> for the supported metrics.</p></td>
</tr>
<tr class="row-odd"><td><p>valid_higher_better</p></td>
<td><p>(bool) - some metrics are higher better, while some are lower better                                                 this will affect how to save the best validation checkpoint.</p></td>
</tr>
<tr class="row-even"><td><p>auto_resume</p></td>
<td><p>(bool) - if there are already the last checkpoint in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.HearVoxLingual.run" title="s3prl.problem.HearVoxLingual.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>),                                                 whether to resume from it or delete it and start a new training session.</p></td>
</tr>
<tr class="row-odd"><td><p>resume_ckpt_dir</p></td>
<td><p>(str) - you can directly specify the checkpoint path to resume which is not necessary                                                 in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.HearVoxLingual.run" title="s3prl.problem.HearVoxLingual.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>).</p></td>
</tr>
<tr class="row-even"><td><p>seed</p></td>
<td><p>(int) - fix the seed before the training start</p></td>
</tr>
<tr class="row-odd"><td><p>keep_num_ckpts</p></td>
<td><p>(int) - to prevent saving too many checkpoints, only save the <code class="code docutils literal notranslate"><span class="pre">keep_num_ckpts</span></code>                                                 latest checkpoints and delete the old ones.</p></td>
</tr>
<tr class="row-even"><td><p>use_scheduler</p></td>
<td><p>(bool) - whether to use the scheduler</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="heardcase2016task2">
<h2>HearDcase2016Task2<a class="headerlink" href="#heardcase2016task2" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="s3prl.problem.HearDcase2016Task2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">s3prl.problem.</span></span><span class="sig-name descname"><span class="pre">HearDcase2016Task2</span></span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_dcase_2016_task2.html#HearDcase2016Task2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_dcase_2016_task2.py#L82-L260"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearDcase2016Task2" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="s3prl.problem.common.hear_fsd.html#s3prl.problem.common.hear_fsd.HearFSD" title="s3prl.problem.common.hear_fsd.HearFSD"><code class="xref py py-class docutils literal notranslate"><span class="pre">HearFSD</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearDcase2016Task2.default_config">
<span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_dcase_2016_task2.html#HearDcase2016Task2.default_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_dcase_2016_task2.py#L83-L159"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearDcase2016Task2.default_config" title="Permalink to this definition">#</a></dt>
<dd><p>The default arguments for <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.run" title="s3prl.problem.HearDcase2016Task2.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> in yaml.
Note that for the fields with inner values, like <code class="code docutils literal notranslate"><span class="pre">build_model</span></code>,
the outer field name corresponds to a method name, so you can find the method
<a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.build_model" title="s3prl.problem.HearDcase2016Task2.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>. Furthermore, the values inside that field will be
directly passed into the method. So by changing these inner values, you
can directly affect the behavior of the corresponding method. See the method
documentation for all the supported arguments and their meanings.</p>
<p>The methods affected by the following config are: <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.prepare_data" title="s3prl.problem.HearDcase2016Task2.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.build_dataset" title="s3prl.problem.HearDcase2016Task2.build_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_dataset</span></code></a> <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.build_batch_sampler" title="s3prl.problem.HearDcase2016Task2.build_batch_sampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_batch_sampler</span></code></a> <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.build_upstream" title="s3prl.problem.HearDcase2016Task2.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a> <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.build_featurizer" title="s3prl.problem.HearDcase2016Task2.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a> <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.build_downstream" title="s3prl.problem.HearDcase2016Task2.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a> <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.build_model" title="s3prl.problem.HearDcase2016Task2.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.build_task" title="s3prl.problem.HearDcase2016Task2.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.build_optimizer" title="s3prl.problem.HearDcase2016Task2.build_optimizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_optimizer</span></code></a> <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.build_scheduler" title="s3prl.problem.HearDcase2016Task2.build_scheduler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_scheduler</span></code></a> <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.save_model" title="s3prl.problem.HearDcase2016Task2.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a> <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.save_task" title="s3prl.problem.HearDcase2016Task2.save_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_task</span></code></a> <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.train" title="s3prl.problem.HearDcase2016Task2.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.evaluate" title="s3prl.problem.HearDcase2016Task2.evaluate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate</span></code></a></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">start</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="nt">stop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">target_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">cache_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">remove_all_cache</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">prepare_data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">dataset_root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">build_dataset</span><span class="p">:</span>
<span class="w">  </span><span class="nt">train</span><span class="p">:</span>
<span class="w">    </span><span class="nt">chunk_secs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4.0</span>
<span class="w">    </span><span class="nt">step_secs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4.0</span>
<span class="w">  </span><span class="nt">valid</span><span class="p">:</span>
<span class="w">    </span><span class="nt">chunk_secs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4.0</span>
<span class="w">    </span><span class="nt">step_secs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4.0</span>
<span class="w">  </span><span class="nt">test</span><span class="p">:</span>
<span class="w">    </span><span class="nt">chunk_secs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4.0</span>
<span class="w">    </span><span class="nt">step_secs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">4.0</span>
<span class="nt">build_batch_sampler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">train</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">    </span><span class="nt">shuffle</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">build_upstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">build_featurizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">layer_selections</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="nt">normalize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_downstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">hidden_layers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="nt">build_model</span><span class="p">:</span>
<span class="w">  </span><span class="nt">upstream_trainable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_task</span><span class="p">:</span>
<span class="w">  </span><span class="nt">prediction_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">multilabel</span>
<span class="w">  </span><span class="nt">scores</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">event_onset_200ms_fms</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">segment_1s_er</span>
<span class="w">  </span><span class="nt">postprocessing_grid</span><span class="p">:</span>
<span class="w">    </span><span class="nt">median_filter_ms</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">250</span>
<span class="w">    </span><span class="nt">min_duration</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">125</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">250</span>
<span class="nt">build_optimizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Adam</span>
<span class="w">  </span><span class="nt">conf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">lr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.001</span>
<span class="nt">build_scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ExponentialLR</span>
<span class="w">  </span><span class="nt">gamma</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.9</span>
<span class="nt">save_model</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">save_task</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">train</span><span class="p">:</span>
<span class="w">  </span><span class="nt">total_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">15000</span>
<span class="w">  </span><span class="nt">log_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">  </span><span class="nt">eval_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">500</span>
<span class="w">  </span><span class="nt">save_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">500</span>
<span class="w">  </span><span class="nt">gradient_clipping</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0</span>
<span class="w">  </span><span class="nt">gradient_accumulate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">valid_metric</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">event_onset_200ms_fms</span>
<span class="w">  </span><span class="nt">valid_higher_better</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">auto_resume</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">resume_ckpt_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">evaluate</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearDcase2016Task2.prepare_data">
<span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_dcase_2016_task2.html#HearDcase2016Task2.prepare_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_dcase_2016_task2.py#L161-L170"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearDcase2016Task2.prepare_data" title="Permalink to this definition">#</a></dt>
<dd><p>Prepare the task-specific data metadata (path, labels…).
By default call <code class="xref py py-obj docutils literal notranslate"><span class="pre">voxceleb1_for_sid</span></code> with <code class="code docutils literal notranslate"><span class="pre">**prepare_data</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prepare_data</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.default_config" title="s3prl.problem.HearDcase2016Task2.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments in <code class="xref py py-obj docutils literal notranslate"><span class="pre">voxceleb1_for_sid</span></code></p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Parse your corpus and save the csv file into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the parsing or preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>train_path (str)</p></li>
<li><p>valid_path (str)</p></li>
<li><p>test_paths (List[str])</p></li>
</ol>
<p>Each path (str) should be a csv file containing the following columns:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>column</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>(str) - the unique id for this data point</p></td>
</tr>
<tr class="row-odd"><td><p>wav_path</p></td>
<td><p>(str) - the absolute path of the waveform file</p></td>
</tr>
<tr class="row-even"><td><p>label</p></td>
<td><p>(str) - a string label of the waveform</p></td>
</tr>
<tr class="row-odd"><td><p>start_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">start_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load from the beginning.</p></td>
</tr>
<tr class="row-even"><td><p>end_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">end_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load to the end.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearDcase2016Task2.build_dataset">
<span class="sig-name descname"><span class="pre">build_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_shift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_dcase_2016_task2.html#HearDcase2016Task2.build_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_dcase_2016_task2.py#L172-L199"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearDcase2016Task2.build_dataset" title="Permalink to this definition">#</a></dt>
<dd><p>Build the dataset for train/valid/test.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_dataset</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.default_config" title="s3prl.problem.HearDcase2016Task2.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>. with <code class="code docutils literal notranslate"><span class="pre">train</span></code>, <code class="code docutils literal notranslate"><span class="pre">valid</span></code>, <code class="code docutils literal notranslate"><span class="pre">test</span></code> keys, each
is a dictionary with the following supported options:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>max_secs</p></td>
<td><p>(float) - If a waveform is longer than <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds, randomly crop the waveform into <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds</p></td>
</tr>
<tr class="row-odd"><td><p>sox_effects</p></td>
<td><p>(List[List[str]]) - If not None, apply sox effects on the utterance</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – The metadata csv file for the specific <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p></li>
<li><p><strong>encoder_path</strong> (<em>str</em>) – The pickled encoder path for encoding the labels</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch Dataset</p>
<p>For all train/valid/test mode, the dataset should return each item as a dictionary
containing the following keys:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>x</p></td>
<td><p>(torch.FloatTensor) - the waveform in (seq_len, 1)</p></td>
</tr>
<tr class="row-odd"><td><p>x_len</p></td>
<td><p>(int) - the waveform length <code class="code docutils literal notranslate"><span class="pre">seq_len</span></code></p></td>
</tr>
<tr class="row-even"><td><p>class_id</p></td>
<td><p>(int) - the encoded class id</p></td>
</tr>
<tr class="row-odd"><td><p>label</p></td>
<td><p>(str) - the class name</p></td>
</tr>
<tr class="row-even"><td><p>unique_name</p></td>
<td><p>(str) - the unique id for this datapoint</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearDcase2016Task2.build_batch_sampler">
<span class="sig-name descname"><span class="pre">build_batch_sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_dcase_2016_task2.html#HearDcase2016Task2.build_batch_sampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_dcase_2016_task2.py#L201-L226"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearDcase2016Task2.build_batch_sampler" title="Permalink to this definition">#</a></dt>
<dd><p>Return the batch sampler for torch DataLoader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_batch_sampler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.default_config" title="s3prl.problem.HearDcase2016Task2.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>train</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>valid</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-even"><td><p>test</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">mode</span></code> specific csv from <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.prepare_data" title="s3prl.problem.HearDcase2016Task2.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>dataset</strong> – the dataset from <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.build_dataset" title="s3prl.problem.HearDcase2016Task2.build_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_dataset</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>batch sampler for torch DataLoader</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearDcase2016Task2.build_task">
<span class="sig-name descname"><span class="pre">build_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_dcase_2016_task2.html#HearDcase2016Task2.build_task"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_dcase_2016_task2.py#L228-L260"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearDcase2016Task2.build_task" title="Permalink to this definition">#</a></dt>
<dd><p>Build the task, which defines the logics for every train/valid/test forward step for the <code class="code docutils literal notranslate"><span class="pre">model</span></code>,
and the logics for how to reduce all the batch results from multiple train/valid/test steps into metrics</p>
<p>By default build <code class="xref py py-obj docutils literal notranslate"><span class="pre">UtteranceClassificationTask</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.default_config" title="s3prl.problem.HearDcase2016Task2.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model built by <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.build_model" title="s3prl.problem.HearDcase2016Task2.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a></p></li>
<li><p><strong>encoder</strong> – the encoder built by <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.build_encoder" title="s3prl.problem.HearDcase2016Task2.build_encoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_encoder</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Task</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearDcase2016Task2.build_collate_fn">
<span class="sig-name descname"><span class="pre">build_collate_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L143-L156"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearDcase2016Task2.build_collate_fn" title="Permalink to this definition">#</a></dt>
<dd><p>By default returns <code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataset.base.default_collate_fn</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_collate_fn</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.default_config" title="s3prl.problem.HearDcase2016Task2.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train, valid, or test</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>callable</p>
<p>the collate_fn for torch DataLoader in train/valid/test <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearDcase2016Task2.build_downstream">
<span class="sig-name descname"><span class="pre">build_downstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L231-L240"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearDcase2016Task2.build_downstream" title="Permalink to this definition">#</a></dt>
<dd><p>Return the task-specific downstream model.
By default build the <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code> model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.default_config" title="s3prl.problem.HearDcase2016Task2.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments of <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code></p></li>
<li><p><strong>downstream_input_size</strong> (<em>int</em>) – the required input size of the model</p></li>
<li><p><strong>downstream_output_size</strong> (<em>int</em>) – the required output size of the model</p></li>
<li><p><strong>downstream_input_stride</strong> (<em>int</em>) – the input feature’s stride (from 16 KHz)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUtteranceModel" title="s3prl.nn.interface.AbsUtteranceModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUtteranceModel</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearDcase2016Task2.build_encoder">
<span class="sig-name descname"><span class="pre">build_encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_csv_paths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L142-L170"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearDcase2016Task2.build_encoder" title="Permalink to this definition">#</a></dt>
<dd><p>Build the encoder (for the labels) given the data metadata, and return the saved encoder path.
By default generate and save a <a class="reference internal" href="s3prl.dataio.encoder.html#s3prl.dataio.encoder.CategoryEncoder" title="s3prl.dataio.encoder.CategoryEncoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataio.encoder.CategoryEncoder</span></code></a> from the <code class="code docutils literal notranslate"><span class="pre">label</span></code> column of all the csv files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_encoder</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.default_config" title="s3prl.problem.HearDcase2016Task2.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Save your encoder into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>train_csv_path</strong> (<em>str</em>) – the train path from <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.prepare_data" title="s3prl.problem.HearDcase2016Task2.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>valid_csv_path</strong> (<em>str</em>) – the valid path from <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.prepare_data" title="s3prl.problem.HearDcase2016Task2.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>test_csv_paths</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – the test paths from <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.prepare_data" title="s3prl.problem.HearDcase2016Task2.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>str</p>
<p>encoder_path: The encoder should be saved in the pickle format</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearDcase2016Task2.build_featurizer">
<span class="sig-name descname"><span class="pre">build_featurizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upstream</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L175-L192"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearDcase2016Task2.build_featurizer" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the featurizer with <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.default_config" title="s3prl.problem.HearDcase2016Task2.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p></li>
<li><p><strong>upstream</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">AbsUpstream</span></code>) – the upstream model built by <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.build_upstream" title="s3prl.problem.HearDcase2016Task2.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsFeaturizer" title="s3prl.nn.interface.AbsFeaturizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsFeaturizer</span></code></a></p>
<p>Return the featurizer model. The featurizer is used to reduce the multiple
hidden states returned from the upstream model (built by <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.build_upstream" title="s3prl.problem.HearDcase2016Task2.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>)
into a single hidden state, so can be easliy fed into the downstream model</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearDcase2016Task2.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L194-L231"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearDcase2016Task2.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>By default build model with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.default_config" title="s3prl.problem.HearDcase2016Task2.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p></li>
<li><p><strong>model_output_size</strong> (<em>int</em>) – the required model’s output hidden size</p></li>
<li><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.default_config" title="s3prl.problem.HearDcase2016Task2.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.build_upstream" title="s3prl.problem.HearDcase2016Task2.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.default_config" title="s3prl.problem.HearDcase2016Task2.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.build_featurizer" title="s3prl.problem.HearDcase2016Task2.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a></p></li>
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.default_config" title="s3prl.problem.HearDcase2016Task2.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.build_downstream" title="s3prl.problem.HearDcase2016Task2.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch.nn.Module</p>
<p>Return the entire model for the task, which takes the direct items from DataLoader as the input.
Usually, the components can be built by <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.build_upstream" title="s3prl.problem.HearDcase2016Task2.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>, <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.build_featurizer" title="s3prl.problem.HearDcase2016Task2.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a>,
<a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.build_downstream" title="s3prl.problem.HearDcase2016Task2.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a>, and are concated together to get the final model.
The upstream extracts multiple hidden states, the featuizer reduce them into a single hidden state,
and the downstream takes the hidden states as the feature for the downstream-specific model.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearDcase2016Task2.build_optimizer">
<span class="sig-name descname"><span class="pre">build_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L233-L258"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearDcase2016Task2.build_optimizer" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_optimizer</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.default_config" title="s3prl.problem.HearDcase2016Task2.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to below</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the optimizer class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the optimizer class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;lr&quot;:</span> <span class="pre">1.0e-4}</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>parameters</strong> (<em>iterable</em>) – the standard params accepted by <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code></p>
<p>An optimizer following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearDcase2016Task2.build_scheduler">
<span class="sig-name descname"><span class="pre">build_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L260-L285"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearDcase2016Task2.build_scheduler" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_scheduler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.default_config" title="s3prl.problem.HearDcase2016Task2.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the scheduler class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the scheduler class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;gamma&quot;:</span> <span class="pre">0.01}</span></code> for <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler.StepLR</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>optimizer</strong> – the standard torch optimizer accepted by Scheduler in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch scheduler</p>
<p>A scheduler following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearDcase2016Task2.build_upstream">
<span class="sig-name descname"><span class="pre">build_upstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L158-L173"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearDcase2016Task2.build_upstream" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the upstream with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.default_config" title="s3prl.problem.HearDcase2016Task2.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUpstream" title="s3prl.nn.interface.AbsUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUpstream</span></code></a></p>
<p>Return an upstream model, whose forward takes the waveform input and returns
multiple hidden states as features.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearDcase2016Task2.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L660-L707"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearDcase2016Task2.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>The evaluate routine used by <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.train" title="s3prl.problem.HearDcase2016Task2.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> (during validation phase) and <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.run" title="s3prl.problem.HearDcase2016Task2.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>
(during testing phase).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evaluate</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.default_config" title="s3prl.problem.HearDcase2016Task2.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearDcase2016Task2.get_class_from_name">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_class_from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L129-L141"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearDcase2016Task2.get_class_from_name" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">__name__</span></code> of the problem class</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Problem</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearDcase2016Task2.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L752-L772"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearDcase2016Task2.load_model" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model_ckpt_dir</strong> (<em>str</em>) – Restore the model with <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.build_model" title="s3prl.problem.HearDcase2016Task2.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> and the checkpoint
saved in this directory.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearDcase2016Task2.load_model_and_task">
<span class="sig-name descname"><span class="pre">load_model_and_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ckpts_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L884-L902"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearDcase2016Task2.load_model_and_task" title="Permalink to this definition">#</a></dt>
<dd><p>This is a helper method to combine <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.load_model" title="s3prl.problem.HearDcase2016Task2.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a> and <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.load_task" title="s3prl.problem.HearDcase2016Task2.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>
together to directly load the model and the task. This method assumes
the model is saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'model'</span></code> and the task is
saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'task'</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>model (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>)</p></li>
<li><p>task (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a>)</p></li>
</ol>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearDcase2016Task2.load_task">
<span class="sig-name descname"><span class="pre">load_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L833-L882"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearDcase2016Task2.load_task" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – Restore the task with <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.build_task" title="s3prl.problem.HearDcase2016Task2.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> and the checkpoint
saved in this directory.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model for the task, since the model is separately saved
and is required for <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.build_task" title="s3prl.problem.HearDcase2016Task2.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a>.</p></li>
<li><p><strong>task_overrides</strong> (<em>dict</em>) – overrides the saved initialization arguments, so can change
the loaded task’s behavior. Like, change the decoding hyperparameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearDcase2016Task2.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L954-L995"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearDcase2016Task2.main" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearDcase2016Task2.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_all_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cuda'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/run.py#L26-L318"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearDcase2016Task2.run" title="Permalink to this definition">#</a></dt>
<dd><div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>stage</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Parse the corpus and save the metadata file (waveform path, label…)</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Build the encoder to encode the labels</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Train the model</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Evaluate the model on multiple test sets</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_dir</strong> (<em>str</em>) – The directory that stores the script result.</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – The directory that caches the processed data.
Default: /home/user/.cache/s3prl/data</p></li>
<li><p><strong>remove_all_cache</strong> (<em>bool</em>) – Whether to remove all the cache stored under <cite>cache_dir</cite>.
Default: False</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting stage of the problem script.
Default: 0</p></li>
<li><p><strong>stop</strong> (<em>int</em>) – The stoping stage of the problem script, set <cite>None</cite> to reach the final stage.
Default: None</p></li>
<li><p><strong>num_workers</strong> (<em>int</em>) – num_workers for all the torch DataLoder</p></li>
<li><p><strong>eval_batch</strong> (<em>int</em>) – During evaluation (valid or test), limit the number of batch.
This is helpful for the fast development to check everything won’t crash.
If is -1, disable this feature and evaluate the entire epoch.
Default: -1</p></li>
<li><p><strong>device</strong> (<em>str</em>) – The device type for all torch-related operation: “cpu” or “cuda”
Default: “cuda”</p></li>
<li><p><strong>world_size</strong> (<em>int</em>) – How many processes are running this script simultaneously (in parallel).
Usually this is just 1, however if you are runnig distributed training,
this should be &gt; 1.
Default: 1</p></li>
<li><p><strong>rank</strong> (<em>int</em>) – When distributed training, world_size &gt; 1. Take <code class="code docutils literal notranslate"><span class="pre">world_size</span> <span class="pre">==</span> <span class="pre">8</span></code> for
example, this means 8 processes (8 GPUs) are runing in parallel. The script
needs to know which process among 8 processes it is. In this case, <code class="code docutils literal notranslate"><span class="pre">rank</span></code>
can range from 0~7. All the 8 processes have the same <code class="code docutils literal notranslate"><span class="pre">world_size</span></code> but
different <code class="code docutils literal notranslate"><span class="pre">rank</span></code> (process id).</p></li>
<li><p><strong>test_ckpt_dir</strong> (<em>str</em>) – Specify the checkpoint path for testing. If not, use the validation best
checkpoint under the given <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> directory.</p></li>
<li><p><strong>**kwds</strong> – The other arguments like <code class="code docutils literal notranslate"><span class="pre">prepare_data</span></code> and <code class="code docutils literal notranslate"><span class="pre">build_model</span></code> are
method specific-arguments for methods like <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.prepare_data" title="s3prl.problem.HearDcase2016Task2.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> and
<a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.build_model" title="s3prl.problem.HearDcase2016Task2.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>, and will not be used in the core <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.run" title="s3prl.problem.HearDcase2016Task2.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> logic.
See the specific method documentation for their supported arguments and
meaning</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearDcase2016Task2.save_model">
<span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L709-L750"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearDcase2016Task2.save_model" title="Permalink to this definition">#</a></dt>
<dd><p>Save the model state_dict and the model initialization arguments into the given directory.
If you override this method, it is highly possible you also need to override <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.load_model" title="s3prl.problem.HearDcase2016Task2.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.default_config" title="s3prl.problem.HearDcase2016Task2.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_model</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>model_ckpt_dir</strong> (<em>str</em>) – save the model into the this directory.</p></li>
<li><p><strong>build_model_all_args</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.build_model" title="s3prl.problem.HearDcase2016Task2.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>.
By saving this dictionary, you can easily reconstruct the same model
by calling <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.build_model" title="s3prl.problem.HearDcase2016Task2.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearDcase2016Task2.save_task">
<span class="sig-name descname"><span class="pre">save_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="s3prl.task.base.html#s3prl.task.base.Task" title="s3prl.task.base.Task"><span class="pre">Task</span></a></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L774-L831"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearDcase2016Task2.save_task" title="Permalink to this definition">#</a></dt>
<dd><p>Save the task’s state, <code class="code docutils literal notranslate"><span class="pre">task.get_state()</span></code>, and the initialization arguments into the given
directory. If you override this method, it is highly possible you also need to override
<a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.load_task" title="s3prl.problem.HearDcase2016Task2.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.default_config" title="s3prl.problem.HearDcase2016Task2.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_task</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – save the task into this directory.</p></li>
<li><p><strong>build_task_all_args_except_model</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.build_task" title="s3prl.problem.HearDcase2016Task2.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> except
the <code class="code docutils literal notranslate"><span class="pre">model</span></code> argument since the model should be sapartely saved by
<a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.save_model" title="s3prl.problem.HearDcase2016Task2.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a>. By saving this dictionary, you can easily reconstruct the same task
by calling <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.build_task" title="s3prl.problem.HearDcase2016Task2.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>task</strong> (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><em>Task</em></a>) – the task to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearDcase2016Task2.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L287-L658"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearDcase2016Task2.train" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.default_config" title="s3prl.problem.HearDcase2016Task2.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>total_steps</p></td>
<td><p>(int) - the total optimization steps</p></td>
</tr>
<tr class="row-odd"><td><p>log_step</p></td>
<td><p>(int) - logging frequency. log every <code class="code docutils literal notranslate"><span class="pre">log_step</span></code> step</p></td>
</tr>
<tr class="row-even"><td><p>eval_step</p></td>
<td><p>(int) - evaluation frequency. Evaluate every <code class="code docutils literal notranslate"><span class="pre">eval_step</span></code> step.                                                 Note that you can control how many batch to evaluate to speed up the                                                 development by the <code class="code docutils literal notranslate"><span class="pre">eval_batch</span></code> argument in <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.run" title="s3prl.problem.HearDcase2016Task2.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>save_step</p></td>
<td><p>(int) - save the checkpoint every <code class="code docutils literal notranslate"><span class="pre">save_step</span></code> step.</p></td>
</tr>
<tr class="row-even"><td><p>gradient_clipping</p></td>
<td><p>(float) - clip the gradient. important for RNNs.</p></td>
</tr>
<tr class="row-odd"><td><p>gradient_accumulate</p></td>
<td><p>(int) - accumulate multiple steps’ gradient before updating network parameters                                                 to simulate large-batch optimization.</p></td>
</tr>
<tr class="row-even"><td><p>valid_metric</p></td>
<td><p>(str) - the metric to select the best valid checkpoint. Different Tasks have different                                                 supported valid_metrics. See <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.build_task" title="s3prl.problem.HearDcase2016Task2.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> for the supported metrics.</p></td>
</tr>
<tr class="row-odd"><td><p>valid_higher_better</p></td>
<td><p>(bool) - some metrics are higher better, while some are lower better                                                 this will affect how to save the best validation checkpoint.</p></td>
</tr>
<tr class="row-even"><td><p>auto_resume</p></td>
<td><p>(bool) - if there are already the last checkpoint in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.run" title="s3prl.problem.HearDcase2016Task2.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>),                                                 whether to resume from it or delete it and start a new training session.</p></td>
</tr>
<tr class="row-odd"><td><p>resume_ckpt_dir</p></td>
<td><p>(str) - you can directly specify the checkpoint path to resume which is not necessary                                                 in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.HearDcase2016Task2.run" title="s3prl.problem.HearDcase2016Task2.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>).</p></td>
</tr>
<tr class="row-even"><td><p>seed</p></td>
<td><p>(int) - fix the seed before the training start</p></td>
</tr>
<tr class="row-odd"><td><p>keep_num_ckpts</p></td>
<td><p>(int) - to prevent saving too many checkpoints, only save the <code class="code docutils literal notranslate"><span class="pre">keep_num_ckpts</span></code>                                                 latest checkpoints and delete the old ones.</p></td>
</tr>
<tr class="row-even"><td><p>use_scheduler</p></td>
<td><p>(bool) - whether to use the scheduler</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="hearmaestro">
<h2>HearMaestro<a class="headerlink" href="#hearmaestro" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="s3prl.problem.HearMaestro">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">s3prl.problem.</span></span><span class="sig-name descname"><span class="pre">HearMaestro</span></span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_maestro.html#HearMaestro"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_maestro.py#L94-L175"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearMaestro" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="s3prl.problem.common.hear_dcase_2016_task2.html#s3prl.problem.common.hear_dcase_2016_task2.HearDcase2016Task2" title="s3prl.problem.common.hear_dcase_2016_task2.HearDcase2016Task2"><code class="xref py py-class docutils literal notranslate"><span class="pre">HearDcase2016Task2</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearMaestro.default_config">
<span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_maestro.html#HearMaestro.default_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_maestro.py#L95-L164"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearMaestro.default_config" title="Permalink to this definition">#</a></dt>
<dd><p>The default arguments for <a class="reference internal" href="#s3prl.problem.HearMaestro.run" title="s3prl.problem.HearMaestro.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> in yaml.
Note that for the fields with inner values, like <code class="code docutils literal notranslate"><span class="pre">build_model</span></code>,
the outer field name corresponds to a method name, so you can find the method
<a class="reference internal" href="#s3prl.problem.HearMaestro.build_model" title="s3prl.problem.HearMaestro.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>. Furthermore, the values inside that field will be
directly passed into the method. So by changing these inner values, you
can directly affect the behavior of the corresponding method. See the method
documentation for all the supported arguments and their meanings.</p>
<p>The methods affected by the following config are: <a class="reference internal" href="#s3prl.problem.HearMaestro.prepare_data" title="s3prl.problem.HearMaestro.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> <a class="reference internal" href="#s3prl.problem.HearMaestro.build_batch_sampler" title="s3prl.problem.HearMaestro.build_batch_sampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_batch_sampler</span></code></a> <a class="reference internal" href="#s3prl.problem.HearMaestro.build_upstream" title="s3prl.problem.HearMaestro.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a> <a class="reference internal" href="#s3prl.problem.HearMaestro.build_featurizer" title="s3prl.problem.HearMaestro.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a> <a class="reference internal" href="#s3prl.problem.HearMaestro.build_downstream" title="s3prl.problem.HearMaestro.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a> <a class="reference internal" href="#s3prl.problem.HearMaestro.build_model" title="s3prl.problem.HearMaestro.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> <a class="reference internal" href="#s3prl.problem.HearMaestro.build_task" title="s3prl.problem.HearMaestro.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> <a class="reference internal" href="#s3prl.problem.HearMaestro.build_optimizer" title="s3prl.problem.HearMaestro.build_optimizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_optimizer</span></code></a> <a class="reference internal" href="#s3prl.problem.HearMaestro.build_scheduler" title="s3prl.problem.HearMaestro.build_scheduler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_scheduler</span></code></a> <a class="reference internal" href="#s3prl.problem.HearMaestro.save_model" title="s3prl.problem.HearMaestro.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a> <a class="reference internal" href="#s3prl.problem.HearMaestro.save_task" title="s3prl.problem.HearMaestro.save_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_task</span></code></a> <a class="reference internal" href="#s3prl.problem.HearMaestro.train" title="s3prl.problem.HearMaestro.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> <a class="reference internal" href="#s3prl.problem.HearMaestro.evaluate" title="s3prl.problem.HearMaestro.evaluate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate</span></code></a></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">start</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="nt">stop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">target_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">cache_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">remove_all_cache</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">prepare_data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">dataset_root</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="w">  </span><span class="nt">test_fold</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">build_batch_sampler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">train</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">    </span><span class="nt">shuffle</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">valid</span><span class="p">:</span>
<span class="w">    </span><span class="nt">item</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">record_id</span>
<span class="w">  </span><span class="nt">test</span><span class="p">:</span>
<span class="w">    </span><span class="nt">item</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">record_id</span>
<span class="nt">build_upstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">build_featurizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">layer_selections</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="nt">normalize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_downstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">hidden_layers</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">2</span>
<span class="nt">build_model</span><span class="p">:</span>
<span class="w">  </span><span class="nt">upstream_trainable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_task</span><span class="p">:</span>
<span class="w">  </span><span class="nt">prediction_type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">multilabel</span>
<span class="w">  </span><span class="nt">scores</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">event_onset_50ms_fms</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">event_onset_offset_50ms_20perc_fms</span>
<span class="w">  </span><span class="nt">postprocessing_grid</span><span class="p">:</span>
<span class="w">    </span><span class="nt">median_filter_ms</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">150</span>
<span class="w">    </span><span class="nt">min_duration</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50</span>
<span class="nt">build_optimizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Adam</span>
<span class="w">  </span><span class="nt">conf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">lr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.001</span>
<span class="nt">build_scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ExponentialLR</span>
<span class="w">  </span><span class="nt">gamma</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.9</span>
<span class="nt">save_model</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">save_task</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">train</span><span class="p">:</span>
<span class="w">  </span><span class="nt">total_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">15000</span>
<span class="w">  </span><span class="nt">log_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">100</span>
<span class="w">  </span><span class="nt">eval_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">500</span>
<span class="w">  </span><span class="nt">save_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">500</span>
<span class="w">  </span><span class="nt">gradient_clipping</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0</span>
<span class="w">  </span><span class="nt">gradient_accumulate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">valid_metric</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">event_onset_50ms_fms</span>
<span class="w">  </span><span class="nt">valid_higher_better</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">auto_resume</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">resume_ckpt_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">evaluate</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearMaestro.prepare_data">
<span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/common/hear_maestro.html#HearMaestro.prepare_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_maestro.py#L166-L175"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearMaestro.prepare_data" title="Permalink to this definition">#</a></dt>
<dd><p>Prepare the task-specific data metadata (path, labels…).
By default call <code class="xref py py-obj docutils literal notranslate"><span class="pre">voxceleb1_for_sid</span></code> with <code class="code docutils literal notranslate"><span class="pre">**prepare_data</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prepare_data</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearMaestro.default_config" title="s3prl.problem.HearMaestro.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments in <code class="xref py py-obj docutils literal notranslate"><span class="pre">voxceleb1_for_sid</span></code></p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Parse your corpus and save the csv file into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the parsing or preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>train_path (str)</p></li>
<li><p>valid_path (str)</p></li>
<li><p>test_paths (List[str])</p></li>
</ol>
<p>Each path (str) should be a csv file containing the following columns:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>column</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>(str) - the unique id for this data point</p></td>
</tr>
<tr class="row-odd"><td><p>wav_path</p></td>
<td><p>(str) - the absolute path of the waveform file</p></td>
</tr>
<tr class="row-even"><td><p>label</p></td>
<td><p>(str) - a string label of the waveform</p></td>
</tr>
<tr class="row-odd"><td><p>start_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">start_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load from the beginning.</p></td>
</tr>
<tr class="row-even"><td><p>end_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">end_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load to the end.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearMaestro.build_batch_sampler">
<span class="sig-name descname"><span class="pre">build_batch_sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_dcase_2016_task2.py#L201-L226"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearMaestro.build_batch_sampler" title="Permalink to this definition">#</a></dt>
<dd><p>Return the batch sampler for torch DataLoader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_batch_sampler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearMaestro.default_config" title="s3prl.problem.HearMaestro.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>train</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>valid</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-even"><td><p>test</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">mode</span></code> specific csv from <a class="reference internal" href="#s3prl.problem.HearMaestro.prepare_data" title="s3prl.problem.HearMaestro.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>dataset</strong> – the dataset from <a class="reference internal" href="#s3prl.problem.HearMaestro.build_dataset" title="s3prl.problem.HearMaestro.build_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_dataset</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>batch sampler for torch DataLoader</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearMaestro.build_collate_fn">
<span class="sig-name descname"><span class="pre">build_collate_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L143-L156"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearMaestro.build_collate_fn" title="Permalink to this definition">#</a></dt>
<dd><p>By default returns <code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataset.base.default_collate_fn</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_collate_fn</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearMaestro.default_config" title="s3prl.problem.HearMaestro.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train, valid, or test</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>callable</p>
<p>the collate_fn for torch DataLoader in train/valid/test <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearMaestro.build_dataset">
<span class="sig-name descname"><span class="pre">build_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_shift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_dcase_2016_task2.py#L172-L199"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearMaestro.build_dataset" title="Permalink to this definition">#</a></dt>
<dd><p>Build the dataset for train/valid/test.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_dataset</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearMaestro.default_config" title="s3prl.problem.HearMaestro.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>. with <code class="code docutils literal notranslate"><span class="pre">train</span></code>, <code class="code docutils literal notranslate"><span class="pre">valid</span></code>, <code class="code docutils literal notranslate"><span class="pre">test</span></code> keys, each
is a dictionary with the following supported options:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>max_secs</p></td>
<td><p>(float) - If a waveform is longer than <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds, randomly crop the waveform into <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds</p></td>
</tr>
<tr class="row-odd"><td><p>sox_effects</p></td>
<td><p>(List[List[str]]) - If not None, apply sox effects on the utterance</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – The metadata csv file for the specific <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p></li>
<li><p><strong>encoder_path</strong> (<em>str</em>) – The pickled encoder path for encoding the labels</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch Dataset</p>
<p>For all train/valid/test mode, the dataset should return each item as a dictionary
containing the following keys:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>x</p></td>
<td><p>(torch.FloatTensor) - the waveform in (seq_len, 1)</p></td>
</tr>
<tr class="row-odd"><td><p>x_len</p></td>
<td><p>(int) - the waveform length <code class="code docutils literal notranslate"><span class="pre">seq_len</span></code></p></td>
</tr>
<tr class="row-even"><td><p>class_id</p></td>
<td><p>(int) - the encoded class id</p></td>
</tr>
<tr class="row-odd"><td><p>label</p></td>
<td><p>(str) - the class name</p></td>
</tr>
<tr class="row-even"><td><p>unique_name</p></td>
<td><p>(str) - the unique id for this datapoint</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearMaestro.build_downstream">
<span class="sig-name descname"><span class="pre">build_downstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L231-L240"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearMaestro.build_downstream" title="Permalink to this definition">#</a></dt>
<dd><p>Return the task-specific downstream model.
By default build the <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code> model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearMaestro.default_config" title="s3prl.problem.HearMaestro.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments of <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code></p></li>
<li><p><strong>downstream_input_size</strong> (<em>int</em>) – the required input size of the model</p></li>
<li><p><strong>downstream_output_size</strong> (<em>int</em>) – the required output size of the model</p></li>
<li><p><strong>downstream_input_stride</strong> (<em>int</em>) – the input feature’s stride (from 16 KHz)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUtteranceModel" title="s3prl.nn.interface.AbsUtteranceModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUtteranceModel</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearMaestro.build_encoder">
<span class="sig-name descname"><span class="pre">build_encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_csv_paths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_fsd.py#L142-L170"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearMaestro.build_encoder" title="Permalink to this definition">#</a></dt>
<dd><p>Build the encoder (for the labels) given the data metadata, and return the saved encoder path.
By default generate and save a <a class="reference internal" href="s3prl.dataio.encoder.html#s3prl.dataio.encoder.CategoryEncoder" title="s3prl.dataio.encoder.CategoryEncoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataio.encoder.CategoryEncoder</span></code></a> from the <code class="code docutils literal notranslate"><span class="pre">label</span></code> column of all the csv files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_encoder</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearMaestro.default_config" title="s3prl.problem.HearMaestro.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Save your encoder into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>train_csv_path</strong> (<em>str</em>) – the train path from <a class="reference internal" href="#s3prl.problem.HearMaestro.prepare_data" title="s3prl.problem.HearMaestro.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>valid_csv_path</strong> (<em>str</em>) – the valid path from <a class="reference internal" href="#s3prl.problem.HearMaestro.prepare_data" title="s3prl.problem.HearMaestro.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>test_csv_paths</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – the test paths from <a class="reference internal" href="#s3prl.problem.HearMaestro.prepare_data" title="s3prl.problem.HearMaestro.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>str</p>
<p>encoder_path: The encoder should be saved in the pickle format</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearMaestro.build_featurizer">
<span class="sig-name descname"><span class="pre">build_featurizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upstream</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L175-L192"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearMaestro.build_featurizer" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the featurizer with <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearMaestro.default_config" title="s3prl.problem.HearMaestro.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p></li>
<li><p><strong>upstream</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">AbsUpstream</span></code>) – the upstream model built by <a class="reference internal" href="#s3prl.problem.HearMaestro.build_upstream" title="s3prl.problem.HearMaestro.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsFeaturizer" title="s3prl.nn.interface.AbsFeaturizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsFeaturizer</span></code></a></p>
<p>Return the featurizer model. The featurizer is used to reduce the multiple
hidden states returned from the upstream model (built by <a class="reference internal" href="#s3prl.problem.HearMaestro.build_upstream" title="s3prl.problem.HearMaestro.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>)
into a single hidden state, so can be easliy fed into the downstream model</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearMaestro.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L194-L231"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearMaestro.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>By default build model with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearMaestro.default_config" title="s3prl.problem.HearMaestro.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p></li>
<li><p><strong>model_output_size</strong> (<em>int</em>) – the required model’s output hidden size</p></li>
<li><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearMaestro.default_config" title="s3prl.problem.HearMaestro.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearMaestro.build_upstream" title="s3prl.problem.HearMaestro.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearMaestro.default_config" title="s3prl.problem.HearMaestro.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearMaestro.build_featurizer" title="s3prl.problem.HearMaestro.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a></p></li>
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearMaestro.default_config" title="s3prl.problem.HearMaestro.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.HearMaestro.build_downstream" title="s3prl.problem.HearMaestro.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch.nn.Module</p>
<p>Return the entire model for the task, which takes the direct items from DataLoader as the input.
Usually, the components can be built by <a class="reference internal" href="#s3prl.problem.HearMaestro.build_upstream" title="s3prl.problem.HearMaestro.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>, <a class="reference internal" href="#s3prl.problem.HearMaestro.build_featurizer" title="s3prl.problem.HearMaestro.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a>,
<a class="reference internal" href="#s3prl.problem.HearMaestro.build_downstream" title="s3prl.problem.HearMaestro.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a>, and are concated together to get the final model.
The upstream extracts multiple hidden states, the featuizer reduce them into a single hidden state,
and the downstream takes the hidden states as the feature for the downstream-specific model.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearMaestro.build_optimizer">
<span class="sig-name descname"><span class="pre">build_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L233-L258"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearMaestro.build_optimizer" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_optimizer</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearMaestro.default_config" title="s3prl.problem.HearMaestro.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to below</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the optimizer class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the optimizer class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;lr&quot;:</span> <span class="pre">1.0e-4}</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>parameters</strong> (<em>iterable</em>) – the standard params accepted by <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code></p>
<p>An optimizer following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearMaestro.build_scheduler">
<span class="sig-name descname"><span class="pre">build_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L260-L285"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearMaestro.build_scheduler" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_scheduler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearMaestro.default_config" title="s3prl.problem.HearMaestro.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the scheduler class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the scheduler class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;gamma&quot;:</span> <span class="pre">0.01}</span></code> for <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler.StepLR</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>optimizer</strong> – the standard torch optimizer accepted by Scheduler in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch scheduler</p>
<p>A scheduler following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearMaestro.build_task">
<span class="sig-name descname"><span class="pre">build_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/hear_dcase_2016_task2.py#L228-L260"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearMaestro.build_task" title="Permalink to this definition">#</a></dt>
<dd><p>Build the task, which defines the logics for every train/valid/test forward step for the <code class="code docutils literal notranslate"><span class="pre">model</span></code>,
and the logics for how to reduce all the batch results from multiple train/valid/test steps into metrics</p>
<p>By default build <code class="xref py py-obj docutils literal notranslate"><span class="pre">UtteranceClassificationTask</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearMaestro.default_config" title="s3prl.problem.HearMaestro.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model built by <a class="reference internal" href="#s3prl.problem.HearMaestro.build_model" title="s3prl.problem.HearMaestro.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a></p></li>
<li><p><strong>encoder</strong> – the encoder built by <a class="reference internal" href="#s3prl.problem.HearMaestro.build_encoder" title="s3prl.problem.HearMaestro.build_encoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_encoder</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Task</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearMaestro.build_upstream">
<span class="sig-name descname"><span class="pre">build_upstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L158-L173"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearMaestro.build_upstream" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the upstream with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearMaestro.default_config" title="s3prl.problem.HearMaestro.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUpstream" title="s3prl.nn.interface.AbsUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUpstream</span></code></a></p>
<p>Return an upstream model, whose forward takes the waveform input and returns
multiple hidden states as features.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearMaestro.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L660-L707"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearMaestro.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>The evaluate routine used by <a class="reference internal" href="#s3prl.problem.HearMaestro.train" title="s3prl.problem.HearMaestro.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> (during validation phase) and <a class="reference internal" href="#s3prl.problem.HearMaestro.run" title="s3prl.problem.HearMaestro.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>
(during testing phase).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evaluate</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearMaestro.default_config" title="s3prl.problem.HearMaestro.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearMaestro.get_class_from_name">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_class_from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L129-L141"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearMaestro.get_class_from_name" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">__name__</span></code> of the problem class</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Problem</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearMaestro.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L752-L772"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearMaestro.load_model" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model_ckpt_dir</strong> (<em>str</em>) – Restore the model with <a class="reference internal" href="#s3prl.problem.HearMaestro.build_model" title="s3prl.problem.HearMaestro.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> and the checkpoint
saved in this directory.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearMaestro.load_model_and_task">
<span class="sig-name descname"><span class="pre">load_model_and_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ckpts_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L884-L902"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearMaestro.load_model_and_task" title="Permalink to this definition">#</a></dt>
<dd><p>This is a helper method to combine <a class="reference internal" href="#s3prl.problem.HearMaestro.load_model" title="s3prl.problem.HearMaestro.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a> and <a class="reference internal" href="#s3prl.problem.HearMaestro.load_task" title="s3prl.problem.HearMaestro.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>
together to directly load the model and the task. This method assumes
the model is saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'model'</span></code> and the task is
saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'task'</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>model (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>)</p></li>
<li><p>task (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a>)</p></li>
</ol>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearMaestro.load_task">
<span class="sig-name descname"><span class="pre">load_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L833-L882"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearMaestro.load_task" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – Restore the task with <a class="reference internal" href="#s3prl.problem.HearMaestro.build_task" title="s3prl.problem.HearMaestro.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> and the checkpoint
saved in this directory.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model for the task, since the model is separately saved
and is required for <a class="reference internal" href="#s3prl.problem.HearMaestro.build_task" title="s3prl.problem.HearMaestro.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a>.</p></li>
<li><p><strong>task_overrides</strong> (<em>dict</em>) – overrides the saved initialization arguments, so can change
the loaded task’s behavior. Like, change the decoding hyperparameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearMaestro.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L954-L995"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearMaestro.main" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearMaestro.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_all_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cuda'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/run.py#L26-L318"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearMaestro.run" title="Permalink to this definition">#</a></dt>
<dd><div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>stage</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Parse the corpus and save the metadata file (waveform path, label…)</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Build the encoder to encode the labels</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Train the model</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Evaluate the model on multiple test sets</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_dir</strong> (<em>str</em>) – The directory that stores the script result.</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – The directory that caches the processed data.
Default: /home/user/.cache/s3prl/data</p></li>
<li><p><strong>remove_all_cache</strong> (<em>bool</em>) – Whether to remove all the cache stored under <cite>cache_dir</cite>.
Default: False</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting stage of the problem script.
Default: 0</p></li>
<li><p><strong>stop</strong> (<em>int</em>) – The stoping stage of the problem script, set <cite>None</cite> to reach the final stage.
Default: None</p></li>
<li><p><strong>num_workers</strong> (<em>int</em>) – num_workers for all the torch DataLoder</p></li>
<li><p><strong>eval_batch</strong> (<em>int</em>) – During evaluation (valid or test), limit the number of batch.
This is helpful for the fast development to check everything won’t crash.
If is -1, disable this feature and evaluate the entire epoch.
Default: -1</p></li>
<li><p><strong>device</strong> (<em>str</em>) – The device type for all torch-related operation: “cpu” or “cuda”
Default: “cuda”</p></li>
<li><p><strong>world_size</strong> (<em>int</em>) – How many processes are running this script simultaneously (in parallel).
Usually this is just 1, however if you are runnig distributed training,
this should be &gt; 1.
Default: 1</p></li>
<li><p><strong>rank</strong> (<em>int</em>) – When distributed training, world_size &gt; 1. Take <code class="code docutils literal notranslate"><span class="pre">world_size</span> <span class="pre">==</span> <span class="pre">8</span></code> for
example, this means 8 processes (8 GPUs) are runing in parallel. The script
needs to know which process among 8 processes it is. In this case, <code class="code docutils literal notranslate"><span class="pre">rank</span></code>
can range from 0~7. All the 8 processes have the same <code class="code docutils literal notranslate"><span class="pre">world_size</span></code> but
different <code class="code docutils literal notranslate"><span class="pre">rank</span></code> (process id).</p></li>
<li><p><strong>test_ckpt_dir</strong> (<em>str</em>) – Specify the checkpoint path for testing. If not, use the validation best
checkpoint under the given <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> directory.</p></li>
<li><p><strong>**kwds</strong> – The other arguments like <code class="code docutils literal notranslate"><span class="pre">prepare_data</span></code> and <code class="code docutils literal notranslate"><span class="pre">build_model</span></code> are
method specific-arguments for methods like <a class="reference internal" href="#s3prl.problem.HearMaestro.prepare_data" title="s3prl.problem.HearMaestro.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> and
<a class="reference internal" href="#s3prl.problem.HearMaestro.build_model" title="s3prl.problem.HearMaestro.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>, and will not be used in the core <a class="reference internal" href="#s3prl.problem.HearMaestro.run" title="s3prl.problem.HearMaestro.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> logic.
See the specific method documentation for their supported arguments and
meaning</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearMaestro.save_model">
<span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L709-L750"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearMaestro.save_model" title="Permalink to this definition">#</a></dt>
<dd><p>Save the model state_dict and the model initialization arguments into the given directory.
If you override this method, it is highly possible you also need to override <a class="reference internal" href="#s3prl.problem.HearMaestro.load_model" title="s3prl.problem.HearMaestro.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearMaestro.default_config" title="s3prl.problem.HearMaestro.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_model</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>model_ckpt_dir</strong> (<em>str</em>) – save the model into the this directory.</p></li>
<li><p><strong>build_model_all_args</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.HearMaestro.build_model" title="s3prl.problem.HearMaestro.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>.
By saving this dictionary, you can easily reconstruct the same model
by calling <a class="reference internal" href="#s3prl.problem.HearMaestro.build_model" title="s3prl.problem.HearMaestro.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearMaestro.save_task">
<span class="sig-name descname"><span class="pre">save_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="s3prl.task.base.html#s3prl.task.base.Task" title="s3prl.task.base.Task"><span class="pre">Task</span></a></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L774-L831"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearMaestro.save_task" title="Permalink to this definition">#</a></dt>
<dd><p>Save the task’s state, <code class="code docutils literal notranslate"><span class="pre">task.get_state()</span></code>, and the initialization arguments into the given
directory. If you override this method, it is highly possible you also need to override
<a class="reference internal" href="#s3prl.problem.HearMaestro.load_task" title="s3prl.problem.HearMaestro.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.HearMaestro.default_config" title="s3prl.problem.HearMaestro.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_task</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – save the task into this directory.</p></li>
<li><p><strong>build_task_all_args_except_model</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.HearMaestro.build_task" title="s3prl.problem.HearMaestro.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> except
the <code class="code docutils literal notranslate"><span class="pre">model</span></code> argument since the model should be sapartely saved by
<a class="reference internal" href="#s3prl.problem.HearMaestro.save_model" title="s3prl.problem.HearMaestro.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a>. By saving this dictionary, you can easily reconstruct the same task
by calling <a class="reference internal" href="#s3prl.problem.HearMaestro.build_task" title="s3prl.problem.HearMaestro.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>task</strong> (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><em>Task</em></a>) – the task to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.HearMaestro.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L287-L658"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.HearMaestro.train" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.HearMaestro.default_config" title="s3prl.problem.HearMaestro.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>total_steps</p></td>
<td><p>(int) - the total optimization steps</p></td>
</tr>
<tr class="row-odd"><td><p>log_step</p></td>
<td><p>(int) - logging frequency. log every <code class="code docutils literal notranslate"><span class="pre">log_step</span></code> step</p></td>
</tr>
<tr class="row-even"><td><p>eval_step</p></td>
<td><p>(int) - evaluation frequency. Evaluate every <code class="code docutils literal notranslate"><span class="pre">eval_step</span></code> step.                                                 Note that you can control how many batch to evaluate to speed up the                                                 development by the <code class="code docutils literal notranslate"><span class="pre">eval_batch</span></code> argument in <a class="reference internal" href="#s3prl.problem.HearMaestro.run" title="s3prl.problem.HearMaestro.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>save_step</p></td>
<td><p>(int) - save the checkpoint every <code class="code docutils literal notranslate"><span class="pre">save_step</span></code> step.</p></td>
</tr>
<tr class="row-even"><td><p>gradient_clipping</p></td>
<td><p>(float) - clip the gradient. important for RNNs.</p></td>
</tr>
<tr class="row-odd"><td><p>gradient_accumulate</p></td>
<td><p>(int) - accumulate multiple steps’ gradient before updating network parameters                                                 to simulate large-batch optimization.</p></td>
</tr>
<tr class="row-even"><td><p>valid_metric</p></td>
<td><p>(str) - the metric to select the best valid checkpoint. Different Tasks have different                                                 supported valid_metrics. See <a class="reference internal" href="#s3prl.problem.HearMaestro.build_task" title="s3prl.problem.HearMaestro.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> for the supported metrics.</p></td>
</tr>
<tr class="row-odd"><td><p>valid_higher_better</p></td>
<td><p>(bool) - some metrics are higher better, while some are lower better                                                 this will affect how to save the best validation checkpoint.</p></td>
</tr>
<tr class="row-even"><td><p>auto_resume</p></td>
<td><p>(bool) - if there are already the last checkpoint in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.HearMaestro.run" title="s3prl.problem.HearMaestro.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>),                                                 whether to resume from it or delete it and start a new training session.</p></td>
</tr>
<tr class="row-odd"><td><p>resume_ckpt_dir</p></td>
<td><p>(str) - you can directly specify the checkpoint path to resume which is not necessary                                                 in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.HearMaestro.run" title="s3prl.problem.HearMaestro.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>).</p></td>
</tr>
<tr class="row-even"><td><p>seed</p></td>
<td><p>(int) - fix the seed before the training start</p></td>
</tr>
<tr class="row-odd"><td><p>keep_num_ckpts</p></td>
<td><p>(int) - to prevent saving too many checkpoints, only save the <code class="code docutils literal notranslate"><span class="pre">keep_num_ckpts</span></code>                                                 latest checkpoints and delete the old ones.</p></td>
</tr>
<tr class="row-even"><td><p>use_scheduler</p></td>
<td><p>(bool) - whether to use the scheduler</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="commonexample">
<h2>CommonExample<a class="headerlink" href="#commonexample" title="Permalink to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="s3prl.problem.CommonExample">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">s3prl.problem.</span></span><span class="sig-name descname"><span class="pre">CommonExample</span></span><a class="reference internal" href="../_modules/s3prl/problem/common/example.html#CommonExample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/example.py#L12-L58"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.CommonExample" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="s3prl.problem.common.superb_sid.html#s3prl.problem.common.superb_sid.SuperbSID" title="s3prl.problem.common.superb_sid.SuperbSID"><code class="xref py py-class docutils literal notranslate"><span class="pre">SuperbSID</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.CommonExample.default_config">
<span class="sig-name descname"><span class="pre">default_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/s3prl/problem/common/example.html#CommonExample.default_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/example.py#L13-L27"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.CommonExample.default_config" title="Permalink to this definition">#</a></dt>
<dd><p>The default arguments for <a class="reference internal" href="#s3prl.problem.CommonExample.run" title="s3prl.problem.CommonExample.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> in yaml.
Note that for the fields with inner values, like <code class="code docutils literal notranslate"><span class="pre">build_model</span></code>,
the outer field name corresponds to a method name, so you can find the method
<a class="reference internal" href="#s3prl.problem.CommonExample.build_model" title="s3prl.problem.CommonExample.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>. Furthermore, the values inside that field will be
directly passed into the method. So by changing these inner values, you
can directly affect the behavior of the corresponding method. See the method
documentation for all the supported arguments and their meanings.</p>
<p>The methods affected by the following config are: <a class="reference internal" href="#s3prl.problem.CommonExample.prepare_data" title="s3prl.problem.CommonExample.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> <a class="reference internal" href="#s3prl.problem.CommonExample.build_encoder" title="s3prl.problem.CommonExample.build_encoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_encoder</span></code></a> <a class="reference internal" href="#s3prl.problem.CommonExample.build_dataset" title="s3prl.problem.CommonExample.build_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_dataset</span></code></a> <a class="reference internal" href="#s3prl.problem.CommonExample.build_batch_sampler" title="s3prl.problem.CommonExample.build_batch_sampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_batch_sampler</span></code></a> <a class="reference internal" href="#s3prl.problem.CommonExample.build_upstream" title="s3prl.problem.CommonExample.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a> <a class="reference internal" href="#s3prl.problem.CommonExample.build_featurizer" title="s3prl.problem.CommonExample.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a> <a class="reference internal" href="#s3prl.problem.CommonExample.build_downstream" title="s3prl.problem.CommonExample.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a> <a class="reference internal" href="#s3prl.problem.CommonExample.build_model" title="s3prl.problem.CommonExample.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> <a class="reference internal" href="#s3prl.problem.CommonExample.build_task" title="s3prl.problem.CommonExample.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> <a class="reference internal" href="#s3prl.problem.CommonExample.build_optimizer" title="s3prl.problem.CommonExample.build_optimizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_optimizer</span></code></a> <a class="reference internal" href="#s3prl.problem.CommonExample.build_scheduler" title="s3prl.problem.CommonExample.build_scheduler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_scheduler</span></code></a> <a class="reference internal" href="#s3prl.problem.CommonExample.save_model" title="s3prl.problem.CommonExample.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a> <a class="reference internal" href="#s3prl.problem.CommonExample.save_task" title="s3prl.problem.CommonExample.save_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_task</span></code></a> <a class="reference internal" href="#s3prl.problem.CommonExample.train" title="s3prl.problem.CommonExample.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> <a class="reference internal" href="#s3prl.problem.CommonExample.evaluate" title="s3prl.problem.CommonExample.evaluate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate</span></code></a></p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">start</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0</span>
<span class="nt">stop</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">target_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">cache_dir</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="nt">remove_all_cache</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">prepare_data</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">build_encoder</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">build_dataset</span><span class="p">:</span>
<span class="w">  </span><span class="nt">train</span><span class="p">:</span>
<span class="w">    </span><span class="nt">max_secs</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8.0</span>
<span class="nt">build_batch_sampler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">train</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8</span>
<span class="w">    </span><span class="nt">shuffle</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">valid</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">test</span><span class="p">:</span>
<span class="w">    </span><span class="nt">batch_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="nt">build_upstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">???</span>
<span class="nt">build_featurizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">layer_selections</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">null</span>
<span class="w">  </span><span class="nt">normalize</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_downstream</span><span class="p">:</span>
<span class="w">  </span><span class="nt">hidden_size</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">256</span>
<span class="nt">build_model</span><span class="p">:</span>
<span class="w">  </span><span class="nt">upstream_trainable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="nt">build_task</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">build_optimizer</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Adam</span>
<span class="w">  </span><span class="nt">conf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">lr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0001</span>
<span class="nt">build_scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ExponentialLR</span>
<span class="w">  </span><span class="nt">gamma</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.9</span>
<span class="nt">save_model</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">save_task</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
<span class="nt">train</span><span class="p">:</span>
<span class="w">  </span><span class="nt">total_steps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10</span>
<span class="w">  </span><span class="nt">log_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">eval_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">  </span><span class="nt">save_step</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5</span>
<span class="w">  </span><span class="nt">gradient_clipping</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0</span>
<span class="w">  </span><span class="nt">gradient_accumulate</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">valid_metric</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">accuracy</span>
<span class="w">  </span><span class="nt">valid_higher_better</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">auto_resume</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="nt">evaluate</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.CommonExample.prepare_data">
<span class="sig-name descname"><span class="pre">prepare_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/s3prl/problem/common/example.html#CommonExample.prepare_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/example.py#L29-L58"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.CommonExample.prepare_data" title="Permalink to this definition">#</a></dt>
<dd><p>Prepare the task-specific data metadata (path, labels…).
By default call <code class="xref py py-obj docutils literal notranslate"><span class="pre">voxceleb1_for_sid</span></code> with <code class="code docutils literal notranslate"><span class="pre">**prepare_data</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prepare_data</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.CommonExample.default_config" title="s3prl.problem.CommonExample.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments in <code class="xref py py-obj docutils literal notranslate"><span class="pre">voxceleb1_for_sid</span></code></p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Parse your corpus and save the csv file into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the parsing or preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>train_path (str)</p></li>
<li><p>valid_path (str)</p></li>
<li><p>test_paths (List[str])</p></li>
</ol>
<p>Each path (str) should be a csv file containing the following columns:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>column</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>id</p></td>
<td><p>(str) - the unique id for this data point</p></td>
</tr>
<tr class="row-odd"><td><p>wav_path</p></td>
<td><p>(str) - the absolute path of the waveform file</p></td>
</tr>
<tr class="row-even"><td><p>label</p></td>
<td><p>(str) - a string label of the waveform</p></td>
</tr>
<tr class="row-odd"><td><p>start_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">start_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load from the beginning.</p></td>
</tr>
<tr class="row-even"><td><p>end_sec</p></td>
<td><p>(float) - optional, load the waveform from <code class="code docutils literal notranslate"><span class="pre">end_sec</span></code> seconds. If not presented or is <code class="code docutils literal notranslate"><span class="pre">math.nan</span></code>, load to the end.</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.CommonExample.build_batch_sampler">
<span class="sig-name descname"><span class="pre">build_batch_sampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/superb_sid.py#L360-L411"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.CommonExample.build_batch_sampler" title="Permalink to this definition">#</a></dt>
<dd><p>Return the batch sampler for torch DataLoader.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_batch_sampler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.CommonExample.default_config" title="s3prl.problem.CommonExample.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>train</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>valid</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
<tr class="row-even"><td><p>test</p></td>
<td><p>(dict) - arguments for <code class="xref py py-obj docutils literal notranslate"><span class="pre">FixedBatchSizeBatchSampler</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">mode</span></code> specific csv from <a class="reference internal" href="#s3prl.problem.CommonExample.prepare_data" title="s3prl.problem.CommonExample.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>dataset</strong> – the dataset from <a class="reference internal" href="#s3prl.problem.CommonExample.build_dataset" title="s3prl.problem.CommonExample.build_dataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_dataset</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>batch sampler for torch DataLoader</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.CommonExample.build_collate_fn">
<span class="sig-name descname"><span class="pre">build_collate_fn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L143-L156"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.CommonExample.build_collate_fn" title="Permalink to this definition">#</a></dt>
<dd><p>By default returns <code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataset.base.default_collate_fn</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_collate_fn</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.CommonExample.default_config" title="s3prl.problem.CommonExample.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train, valid, or test</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>callable</p>
<p>the collate_fn for torch DataLoader in train/valid/test <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.CommonExample.build_dataset">
<span class="sig-name descname"><span class="pre">build_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_csv</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frame_shift</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/superb_sid.py#L244-L358"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.CommonExample.build_dataset" title="Permalink to this definition">#</a></dt>
<dd><p>Build the dataset for train/valid/test.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_dataset</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.CommonExample.default_config" title="s3prl.problem.CommonExample.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>. with <code class="code docutils literal notranslate"><span class="pre">train</span></code>, <code class="code docutils literal notranslate"><span class="pre">valid</span></code>, <code class="code docutils literal notranslate"><span class="pre">test</span></code> keys, each
is a dictionary with the following supported options:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>max_secs</p></td>
<td><p>(float) - If a waveform is longer than <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds, randomly crop the waveform into <code class="code docutils literal notranslate"><span class="pre">max_secs</span></code> seconds</p></td>
</tr>
<tr class="row-odd"><td><p>sox_effects</p></td>
<td><p>(List[List[str]]) - If not None, apply sox effects on the utterance</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Current experiment directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>mode</strong> (<em>str</em>) – train/valid/test</p></li>
<li><p><strong>data_csv</strong> (<em>str</em>) – The metadata csv file for the specific <code class="code docutils literal notranslate"><span class="pre">mode</span></code></p></li>
<li><p><strong>encoder_path</strong> (<em>str</em>) – The pickled encoder path for encoding the labels</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch Dataset</p>
<p>For all train/valid/test mode, the dataset should return each item as a dictionary
containing the following keys:</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>x</p></td>
<td><p>(torch.FloatTensor) - the waveform in (seq_len, 1)</p></td>
</tr>
<tr class="row-odd"><td><p>x_len</p></td>
<td><p>(int) - the waveform length <code class="code docutils literal notranslate"><span class="pre">seq_len</span></code></p></td>
</tr>
<tr class="row-even"><td><p>class_id</p></td>
<td><p>(int) - the encoded class id</p></td>
</tr>
<tr class="row-odd"><td><p>label</p></td>
<td><p>(str) - the class name</p></td>
</tr>
<tr class="row-even"><td><p>unique_name</p></td>
<td><p>(str) - the unique id for this datapoint</p></td>
</tr>
</tbody>
</table>
</div>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.CommonExample.build_downstream">
<span class="sig-name descname"><span class="pre">build_downstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">downstream_input_stride</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/superb_sid.py#L413-L436"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.CommonExample.build_downstream" title="Permalink to this definition">#</a></dt>
<dd><p>Return the task-specific downstream model.
By default build the <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code> model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.CommonExample.default_config" title="s3prl.problem.CommonExample.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, support arguments of <code class="xref py py-obj docutils literal notranslate"><span class="pre">MeanPoolingLinear</span></code></p></li>
<li><p><strong>downstream_input_size</strong> (<em>int</em>) – the required input size of the model</p></li>
<li><p><strong>downstream_output_size</strong> (<em>int</em>) – the required output size of the model</p></li>
<li><p><strong>downstream_input_stride</strong> (<em>int</em>) – the input feature’s stride (from 16 KHz)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUtteranceModel" title="s3prl.nn.interface.AbsUtteranceModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUtteranceModel</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.CommonExample.build_encoder">
<span class="sig-name descname"><span class="pre">build_encoder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_csv_path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_csv_paths</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">get_path_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/superb_sid.py#L198-L242"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.CommonExample.build_encoder" title="Permalink to this definition">#</a></dt>
<dd><p>Build the encoder (for the labels) given the data metadata, and return the saved encoder path.
By default generate and save a <a class="reference internal" href="s3prl.dataio.encoder.html#s3prl.dataio.encoder.CategoryEncoder" title="s3prl.dataio.encoder.CategoryEncoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.dataio.encoder.CategoryEncoder</span></code></a> from the <code class="code docutils literal notranslate"><span class="pre">label</span></code> column of all the csv files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_encoder</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.CommonExample.default_config" title="s3prl.problem.CommonExample.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>target_dir</strong> (<em>str</em>) – Save your encoder into this directory</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – If the preprocessing takes too long time, you can save
the temporary files into this directory. This directory is expected to be shared
across different training sessions (different hypers and <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code>)</p></li>
<li><p><strong>train_csv_path</strong> (<em>str</em>) – the train path from <a class="reference internal" href="#s3prl.problem.CommonExample.prepare_data" title="s3prl.problem.CommonExample.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>valid_csv_path</strong> (<em>str</em>) – the valid path from <a class="reference internal" href="#s3prl.problem.CommonExample.prepare_data" title="s3prl.problem.CommonExample.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>test_csv_paths</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – the test paths from <a class="reference internal" href="#s3prl.problem.CommonExample.prepare_data" title="s3prl.problem.CommonExample.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a></p></li>
<li><p><strong>get_path_only</strong> (<em>str</em>) – Directly return the filepaths no matter they exist or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>str</p>
<p>encoder_path: The encoder should be saved in the pickle format</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.CommonExample.build_featurizer">
<span class="sig-name descname"><span class="pre">build_featurizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upstream</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L175-L192"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.CommonExample.build_featurizer" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the featurizer with <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.CommonExample.default_config" title="s3prl.problem.CommonExample.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.html#s3prl.nn.Featurizer" title="s3prl.nn.Featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.Featurizer</span></code></a></p></li>
<li><p><strong>upstream</strong> (<code class="xref py py-obj docutils literal notranslate"><span class="pre">AbsUpstream</span></code>) – the upstream model built by <a class="reference internal" href="#s3prl.problem.CommonExample.build_upstream" title="s3prl.problem.CommonExample.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsFeaturizer" title="s3prl.nn.interface.AbsFeaturizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsFeaturizer</span></code></a></p>
<p>Return the featurizer model. The featurizer is used to reduce the multiple
hidden states returned from the upstream model (built by <a class="reference internal" href="#s3prl.problem.CommonExample.build_upstream" title="s3prl.problem.CommonExample.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>)
into a single hidden state, so can be easliy fed into the downstream model</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.CommonExample.build_model">
<span class="sig-name descname"><span class="pre">build_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_output_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L194-L231"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.CommonExample.build_model" title="Permalink to this definition">#</a></dt>
<dd><p>By default build model with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.CommonExample.default_config" title="s3prl.problem.CommonExample.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.UpstreamDownstreamModel" title="s3prl.nn.upstream.UpstreamDownstreamModel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.UpstreamDownstreamModel</span></code></a></p></li>
<li><p><strong>model_output_size</strong> (<em>int</em>) – the required model’s output hidden size</p></li>
<li><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.CommonExample.default_config" title="s3prl.problem.CommonExample.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.CommonExample.build_upstream" title="s3prl.problem.CommonExample.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a></p></li>
<li><p><strong>build_featurizer</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.CommonExample.default_config" title="s3prl.problem.CommonExample.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.CommonExample.build_featurizer" title="s3prl.problem.CommonExample.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a></p></li>
<li><p><strong>build_downstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.CommonExample.default_config" title="s3prl.problem.CommonExample.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to <a class="reference internal" href="#s3prl.problem.CommonExample.build_downstream" title="s3prl.problem.CommonExample.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch.nn.Module</p>
<p>Return the entire model for the task, which takes the direct items from DataLoader as the input.
Usually, the components can be built by <a class="reference internal" href="#s3prl.problem.CommonExample.build_upstream" title="s3prl.problem.CommonExample.build_upstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_upstream</span></code></a>, <a class="reference internal" href="#s3prl.problem.CommonExample.build_featurizer" title="s3prl.problem.CommonExample.build_featurizer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_featurizer</span></code></a>,
<a class="reference internal" href="#s3prl.problem.CommonExample.build_downstream" title="s3prl.problem.CommonExample.build_downstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_downstream</span></code></a>, and are concated together to get the final model.
The upstream extracts multiple hidden states, the featuizer reduce them into a single hidden state,
and the downstream takes the hidden states as the feature for the downstream-specific model.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.CommonExample.build_optimizer">
<span class="sig-name descname"><span class="pre">build_optimizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parameters</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L233-L258"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.CommonExample.build_optimizer" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_optimizer</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.CommonExample.default_config" title="s3prl.problem.CommonExample.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, refer to below</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the optimizer class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the optimizer class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;lr&quot;:</span> <span class="pre">1.0e-4}</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>parameters</strong> (<em>iterable</em>) – the standard params accepted by <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code></p>
<p>An optimizer following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.CommonExample.build_scheduler">
<span class="sig-name descname"><span class="pre">build_scheduler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L260-L285"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.CommonExample.build_scheduler" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_scheduler</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.CommonExample.default_config" title="s3prl.problem.CommonExample.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>(str) - the scheduler class name in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>conf</p></td>
<td><p>(dict) - the arguments for initializing the scheduler class. e.g. <code class="code docutils literal notranslate"><span class="pre">{&quot;gamma&quot;:</span> <span class="pre">0.01}</span></code> for <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler.StepLR</span></code></p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>optimizer</strong> – the standard torch optimizer accepted by Scheduler in <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.optim.lr_scheduler</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>torch scheduler</p>
<p>A scheduler following standard torch usage</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.CommonExample.build_task">
<span class="sig-name descname"><span class="pre">build_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">encoder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">DataFrame</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/run.py#L352-L375"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.CommonExample.build_task" title="Permalink to this definition">#</a></dt>
<dd><p>Build the task, which defines the logics for every train/valid/test forward step for the <code class="code docutils literal notranslate"><span class="pre">model</span></code>,
and the logics for how to reduce all the batch results from multiple train/valid/test steps into metrics</p>
<p>By default build <code class="xref py py-obj docutils literal notranslate"><span class="pre">UtteranceClassificationTask</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>build_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.CommonExample.default_config" title="s3prl.problem.CommonExample.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model built by <a class="reference internal" href="#s3prl.problem.CommonExample.build_model" title="s3prl.problem.CommonExample.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a></p></li>
<li><p><strong>encoder</strong> – the encoder built by <a class="reference internal" href="#s3prl.problem.CommonExample.build_encoder" title="s3prl.problem.CommonExample.build_encoder"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_encoder</span></code></a></p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Task</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.CommonExample.build_upstream">
<span class="sig-name descname"><span class="pre">build_upstream</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L158-L173"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.CommonExample.build_upstream" title="Permalink to this definition">#</a></dt>
<dd><p>By default build the upstream with <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>build_upstream</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.CommonExample.default_config" title="s3prl.problem.CommonExample.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>,
arguments for <a class="reference internal" href="s3prl.nn.upstream.html#s3prl.nn.upstream.S3PRLUpstream" title="s3prl.nn.upstream.S3PRLUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.upstream.S3PRLUpstream</span></code></a></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p><a class="reference internal" href="s3prl.nn.interface.html#s3prl.nn.interface.AbsUpstream" title="s3prl.nn.interface.AbsUpstream"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.nn.interface.AbsUpstream</span></code></a></p>
<p>Return an upstream model, whose forward takes the waveform input and returns
multiple hidden states as features.</p>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.CommonExample.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dump_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L660-L707"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.CommonExample.evaluate" title="Permalink to this definition">#</a></dt>
<dd><p>The evaluate routine used by <a class="reference internal" href="#s3prl.problem.CommonExample.train" title="s3prl.problem.CommonExample.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">train</span></code></a> (during validation phase) and <a class="reference internal" href="#s3prl.problem.CommonExample.run" title="s3prl.problem.CommonExample.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>
(during testing phase).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evaluate</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.CommonExample.default_config" title="s3prl.problem.CommonExample.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, no argument supported for now</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.CommonExample.get_class_from_name">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_class_from_name</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L129-L141"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.CommonExample.get_class_from_name" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>name</strong> (<em>str</em>) – the <code class="code docutils literal notranslate"><span class="pre">__name__</span></code> of the problem class</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Problem</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.CommonExample.load_model">
<span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L752-L772"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.CommonExample.load_model" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model_ckpt_dir</strong> (<em>str</em>) – Restore the model with <a class="reference internal" href="#s3prl.problem.CommonExample.build_model" title="s3prl.problem.CommonExample.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> and the checkpoint
saved in this directory.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.CommonExample.load_model_and_task">
<span class="sig-name descname"><span class="pre">load_model_and_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ckpts_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L884-L902"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.CommonExample.load_model_and_task" title="Permalink to this definition">#</a></dt>
<dd><p>This is a helper method to combine <a class="reference internal" href="#s3prl.problem.CommonExample.load_model" title="s3prl.problem.CommonExample.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a> and <a class="reference internal" href="#s3prl.problem.CommonExample.load_task" title="s3prl.problem.CommonExample.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>
together to directly load the model and the task. This method assumes
the model is saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'model'</span></code> and the task is
saved under <code class="code docutils literal notranslate"><span class="pre">ckpts_dir</span> <span class="pre">/</span> <span class="pre">'task'</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><p>tuple</p>
<ol class="arabic simple">
<li><p>model (<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.nn.Module</span></code>)</p></li>
<li><p>task (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a>)</p></li>
</ol>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.CommonExample.load_task">
<span class="sig-name descname"><span class="pre">load_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L833-L882"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.CommonExample.load_task" title="Permalink to this definition">#</a></dt>
<dd><p>Return the saved task.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – Restore the task with <a class="reference internal" href="#s3prl.problem.CommonExample.build_task" title="s3prl.problem.CommonExample.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> and the checkpoint
saved in this directory.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model for the task, since the model is separately saved
and is required for <a class="reference internal" href="#s3prl.problem.CommonExample.build_task" title="s3prl.problem.CommonExample.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a>.</p></li>
<li><p><strong>task_overrides</strong> (<em>dict</em>) – overrides the saved initialization arguments, so can change
the loaded task’s behavior. Like, change the decoding hyperparameters.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">s3prl.task.Task</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.CommonExample.main">
<span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L954-L995"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.CommonExample.main" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.CommonExample.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">target_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cache_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_all_cache</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stop</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'cuda'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prepare_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_encoder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_dataset</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_batch_sampler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_collate_fn</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_upstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_featurizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_downstream</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/common/run.py#L26-L318"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.CommonExample.run" title="Permalink to this definition">#</a></dt>
<dd><div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>stage</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>0</p></td>
<td><p>Parse the corpus and save the metadata file (waveform path, label…)</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>Build the encoder to encode the labels</p></td>
</tr>
<tr class="row-even"><td><p>2</p></td>
<td><p>Train the model</p></td>
</tr>
<tr class="row-odd"><td><p>3</p></td>
<td><p>Evaluate the model on multiple test sets</p></td>
</tr>
</tbody>
</table>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target_dir</strong> (<em>str</em>) – The directory that stores the script result.</p></li>
<li><p><strong>cache_dir</strong> (<em>str</em>) – The directory that caches the processed data.
Default: /home/user/.cache/s3prl/data</p></li>
<li><p><strong>remove_all_cache</strong> (<em>bool</em>) – Whether to remove all the cache stored under <cite>cache_dir</cite>.
Default: False</p></li>
<li><p><strong>start</strong> (<em>int</em>) – The starting stage of the problem script.
Default: 0</p></li>
<li><p><strong>stop</strong> (<em>int</em>) – The stoping stage of the problem script, set <cite>None</cite> to reach the final stage.
Default: None</p></li>
<li><p><strong>num_workers</strong> (<em>int</em>) – num_workers for all the torch DataLoder</p></li>
<li><p><strong>eval_batch</strong> (<em>int</em>) – During evaluation (valid or test), limit the number of batch.
This is helpful for the fast development to check everything won’t crash.
If is -1, disable this feature and evaluate the entire epoch.
Default: -1</p></li>
<li><p><strong>device</strong> (<em>str</em>) – The device type for all torch-related operation: “cpu” or “cuda”
Default: “cuda”</p></li>
<li><p><strong>world_size</strong> (<em>int</em>) – How many processes are running this script simultaneously (in parallel).
Usually this is just 1, however if you are runnig distributed training,
this should be &gt; 1.
Default: 1</p></li>
<li><p><strong>rank</strong> (<em>int</em>) – When distributed training, world_size &gt; 1. Take <code class="code docutils literal notranslate"><span class="pre">world_size</span> <span class="pre">==</span> <span class="pre">8</span></code> for
example, this means 8 processes (8 GPUs) are runing in parallel. The script
needs to know which process among 8 processes it is. In this case, <code class="code docutils literal notranslate"><span class="pre">rank</span></code>
can range from 0~7. All the 8 processes have the same <code class="code docutils literal notranslate"><span class="pre">world_size</span></code> but
different <code class="code docutils literal notranslate"><span class="pre">rank</span></code> (process id).</p></li>
<li><p><strong>test_ckpt_dir</strong> (<em>str</em>) – Specify the checkpoint path for testing. If not, use the validation best
checkpoint under the given <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> directory.</p></li>
<li><p><strong>**kwds</strong> – The other arguments like <code class="code docutils literal notranslate"><span class="pre">prepare_data</span></code> and <code class="code docutils literal notranslate"><span class="pre">build_model</span></code> are
method specific-arguments for methods like <a class="reference internal" href="#s3prl.problem.CommonExample.prepare_data" title="s3prl.problem.CommonExample.prepare_data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">prepare_data</span></code></a> and
<a class="reference internal" href="#s3prl.problem.CommonExample.build_model" title="s3prl.problem.CommonExample.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>, and will not be used in the core <a class="reference internal" href="#s3prl.problem.CommonExample.run" title="s3prl.problem.CommonExample.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a> logic.
See the specific method documentation for their supported arguments and
meaning</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.CommonExample.save_model">
<span class="sig-name descname"><span class="pre">save_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Module</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L709-L750"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.CommonExample.save_model" title="Permalink to this definition">#</a></dt>
<dd><p>Save the model state_dict and the model initialization arguments into the given directory.
If you override this method, it is highly possible you also need to override <a class="reference internal" href="#s3prl.problem.CommonExample.load_model" title="s3prl.problem.CommonExample.load_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_model</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_model</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.CommonExample.default_config" title="s3prl.problem.CommonExample.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_model</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>model_ckpt_dir</strong> (<em>str</em>) – save the model into the this directory.</p></li>
<li><p><strong>build_model_all_args</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.CommonExample.build_model" title="s3prl.problem.CommonExample.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a>.
By saving this dictionary, you can easily reconstruct the same model
by calling <a class="reference internal" href="#s3prl.problem.CommonExample.build_model" title="s3prl.problem.CommonExample.build_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_model</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>model</strong> (<em>torch.nn.Module</em>) – the model to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.CommonExample.save_task">
<span class="sig-name descname"><span class="pre">save_task</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task_ckpt_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="s3prl.task.base.html#s3prl.task.base.Task" title="s3prl.task.base.Task"><span class="pre">Task</span></a></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L774-L831"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.CommonExample.save_task" title="Permalink to this definition">#</a></dt>
<dd><p>Save the task’s state, <code class="code docutils literal notranslate"><span class="pre">task.get_state()</span></code>, and the initialization arguments into the given
directory. If you override this method, it is highly possible you also need to override
<a class="reference internal" href="#s3prl.problem.CommonExample.load_task" title="s3prl.problem.CommonExample.load_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_task</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_task</strong> (<em>dict</em>) – same in <a class="reference internal" href="#s3prl.problem.CommonExample.default_config" title="s3prl.problem.CommonExample.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a>, so the user can save additional settings,
like the configuration of the dataset by duplicating the dataset hypers
inside the <code class="code docutils literal notranslate"><span class="pre">save_task</span></code> field. You can rely on the <code class="code docutils literal notranslate"><span class="pre">omegaconf</span></code>
package to simplify the duplication.</p></li>
<li><p><strong>task_ckpt_dir</strong> (<em>str</em>) – save the task into this directory.</p></li>
<li><p><strong>build_task_all_args_except_model</strong> (<em>dict</em>) – all the arguments of <a class="reference internal" href="#s3prl.problem.CommonExample.build_task" title="s3prl.problem.CommonExample.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> except
the <code class="code docutils literal notranslate"><span class="pre">model</span></code> argument since the model should be sapartely saved by
<a class="reference internal" href="#s3prl.problem.CommonExample.save_model" title="s3prl.problem.CommonExample.save_model"><code class="xref py py-obj docutils literal notranslate"><span class="pre">save_model</span></code></a>. By saving this dictionary, you can easily reconstruct the same task
by calling <a class="reference internal" href="#s3prl.problem.CommonExample.build_task" title="s3prl.problem.CommonExample.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> with the saved dictionary.</p></li>
<li><p><strong>task</strong> (<a class="reference internal" href="s3prl.task.html#s3prl.task.Task" title="s3prl.task.Task"><em>Task</em></a>) – the task to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="s3prl.problem.CommonExample.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_model_all_args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_task_all_args_except_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_task</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">build_scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">evaluate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_dataset</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_batch_sampler</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">valid_collate_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_workers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">world_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eval_batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference external" href="https://github.com/s3prl/s3prl/blob/v0.4.13 /s3prl/problem/base.py#L287-L658"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#s3prl.problem.CommonExample.train" title="Permalink to this definition">#</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train</strong> (<em>dict</em>) – <p>same in <a class="reference internal" href="#s3prl.problem.CommonExample.default_config" title="s3prl.problem.CommonExample.default_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">default_config</span></code></a></p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>key</p></th>
<th class="head"><p>description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>total_steps</p></td>
<td><p>(int) - the total optimization steps</p></td>
</tr>
<tr class="row-odd"><td><p>log_step</p></td>
<td><p>(int) - logging frequency. log every <code class="code docutils literal notranslate"><span class="pre">log_step</span></code> step</p></td>
</tr>
<tr class="row-even"><td><p>eval_step</p></td>
<td><p>(int) - evaluation frequency. Evaluate every <code class="code docutils literal notranslate"><span class="pre">eval_step</span></code> step.                                                 Note that you can control how many batch to evaluate to speed up the                                                 development by the <code class="code docutils literal notranslate"><span class="pre">eval_batch</span></code> argument in <a class="reference internal" href="#s3prl.problem.CommonExample.run" title="s3prl.problem.CommonExample.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p>save_step</p></td>
<td><p>(int) - save the checkpoint every <code class="code docutils literal notranslate"><span class="pre">save_step</span></code> step.</p></td>
</tr>
<tr class="row-even"><td><p>gradient_clipping</p></td>
<td><p>(float) - clip the gradient. important for RNNs.</p></td>
</tr>
<tr class="row-odd"><td><p>gradient_accumulate</p></td>
<td><p>(int) - accumulate multiple steps’ gradient before updating network parameters                                                 to simulate large-batch optimization.</p></td>
</tr>
<tr class="row-even"><td><p>valid_metric</p></td>
<td><p>(str) - the metric to select the best valid checkpoint. Different Tasks have different                                                 supported valid_metrics. See <a class="reference internal" href="#s3prl.problem.CommonExample.build_task" title="s3prl.problem.CommonExample.build_task"><code class="xref py py-obj docutils literal notranslate"><span class="pre">build_task</span></code></a> for the supported metrics.</p></td>
</tr>
<tr class="row-odd"><td><p>valid_higher_better</p></td>
<td><p>(bool) - some metrics are higher better, while some are lower better                                                 this will affect how to save the best validation checkpoint.</p></td>
</tr>
<tr class="row-even"><td><p>auto_resume</p></td>
<td><p>(bool) - if there are already the last checkpoint in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.CommonExample.run" title="s3prl.problem.CommonExample.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>),                                                 whether to resume from it or delete it and start a new training session.</p></td>
</tr>
<tr class="row-odd"><td><p>resume_ckpt_dir</p></td>
<td><p>(str) - you can directly specify the checkpoint path to resume which is not necessary                                                 in <code class="code docutils literal notranslate"><span class="pre">target_dir</span></code> (see <a class="reference internal" href="#s3prl.problem.CommonExample.run" title="s3prl.problem.CommonExample.run"><code class="xref py py-obj docutils literal notranslate"><span class="pre">run</span></code></a>).</p></td>
</tr>
<tr class="row-even"><td><p>seed</p></td>
<td><p>(int) - fix the seed before the training start</p></td>
</tr>
<tr class="row-odd"><td><p>keep_num_ckpts</p></td>
<td><p>(int) - to prevent saving too many checkpoints, only save the <code class="code docutils literal notranslate"><span class="pre">keep_num_ckpts</span></code>                                                 latest checkpoints and delete the old ones.</p></td>
</tr>
<tr class="row-even"><td><p>use_scheduler</p></td>
<td><p>(bool) - whether to use the scheduler</p></td>
</tr>
</tbody>
</table>
</div>
</p></li>
<li><p><strong>**others</strong> – only meaningful when you want to override this train method, which is not the
common case. Hence we skip the documentation for now.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="s3prl.problem.asr.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">asr</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="s3prl.nn.upstream.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">upstream</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, S3PRL Team
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">problem</a><ul>
<li><a class="reference internal" href="#superbasr">SuperbASR</a></li>
<li><a class="reference internal" href="#superbpr">SuperbPR</a></li>
<li><a class="reference internal" href="#superbsf">SuperbSF</a></li>
<li><a class="reference internal" href="#superbasv">SuperbASV</a></li>
<li><a class="reference internal" href="#superber">SuperbER</a></li>
<li><a class="reference internal" href="#superbic">SuperbIC</a></li>
<li><a class="reference internal" href="#superbks">SuperbKS</a></li>
<li><a class="reference internal" href="#superbsid">SuperbSID</a></li>
<li><a class="reference internal" href="#superbsd">SuperbSD</a></li>
<li><a class="reference internal" href="#hearfsd">HearFSD</a></li>
<li><a class="reference internal" href="#hearesc50">HearESC50</a></li>
<li><a class="reference internal" href="#hearbeijingopera">HearBeijingOpera</a></li>
<li><a class="reference internal" href="#hearcremad">HearCremaD</a></li>
<li><a class="reference internal" href="#heargsc5hr">HearGSC5hr</a></li>
<li><a class="reference internal" href="#heargtzanmusicspeech">HearGtzanMusicSpeech</a></li>
<li><a class="reference internal" href="#heargtzan">HearGtzan</a></li>
<li><a class="reference internal" href="#heargunshot">HearGunshot</a></li>
<li><a class="reference internal" href="#hearlibricount">HearLibriCount</a></li>
<li><a class="reference internal" href="#hearnsynth5hr">HearNsynth5hr</a></li>
<li><a class="reference internal" href="#hearstroke">HearStroke</a></li>
<li><a class="reference internal" href="#heartonic">HearTonic</a></li>
<li><a class="reference internal" href="#hearvocal">HearVocal</a></li>
<li><a class="reference internal" href="#hearvoxlingual">HearVoxLingual</a></li>
<li><a class="reference internal" href="#heardcase2016task2">HearDcase2016Task2</a></li>
<li><a class="reference internal" href="#hearmaestro">HearMaestro</a></li>
<li><a class="reference internal" href="#commonexample">CommonExample</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script src="../_static/js/custom.js"></script>
    </body>
</html>